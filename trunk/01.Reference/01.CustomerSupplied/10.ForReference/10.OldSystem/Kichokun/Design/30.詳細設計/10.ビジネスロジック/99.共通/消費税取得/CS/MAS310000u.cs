using System;
using System.Drawing;
using System.Collections.Generic;
using System.Threading;
using System.Windows.Forms;
using System.ComponentModel;
using System.Collections;
using System.IO;
using MAS310000SwkExclusiveu;
using MAS310000Dlgu;
using MAS310000SubMenuu;
using MAS310000CldFormDlgu;
using VKZ310Cmnu;
using VKZ310AppEntryu;
 // ************************************************************************
 // *		Systeme			:	新会計システム
 // *		Program			:	日常処理仕訳指示
 // *		ProgramID		:	MAS310000
 // *		Name			:	K.Hattori
 // *		Create			:	2001/03/31
 // *		Comment			:	システムメニュー及び各集計表表示画面より呼び出され、
 // *							仕訳入力、元帳表示、検証機能等のコントロールを行う。
 // *
 // *		History			:	XXXX/XX/XX	XX修正者XX（所属）
 // *									 XXXXXXXXXX更新内容XXXXXXXXXX
 // ************************************************************************
 // (*♪♪♪♪♪　Ｓｐｅｃｉａｌ　！！！　*)
 // (*H0001	20010409 khattori 処理月による排他*)
 // (*H0002	20010511 khattori 月固定／月可変切替のデフォルト*)
 // (*H0003	20010511 khattori ＤＢのオープンに失敗した時の処理*)
 // (*H0004	20010531 khattori Ｃａｐｔｉｏｎの出し方変更*)
 // (*H0005	20010604 khattori Ａｌｔ＋ｘの時、ドリルダウンの修正フラグが渡らない*)
 // (*H0006	20010626 khattori 表示からの入力中等でマウスで指示に戻った時、指示が不正*)
 // (*H0007	20010628 khattori 初期処理中に他のアプリケーションを表示された時*)
 // (*H0008 20010703 khattori プレビュー中に裏画面にされた時！*)
 // (*H0009 20010709 khattori Ｃｏｍｂｏの動き調整*)
 // (*H0010 20010712 khattori やばすぎ２！！！*)
 // (*H0011 20010725 tyamaguchi 付箋ボタン対応*)
 // (*H0012 20010730 tyamaguchi 終了処理メッセージ変更(出納帳用作成)*)
 // (*H0013 20010731 tyamaguchi 入力不可区分、修正／削除区分対応*)
 // (*H0014 20010820 tyamaguchi コード拡大対応*)
 // (*H0015 20010921 tyamaguchi 定型仕訳対応*)
 // (*H0016 20010921 tyamaguchi インスタンスの解放をOnDestroyに移動*)
 // (*H0017 20010925 khattori	定型仕訳対応*)
 // (*H0018 20010926 khattori	定型仕訳排他対応*)
 // (*H0019 20010927 khattori	定型仕訳ＦＡＳ対応*)
 // (*H0020 20010927 khattori	復活！！！*)
 // (*H0021 20010928 khattori	更新確認のＣａｎｃｅｌボタン*)
 // (*H0022 20011009 khattori	Ｒｏｏｔ初期処理追加*)
 // (*H0023 20011024 khattori	初期値変更*)
 // (*Ver.x*)
 // (*H0025	20011217 khattori	マルチ入力*)
 // (*H0024	20011217 khattori	手形入力*)
 // (*H0026 20020111 khattori	第２指示もセットする。*)
 // (*Ver A121 M101*)
 // (*H0026 20020301 khattori	ＣＲ、００、０００　キー*)
 // (*H0027 20020307 khattori	ＦＡＳがめろめろ*)
 // (*Ver A122 M102*)
 // (*H0028 20020328 khattori	エスケープキーでドロップダウンを閉じる*)
 // (*Ver A123 M102*)
 // (*H0029 20020328 khattori	第１指示のＣａｐｔｉｏｎ切替*)
 // (*Ver A123 M102*)
 // (*H0030 20020415 khattori	メール会計本支店対応*)
 // (*Ver A123 M103*)
 // (*H0032 20020501 khattori	終了処理メッセージ変更(手形用作成)*)
 // (*H0033 20030129 khattori	切り出し→最小化→ツリーから選択→Ｅｎｔｅｒ→エラー*)
 // (*H0034 20030611 khattori	分散入力*)
 // (*H0035 20030825 khattori	MJSLINK <-> ACELINK 統一*)
 // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
 // (*H0037 20030827 khattori	ＡＣＥＬＩＮＫ＜−＞ＭＪＳＬＩＮＫ統合*)
 // (*H0038 20030904 khattori	分散入力<単一入力>*)
 // (*H0043 20040616 khattori	クリック！*)
 // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
 // (*H0045 20050210 A.Ando		切出／埋込処理の記述変更*)
 // (*H0046 20050302 T.Shimada  高解像度対応追加。*)
 // (*H0047 20050418 khattori	一括置換*)
 // (*H0048 20050516 khattori	操作ガイド番号通知*)
 // <HIS-001> 2006/02/15 T.Yamaguchi	サブプログラムボタン ＆ Excel取込 対応
 // <HIS-002> 2006/04/06 T.Yamaguchi	オプション採用有無チェックの機能追加
 // <HIS-004> 2006/10/17 T.Yamaguchi	サブプログラム メニュー追加(他社データ取込 他)
 // <HIS-005> 2006/10/25 T.Yamaguchi	マルチスクリーンでサブプログラムボタンの位置がおかしくなる
 // <HIS-006> 2006/12/27 T.Yamaguchi	サブプログラム メニュー追加
 // <HIS-007> 2006/12/28 T.Yamaguchi	サブプログラム呼び出し時に指示から排他(会社別処理単独)をかける
 // <HIS-008> 2007/02/26 T.Yamaguchi	<HIS-005> 追加修正 高解像度が考慮されていない
 // <HIS-009> 2007/02/26 T.Yamaguchi	フォームの DragKind を dkDrag に変更(Vista対応)
 // <HIS-011> 2007/03/06 T.Yamaguchi	サブプログラム メニュー追加(IBEX出納帳)(ｺﾒﾝﾄ省略)
 // <HIS-014> 2007/05/08 T.Yamaguchi	伝票 対応
 // <HIS-015> 2007/05/31 T.Yamaguchi	画面サイズ可変 対応
 // <HIS-016> 2007/08/24 T.Yamaguchi	サブプログラム メニュー追加(記帳くん07)
 // <HIS-017> 2007/09/11 T.Yamaguchi	終了ボタン クリックと(&X)で微妙に動作が違う
 // <HIS-018> 2007/09/12 T.Yamaguchi	伝票で付箋ボタンの位置がおかしい
 // <HIS-019> 2007/10/05 T.Yamaguchi	ニーモニック(&x)論理変更(MjsBtnVisible を使用しない) [QZF-0790]
 // <HIS-020> 2007/10/05 T.Yamaguchi	連想コンポーネントの初期化が正しく機能していない
 // <HIS-022> 2007/10/11 T.Yamaguchi	<HIS-015>追加 Constraints は使用しない
 // <HIS-023> 2007/11/01 T.Yamaguchi	ツリー表示後画面が縮んだままになるケースがある
 // <HIS-024> 2007/11/14 T.Yamaguchi	<HIS-023> 追加修正 ドリルダウン時に子プログラムが縮んだまま
 // <HIS-027> 2008/01/23 T.Yamaguchi	uses節 に Contnrs 追加 (仕訳更新の改良に伴い)
 // <HIS-028> 2008/01/30 T.Yamaguchi	<HIS-015>追加 Align の設定タイミングを変更
 // <HIS-029> 2008/01/30 T.Yamaguchi	<HIS-005>破棄 <HIS-028> の対応に伴い戻す
 // <HIS-030> 2008/02/12 T.Yamaguchi	マウスクリックで月変更すると月固定ボタンが切り替わらない
 // <HIS-032> 2008/03/19 T.Yamaguchi	取込処理 メール会計オフライン 対応
 // <HIS-033> 2008/04/01 T.Yamaguchi	取込処理は、仕訳入力のみ
 // <HIS-034> 2008/04/01 T.Yamaguchi	<HIS-028>追加 採用なし時の分散入力の考慮が不十分
 // <HIS-035> 2008/05/20 T.Yamaguchi	<HIS-028>追加 仕訳入力のグリッドのスクロール位置がおかしくなる
 // <HIS-037> 2008/06/10 T.Yamaguchi	定型Ｎｏ, 伝票Ｎｏ, 日付に負数が入力できてしまう(フォームのみ)
 // <HIS-039> 2008/06/30 T.Yamaguchi	終了処理以降のエラーを吸収する(須藤会計)(ｺﾒﾝﾄ省略)
 // <HIS-042> 2008/07/14 T.Yamaguchi	<HIS-035>追加 画面が切れる現象が再発(ドリルダウン時)
 // <HIS-044> 2008/08/20 T.Yamaguchi	仕訳排他 対応
 // <HIS-045> 2008/08/20 T.Yamaguchi	分散テーブル対応
 // <HIS-047> 2008/09/11 T.Yamaguchi	MAS312100DSIParam 定義変更に伴う対応
 // <HIS-049> 2008/10/03 T.Yamaguchi	指示コンボの切替に不具合
 // <HIS-050> 2008/10/21 T.Yamaguchi	<HIS-044>追加 分散入力(採用なし)でエラー
 // <HIS-052> 2009/01/09 T.Yamaguchi	翌期の月可変を可能にする
 // <HIS-056> 2009/04/01 T.Yamaguchi	処理切替時、選択処理中のコンボが切り替わらない
 // <HIS-059> 2009/08/19 T.Yamaguchi	取込処理 ＰＣＡ会計９対応
 // <HIS-060> 2009/09/07 T.Yamaguchi	ウィンドウ コードによる絞り込み機能を追加
 // <HIS-062> 2010/01/26 T.Yamaguchi	分散排他エラーのキャプション対応
 // <HIS-063> 2010/04/01 T.Yamaguchi	取込処理 項目のEnabled,Visibleを一括設定できるようにする
 // <HIS-064> 2010/04/01 T.Yamaguchi	取込処理 会計王11、勘定奉行i 対応
namespace MAS310000u
{
    public partial class TMAS310000f: Form
    {
    //@ Undeclared identifier(3): 'CM_CHILDKEY'
    //@ Undeclared identifier(3): 'CM_DIALOGCHAR'
        // (* Private 宣言 *)
        protected object g_pDrill = null;
        // ドリルダウン構造体（指示用）
        protected int g_miSystemCode = 0;
        // (*Ver.x*)
        // (*H0024	20011217 khattori	手形入力*)
        protected int g_miOptionCode = 0;
        protected TMASL310HeadAc PMASLHdRd01 = null;
        protected object PMASLHdRd02 = null;
        protected object PMASLHdRd03 = null;
        protected object PMASLHdRd04 = null;
        protected TWParam rParam = null;
        protected TMAS310SelWndDB SelWnd = null;
        // 選択ウィンドウ
        protected TMASL310Root Rt = null;
        // 日常処理共通クラス
        protected TMASL310SelMonth Sm = null;
        // 処理月操作クラス
        protected TMASL310Item Itm = null;
        // 指示項目操作クラス
        protected TMASL310Func Fnc = null;
        // ファンクションバー操作クラス
        protected TMASL310Ind Ind = null;
        // 指示ComboBox操作クラス
        protected TMASL310StatusBar Stb = null;
        // ステータスバー操作クラス
        // ---<HIS-001>------------------------------------------------------------------
        protected TSubPrgBtn SubPrg = null;
        // サブプログラム呼び出しボタン
        // ------------------------------------------------------------------<HIS-001>---
        protected bool gfg = false;
        protected bool gfirst = false;
        protected Control[] gcrCont;
        protected TMASL310IParam gMASLParam = null;
        protected object m_pRec = null;
        // Bpl管理構造体
        protected TMDataModulef m_cMDModule = null;
        // (*H0013 20010731 tyamaguchi 入力不可区分、修正／削除区分対応*)
        protected int m_FixKbn16 = 0;
        // 仕訳入力不可区分
        // (*H0017 20010925 khattori	定型仕訳対応*)
        protected int m_FixKbn20 = 0;
        // 定型仕訳採用区分（仕訳）
        protected int m_FixKbn21 = 0;
        // 定型仕訳採用区分（出納）
        protected int m_FixKbn22 = 0;
        // 定型仕訳ウィンドウ表示区分
        protected int m_FixKbn23 = 0;
        // ウィンドウ内部コード表示区分
        protected int m_FixKbn29 = 0;
        // 定型仕訳採用区分（伝票）
        // (*H0034 20030611 khattori	分散入力*)
        protected int m_BunKbn01 = 0;
        // 分散入力採用区分
        protected TMASL310IFixLock m_cFixLock = null;
        // 定型仕訳排他パラメータ
        protected int m_iFxRenLength = 0;
        // (*H0043 20040616 khattori	クリック！*)
        protected int m_iFxSwkInp = 0;
        // ---<HIS-044>------------------------------------------------------------------
        protected ISwkExclusive m_cSwkExc = null;
        // 仕訳排他クラス(インターフェース)
        // ------------------------------------------------------------------<HIS-044>---
        protected int m_iExclusive = 0;
        // (*H0001	20010426	khattori	処理月による排他*)
        protected int m_iClose = 0;
        // (*H0001	20010409	khattori	処理月による排他*)
        protected bool m_bfirst = false;
        protected TFlexInfo m_stFlexInfo = null;
        // (*H0010 20010712 khattori やばすぎ２！！！*)
        protected bool m_bTerm = false;
        // (*H0002	20010511 khattori 月固定／月可変切替のデフォルト*)
        protected int m_iTukiDefault = 0;
        // 単一入力（年間）の時の初期値　0:月固定 1:月可変
        // (*H0003	20010511 khattori ＤＢのオープンに失敗した時の処理*)
        protected object m_FCopDBMas = null;
        protected bool m_bCB2KeyEnter = false;
        protected bool m_bCB2Select = false;
        protected int m_bCB2Index = 0;
        protected bool m_bCB3KeyEnter = false;
        protected int m_bCB3Index = 0;
        protected bool m_bCB4KeyEnter = false;
        protected int m_bCB4Index = 0;
        // (*H0008 20010703 khattori プレビュー中に裏画面にされた時！*)
        protected TMjsPreviewIF MJSPreIf = null;
        // (*H0015 20010921 tyamaguchi 定型仕訳対応*)
        protected int m_iFxExists = 0;
        // 0：存在する(修正ﾓｰﾄﾞ)  -1：存在しない(新規ﾓｰﾄﾞ)  -2：使用不可
        // (*Ver A121 M101*)
        // (*H0026 20020301 khattori	ＣＲ、００、０００　キー*)
        protected bool m_bCRKey = false;
        protected int m_iCRKey = 0;
        protected int m_i00Key = 0;
        protected int m_i000Key = 0;
        // ---<HIS-060>------------------------------------------------------------------
        protected int m_iCodeAssoc = 0;
        // ｺｰﾄﾞによる連想絞込	(0:絞込なし 1:絞込あり)
        // ------------------------------------------------------------------<HIS-060>---
        // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
        protected TMasExceptIF m_cExcept = null;
        protected int m_iRet = 0;
        protected int m_nReferMode = 0;
        // (*H0038 20030904 khattori	分散入力<単一入力>*)
        protected int m_iPMPanelDev = 0;
        // ---<HIS-002>------------------------------------------------------------------
        protected TMASL310SubPrgUse m_cSubUse = null;
        public TMAS310000f()
        {
            InitializeComponent();
        }

        // 定型仕訳関係処理(MASLFx.inc)
        // __MASL310ROOTB_INC__
        // *****************************************************************************
        // System			:	新会計システム
        // Program			:	定型仕訳関係処理
        // ProgramID		:	MASL310Fx.inc
        // Name			:	T.Yamaguchi(MJS)
        // Create 			:	2001/09/21
        // Comment			:
        // History			:
        // *****************************************************************************
        // (*H0001 20011024 khattori	初期値変更*)
        // (*H0002 20011025 khattori	ちゃんと消えない*)
        // (*H0027 20020307 khattori	ＦＡＳがめろめろ*)
        // (*H0028 20021105 khattori	伝票対応*)
        // (*H0029 20030224 khattori	伝票印刷対応*)
        // (*H0043 20040616 khattori	クリック！*)
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        // <HIS-020> 2007/10/05 T.Yamaguchi	連想コンポーネントの初期化が正しく機能していない
        // <HIS-038> 2008/06/10 T.Yamaguchi	定型 ファンクション押下の論理修正
        // <HIS-074> 2012/01/17 T.Yamaguchi	定型 特定のファンクションが表示されたりされなかったりする。
        // ******************************************************************************
        // Proccess	:   定型仕訳関係初期処理
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   Integer			処理ﾓｰﾄﾞ
        // 0:	全てクリア
        // 1:  Editのみクリア(定型ＮＯを除く)
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        protected void FxReset(int iMode)
        {
            // var
            // iLoop		:	Integer;
            // iPar		:	Integer;
            // //	定型入力有効か
            // if	(IsBaseMode and(m_FixKbn20=1))	or		//	通常
            // (IsSlipMode and(m_FixKbn29=1))	or		//	伝票
            // ((not IsBaseMode)and(not IsSlipMode)and(m_FixKbn21=1))	then
            // //	if	(((IsBaseMode)or(IsSlipMode))and(m_FixKbn20=1))	or
            // //		((not IsBaseMode)and(not IsSlipMode)and(m_FixKbn21=1))	then
            // //	if	((m_pRec^.m_sParameter = '')	and	(m_FixKbn20=1))	or
            // //		((m_pRec^.m_sParameter <>'')	and	(m_FixKbn21=1))	then
            // begin
            // if	not	PMPanelHdFx.Visible	then
            // begin
            // //	出納帳か？
            // if	(not IsBaseMode)and(not IsSlipMode)	then
            // //			if m_pRec^.m_sParameter <> '' then
            // begin
            // PMPanelHdSd.Height:=63-PMPanelHdSd.Height;
            // PMPanelHd.Height:=125-PMPanelHd.Height;
            // end;
            // PMPanelHdFx.Visible	:=	true;
            // end;
            // if iMode = 0 then
            // begin
            // PMPanelHdFx.Enabled := False;
            // FxDsp();
            // m_iFxExists	:= -1;
            // EMNumEditFx_No.Value := 0;
            // end;
            // with EMNumEditFx_Date 	do begin  Value := 0; 	Parent.Enabled := False; end;
            // with EMNumEditFx_Den  	do begin  Value := 0;	InputFlag:=true; 	Parent.Enabled := False; end;
            // with MTxtFx_Ren			do begin  Text  := '';  Parent.Enabled := False; end;
            // with MTxtFx_RenEnt		do begin  Text  := '';  Parent.Enabled := False; end;
            // with MTxtFx_Name		do begin  Text  := '';  Static 		   := True;  end;
            // end
            // else
            // begin
            // if	PMPanelHdFx.Visible	then
            // begin
            // PMPanelHdFx.Visible	:=	false;
            // //	出納帳か？
            // if	(not IsBaseMode)and(not IsSlipMode)	then
            // //			if m_pRec^.m_sParameter <> '' then
            // begin
            // PMPanelHdSd.Height:=63-PMPanelHdSd.Height;
            // PMPanelHd.Height:=125-PMPanelHd.Height;
            // end;
            // end;
            // m_iFxExists := -1;
            // iPar 	:= 10;	gMASL310RootVf(MASL_VSET_FIX_HEAD, @iPar, @m_iFxExists);
            // end;

        }

        // ////////////////////////////////////////////////////////////////////
        public void FxDsp_DspOff()
        {
            if (!(new ArrayList(VFlg).Contains(Enum_TVisibleFlg1.fNo)))
            {
                //@ Unsupported property or method(C): 'Visible'
                PMPanelFx_No.Visible = false;
            }
            if (!(new ArrayList(VFlg).Contains(Enum_TVisibleFlg1.fRen)))
            {
                //@ Unsupported property or method(C): 'Visible'
                PMPanelFx_Ren.Visible = false;
            }
            if (!(new ArrayList(VFlg).Contains(Enum_TVisibleFlg1.fRenEnt)))
            {
                //@ Unsupported property or method(C): 'Visible'
                PMPanelFx_RenEnt.Visible = false;
            }
            if (!(new ArrayList(VFlg).Contains(Enum_TVisibleFlg1.fDate)))
            {
                //@ Unsupported property or method(C): 'Visible'
                PMPanelFx_Date.Visible = false;
            }
            if (!(new ArrayList(VFlg).Contains(Enum_TVisibleFlg1.fDen)))
            {
                //@ Unsupported property or method(C): 'Visible'
                PMPanelFx_Den.Visible = false;
            }
            if (!(new ArrayList(VFlg).Contains(Enum_TVisibleFlg1.fName)))
            {
                //@ Unsupported property or method(C): 'Visible'
                MTxtFx_Name.Visible = false;
            }
        }

        // ////////////////////////////////////////////////////////////////////
        // 連想表示ﾊﾟﾀｰﾝの切り替え
        public void FxDsp_RenChg(int iType)
        {
            // PMPanelFx_Ren.Width				:= 152;
            //@ Undeclared identifier(3): 'bvRaised'
            //@ Unsupported property or method(C): 'BevelOuter'
            PMPanelFx_RenN.BevelOuter = bvRaised;
            //@ Undeclared identifier(3): 'TMASCom'
            //@ Unsupported property or method(D): 'SystemArea'
            //@ Unsupported property or method(D): 'SysColorD'
            //@ Unsupported property or method(C): 'Color'
            PMPanelFx_RenN.Color = TMASCom(m_pRec.m_pSystemArea).SystemArea.SysColorD;
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            //@ Unsupported property or method(C): 'Width'
            //@ Unsupported property or method(C): 'Left'
            MTxtFx_Ren.Left = PMPanelFx_RenN.Width + 2;
            // MTxtFx_Ren.Left					:= 46;
            // PMPanelFx_RenEnt.Width	 		:= 138;
            //@ Undeclared identifier(3): 'bvNone'
            //@ Unsupported property or method(C): 'BevelOuter'
            PMPanelFx_RenEntN.BevelOuter = bvNone;
            //@ Undeclared identifier(3): 'TMASCom'
            //@ Unsupported property or method(D): 'SystemArea'
            //@ Unsupported property or method(D): 'SysColorB'
            //@ Unsupported property or method(C): 'Color'
            PMPanelFx_RenEntN.Color = TMASCom(m_pRec.m_pSystemArea).SystemArea.SysColorB;
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            //@ Unsupported property or method(C): 'Width'
            //@ Unsupported property or method(C): 'Left'
            MTxtFx_RenEnt.Left = PMPanelFx_RenEntN.Width + 2;
            // MTxtFx_RenEnt.Left		 		:= 32;

        }

        // ////////////////////////////////////////////////////////////////////
        public void FxDsp_SetPosition(Control Sender)
        {
            const int SPACE = 8;
            Sender.Visible = true;
            Sender.Left = iLeft;
            iLeft = iLeft + Sender.Width + SPACE;
        }

        // ////////////////////////////////////////////////////////////////////
        public bool FxDsp_ChkKbnInfo()
        {
            bool result;
            enTblList tlTblList;
            TMQuery pQuery;
            int iKbn;
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
            pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PREF_TBL_LIST, tlTblList);
            if (pQuery != null)
            {
                //@ Unsupported property or method(B): 'Locate'
                if ((TMQuery(pQuery).Locate("RecKbn", 2, new object[] {})) == true)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iKbn = TMQuery(pQuery).GetFld("GnPuKbn11").AsInteger;
                }
            }
            // 伝票ＮＯ入力区分	0:任意入力 1:自動付番 9:入力なし
            if (iKbn == 9)
            {
                result = false;
            }
            else
            {
                result = true;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	:   定型仕訳関係コンポーネントの配置
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   Integer			指示ＮＯ　	入力：1	登録：7
        // Integer			連想モード	ＮＯ：0 連想：1
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        protected void FxDsp(int iSjiNo, int iMode)
        {
            int iLeft;
            Enum_TVisibleFlg1[] VFlg;
            int iLoop;
            TMASL310IFunc rFunc;
            if (iSjiNo != 0)
            {
                rFunc = Itm.ReadIniRec(iSjiNo);
            }
            else
            {
                rFunc.iMode = 0;
            }
            // 定型仕訳を採用していない時はExit
            // Exit;
            VFlg = new object[] {};
            iLeft = 6;
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            //@ Unsupported property or method(C): 'Height'
            if (PMPanelHdFx.Height == 0)
            {
                //@ Unsupported property or method(C): 'Height'
                PMPanelHdFx.Height = 23;
            }
            // Heigth:19 + Space:4
            //@ Unsupported property or method(C): 'Visible'
            PMPanelHdFx.Visible = true;
            // 連想表示ﾊﾟﾀｰﾝのセット
            FxDsp_RenChg(iMode);
            switch(rFunc.iMode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU:
                    // 定型仕訳入力
                    FxDsp_SetPosition(PMPanelFx_No);
                    VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fNo};
                    if (!IsSlipMode)
                    {
                        FxDsp_SetPosition(PMPanelFx_Date);
                    }
                    VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fDate};
                    if (!IsSlipMode)
                    {
                        if (FxDsp_ChkKbnInfo())
                        {
                            FxDsp_SetPosition(PMPanelFx_Den);
                        }
                    }
                    VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fDen};
                    FxDsp_SetPosition(MTxtFx_Name);
                    VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fName};
                    //@ Unsupported property or method(C): 'Static'
                    MTxtFx_Name.Static = true;
                    // １行型または伝票か？
                    if ((FxDsp_ChkKbnInfo()) && (IsBaseMode || IsSlipMode) && (!Is_FASMODE()))
                    {
                        // (m_pRec^.m_sParameter='')	and
                        // (*H0027 20020307 khattori	ＦＡＳがめろめろ*)
                        // (g_miSystemCode<>MASL_PROC_SYS_FASENTRY)	and
                        // (g_miSystemCode<>MASL_PROC_SYS_FASENTRY)	then
                        // (g_miSystemCode<>MASL_PROC_SYS_ZFASCS)	and
                        // (g_miSystemCode<>MASL_PROC_SYS_ZFASMN)	then
                        //@ Unsupported property or method(C): 'Width'
                        MTxtFx_Name.Width = 371;
                    }
                    else
                    {
                        //@ Unsupported property or method(C): 'Width'
                        MTxtFx_Name.Width = 396;
                    }
                    if (iMode == 1)
                    {
                        // ---<HIS-020>------------------------------------------------------------------
                        // for iLoop := 1 to length(MTxtFx_Ren.Text)	do
                        // PostMessage(MTxtFx_Ren.Handle, WM_KEYDOWN, VK_DELETE, 0);
                        // ------------------------------------------------------------------<HIS-020>---
                        //@ Unsupported property or method(C): 'Tag'
                        MTxtFx_Ren.Tag = 0;
                        //@ Unsupported property or method(C): 'Left'
                        //@ Unsupported property or method(C): 'Left'
                        //@ Unsupported property or method(C): 'Left'
                        PMPanelFx_Ren.Left = PMPanelFx_No.Left + EMNumEditFx_No.Left;
                        // ---<HIS-020>------------------------------------------------------------------
                        FxRenClear();
                        // MTxtFx_Ren.Text := '';
                        // ------------------------------------------------------------------<HIS-020>---
                        //@ Unsupported property or method(C): 'Visible'
                        PMPanelFx_Ren.Visible = true;
                        //@ Unsupported property or method(C): 'Enabled'
                        PMPanelFx_Ren.Enabled = true;
                        VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fRen};
                        //@ Unsupported property or method(A): 'BringToFront'
                        PMPanelFx_Ren.BringToFront();
                        //@ Unsupported property or method(C): 'SetFocus'
                        MTxtFx_Ren.SetFocus;
                    }
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU:
                    // 定型仕訳登録
                    FxDsp_SetPosition(PMPanelFx_No);
                    VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fNo};
                    FxDsp_SetPosition(MTxtFx_Name);
                    VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fName};
                    //@ Unsupported property or method(C): 'Static'
                    MTxtFx_Name.Static = false;
                    FxDsp_SetPosition(PMPanelFx_RenEnt);
                    VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fRenEnt};
                    //@ Unsupported property or method(C): 'Width'
                    MTxtFx_Name.Width = 396;
                    if (iMode == 1)
                    {
                        // ---<HIS-020>------------------------------------------------------------------
                        // for iLoop := 1 to length(MTxtFx_Ren.Text)	do
                        // PostMessage(MTxtFx_Ren.Handle, WM_KEYDOWN, VK_DELETE, 0);
                        // ------------------------------------------------------------------<HIS-020>---
                        //@ Unsupported property or method(C): 'Tag'
                        MTxtFx_Ren.Tag = 0;
                        //@ Unsupported property or method(C): 'Left'
                        //@ Unsupported property or method(C): 'Left'
                        //@ Unsupported property or method(C): 'Left'
                        PMPanelFx_Ren.Left = PMPanelFx_No.Left + EMNumEditFx_No.Left;
                        // ---<HIS-020>------------------------------------------------------------------
                        FxRenClear();
                        // MTxtFx_Ren.Text := '';
                        // ------------------------------------------------------------------<HIS-020>---
                        //@ Unsupported property or method(C): 'Visible'
                        PMPanelFx_Ren.Visible = true;
                        //@ Unsupported property or method(C): 'Enabled'
                        PMPanelFx_Ren.Enabled = true;
                        VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fRen};
                        //@ Unsupported property or method(A): 'BringToFront'
                        PMPanelFx_Ren.BringToFront();
                        //@ Unsupported property or method(C): 'SetFocus'
                        MTxtFx_Ren.SetFocus;
                    }
                    break;
                default:
                    FxDsp_SetPosition(PMPanelFx_No);
                    VFlg = VFlg + new Enum_TVisibleFlg1[] {Enum_TVisibleFlg1.fNo};
                    break;
            }
            FxDsp_DspOff();
            //@ Unsupported property or method(C): 'Refresh'
            PMPanelHdFx.Refresh;
        }

        // 定型仕訳関係処理(MASLFx.inc)
        // **************************************************************************
        // Component  :   定型仕訳のコンポーネント
        // Event	  :   OnEnter
        // Name	   :   T.Yamaguchi
        // **************************************************************************
        public void FxEnter(Object Sender)
        {
            const int FxOnEnter = 0;
            // アクティヴコントロールに自分をセット
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_ACTV_CTRL, Sender);
            //@ Unsupported property or method(C): 'Enabled'
            PMPanelHdRd.Enabled = false;
            if (Sender == PMPanelHdFx)
            {
                FxAction_Parent(FxOnEnter);
            }
            // パネルのイベント
            if (Sender == EMNumEditFx_No)
            {
                FxAction_No(FxOnEnter);
            }
            // 定型ＮＯのイベント
            if (Sender == EMNumEditFx_Date)
            {
                FxAction_Date(FxOnEnter);
            }
            // 日付のイベント
            if (Sender == EMNumEditFx_Den)
            {
                FxAction_Den(FxOnEnter);
            }
            // 伝票ＮＯのイベント
            if (Sender == MTxtFx_Ren)
            {
                FxAction_Ren(FxOnEnter);
            }
            // 連想のイベント
            if (Sender == MTxtFx_RenEnt)
            {
                FxAction_RenEnt(FxOnEnter);
            }
            // 連想のイベント
            if (Sender == MTxtFx_Name)
            {
                FxAction_Name(FxOnEnter);
            }
            // 定型名称のイベント

        }

        // **************************************************************************
        // Component  :   定型仕訳のコンポーネント
        // Event	  :   OnExit
        // Name	   :   T.Yamaguchi
        // **************************************************************************
        public void FxExit(Object Sender)
        {
            const int FxOnExit = 1;
            if (!m_bTerm)
            {
                if (Sender == PMPanelHdFx)
                {
                    FxAction_Parent(FxOnExit);
                }
                // パネルのイベント
                if (Sender == EMNumEditFx_No)
                {
                    FxAction_No(FxOnExit);
                }
                // 定型ＮＯのイベント
                if (Sender == EMNumEditFx_Date)
                {
                    FxAction_Date(FxOnExit);
                }
                // 日付のイベント
                if (Sender == EMNumEditFx_Den)
                {
                    FxAction_Den(FxOnExit);
                }
                // 伝票ＮＯのイベント
                if (Sender == MTxtFx_Ren)
                {
                    FxAction_Ren(FxOnExit);
                }
                // 連想のイベント
                if (Sender == MTxtFx_RenEnt)
                {
                    FxAction_RenEnt(FxOnExit);
                }
                // 連想のイベント
                if (Sender == MTxtFx_Name)
                {
                    FxAction_Name(FxOnExit);
                }
            // 定型名称のイベント
            }
        }

        // **************************************************************************
        // Component  :   定型仕訳のコンポーネント
        // Event	  :   OnKeyDown
        // Name	   :   T.Yamaguchi
        // **************************************************************************
        public void FxKeyDown(Object Sender, ref ushort Key, Keys Shift)
        {
            const int FxOnKeyDown = 2;
            if (Sender == EMNumEditFx_No)
            {
                FxAction_No(FxOnKeyDown, Key, Shift);
            }
            // 定型ＮＯのイベント
            if (Sender == MTxtFx_Ren)
            {
                FxAction_Ren(FxOnKeyDown, Key, Shift);
            }
            // 連想のイベント
            if (Sender == MTxtFx_RenEnt)
            {
                FxAction_RenEnt(FxOnKeyDown, Key, Shift);
            }
            // 連想のイベント
            if (Sender == EMNumEditFx_Date)
            {
                FxAction_Date(FxOnKeyDown, Key, Shift);
            }
            // 伝票日付のイベント
            if (Sender == EMNumEditFx_Den)
            {
                FxAction_Den(FxOnKeyDown, Key, Shift);
            }
            // 伝票ＮＯのイベント
            if (Sender == MTxtFx_Name)
            {
                FxAction_Name(FxOnKeyDown, Key, Shift);
            }
            // 定型ＮＯのイベント

        }

        // ******************************************************************************
        // Proccess	:   フォーカス移動処理
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   TObject			コンポーネント
        // Integer			0:	なし
        // 1:  進む
        // 2:	戻る
        // 3:  指示へ移動
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        protected void FxFocusMove(Object Sender, int iMove)
        {
            const int MOVE_NEXT = 1;
            const int MOVE_PREVIOUS = 2;
            const int MOVE_HOME = 3;
            int iSjiNo;
            Control cCompo;
            bool bNext;
            int iLoop;
            int iRightCnt;
            int iPar;
            string sString;
            TMASL310IFunc rFunc;
            rFunc = FxGetFxFunc();
            iSjiNo = rFunc.iOpCode;
            // iSjiNo	:=	gMASL310RootIf(MASL_IGET_FST_CODE);
            // rFunc	:=	Itm.ReadIniRec(iSjiNo);
            // マウスクリックで先に進めないようにする為、移動の時だけEnableにする。
            //@ Unsupported property or method(C): 'Enabled'
            PMPanelFx_No.Enabled = true;
            //@ Unsupported property or method(C): 'Enabled'
            PMPanelFx_Ren.Enabled = true;
            //@ Unsupported property or method(C): 'Enabled'
            PMPanelFx_RenEnt.Enabled = true;
            //@ Unsupported property or method(C): 'Enabled'
            PMPanelFx_Date.Enabled = true;
            //@ Unsupported property or method(C): 'Enabled'
            PMPanelFx_Den.Enabled = true;
            if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
            {
                //@ Unsupported property or method(C): 'Static'
                MTxtFx_Name.Static = false;
            }
            // 出納帳か？
            if (!IsBaseMode && !IsSlipMode)
            {
                // 現在の処理パラメータを取得(０：単一仕訳　２：現金出納帳　３：預金出納帳　11：売掛帳　12：買掛帳)
                // if	m_pRec^.m_sParameter = '2'	then
                // 定型入力？
                if (((Sender == EMNumEditFx_Date) || (Sender == EMNumEditFx_Den)))
                {
                    iRightCnt = 0;
                    for (iLoop = 0; iLoop <= 3; iLoop ++ )
                    {
                        TMASL310HeadOt _wvar1 = ((PMASLHdRd01.PMSiwakexx[iLoop]) as TMASL310HeadOt);
                        if ((this.Visible == true) && (_wvar1.iRight == 1))
                        {
                            if (iRightCnt == 0)
                            {
                                _wvar1.cPrevComp = ((Sender) as Control);
                            }
                            //@ Unsupported property or method(C): 'Enabled'
                            PMPanelHdRd.Enabled = true;
                            this.Enabled = true;
                        }
                        else
                        {
                            this.Enabled = false;
                        }
                    }
                }
                else
                {
                    for (iLoop = 0; iLoop <= 3; iLoop ++ )
                    {
                        TMASL310HeadOt _wvar2 = ((PMASLHdRd01.PMSiwakexx[iLoop]) as TMASL310HeadOt);
                        this.Enabled = true;
                        if (iLoop > 0)
                        {
                            _wvar2.cPrevComp = PMASLHdRd01.PMSiwakexx[iLoop - 1].cEditComp;
                        }
                    }
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelHdRd.Enabled = true;
                }
            }
            switch(iMove)
            {
                case MOVE_NEXT:
                    // 次のコンポーネントへ移動
                    //@ Unsupported property or method(A): 'FindNextControl'
                    cCompo = this.FindNextControl(((Sender) as Control), true, true, false);
                    //@ Unsupported property or method(A): 'ContainsControl'
                    bNext = PMPanelHdOt.ContainsControl(cCompo);
                    if (cCompo == EMNumEditFx_No)
                    {
                        bNext = false;
                    }
                    //@ Unsupported property or method(D): 'Name'
                    if (cCompo.Name == "PMASLHdRd01TxNm")
                    {
                        PMASLHdRd01.cPrevComp = ((Sender) as Control);
                    }
                    if (!bNext)
                    {
                        // 最後の場合(当該も含む)
                        // if	( IsSlipMode and (EMNumEditFx_No.Value<>0))	or
                        //@ Unsupported property or method(C): 'Value'
                        if (((Sender == EMNumEditFx_No) && (EMNumEditFx_No.Value != 0)) || (Sender == EMNumEditFx_Date) || (Sender == EMNumEditFx_Den))
                        {
                            // 定型仕訳入力の場合
                            // if ( Sender = EMNumEditFx_Date ) or ( Sender = EMNumEditFx_Den ) then	//  定型仕訳入力の場合
                            FxCallDoAction(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEINYUURYOKU);
                        }
                        else if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                        {
                            //@ Unsupported property or method(C): 'Text'
                            sString = MTxtFx_Name.Text;
                            iPar = 2;
                            gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, sString);
                            //@ Unsupported property or method(C): 'Text'
                            sString = MTxtFx_RenEnt.Text;
                            iPar = 3;
                            gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, sString);
                            if (m_iFxExists == 0)
                            {
                                FxCallDoAction(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEISYUUSEI);
                            }
                            else
                            {
                                FxCallDoAction(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU);
                            }
                        }
                        else
                        {
                            //@ Unsupported property or method(C): 'ParentColor'
                            EMNumEditFx_No.ParentColor = true;
                            // EMNumEditFx_No.Refresh;
                            FxCallDoAction(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU);
                        }
                    }
                    //@ Unsupported property or method(D): 'CanFocus'
                    else if (cCompo.CanFocus)
                    {
                        //@ Unsupported property or method(D): 'SetFocus'
                        cCompo.SetFocus;
                    }
                    break;
                case MOVE_PREVIOUS:
                    // 後ろがある場合
                    // 定型ＮＯ：	第１指示へ移動
                    if (Sender == EMNumEditFx_No)
                    {
                        if (!Is_FASMODE())
                        {
                            // (*H0027 20020307 khattori	ＦＡＳがめろめろ*)
                            // if	(g_miSystemCode<>MASL_PROC_SYS_FASENTRY)	and
                            // if	g_miSystemCode<>MASL_PROC_SYS_FASENTRY	then
                            // (g_miSystemCode<>MASL_PROC_SYS_ZFASCS)	and
                            // (g_miSystemCode<>MASL_PROC_SYS_ZFASMN)	then
                            //@ Unsupported property or method(C): 'SetFocus'
                            PMComboBox3.SetFocus;
                        }
                    // その他：	前のコンポーネントへ移動
                    }
                    else
                    {
                        //@ Unsupported property or method(A): 'FindNextControl'
                        cCompo = this.FindNextControl(((Sender) as Control), false, true, false);
                        //@ Unsupported property or method(D): 'CanFocus'
                        if (cCompo.CanFocus)
                        {
                            //@ Unsupported property or method(D): 'SetFocus'
                            cCompo.SetFocus;
                        }
                    }
                    break;
                case MOVE_HOME:
                    // (*♪♪♪*)
                    // (*H0027 20020307 khattori	ＦＡＳがめろめろ*)
                    // if	(g_miSystemCode<>MASL_PROC_SYS_FASENTRY)	and
                    // if	g_miSystemCode<>MASL_PROC_SYS_FASENTRY
                    // (g_miSystemCode<>MASL_PROC_SYS_ZFASCS)	and
                    // (g_miSystemCode<>MASL_PROC_SYS_ZFASMN)
                    // 第１指示へ移動
                    if (!Is_FASMODE())
                    {
                        //@ Unsupported property or method(C): 'SetFocus'
                        PMComboBox3.SetFocus;
                    }
                    else
                    {
                        EscKeyKeyDown(Sender, 0);
                    }
                    break;
            }
        }

        // ******************************************************************************
        // Proccess	:   DoAction処理
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   Integer			処理ﾓｰﾄﾞ
        // MASL_PROC_MODE_TEIKEITOUROKU(デフォルト)
        // MASL_PROC_MODE_TEIKEISYUUSEI
        // MASL_PROC_MODE_TEIKEISAKUJO
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        protected void FxCallDoAction(int iMode)
        {
            TMASL310IFunc rFunc;
            int iPar;
            bool bFixUpdate;
            if (iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEISYUUSEI)
            {
                //@ Unsupported property or method(C): 'AsInteger'
                //@ Unsupported property or method(C): 'Text'
                //@ Unsupported property or method(C): 'Text'
                Rt.FxHeadChange(0, EMNumEditFx_No.AsInteger, MTxtFx_Name.Text, MTxtFx_RenEnt.Text);
            }
            iPar = 8;
            bFixUpdate = false;
            gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, bFixUpdate);
            // 出納帳か？
            // if	(m_pRec^.m_sParameter <>'')	and
            if ((!IsBaseMode && !IsSlipMode) && ((iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEISYUUSEI) || (iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEINYUURYOKU)))
            {
                if (PMASLHdRd01.SetDrillPar())
                {
                    iPar = 8;
                    bFixUpdate = true;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, bFixUpdate);
                }
            }
            //@ Unsupported property or method(C): 'Enabled'
            PMPanelHdFx.Enabled = false;
            //@ Unsupported property or method(A): 'Refresh'
            PMPanelHdFx.Refresh();
            // 再描画しておかないと表示が一瞬消える
            rFunc = FxGetFxFunc();
            // rFunc	:= Itm.ReadIniRec( 	gMASL310RootIf(MASL_IGET_FST_CODE)	(*指示処理コード*)	);  //  ファンクション情報取得
            rFunc.iMode = iMode;
            Rt.DoAction(rFunc);
        }

        // **************************************************************************
        // Component  :   定型仕訳のコンポーネント
        // Event	  :   OnChange
        // Name	   :   T.Yamaguchi
        // **************************************************************************
        public void FxChange(Object Sender)
        {
            int iLen;
            // 連想
            if (Sender == MTxtFx_Ren)
            {
                //@ Unsupported property or method(C): 'Text'
                iLen = MTxtFx_Ren.Text.Length;
                // 連想絞込み
                //@ Unsupported property or method(A): 'Text'
                //@ Unsupported property or method(A): 'Text'
                if ((iLen == 0) || (iLen < m_iFxRenLength) && ((MTxtFx_Ren.Text[iLen] < '0') || (MTxtFx_Ren.Text[iLen] > '9')))
                {
                    // if	MTxtFx_Ren.Text=''	then
                    gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_RenChange, Sender);
                }
                m_iFxRenLength = iLen;
            // 定型名称
            }
            else if (Sender == MTxtFx_Name)
            {
                // ---<HIS-020>------------------------------------------------------------------
                //@ Unsupported property or method(C): 'Text'
                if (MTxtFx_Name.Text == "")
                {
                    FxRenClear();
                }
            }
            // if MTxtFx_Name.Text = '' then MTxtFx_Ren.Text := '';
            // ------------------------------------------------------------------<HIS-020>---

        }

        // ******************************************************************************
        // Proccess	:   イベント処理
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   Integer			0:	OnEnter
        // 1:  OnExit
        // 2:	OnKeyDown
        // Pointer			パラメータ１(汎用的に使用)
        // Pointer		 パラメータ２(汎用的に使用)
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        // //////////////////////////////////////////////////////////////////////////////
        // PMPanelHdFx(親パネル)
        // //////////////////////////////////////////////////////////////////////////////
        protected void FxAction_Parent(int iEvent, object pPar1, object pPar2)
        {
            int iSjiNo;
            TMASL310IFunc rFunc;
            rFunc = FxGetFxFunc();
            iSjiNo = rFunc.iOpCode;
            switch(iEvent)
            {
                case 0:
                    // iSjiNo := gMASL310RootIf(MASL_IGET_FST_CODE);	//  指示ＮＯ
                    // rFunc	:=	Itm.ReadIniRec(iSjiNo);
                    // OnEnter
                    // 定型パネルﾚｲｱｳﾄ
                    if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                    {
                        FxDsp(iSjiNo);
                    }
                    break;
                case 1:
                    // iSjiNo );
                    // OnExit
                    // 定型ＮＯのみ表示
                    //@ Unsupported property or method(C): 'ActiveControl'
                    //@ Unsupported property or method(C): 'ActiveControl'
                    if ((Screen.PrimaryScreen.ActiveControl == PMComboBox2) || (Screen.PrimaryScreen.ActiveControl == PMComboBox3))
                    {
                        FxDsp();
                    }
                    break;
            }
        }

        // ////////////////////////////////////////////////////////////////////
        // 定型仕訳の存在チェック
        public int FxAction_No_CheckValue(int iNo)
        {
            int result;
            TMQuery pQuery;
            string sRen;
            string sName;
            int iTClass;
            int iHassei;
            int iFixHNo;
            int iPar;
            bool bUseful;
            result =  -1;
            pQuery = new TMQuery();
            iPar = 9;
            gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, Rt.m_iHassei);
            // (*H0043 20040616 khattori	クリック！*)
            Rt.GetFxHead(pQuery, iNo, m_iFxSwkInp);
            // 定型仕訳ヘッダ取得
            // Rt.GetFxHead( pQuery, iNo );				//  定型仕訳ヘッダ取得
            //@ Unsupported property or method(D): 'RecordCount'
            if (pQuery.RecordCount > 0)
            {
                bUseful = true;
                // 定型登録でメール会計ありで発生区分が違う時使用不可
                if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU) && ((Rt.m_iComKbn3 != 0) || (Rt.m_iBusyoNrk != 0)))
                {
                    // (Rt.m_iComKbn3<>0)		then
                    bUseful = false;
                    //@ Unsupported function or procedure: 'eof'
                    while (!eof)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        if ((Rt.m_iHassei == pQuery.GetFld("SwkInpKbn").AsInteger))
                        {
                            bUseful = true;
                            break;
                        }
                        //@ Unsupported property or method(C): 'Next'
                        this.Next;
                    }
                }
                if (bUseful)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    sName = pQuery.GetFld("LongName").AsString;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    sRen = pQuery.GetFld("RenChar").AsString;
                    iValue = 0;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iTClass = pQuery.GetFld("TeikeiClass").AsInteger;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iHassei = pQuery.GetFld("SwkInpKbn").AsInteger;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iFixHNo = pQuery.GetFld("HSrchNo").AsInteger;
                    iPar = 1;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, iNo);
                    iPar = 2;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, sName);
                    iPar = 3;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, sRen);
                    iPar = 5;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, iValue);
                    iPar = 6;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, iTClass);
                    iPar = 7;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, iFixHNo);
                    iPar = 9;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, iHassei);
                    result = 0;
                }
                else
                {
                    result =  -2;
                }
            }
            this.Close();
            //@ Unsupported property or method(C): 'Free'
            this.Free;
            this.Dispose(pQuery);
            return result;
        }

        // ////////////////////////////////////////////////////////////////////
        // ウィンドウから値を取得
        public int FxAction_No_GetWndGCode()
        {
            int result;
            TWParam WndParam;
            string sInpCode;
            bool bWndSelMode;
            result =  -1;
            bWndSelMode = gMASL310RootBf(VKZ310Cmnu.enBfunc.MASL_BGET_WND_SELMODE);
            // sInpCode:= EMNumEditFx_No.Text;
            // gMASL310RootWf(MASL_WND_SearchDataB,@sInpCode,@bWndSelMode);
            if (bWndSelMode)
            {
                //@ Unsupported property or method(C): 'Text'
                sInpCode = EMNumEditFx_No.Text;
                gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_SearchDataB, sInpCode, bWndSelMode);
                result =  -2;
                bWndSelMode = false;
                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_WND_SELMODE, bWndSelMode);
            }
            WndParam = gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM);
            // (*H0043 20040616 khattori	クリック！*)
            m_iFxSwkInp =  -1;
            if (WndParam.Code != "")
            {
                result = Convert.ToInt64(WndParam.Code.Substring(WndParam.Code.Length - 9 - 1 ,10));
                m_iFxSwkInp = Convert.ToInt64(WndParam.Code.Substring(1 - 1 ,1));
            }
            // if WndParam^.Code <> '' then	Result := StrToInt64( WndParam^.Code );
            WndParam.Code = "";
            // クリア

            return result;
        }

        // ////////////////////////////////////////////////////////////////////
        // 出納帳タイトルの取得
        // 戻り値	出納帳タイトル	(1:処理見出し 2:正残タイトル 3:負残タイトル 4:残高タイトル)
        public string FxAction_No_GetTitle(int iMode)
        {
            string result;
            TMQuery pQue;
            enTblList tlTblList;
            result = "";
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_CashPara;
            pQue = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
            if (pQue != null)
            {
                //@ Unsupported property or method(B): 'Locate'
                if (pQue.Locate("ParaKbn", iMode, new object[] {}) == true)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    result = pQue.GetFld("TitleName").AsString;
                }
            }
            return result;
        }

        // ////////////////////////////////////////////////////////////////////
        // 和暦西暦区分取得
        public int FxAction_No_GetWaSei()
        {
            int result;
            enTblList tlTblList;
            object pQuery;
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_DTMAIN;
            pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PREF_TBL_LIST, tlTblList);
            if (pQuery != null)
            {
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                result = TMQuery(pQuery).GetFld("YearKbn").AsInteger;
            }
            else
            {
                result = 0;
            }
            return result;
        }

        // //////////////////////////////////////////////////////////////////////////////
        // 定型ＮＯ
        // //////////////////////////////////////////////////////////////////////////////
        protected void FxAction_No(int iEvent, object pPar1, object pPar2)
        {
            // (*H0001	20010920 khattori 定型仕訳　印刷、一括削除*)
            string[] FUNCCAPTION1 = {"", "", "", "", "", "", "", ""};
            string[] FUNCCAPTION2 = {"", "", "一括削除", "", "", "", "", "印刷"};
            string[] FUNCCAPTION3 = {"", "", "一括削除", "", "", "", "", ""};
            // FUNCCAPTION	: array[1..8] of String	= ('', '', '', '', '', '', '', '');
            int iPar;
            int iSjiNo;
            int iValue;
            TMjsMsgRec infoRec;
            int iGCode;
            int iSwkInp;
            ushort Key;
            Keys Shift;
            // (*H0001	20010920 khattori 定型仕訳　印刷、一括削除*)
            MAS320100DSIParam stParam;
            string srJnl1;
            string srJnl2;
            string srJnl3;
            string srJnl4;
            ushort mrBtn;
            TMQuery cQuery;
            // Query
            TMASL310IFunc rFunc;
            rFunc = FxGetFxFunc();
            iSjiNo = rFunc.iOpCode;
            switch(iEvent)
            {
                case 0:
                    // iSjiNo	:=	gMASL310RootIf(MASL_IGET_FST_CODE);	//  指示ＮＯ
                    // rFunc	:=	Itm.ReadIniRec(iSjiNo);
                    // OnEnter
                    // マウスクリックで先に進めないようにする為、先のものはDisableにする。
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_RenEnt.Enabled = false;
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_Date.Enabled = false;
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_Den.Enabled = false;
                    //@ Unsupported property or method(C): 'Static'
                    MTxtFx_Name.Static = true;
                    // 排他開放する
                    m_cFixLock.iAction =  -1;
                    Rt.GetFixLock(m_cFixLock);
                    // (*H0001	20010920 khattori 定型仕訳　印刷、一括削除*)
                    // ファンクションセット
                    if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                    {
                        // (*H0029 20030224 khattori	伝票印刷対応*)
                        SetFuncOnFix(FUNCCAPTION2);
                    // if	IsSlipMode
                    // then	SetFuncOnFix( FUNCCAPTION3 )
                    // else	SetFuncOnFix( FUNCCAPTION2 );
                    }
                    else
                    {
                        SetFuncOnFix(FUNCCAPTION1);
                    }
                    // [定型入力]
                    // ウィンドウ表示
                    //@ Unsupported property or method(C): 'Tag'
                    if (MTxtFx_Ren.Tag == 1)
                    {
                        // 連想による絞込みはウィンドウ更新せず
                        //@ Unsupported property or method(C): 'Tag'
                        MTxtFx_Ren.Tag = 0;
                    }
                    else
                    {
                        // レコードがない場合は通常の処理(定型入力の時)
                        if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU) && ((Sm.CurMonth.iInner == 0) || (FxWndDsp(EMNumEditFx_No) <= 0)))
                        {
                            //@ Undeclared identifier(3): 'VK_RETURN'
                            Key = VK_RETURN;
                            Shift = new object[] {};
                            FxKeyDown(EMNumEditFx_No, ref Key, Shift);
                            //@ Unsupported property or method(C): 'Enabled'
                            PMPanelHdFx.Enabled = false;
                        }
                        if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                        {
                            FxWndDsp(EMNumEditFx_No);
                        }
                    }
                    break;
                case 1:
                    // OnExit
                    // メモリへ情報書き込み
                    //@ Unsupported property or method(C): 'Value'
                    iValue = Convert.ToInt64(EMNumEditFx_No.Value);
                    iPar = 1;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, iValue);
                    Stb.SetStatusBarText("");
                    // ステータスメッセージのクリア
                    gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_Clear);
                    break;
                case 2:
                    // OnKenDown
                    gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_KeyDown, pPar1, pPar2);
                    // フォーカス移動
                    //@ Undeclared identifier(3): 'VK_RETURN'
                    //@ Undeclared identifier(3): 'VK_TAB'
                    //@ Undeclared identifier(3): 'VK_LEFT'
                    //@ Undeclared identifier(3): 'VK_END'
                    //@ Undeclared identifier(3): 'VK_ESCAPE'
                    if (new ArrayList(new object[] {VK_RETURN, VK_TAB, VK_LEFT, VK_END, VK_ESCAPE}).Contains((ushort)pPar1))
                    {
                        //@ Undeclared identifier(3): 'VK_RETURN'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        if (((ushort)pPar1 == VK_RETURN) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new object[] {})))
                        {
                            // ウィンドウから定型ＮＯを取得
                            iGCode = FxAction_No_GetWndGCode();
                            if (iGCode > 0)
                            {
                                //@ Unsupported property or method(C): 'Value'
                                EMNumEditFx_No.Value = iGCode;
                            }
                            // else				EMNumEditFx_No.Value := 0;
                            if (iGCode ==  -2)
                            {
                                Console.Beep();
                                return;
                            }
                            // 値が入力されている
                            //@ Unsupported property or method(C): 'Value'
                            if (EMNumEditFx_No.Value > 0)
                            {
                                //@ Unsupported property or method(C): 'Value'
                                m_iFxExists = FxAction_No_CheckValue(Convert.ToInt64(EMNumEditFx_No.Value));
                                iPar = 10;
                                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, m_iFxExists);
                                if (m_iFxExists == 0)
                                {
                                    iPar = 2;
                                    //@ Unsupported property or method(C): 'Text'
                                    MTxtFx_Name.Text = (gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar) as string);
                                    iPar = 3;
                                    //@ Unsupported property or method(C): 'Text'
                                    MTxtFx_RenEnt.Text = (gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar) as string);
                                    iPar = 9;
                                    iSwkInp = ((int)gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                                    // (*H0018 20010926 khattori	定型仕訳排他対応*)
                                    if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                                    {
                                        // 定型仕訳登録
                                        m_cFixLock.iAction = 0;
                                    }
                                    else
                                    {
                                        // 定型仕訳入力
                                        m_cFixLock.iAction = 1;
                                    }
                                    m_cFixLock.iInpKbn = iSwkInp;
                                    m_cFixLock.iForm = GetSForm();
                                    m_cFixLock.iClass = GetTClass();
                                    //@ Unsupported property or method(C): 'AsInteger'
                                    m_cFixLock.iGCodeF = EMNumEditFx_No.AsInteger;
                                    if (Rt.GetFixLock(m_cFixLock) == 0)
                                    {
                                        FxDsp(iSjiNo);
                                    }
                                    else
                                    {
                                        // showmessage('他の端末で使用されています。');
                                        if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                                        {
                                            // 定型仕訳登録
                                            //@ Undeclared identifier(3): 'mjError'
                                            //@ Undeclared identifier(3): 'mjOk'
                                            //@ Undeclared identifier(3): 'mjDefOk'
                                            VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("他の端末で使用されています。", "定型仕訳登録", mjError, mjOk, mjDefOk);
                                        }
                                        else
                                        {
                                            //@ Undeclared identifier(3): 'mjError'
                                            //@ Undeclared identifier(3): 'mjOk'
                                            //@ Undeclared identifier(3): 'mjDefOk'
                                            VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("他の端末で使用されています。", "定型仕訳入力", mjError, mjOk, mjDefOk);
                                        }
                                        return;
                                    }
                                    if (!IsSlipMode)
                                    {
                                        iPar = 6;
                                        if (((int)gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar)) > 0)
                                        {
                                            FxSetHead();
                                        }
                                    }
                                }
                                else if (m_iFxExists ==  -1)
                                {
                                    // 入力値の仕訳が存在しない
                                    if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                                    {
                                        // 定型仕訳登録
                                        iPar = 9;
                                        iSwkInp = ((int)gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                                        // (*H0018 20010926 khattori	定型仕訳排他対応*)
                                        m_cFixLock.iAction = 0;
                                        m_cFixLock.iInpKbn = iSwkInp;
                                        m_cFixLock.iForm = GetSForm();
                                        m_cFixLock.iClass = GetTClass();
                                        //@ Unsupported property or method(C): 'AsInteger'
                                        m_cFixLock.iGCodeF = EMNumEditFx_No.AsInteger;
                                        if (Rt.GetFixLock(m_cFixLock) == 0)
                                        {
                                        // FxDsp(iSjiNo);
                                        }
                                        else
                                        {
                                            //@ Undeclared identifier(3): 'mjError'
                                            //@ Undeclared identifier(3): 'mjOk'
                                            //@ Undeclared identifier(3): 'mjDefOk'
                                            VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("他の端末で使用されています。", "定型仕訳登録", mjError, mjOk, mjDefOk);
                                            return;
                                        }
                                    }
                                    FxReset(1);
                                    if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU))
                                    {
                                        // 定型仕訳入力ではエラー
                                        Console.Beep();
                                        //@ Unsupported property or method(A): 'SelectAll'
                                        EMNumEditFx_No.SelectAll();
                                        //@ Undeclared identifier(3): 'TMASCom'
                                        //@ Unsupported property or method(D): 'm_MsgStd'
                                        //@ Unsupported property or method(B): 'GetMSG'
                                        TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(infoRec, 20, 114);
                                        //@ Undeclared identifier(3): 'TMASCom'
                                        //@ Unsupported property or method(D): 'sMsg'
                                        //@ Unsupported property or method(D): 'm_MsgStd'
                                        //@ Unsupported property or method(B): 'MsgChange'
                                        //@ Unsupported property or method(D): 'sMsg'
                                        infoRec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(infoRec.sMsg, "検索", "定型");
                                        Stb.SetStatusBarText("定型NOが存在しません。");
                                        return;
                                    }
                                }
                                else if (m_iFxExists ==  -2)
                                {
                                    // 入力値の仕訳が使用不可
                                    FxReset(1);
                                    Console.Beep();
                                    //@ Unsupported property or method(A): 'SelectAll'
                                    EMNumEditFx_No.SelectAll();
                                    Stb.SetStatusBarText("他で登録された定型仕訳は修正・削除できません。");
                                    return;
                                }
                            // 値が入力されていない
                            }
                            else
                            {
                                m_iFxExists =  -1;
                                iPar = 10;
                                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, m_iFxExists);
                                FxReset(1);
                                // 定型仕訳入力⇒通常入力
                                // 定型仕訳登録⇒エラー
                                if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU))
                                {
                                    FxDsp();
                                }
                                else
                                {
                                    Console.Beep();
                                    //@ Undeclared identifier(3): 'TMASCom'
                                    //@ Unsupported property or method(D): 'm_MsgStd'
                                    //@ Unsupported property or method(B): 'GetMSG'
                                    TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(infoRec, 20, 108);
                                    //@ Undeclared identifier(3): 'TMASCom'
                                    //@ Unsupported property or method(D): 'sMsg'
                                    //@ Unsupported property or method(D): 'm_MsgStd'
                                    //@ Unsupported property or method(B): 'MsgChange'
                                    //@ Unsupported property or method(D): 'sMsg'
                                    infoRec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(infoRec.sMsg, "@_@", "定型NO");
                                    //@ Unsupported property or method(D): 'sMsg'
                                    Stb.SetStatusBarText(infoRec.sMsg);
                                    return;
                                }
                            }
                            FxFocusMove(EMNumEditFx_No, 1);
                        }
                        //@ Undeclared identifier(3): 'VK_LEFT'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        else if (((ushort)pPar1 == VK_LEFT) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift})))
                        {
                            FxFocusMove(EMNumEditFx_No, 2);
                        }
                        //@ Undeclared identifier(3): 'VK_END'
                        //@ Undeclared identifier(3): 'VK_ESCAPE'
                        else if ((((ushort)pPar1 == VK_END) || ((ushort)pPar1 == VK_ESCAPE)) && (((pPar2) as Keys) == new object[] {}))
                        {
                            FxFocusMove(EMNumEditFx_No, 3);
                        }
                    }
                    //@ Undeclared identifier(3): 'VK_HOME'
                    else if (((ushort)pPar1 == VK_HOME) && (((pPar2) as Keys) == new object[] {}))
                    {
                        // 入力の時｢連想モード｣で表示
                        FxDsp(iSjiNo, 1);
                    }
                    // (*H0001	20010920 khattori 定型仕訳　印刷、一括削除*)
                    // ファンクション押下
                    //@ Undeclared identifier(3): 'VK_F1'
                    //@ Undeclared identifier(3): 'VK_F8'
                    if (((ushort)pPar1 >= VK_F1 && (ushort)pPar1<= VK_F8) && (((pPar2) as Keys) == new object[] {}))
                    {
                        // ---<HIS-038> ファンクションがあるか？-----------------------------------------
                        //@ Undeclared identifier(3): 'VK_F1'
                        iPar = (ushort)pPar1 - VK_F1 + 1;
                        if ((Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iPar) != null))
                        {
                            switch((ushort)pPar1)
                            {
                                // if (rFunc.iMode = MASL_PROC_MODE_TEIKEITOUROKU) then		//  定型仕訳登録
                                // ------------------------------------------------------------------<HIS-038>---
                                // 一括削除
                                //@ Undeclared identifier(3): 'VK_F3'
                                case VK_F3:
                                    // showmessage('all delete now making!');
                                    //@ Undeclared identifier(3): 'TMASCom'
                                    //@ Unsupported property or method(D): 'm_MsgStd'
                                    //@ Unsupported property or method(B): 'GetMsg'
                                    TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMsg(infoRec, 20, 101);
                                    // ﾒｯｾｰｼﾞ文字列の置換え
                                    //@ Unsupported property or method(B): 'TMASCom'
                                    //@ Unsupported property or method(D): 'sMsg'
                                    //@ Unsupported property or method(D): 'm_MsgStd'
                                    //@ Unsupported property or method(B): 'MsgChange'
                                    //@ Unsupported property or method(D): 'sMsg'
                                    infoRec.sMsg = infoRec.TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(infoRec.sMsg, "一括@_@", "定型仕訳一括削除");
                                    // ﾀｲﾄﾙ文字列の置換え
                                    //@ Unsupported property or method(B): 'TMASCom'
                                    //@ Unsupported property or method(D): 'sTitle'
                                    //@ Unsupported property or method(D): 'm_MsgStd'
                                    //@ Unsupported property or method(B): 'MsgChange'
                                    //@ Unsupported property or method(D): 'sTitle'
                                    infoRec.sTitle = infoRec.TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(infoRec.sTitle, "一括@_@", "定型仕訳一括削除");
                                    //@ Unsupported property or method(D): 'sMsg'
                                    //@ Unsupported property or method(D): 'sTitle'
                                    //@ Unsupported property or method(D): 'icontype'
                                    //@ Unsupported property or method(D): 'btntype'
                                    //@ Unsupported property or method(D): 'btndef'
                                    //@ Unsupported property or method(D): 'LogType'
                                    mrBtn = VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(infoRec.sMsg, infoRec.sTitle, infoRec.icontype, infoRec.btntype, infoRec.btndef, infoRec.LogType);
                                    if (mrBtn == System.Windows.Forms.DialogResult.Yes)
                                    {
                                        m_cFixLock.iAction = 0;
                                        // ♪♪♪♪♪♪
                                        // メール会計採用をはずすと、発生区分にかかわらず修正、削除できる
                                        if ((Rt.m_iComKbn3 == 0))
                                        {
                                            m_cFixLock.iInpKbn =  -1;
                                        // 全発生区分対象
                                        }
                                        else
                                        {
                                            iPar = 9;
                                            iSwkInp = ((int)gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                                            m_cFixLock.iInpKbn = iSwkInp;
                                        }
                                        m_cFixLock.iForm = GetSForm();
                                        m_cFixLock.iClass = GetTClass();
                                        m_cFixLock.iGCodeF = 0;
                                        // ０＝全件
                                        if (Rt.GetFixLock(m_cFixLock) == 0)
                                        {
                                            Rt.FxHeadAllDel(0);
                                            m_cFixLock.iAction =  -1;
                                            Rt.GetFixLock(m_cFixLock);
                                            FxWndDsp(EMNumEditFx_No);
                                        }
                                        else
                                        {
                                            // showmessage('他の端末で使用されています。');
                                            //@ Undeclared identifier(3): 'mjError'
                                            //@ Undeclared identifier(3): 'mjOk'
                                            //@ Undeclared identifier(3): 'mjDefOk'
                                            VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("他の端末で使用されています。", "定型仕訳登録", mjError, mjOk, mjDefOk);
                                        }
                                    }
                                    break;
                                // 印刷
                                //@ Undeclared identifier(3): 'VK_F8'
                                case VK_F8:
                                    // ♪♪♪♪♪	伝票の定型印刷は未だ出来てない。
                                    // (*H0029 20030224 khattori	伝票印刷対応*)
                                    // if	IsSlipMode	then	exit;
                                    cQuery = new TMQuery(this);
                                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                                    m_cMDModule.SetDBInfoToQuery(m_FCopDBMas, cQuery);
                                    m_stFlexInfo.pRec = ((m_pRec) as TMjsAppRecord);
                                    m_stFlexInfo.pQuery = cQuery;
                                    m_stFlexInfo.iMode = 0;
                                    m_stFlexInfo.iInpKbn = GetTClass();
                                    // 空きがないのでここを使う
                                    m_stFlexInfo.iStNo = 0;
                                    m_stFlexInfo.iEdNo = 0;
                                    m_stFlexInfo.AOwner = this;
                                    if (MAS310000Dlgu.Units.MAS310000Dlgu.MFlexibleDialog_Call(ref m_stFlexInfo))
                                    {
                                        stParam.Mot1[0] = FxAction_No_GetWaSei();
                                        // 和暦/西暦区分
                                        stParam.Mot2[0] = GetTClass();
                                        // 出納帳定型種別
                                        stParam.Mot2[1] = m_stFlexInfo.iStNo;
                                        // 印刷開始定型ＮＯ
                                        stParam.Mot2[2] = m_stFlexInfo.iEdNo;
                                        // 印刷終了定型ＮＯ
                                        if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_TYPE) == 1)
                                        {
                                            stParam.iClientId = 5;
                                            // MAS320_OUT_TEIKEI
                                            // (*H0029 20030224 khattori	伝票印刷対応*)
                                            srJnl1 = '1';
                                            stParam.Jnl1[1] = srJnl1;
                                            stParam.iAction = 12;
                                            // 要求動作	MAS320_OUT_CLEAR	集計エリア初期化
                                            Rt.DoAction(Itm.ReadIniRec(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DIARY), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, stParam);
                                            stParam.iAction = 1;
                                            // 要求動作	MAS320_OUT_PRINT;
                                            Rt.DoAction(Itm.ReadIniRec(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DIARY), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, stParam);
                                        }
                                        else if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_TYPE) == 2)
                                        {
                                            stParam.iClientId = 6;
                                            // MAS320_OUT_SUITEI
                                            srJnl1 = FxAction_No_GetTitle(1);
                                            stParam.Jnl1[1] = srJnl1;
                                            srJnl2 = FxAction_No_GetTitle(2);
                                            stParam.Jnl1[2] = srJnl2;
                                            srJnl3 = FxAction_No_GetTitle(3);
                                            stParam.Jnl1[3] = srJnl3;
                                            srJnl4 = FxAction_No_GetTitle(4);
                                            stParam.Jnl1[4] = srJnl4;
                                            stParam.iAction = 12;
                                            // 要求動作	MAS320_OUT_CLEAR	集計エリア初期化
                                            Rt.DoAction(Itm.ReadIniRec(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_LEDGER), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, stParam);
                                            stParam.iAction = 1;
                                            // 要求動作	MAS320_OUT_PRINT;
                                            Rt.DoAction(Itm.ReadIniRec(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_LEDGER), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, stParam);
                                        }
                                        else
                                        {
                                            stParam.iClientId = 5;
                                            // MAS320_OUT_TEIKEI
                                            srJnl1 = (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_TYPE)).ToString();
                                            stParam.Jnl1[1] = srJnl1;
                                            // (*H0029 20030224 khattori	伝票印刷対応*)
                                            // 第２指示取得
                                            rFunc = Itm.ReadIniRec(gMASL310RootIf(VKZ310Cmnu.enIfunc.MASL_IGET_SND_CODE));
                                            srJnl2 = srJnl1 + " - " + (stParam.Mot2[0]).ToString() + ' ' + rFunc.sCaption;
                                            stParam.Jnl1[2] = srJnl2;
                                            stParam.iAction = 12;
                                            // 要求動作	MAS320_OUT_CLEAR	集計エリア初期化
                                            Rt.DoAction(Itm.ReadIniRec(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DIARY), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, stParam);
                                            // Rt.DoAction(Itm.ReadIniRec(MASL_PROC_CODE_SLIP),MASL_DRILL_FRM_PARENT,@stParam);
                                            stParam.iAction = 1;
                                            // 要求動作	MAS320_OUT_PRINT;
                                            Rt.DoAction(Itm.ReadIniRec(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DIARY), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, stParam);
                                        // Rt.DoAction(Itm.ReadIniRec(MASL_PROC_CODE_SLIP),MASL_DRILL_FRM_PARENT,@stParam);
                                        }
                                    }
                                    break;
                            // 印刷
                            }
                        }
                    // case
                    }
                    break;
            // ファンクション押下
            // OnKenDown
            }
            // case

        }

        // //////////////////////////////////////////////////////////////////////////////
        // 連想
        // //////////////////////////////////////////////////////////////////////////////
        protected void FxAction_Ren(int iEvent, object pPar1, object pPar2)
        {
            string[] FUNCCAPTION1 = {"", "", "", "", "", "", "", ""};
            int iPar;
            int iSjiNo;
            string sText;
            int iRenMode;
            int iNumLen;
            string sNum1;
            string sNum2;
            iSjiNo = FxGetFxFunc().iOpCode;
            switch(iEvent)
            {
                case 0:
                    // iSjiNo := gMASL310RootIf(MASL_IGET_FST_CODE);	//  指示ＮＯ
                    // OnEnter
                    iRenMode = Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_RENSOU_MODE);
                    switch(iRenMode)
                    {
                        case 0:
                            //@ Unsupported property or method(C): 'ImRoma'
                            //@ Unsupported property or method(C): 'InputMode'
                            MTxtFx_Ren.InputMode = MTxtFx_Ren.ImRoma;
                            //@ Unsupported property or method(C): 'CmToKana'
                            //@ Unsupported property or method(C): 'ConvertMode'
                            MTxtFx_Ren.ConvertMode = MTxtFx_Ren.CmToKana;
                            break;
                        case 1:
                            //@ Unsupported property or method(C): 'ImRoma'
                            //@ Unsupported property or method(C): 'InputMode'
                            MTxtFx_Ren.InputMode = MTxtFx_Ren.ImRoma;
                            //@ Unsupported property or method(C): 'CmToEnglish'
                            //@ Unsupported property or method(C): 'ConvertMode'
                            MTxtFx_Ren.ConvertMode = MTxtFx_Ren.CmToEnglish;
                            break;
                        case 2:
                            //@ Unsupported property or method(C): 'ImKana'
                            //@ Unsupported property or method(C): 'InputMode'
                            MTxtFx_Ren.InputMode = MTxtFx_Ren.ImKana;
                            //@ Unsupported property or method(C): 'CmToKana'
                            //@ Unsupported property or method(C): 'ConvertMode'
                            MTxtFx_Ren.ConvertMode = MTxtFx_Ren.CmToKana;
                            break;
                    }
                    //@ Unsupported property or method(C): 'Caption'
                    PMPanelFx_RenN.Caption = Rt.Sfnc(VKZ310Cmnu.enSfunc.MASL_SGET_RENSOU_MODE);
                    // マウスクリックで先に進めないようにする為、先のものはDisableにする。
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_Date.Enabled = false;
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_Den.Enabled = false;
                    //@ Unsupported property or method(C): 'Static'
                    MTxtFx_Name.Static = true;
                    //@ Unsupported property or method(A): 'SelectAll'
                    MTxtFx_Ren.SelectAll();
                    SetFuncOnFix(FUNCCAPTION1);
                    // [定型入力]
                    // ウィンドウ表示
                    FxWndDsp(EMNumEditFx_No);
                    m_iFxRenLength = 0;
                    break;
                case 1:
                    // OnExit
                    FxDsp(iSjiNo);
                    Stb.SetStatusBarText("");
                    break;
                case 2:
                    // ステータスメッセージのクリア
                    // OnKenDown
                    // フォーカス移動
                    gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_KeyDown, pPar1, pPar2);
                    // //////////////////////////////////////////////////////////////////////////////
                    // 連想入力モード			連想パーツプロパティ		連想Ｃａｐｔｉｏｎ
                    // 入力モード	変換モード
                    // ０＝ローマ字ー＞カナ	ImRoma		CmToKana		連想Rｶ
                    // １＝英数				ImRoma		CmToEnglish		連想 A
                    // ２＝かなー＞カナ		ImKana		CmToKana		連想 ｶ
                    // //////////////////////////////////////////////////////////////////////////////
                    //@ Undeclared identifier(3): 'VK_F9'
                    if (((ushort)pPar1 == VK_F9))
                    {
                        iRenMode =  -1;
                        iRenMode = Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_RENSOU_MODE, iRenMode);
                        switch(iRenMode)
                        {
                            case 0:
                                //@ Unsupported property or method(C): 'ImRoma'
                                //@ Unsupported property or method(C): 'InputMode'
                                MTxtFx_Ren.InputMode = MTxtFx_Ren.ImRoma;
                                //@ Unsupported property or method(C): 'CmToKana'
                                //@ Unsupported property or method(C): 'ConvertMode'
                                MTxtFx_Ren.ConvertMode = MTxtFx_Ren.CmToKana;
                                break;
                            case 1:
                                //@ Unsupported property or method(C): 'ImRoma'
                                //@ Unsupported property or method(C): 'InputMode'
                                MTxtFx_Ren.InputMode = MTxtFx_Ren.ImRoma;
                                //@ Unsupported property or method(C): 'CmToEnglish'
                                //@ Unsupported property or method(C): 'ConvertMode'
                                MTxtFx_Ren.ConvertMode = MTxtFx_Ren.CmToEnglish;
                                break;
                            case 2:
                                //@ Unsupported property or method(C): 'ImKana'
                                //@ Unsupported property or method(C): 'InputMode'
                                MTxtFx_Ren.InputMode = MTxtFx_Ren.ImKana;
                                //@ Unsupported property or method(C): 'CmToKana'
                                //@ Unsupported property or method(C): 'ConvertMode'
                                MTxtFx_Ren.ConvertMode = MTxtFx_Ren.CmToKana;
                                break;
                        }
                        //@ Unsupported property or method(C): 'Caption'
                        PMPanelFx_RenN.Caption = Rt.Sfnc(VKZ310Cmnu.enSfunc.MASL_SGET_RENSOU_MODE);
                    }
                    //@ Undeclared identifier(3): 'VK_RETURN'
                    //@ Undeclared identifier(3): 'VK_TAB'
                    if ((new ArrayList(new object[] {VK_RETURN, VK_TAB}).Contains((ushort)pPar1)) && (((pPar2) as Keys) == new object[] {}))
                    {
                        //@ Unsupported property or method(C): 'Parent'
                        //@ Unsupported property or method(D): 'Tag'
                        if (MTxtFx_Ren.Parent.Tag == 1)
                        {
                            //@ Unsupported property or method(C): 'Parent'
                            //@ Unsupported property or method(D): 'Tag'
                            MTxtFx_Ren.Parent.Tag = 0;
                            //@ Unsupported property or method(C): 'Text'
                            iNumLen = MTxtFx_Ren.Text.Length;
                            sNum1 = "";
                            sNum2 = "";
                            if (iNumLen > 1)
                            {
                                //@ Unsupported property or method(C): 'Text'
                                //@ Unsupported function or procedure: 'Copy'
                                sNum2 = Copy(MTxtFx_Ren.Text, iNumLen - 1, 1);
                            }
                            if (iNumLen > 0)
                            {
                                //@ Unsupported property or method(C): 'Text'
                                //@ Unsupported function or procedure: 'Copy'
                                sNum1 = Copy(MTxtFx_Ren.Text, iNumLen, 1);
                            }
                            if ((sNum1 >= '0') && (sNum1 <= '9'))
                            {
                                if ((sNum2 >= '1') && (sNum2 <= '3'))
                                {
                                    sNum1 = sNum2 + sNum1;
                                }
                                ((EMNumEditFx_No) as TextBox).Text = sNum1;
                                //@ Unsupported property or method(B): 'OnKeyDown'
                                EMNumEditFx_No.OnKeyDown(EMNumEditFx_No, (ushort)pPar1, ((pPar2) as Keys));
                            }
                        }
                        else
                        {
                            // 呼び元に戻る
                            //@ Unsupported property or method(C): 'Text'
                            if (MTxtFx_Ren.Text != "")
                            {
                                //@ Unsupported property or method(C): 'Tag'
                                MTxtFx_Ren.Tag = 1;
                            }
                            // 確定ﾌﾗｸﾞをOnに
                            //@ Unsupported property or method(B): 'SetFocus'
                            EMNumEditFx_No.SetFocus();
                        }
                    }
                    //@ Undeclared identifier(3): 'VK_HOME'
                    //@ Undeclared identifier(3): 'VK_END'
                    //@ Undeclared identifier(3): 'VK_ESCAPE'
                    if ((new ArrayList(new object[] {VK_HOME, VK_END, VK_ESCAPE}).Contains((ushort)pPar1)) && (((pPar2) as Keys) == new object[] {}))
                    {
                        //@ Unsupported property or method(D): 'SetFocus'
                        EMNumEditFx_No.SetFocus;
                    }
                    break;
            // OnKenDown
            }
            // case

        }

        // //////////////////////////////////////////////////////////////////////////////
        // 連想
        // //////////////////////////////////////////////////////////////////////////////
        protected void FxAction_RenEnt(int iEvent, object pPar1, object pPar2)
        {
            string[] FUNCCAPTION1 = {"", "", "", "", "", "", "", ""};
            int iPar;
            int iSjiNo;
            string sText;
            iSjiNo = FxGetFxFunc().iOpCode;
            switch(iEvent)
            {
                case 0:
                    // iSjiNo := gMASL310RootIf(MASL_IGET_FST_CODE);	//  指示ＮＯ
                    // OnEnter
                    // マウスクリックで先に進めないようにする為、先のものはDisableにする。
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_Date.Enabled = false;
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_Den.Enabled = false;
                    //@ Unsupported property or method(A): 'SelectAll'
                    MTxtFx_Ren.SelectAll();
                    SetFuncOnFix(FUNCCAPTION1);
                    break;
                case 1:
                    // OnExit
                    //@ Unsupported property or method(C): 'Text'
                    sText = MTxtFx_RenEnt.Text;
                    iPar = 3;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, sText);
                    Stb.SetStatusBarText("");
                    break;
                case 2:
                    // ステータスメッセージのクリア
                    // OnKenDown
                    //@ Undeclared identifier(3): 'VK_RETURN'
                    //@ Undeclared identifier(3): 'VK_TAB'
                    //@ Undeclared identifier(3): 'VK_LEFT'
                    //@ Undeclared identifier(3): 'VK_END'
                    //@ Undeclared identifier(3): 'VK_ESCAPE'
                    if (new ArrayList(new object[] {VK_RETURN, VK_TAB, VK_LEFT, VK_END, VK_ESCAPE}).Contains((ushort)pPar1))
                    {
                        //@ Undeclared identifier(3): 'VK_RETURN'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        if (((ushort)pPar1 == VK_RETURN) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new object[] {})))
                        {
                            FxFocusMove(MTxtFx_RenEnt, 1);
                        }
                        //@ Undeclared identifier(3): 'VK_LEFT'
                        //@ Undeclared identifier(3): 'MjsChkCurTop'
                        // else if ( ( Word(pPar1^) = VK_LEFT ) and  MjsChkCurTop( MTxtFx_Ren ) and ( TShiftState(pPar2^) = [] ) )	or
                        //@ Undeclared identifier(3): 'VK_TAB'
                        else if ((((ushort)pPar1 == VK_LEFT) && MjsChkCurTop(MTxtFx_RenEnt) && (((pPar2) as Keys) == new object[] {})) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift})))
                        {
                            FxFocusMove(MTxtFx_RenEnt, 2);
                        }
                        //@ Undeclared identifier(3): 'VK_END'
                        //@ Undeclared identifier(3): 'VK_ESCAPE'
                        else if ((((ushort)pPar1 == VK_END) || ((ushort)pPar1 == VK_ESCAPE)) && (((pPar2) as Keys) == new object[] {}))
                        {
                            FxFocusMove(MTxtFx_RenEnt, 3);
                        }
                    }
                    break;
            // OnKenDown
            }
            // case

        }

        // //////////////////////////////////////////////////////////////////////////////
        // 伝票日付
        // //////////////////////////////////////////////////////////////////////////////
        protected void FxAction_Date(int iEvent, object pPar1, object pPar2)
        {
            string[] FUNCCAPTION = {"", "", "", "", "", "", "", ""};
            int iPar;
            int iValue;
            int iCheckMode;
            // ＝０：表示、＝１：入力
            TMASL310IMonth stMonth;
            int iReturn;
            int iInMonth;
            switch(iEvent)
            {
                case 0:
                    // OnEnter
                    //@ Unsupported property or method(C): 'AsInteger'
                    if (EMNumEditFx_Date.AsInteger == 0)
                    {
                        iInMonth = Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_INN_MONTH);
                        if ((iInMonth % 10) > 4)
                        {
                            iCheckMode = 1;
                            // ＝０：表示、＝１：入力
                            iValue = 99;
                            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_DATE_CHECK, iValue, iCheckMode, stMonth) == 0)
                            {
                                if ((Sm.Kotei == 0))
                                {
                                    //@ Unsupported property or method(C): 'Value'
                                    EMNumEditFx_Date.Value = stMonth.iEndDate % 10000;
                                }
                                else
                                {
                                    //@ Unsupported property or method(C): 'Value'
                                    EMNumEditFx_Date.Value = stMonth.iOuter * 100 + stMonth.iEndDate % 100;
                                }
                            }
                        }
                    }
                    // マウスクリックで先に進めないようにする為、先のものはDisableにする。
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_Den.Enabled = false;
                    //@ Unsupported property or method(C): 'Static'
                    MTxtFx_Name.Static = true;
                    // ファンクションセット
                    SetFuncOnFix(FUNCCAPTION);
                    // (*♪♪♪♪♪*)
                    gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_Clear);
                    break;
                case 1:
                    // OnExit
                    Stb.SetStatusBarText("");
                    break;
                case 2:
                    // ステータスメッセージのクリア
                    // (*♪♪♪♪♪*)
                    // gMASL310RootWf(MASL_WND_Clear);
                    // OnKenDown
                    // フォーカス移動
                    //@ Undeclared identifier(3): 'VK_RETURN'
                    //@ Undeclared identifier(3): 'VK_TAB'
                    //@ Undeclared identifier(3): 'VK_LEFT'
                    //@ Undeclared identifier(3): 'VK_END'
                    //@ Undeclared identifier(3): 'VK_ESCAPE'
                    if (new ArrayList(new object[] {VK_RETURN, VK_TAB, VK_LEFT, VK_END, VK_ESCAPE}).Contains((ushort)pPar1))
                    {
                        //@ Undeclared identifier(3): 'VK_RETURN'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        if (((ushort)pPar1 == VK_RETURN) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new object[] {})))
                        {
                            //@ Unsupported property or method(C): 'Value'
                            iValue = Convert.ToInt64(EMNumEditFx_Date.Value);
                            if ((iValue <= 0) || ((iValue % 100) == 0) || ((iValue % 100) == 99))
                            {
                                Console.Beep();
                                // (*inforec.sMsg*)
                                Stb.SetStatusBarText("月日が間違っています。");
                                //@ Unsupported property or method(A): 'SelectAll'
                                EMNumEditFx_Date.SelectAll();
                                return;
                            }
                            iCheckMode = 1;
                            // ＝０：表示、＝１：入力
                            // 値が入力されている
                            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_DATE_CHECK, iValue, iCheckMode, stMonth) != 0)
                            {
                                Console.Beep();
                                // (*inforec.sMsg*)
                                Stb.SetStatusBarText("月日が間違っています。");
                                //@ Unsupported property or method(A): 'SelectAll'
                                EMNumEditFx_Date.SelectAll();
                                return;
                            }
                            iReturn = gMASL310RootIf(VKZ310Cmnu.enIfunc.MASL_IGET_CHANGEABLE, stMonth.iInner, Rt.m_iHassei);
                            if (((enRetChangeable)(iReturn)) != VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_OK)
                            {
                                Console.Beep();
                                switch(((enRetChangeable)(iReturn)))
                                {
                                    case VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_FIXED:
                                        Stb.SetStatusBarText("月次確定済みの為入力できません。");
                                        break;
                                    case VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_UPPER:
                                        Stb.SetStatusBarText("上位発生区分の為入力できません。");
                                        break;
                                    case VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_LOWER:
                                        Stb.SetStatusBarText("下位発生区分月次未確定の為入力できません。");
                                        break;
                                }
                                //@ Unsupported property or method(A): 'SelectAll'
                                EMNumEditFx_Date.SelectAll();
                            }
                            else
                            {
                                if ((iValue < 100))
                                {
                                    if ((stMonth.iOuter > 12))
                                    {
                                        //@ Unsupported property or method(C): 'Value'
                                        EMNumEditFx_Date.Value = stMonth.iOuter * 100 + iCheckMode % 100;
                                    }
                                    else
                                    {
                                        //@ Unsupported property or method(C): 'Value'
                                        EMNumEditFx_Date.Value = iCheckMode % 10000;
                                    }
                                }
                                iPar = 4;
                                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, iCheckMode);
                                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_CUR_MNTH, stMonth.iInner);
                                // (*♪♪♪♪♪*)
                                if (!IsSlipMode)
                                {
                                    // 出納帳の時、当該情報をセット
                                    iPar = 6;
                                    if (((int)gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar)) > 0)
                                    {
                                        FxSetHead();
                                    }
                                }
                                FxFocusMove(EMNumEditFx_Date, 1);
                            }
                        }
                        //@ Undeclared identifier(3): 'VK_LEFT'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        else if (((ushort)pPar1 == VK_LEFT) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift})))
                        {
                            FxFocusMove(EMNumEditFx_Date, 2);
                        }
                        //@ Undeclared identifier(3): 'VK_END'
                        //@ Undeclared identifier(3): 'VK_ESCAPE'
                        else if ((((ushort)pPar1 == VK_END) || ((ushort)pPar1 == VK_ESCAPE)) && (((pPar2) as Keys) == new object[] {}))
                        {
                            FxFocusMove(EMNumEditFx_Date, 3);
                        }
                    }
                    break;
            }
        }

        // //////////////////////////////////////////////////////////////////////////////
        // 伝票ＮＯ
        // //////////////////////////////////////////////////////////////////////////////
        protected void FxAction_Den(int iEvent, object pPar1, object pPar2)
        {
            string[] FUNCCAPTION = {"", "", "", "", "", "", "", ""};
            int iPar;
            int iValue;
            switch(iEvent)
            {
                case 0:
                    // OnEnter
                    // マウスクリックで先に進めないようにする為、先のものはDisableにする。
                    //@ Unsupported property or method(C): 'Static'
                    MTxtFx_Name.Static = true;
                    // ファンクションセット
                    SetFuncOnFix(FUNCCAPTION);
                    break;
                case 1:
                    // OnExit
                    // メモリへ情報書き込み
                    //@ Unsupported property or method(C): 'Value'
                    iValue = Convert.ToInt64(EMNumEditFx_Den.Value);
                    //@ Unsupported property or method(C): 'InputFlag'
                    if ((iValue == 0) && (EMNumEditFx_Den.InputFlag == true))
                    {
                        iValue =  -1;
                    }
                    iPar = 5;
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, iValue);
                    Stb.SetStatusBarText("");
                    break;
                case 2:
                    // ステータスメッセージのクリア
                    // OnKenDown
                    // フォーカス移動
                    //@ Undeclared identifier(3): 'VK_RETURN'
                    //@ Undeclared identifier(3): 'VK_TAB'
                    //@ Undeclared identifier(3): 'VK_LEFT'
                    //@ Undeclared identifier(3): 'VK_END'
                    //@ Undeclared identifier(3): 'VK_ESCAPE'
                    if (new ArrayList(new object[] {VK_RETURN, VK_TAB, VK_LEFT, VK_END, VK_ESCAPE}).Contains((ushort)pPar1))
                    {
                        //@ Undeclared identifier(3): 'VK_RETURN'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        if (((ushort)pPar1 == VK_RETURN) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new object[] {})))
                        {
                            FxFocusMove(EMNumEditFx_Den, 1);
                        }
                        //@ Undeclared identifier(3): 'VK_LEFT'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        else if (((ushort)pPar1 == VK_LEFT) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift})))
                        {
                            FxFocusMove(EMNumEditFx_Den, 2);
                        }
                        //@ Undeclared identifier(3): 'VK_END'
                        //@ Undeclared identifier(3): 'VK_ESCAPE'
                        else if ((((ushort)pPar1 == VK_END) || ((ushort)pPar1 == VK_ESCAPE)) && (((pPar2) as Keys) == new object[] {}))
                        {
                            FxFocusMove(EMNumEditFx_Den, 3);
                        }
                    }
                    break;
            }
        }

        // //////////////////////////////////////////////////////////////////////////////
        // 名称
        // //////////////////////////////////////////////////////////////////////////////
        protected void FxAction_Name(int iEvent, object pPar1, object pPar2)
        {
            string[] FUNCCAPTION1 = {"", "", "", "", "", "", "", ""};
            string[] FUNCCAPTION2 = {"", "修正", "削除", "コード変更", "", "", "", ""};
            int iPar;
            int iValue;
            int iSjiNo;
            string sString;
            TMjsMsgRec infoRec;
            ushort mrBtn;
            TMQuery cQuery;
            // Query
            TMASL310IFunc rFunc;
            rFunc = FxGetFxFunc();
            iSjiNo = rFunc.iOpCode;
            switch(iEvent)
            {
                case 0:
                    // iSjiNo 	:= gMASL310RootIf(MASL_IGET_FST_CODE);	//  指示ＮＯ
                    // rFunc	:=	Itm.ReadIniRec(iSjiNo);
                    // OnEnter
                    // フリガナコンポーネントのセット(※ここでセットしないと動作しない)
                    //@ Unsupported property or method(C): 'Control'
                    MFurigana.Control = MTxtFx_Name;
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelFx_RenEnt.Enabled = false;
                    // [定型登録]
                    // 修正モード⇒修正ファンクション表示⇒修正処理
                    // 削除ファンクション表示⇒削除処理
                    // ファンクションセット
                    if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU) && (m_iFxExists == 0))
                    {
                        SetFuncOnFix(FUNCCAPTION2);
                    }
                    else
                    {
                        SetFuncOnFix(FUNCCAPTION1);
                    }
                    break;
                case 1:
                    // OnExit
                    // メモリへ情報書き込み
                    if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                    {
                        //@ Unsupported property or method(C): 'Text'
                        sString = MTxtFx_Name.Text;
                        iPar = 2;
                        gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, sString);
                    }
                    Stb.SetStatusBarText("");
                    break;
                case 2:
                    // ステータスメッセージのクリア
                    // OnKenDown
                    // フォーカス移動
                    // フォーカス移動
                    //@ Undeclared identifier(3): 'VK_RETURN'
                    //@ Undeclared identifier(3): 'VK_TAB'
                    //@ Undeclared identifier(3): 'VK_LEFT'
                    //@ Undeclared identifier(3): 'VK_END'
                    //@ Undeclared identifier(3): 'VK_ESCAPE'
                    if (new ArrayList(new object[] {VK_RETURN, VK_TAB, VK_LEFT, VK_END, VK_ESCAPE}).Contains((ushort)pPar1))
                    {
                        //@ Undeclared identifier(3): 'VK_RETURN'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        if (((ushort)pPar1 == VK_RETURN) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new object[] {})))
                        {
                            FxFocusMove(MTxtFx_Name, 1);
                        }
                        //@ Undeclared identifier(3): 'VK_LEFT'
                        //@ Undeclared identifier(3): 'MjsChkCurTop'
                        //@ Undeclared identifier(3): 'VK_TAB'
                        else if ((((ushort)pPar1 == VK_LEFT) && MjsChkCurTop(MTxtFx_Name) && (((pPar2) as Keys) == new object[] {})) || (((ushort)pPar1 == VK_TAB) && (((pPar2) as Keys) == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift})))
                        {
                            FxFocusMove(MTxtFx_Name, 2);
                        }
                        //@ Undeclared identifier(3): 'VK_END'
                        //@ Undeclared identifier(3): 'VK_ESCAPE'
                        else if ((((ushort)pPar1 == VK_END) || ((ushort)pPar1 == VK_ESCAPE)) && (((pPar2) as Keys) == new object[] {}))
                        {
                            FxFocusMove(MTxtFx_Name, 3);
                        }
                    }
                    // ファンクション押下
                    //@ Undeclared identifier(3): 'VK_F1'
                    //@ Undeclared identifier(3): 'VK_F8'
                    if (((ushort)pPar1 >= VK_F1 && (ushort)pPar1<= VK_F8) && (((pPar2) as Keys) == new object[] {}))
                    {
                        // 修正時
                        if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU) && (m_iFxExists == 0))
                        {
                            // if (iSjiNo = 310801) and ( m_iFxExists=0 ) then
                            switch((ushort)pPar1)
                            {
                                // 修正
                                //@ Undeclared identifier(3): 'VK_F2'
                                case VK_F2:
                                    //@ Unsupported property or method(C): 'Text'
                                    sString = MTxtFx_Name.Text;
                                    iPar = 2;
                                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, sString);
                                    //@ Unsupported property or method(C): 'Text'
                                    sString = MTxtFx_RenEnt.Text;
                                    iPar = 3;
                                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, sString);
                                    FxCallDoAction(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEISYUUSEI);
                                    break;
                                // 削除
                                //@ Undeclared identifier(3): 'VK_F3'
                                case VK_F3:
                                    //@ Unsupported property or method(D): 'Text'
                                    //@ Undeclared identifier(3): 'mjQuestion'
                                    //@ Undeclared identifier(3): 'mjYesNo'
                                    //@ Undeclared identifier(3): 'mjDefNo'
                                    mrBtn = VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(EMNumEditFx_No.Text + "番の定型仕訳を削除します。\r\nよろしいですか？", "定型仕訳削除", mjQuestion, mjYesNo, mjDefNo);
                                    if (mrBtn == System.Windows.Forms.DialogResult.Yes)
                                    {
                                        Rt.FxHeadDel();
                                        FxReset(1);
                                        //@ Unsupported property or method(D): 'Value'
                                        EMNumEditFx_No.Value = 0;
                                        //@ Unsupported property or method(D): 'SetFocus'
                                        EMNumEditFx_No.SetFocus;
                                    }
                                    break;
                                // コード変更
                                //@ Undeclared identifier(3): 'VK_F4'
                                case VK_F4:
                                    cQuery = new TMQuery(this);
                                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                                    m_cMDModule.SetDBInfoToQuery(m_FCopDBMas, cQuery);
                                    m_stFlexInfo.pRec = ((m_pRec) as TMjsAppRecord);
                                    m_stFlexInfo.pQuery = cQuery;
                                    m_stFlexInfo.iMode = 1;
                                    m_stFlexInfo.iInpKbn = GetTClass();
                                    // 空きがないのでここを使う
                                    //@ Unsupported property or method(D): 'AsInteger'
                                    m_stFlexInfo.iStNo = EMNumEditFx_No.AsInteger;
                                    m_stFlexInfo.AOwner = this;
                                    // コード変更ダイアログ表示	正しく入力されたときのみ
                                    // コード変更を行う
                                    //@ Unsupported property or method(D): 'AsInteger'
                                    if (MAS310000Dlgu.Units.MAS310000Dlgu.MFlexibleDialog_Call(ref m_stFlexInfo) && (m_stFlexInfo.iStNo != 0) && (m_stFlexInfo.iStNo != EMNumEditFx_No.AsInteger))
                                    {
                                        // 変更前＆変更後を同時に排他獲得する
                                        m_cFixLock.iAction = 0;
                                        iPar = 9;
                                        m_cFixLock.iInpKbn = ((int)gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                                        m_cFixLock.iForm = GetSForm();
                                        m_cFixLock.iClass = GetTClass();
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_cFixLock.iGCodeF = EMNumEditFx_No.AsInteger;
                                        // 変更前
                                        m_cFixLock.iGCodeT = m_stFlexInfo.iStNo;
                                        // 変更後
                                        // 排他獲得	０＝成功
                                        if (Rt.GetFixLock(m_cFixLock) == 0)
                                        {
                                            // コード変更（定型ヘッダの定型ＮＯを書き換えるだけ）０＝成功
                                            if (Rt.FxHeadCodeChange(m_cFixLock.iInpKbn, m_cFixLock.iGCodeF, m_cFixLock.iGCodeT) == 0)
                                            {
                                                // メモリへ情報書き込み
                                                iPar = 1;
                                                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD, iPar, m_cFixLock.iGCodeT);
                                                // 定型ＮＯ欄に変更後ＮＯを入れる
                                                //@ Unsupported property or method(D): 'Value'
                                                EMNumEditFx_No.Value = m_cFixLock.iGCodeT;
                                            }
                                            else
                                            {
                                                //@ Undeclared identifier(3): 'mjError'
                                                //@ Undeclared identifier(3): 'mjOk'
                                                //@ Undeclared identifier(3): 'mjDefOk'
                                                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx((m_stFlexInfo.iStNo).ToString() + "番は登録済みです。", "定型仕訳登録", mjError, mjOk, mjDefOk);
                                            }
                                        }
                                        else
                                        {
                                            //@ Undeclared identifier(3): 'mjError'
                                            //@ Undeclared identifier(3): 'mjOk'
                                            //@ Undeclared identifier(3): 'mjDefOk'
                                            VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("他の端末で使用されています。", "定型仕訳登録", mjError, mjOk, mjDefOk);
                                        }
                                        m_cFixLock.iGCodeT = 0;
                                        // 排他開放する
                                        m_cFixLock.iAction =  -1;
                                        Rt.GetFixLock(m_cFixLock);
                                        //@ Unsupported property or method(D): 'SetFocus'
                                        EMNumEditFx_No.SetFocus;
                                    }
                                    //@ Unsupported property or method(D): 'Free'
                                    cQuery.Free;
                                    break;
                            }
                        }
                    }
                    break;
            }
        }

        // ******************************************************************************
        // Proccess	:   ファンクションセット処理
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   array of String		ファンクションのキャプション文字列
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        protected void SetFuncOnFix(string[] arsFuncCaption)
        {
            int iLoop;
            int iOwner;
            int iPage;
            TMASL310IFunc prFunc;
            // ファンクションセット
            ArrayList cList;
            cList = new ArrayList();
            for (iLoop = 0; iLoop <= 7; iLoop ++ )
            {
                if (arsFuncCaption[iLoop] != "")
                {
                    prFunc = new TMASL310IFunc();
                    prFunc.iOpCode = iLoop + 1;
                    // <HIS-074>
                    prFunc.sCaption = arsFuncCaption[iLoop];
                    prFunc.bEnabled = true;
                    cList.Add(prFunc);
                // ファンクションセット
                }
                else
                {
                    cList.Add(null);
                }
            }
            iPage = 0;
            iOwner = 0;
            // 指示以外は０固定
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_ITEMS, cList, iOwner);
            // ファンクション一括セット（セットのみ）
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_PAGE, iPage);
            // ファンクション頁セット
            cList.Clear();
            //@ Unsupported property or method(C): 'Free'
            cList.Free;
        }

        // ////////////////////////////////////////////////////////////////////
        // ウインドウ表示区分(KbnInfo)より列数を取得
        public int FxWndDsp_GetColCnt()
        {
            int result;
            if (m_FixKbn22 == 1)
            {
                result = 2;
            }
            else
            {
                result = 3;
            }
            return result;
        }

        // ////////////////////////////////////////////////////////////////////
        // ウィンドウに表示する内容をセット
        public int FxWndDsp_SetWRecList(ref TWRecData[] DspRec)
        {
            int result;
            TMQuery pQuery;
            int iRecCnt;
            int iLoop;
            pQuery = new TMQuery();
            // ヘッダ取得
            Rt.GetFxHead(pQuery);
            //@ Unsupported property or method(D): 'RecordCount'
            iRecCnt = pQuery.RecordCount;
            DspRec = new TWRecData[iRecCnt];
            if (iRecCnt > 0)
            {
                //@ Unsupported property or method(B): 'First'
                pQuery.First();
                for (iLoop = 0; iLoop < iRecCnt; iLoop ++ )
                {
                    // (*H0043 20040616 khattori	クリック！*)
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    DspRec[iLoop].Code = (pQuery.GetFld("SwkInpKbn").AsInteger).ToString() + "          " + pQuery.GetFld("GCode").AsString;
                    // DspRec[iLoop].Code := GetFld('GCode').AsString;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    DspRec[iLoop].Name = pQuery.GetFld("LongName").AsString;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    DspRec[iLoop].Ren = pQuery.GetFld("RenChar").AsString;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    if (Rt.m_iHassei != pQuery.GetFld("SwkInpKbn").AsInteger)
                    {
                        DspRec[iLoop].Color = System.Drawing.Color.Blue;
                    }
                    else
                    {
                        DspRec[iLoop].Color = System.Drawing.Color.Black;
                    }
                    //@ Unsupported property or method(A): 'Next'
                    this.Next();
                }
            }
            this.Close();
            //@ Unsupported property or method(A): 'Free'
            this.Free();
            this.Dispose(pQuery);
            result = iRecCnt;
            return result;
        }

        // ******************************************************************************
        // Proccess	:   ウィンドウ表示処理(定型仕訳用 自作)
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   TObject
        // Return		:   Integer			ウィンドウに表示される数
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        protected int FxWndDsp(Object Sender)
        {
            int result;
            TWDspParamTbl rDspParam;
            bool bVal;
            TWRecData[] DspRec;
            TWProperty WProperty;
            ((TWParam)((gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM)))).Sender = ((Sender) as Control);
            gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_ParamSet, gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM));
            rDspParam.DspParam.Filt = false;
            // ﾌｨﾙﾀ区分
            rDspParam.DspParam.Page = 0;
            // 表示ﾍﾟｰｼﾞ
            result = FxWndDsp_SetWRecList(ref DspRec);
            WProperty.AutoSize = true;
            // 行と桁の設定を自動
            WProperty.CodeAlignment = System.Drawing.ContentAlignment.TopCenter;
            // ｺｰﾄﾞのAlignmentの設定
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            WProperty.CodeWidth = 28;
            // ｺｰﾄﾞの幅の設定
            // CodeWidth		:= 42;										//  ｺｰﾄﾞの幅の設定
            WProperty.ColCount = FxWndDsp_GetColCnt();
            // 桁数の設定
            WProperty.ColSize =  -1;
            // 305;									//  桁の幅の設定
            // ColSize			:= 0;//305;									//  桁の幅の設定
            WProperty.RowCount = 5;
            // 行数の設定
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            WProperty.RowSize = 0;
            // 行の高さの設定
            // RowSize			:= 16;										//  行の高さの設定
            gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_PropertySet, WProperty);
            // プロパティのセット
            gMASL310RootWf(VKZ310Cmnu.enWfunc.MASL_WND_Private_Dsp, DspRec, rDspParam);
            // 表示
            bVal = true;
            gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_WND_VSBLE, bVal);
            // 選択ウィンドウパネル表示／非表示

            return result;
        }

        // ******************************************************************************
        // Proccess	:   フリガナのセット
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   TObject
        // Return		:   Integer			ウィンドウに表示される数
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        protected void FxFurigana(string sValue)
        {
            int iSjiNo;
            TMASL310IFunc rFunc;
            rFunc = FxGetFxFunc();
            iSjiNo = rFunc.iOpCode;
            // iSjiNo 	:=	gMASL310RootIf(MASL_IGET_FST_CODE);	//  指示ＮＯ
            // rFunc	:=	Itm.ReadIniRec(iSjiNo);
            // 定型仕訳登録のとき
            if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
            {
                // 連想のデフォルトをセット(定型名称のフリガナ)
                //@ Unsupported property or method(C): 'Text'
                sValue = MTxtFx_RenEnt.Text + sValue;
                //@ Unsupported property or method(C): 'MaxLength'
                if (sValue.Length > MTxtFx_RenEnt.MaxLength)
                {
                    //@ Unsupported property or method(C): 'MaxLength'
                    //@ Unsupported function or procedure: 'SetLength'
                    sValue.Length = MTxtFx_RenEnt.MaxLength;
                }
                //@ Unsupported property or method(C): 'Text'
                MTxtFx_RenEnt.Text = sValue;
            }
        }

        // ---<HIS-020>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  : 連想 ｸﾘｱ
        // Parameter : None
        // Return    : None
        // Comment	  :	ｲﾍﾞﾝﾄを発生させないでｸﾘｱする
        // History	  : <HIS-020>
        // ******************************************************************************
        protected void FxRenClear()
        {
            //@ Unsupported property or method(C): 'OnAssocEvent'
            MTxtFx_Ren.OnAssocEvent = null;
            //@ Unsupported property or method(C): 'OnChange'
            MTxtFx_Ren.OnChange = null;
            try {
                //@ Unsupported property or method(A): 'Clear'
                MTxtFx_Ren.Clear();
            } finally {
                //@ Unsupported property or method(C): 'OnAssocEvent'
                MTxtFx_Ren.OnAssocEvent = FxRenAssocEvent;
                //@ Unsupported property or method(C): 'OnChange'
                MTxtFx_Ren.OnChange = FxChange;
            }
        }

        // ////////////////////////////////////////////////////////////////////
        // 仕訳入力形式の取得
        // 戻り値	仕訳入力形式	(	１：単一仕訳　２：出納帳　３：振替伝票（ミロク）
        // ４：コクヨ型振替伝票　５：入金伝票　６：出金伝票	)
        public int GetSForm()
        {
            int result;
            // １行型
            if (IsBaseMode)
            {
                // 伝票
                result = 1;
            }
            else if (IsSlipMode)
            {
                // 出納帳
                result = Convert.ToInt32(m_pRec.m_sParameter) - 100;
            }
            else
            {
                result = 2;
            }
            return result;
        }

        // 仕訳入力形式の取得
        // ////////////////////////////////////////////////////////////////////
        // 出納帳定型種別の取得
        // 戻り値	出納帳定型種別	(０：単一仕訳　２：現金出納帳　３：預金出納帳　11：売掛帳　12：買掛帳)
        public int GetTClass()
        {
            int result;
            result = 0;
            // 伝票か？
            if (IsSlipMode)
            {
                // 出納帳か？
                result = FxGetFxFunc().iNumb;
            }
            else if (!IsBaseMode)
            {
                result = Convert.ToInt32(m_pRec.m_sParameter);
            }
            // if	((not IsBaseMode)and(not IsSlipMode))	then	Result := StrToInt(m_pRec^.m_sParameter);

            return result;
        }

        // 出納帳定型種別の取得
        // ******************************************************************************
        // Proccess	:   出納帳当該のｾｯﾄ
        // Name		:	T.Yamaguchi
        // Date		:	2001/09/21
        // Parameter	:   Nothing
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        public void FxSetHead()
        {
            string[] sHojoFld = {{"HojCode1", "HojCode2"}, {"CHojCode1", "CHojCode2"}};
            int iPar;
            TMQuery pQuery;
            int iDCKbn;
            int iLoop;
            string sFieldName;
            string sInpCode;
            int iHojoCount;
            TWDspParamTbl rDspParam;
            int iStDate;
            int iEdDate;
            bool bWndSelMode;
            TWParam WndParam;
            TMASL310IFunc rFunc;
            rFunc = FxGetFxFunc();
            // rFunc	:=	Itm.ReadIniRec(Rt.ifnc(MASL_IGET_FST_CODE));
            iHojoCount = 0;
            pQuery = new TMQuery();
            Rt.GetFxDetail(pQuery);
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsInteger'
            iDCKbn = pQuery.GetFld("DCKbn").AsInteger;
            for (iLoop = 0; iLoop <= 3; iLoop ++ )
            {
                sFieldName = "";
                TMASL310HeadOt _wvar1 = ((PMASLHdRd01.PMSiwakexx[iLoop]) as TMASL310HeadOt);
                //@ Unsupported property or method(A): 'Clear'
                _wvar1.EMNumEditCode.Clear();
                // (*H0002 20011025 khattori	ちゃんと消えない*)
                //@ Unsupported property or method(C): 'Value'
                _wvar1.EMNumEditCode.Value = 0;
                //@ Unsupported property or method(C): 'InputFlag'
                _wvar1.EMNumEditCode.InputFlag = true;
                if (iLoop > 0)
                {
                    //@ Unsupported property or method(C): 'Text'
                    _wvar1.EMTxtEditCode.Text = "";
                }
                //@ Unsupported property or method(C): 'Text'
                _wvar1.EMTxtEditName.Text = "";
                _wvar1.iRight = 0;
                //@ Unsupported property or method(C): 'Visible'
                if (PMASLHdRd01.PMSiwakexx[iLoop].Visible == true)
                {
                    switch(_wvar1.sPKind)
                    {
                        case VKZ310Cmnu.TWTableID.wtiKanjoKmk:
                            sFieldName = "KmkCode";
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSaimkKmk:
                            // 勘定科目
                            sFieldName = "SubCode";
                            break;
                        case VKZ310Cmnu.TWTableID.wtiBumon:
                            // 細目科目
                            sFieldName = "BmnCode";
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg1:
                            // 部門
                            sFieldName = "SegCode1";
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg2:
                            // ｾｸﾞﾒﾝﾄ1
                            sFieldName = "SegCode2";
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg3:
                            // ｾｸﾞﾒﾝﾄ2
                            sFieldName = "SegCode3";
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg4:
                            // ｾｸﾞﾒﾝﾄ3
                            sFieldName = "SegCode4";
                            break;
                        case VKZ310Cmnu.TWTableID.wtiGinko:
                        case VKZ310Cmnu.TWTableID.wtiTrhksaki:
                        case VKZ310Cmnu.TWTableID.wtiTkisaki:
                        case VKZ310Cmnu.TWTableID.wtiSirsaki:
                        case VKZ310Cmnu.TWTableID.wtiShain:
                        case VKZ310Cmnu.TWTableID.wtiHanyo1:
                        case VKZ310Cmnu.TWTableID.wtiHanyo2:
                        case VKZ310Cmnu.TWTableID.wtiHanyo3:
                        case VKZ310Cmnu.TWTableID.wtiHanyo4:
                        case VKZ310Cmnu.TWTableID.wtiHanyo5:
                            // ｾｸﾞﾒﾝﾄ4
                            // 銀行
                            // 取引先
                            // 得意先
                            // 仕入先
                            // 社員
                            // 汎用補助1
                            // 汎用補助2
                            // 汎用補助3
                            // 汎用補助4
                            // 汎用補助5
                            if (iHojoCount <= 1)
                            {
                                sFieldName = sHojoFld[0][iHojoCount];
                                iHojoCount ++;
                            }
                            break;
                        case VKZ310Cmnu.TWTableID.wtiKoji:
                            sFieldName = "KojCode";
                            break;
                        case VKZ310Cmnu.TWTableID.wtiKosh:
                            // 工事
                            sFieldName = "KsyCode";
                            break;
                    // 工種
                    }
                    if (sFieldName != "")
                    {
                        if (iDCKbn == 0)
                        {
                            sFieldName = 'D' + sFieldName;
                        }
                        else
                        {
                            sFieldName = 'C' + sFieldName;
                        }
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsString'
                        sInpCode = _wvar1.GetFld(sFieldName).AsString;
                        if (sInpCode != "")
                        {
                            // 科目別補助の省略はー１で書かれている
                            if (((_wvar1.sPKind == VKZ310Cmnu.TWTableID.wtiSaimkKmk) && (sInpCode == "-1")))
                            {
                                // 数値？
                                sInpCode = "";
                            }
                            else if (_wvar1.iPType == 0)
                            {
                                // 前０無し？
                                //@ Unsupported property or method(C): 'FormatStr'
                                if (_wvar1.EMNumEditCode.FormatStr == "")
                                {
                                    // ０？
                                    if (Convert.ToInt64(sInpCode) == 0)
                                    {
                                        sInpCode = '0';
                                    }
                                    else
                                    {
                                        sInpCode = (Convert.ToInt64(sInpCode)).ToString();
                                    }
                                }
                                else
                                {
                                    // 長さ調整
                                    //@ Unsupported property or method(C): 'Digits'
                                    //@ Unsupported property or method(C): 'Digits'
                                    sInpCode = sInpCode.Substring(sInpCode.Length - _wvar1.EMNumEditCode.Digits + 1 - 1 ,_wvar1.EMNumEditCode.Digits);
                                }
                            }
                        }
                        Rt.Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_ParamSet, Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM));
                        rDspParam = _wvar1.SetWndParam(_wvar1.sPKind, false);
                        // ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ設定
                        rDspParam.DspMode = 0;
                        Rt.Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_Dsp, rDspParam);
                        rDspParam.DspMode = 1;
                        // 適用期間指定（指示月の範囲を指定）
                        // 定型仕訳登録のとき
                        if (rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU)
                        {
                            iPar = 4;
                            iStDate = ((int)gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                            iEdDate = ((int)gMASL310RootPf(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                        }
                        else
                        {
                            iStDate = 0;
                            iEdDate = 0;
                        }
                        Rt.Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_SetDate, iStDate, iEdDate);
                        WndParam = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM);
                        bWndSelMode = Rt.Bfnc(VKZ310Cmnu.enBfunc.MASL_BGET_WND_SELMODE);
                        Rt.Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_SearchDataB, sInpCode, bWndSelMode);
                        switch(_wvar1.iPType)
                        {
                            case 0:
                                // ０と空を区別する
                                if ((WndParam.Code == ""))
                                {
                                    //@ Unsupported property or method(A): 'Clear'
                                    _wvar1.EMNumEditCode.Clear();
                                    // (*H0002 20011025 khattori	ちゃんと消えない*)
                                    //@ Unsupported property or method(C): 'Value'
                                    _wvar1.EMNumEditCode.Value = 0;
                                    //@ Unsupported property or method(C): 'InputFlag'
                                    _wvar1.EMNumEditCode.InputFlag = true;
                                }
                                else
                                {
                                    //@ Unsupported property or method(C): 'Value'
                                    _wvar1.EMNumEditCode.Value = Convert.ToInt64(WndParam.Code);
                                    //@ Unsupported property or method(C): 'InputFlag'
                                    _wvar1.EMNumEditCode.InputFlag = false;
                                }
                                break;
                            case 1:
                                //@ Unsupported property or method(C): 'Text'
                                _wvar1.EMTxtEditCode.Text = WndParam.Code;
                                break;
                        }
                        // (*♪♪♪♪*)
                        // 未確定
                        if ((WndParam.Code == ""))
                        {
                            _wvar1.iRight = 1;
                        }
                        //@ Unsupported property or method(C): 'Text'
                        _wvar1.EMTxtEditName.Text = WndParam.Name;
                        WndParam.Code = "";
                        WndParam.Name = "";
                        //@ Unsupported property or method(C): 'BringToFront'
                        _wvar1.EMTxtEditName.BringToFront;
                        if (iLoop == 0)
                        {
                            PMASLHdRd01.KamokuCodeChange();
                        }
                    }
                }
            // if
            // with	TMASL310HeadOt
            }
            // for
            this.Close();
            //@ Unsupported property or method(A): 'Free'
            this.Free();
            // with pQuery^
            this.Dispose(pQuery);
        }

        // (*H0006 20020329 khattori 新規連想パーツ対応*)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxRenKeyDown
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void FxRenAssocEvent(Object Sender, ref string Key)
        {
            if ((Key[Key.Length] < '0') || (Key[Key.Length] > '9'))
            {
                Rt.Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_RenChange, Sender);
            }
        }

        // (*H0028 20021105 khattori	伝票対応*)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // FxGetFxFunc
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public TMASL310IFunc FxGetFxFunc()
        {
            TMASL310IFunc result;
            TMASL310IFunc rFunc;
            // 第１指示取得
            rFunc = Itm.ReadIniRec(gMASL310RootIf(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE));
            // 第１指示取得が定型登録でも定型入力でもない
            if ((rFunc.iMode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU) && (rFunc.iMode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU))
            {
                // 第２指示取得
                rFunc = Itm.ReadIniRec(gMASL310RootIf(VKZ310Cmnu.enIfunc.MASL_IGET_SND_CODE));
            }
            result = rFunc;
            return result;
        }

        // (* Public 宣言 *)
        // __MASL310SYSOPTIONB_INC__
        // ------------------------------------------------------------------<HIS-002>---
        // //******************************************************************************
        // //	Proccess	:	AppEntry
        // //	Name		:	K.Hattori(MJS)
        // //	Date		:	2000/12/08
        // //	Parameter	:	pPar
        // //	Return		:	Integer
        // //******************************************************************************
        // function AppEntry(pPar: Pointer) : Integer;
        // var
        // pFrm		:	^TMAS310000f;
        // pRec		:	^TMjsAppRecord;
        // (*H0004	20010531 khattori Ｃａｐｔｉｏｎの出し方変更*)
        // Exparam		:	TAppParam;
        // begin
        // result	:= ACTID_RET_OK;
        // pRec	:= Pointer( TAppParam( pPar^ ).pRecord );
        // case TAppParam( pPar^ ).iAction of
        // //	Form Create要求
        // ACTID_FORMCREATESTART		:
        // begin
        // new( pFrm );
        // try
        // pFrm^ := TMAS310000f.CreateForm( pPar );
        // pRec^.m_pChildForm := pFrm;
        // except
        // Dispose( pFrm );
        // result := ACTID_RET_NG;
        // end;
        // end;
        // //	Form Create&Show要求
        // ACTID_FORMCREATESHOWSTART	:
        // begin
        // new( pFrm );
        // try
        // pFrm^ := TMAS310000f.CreateForm( pPar );
        // pFrm^.Show();
        // pRec^.m_pChildForm := pFrm;
        // except
        // Dispose( pFrm );
        // result := ACTID_RET_NG;
        // end;
        // end;
        // //	Form Close要求
        // ACTID_FORMCLOSESTART		:
        // begin
        // pFrm := Pointer( pRec^.m_pChildForm );
        // if	pRec^.m_iDelete<>1
        // then
        // begin
        // (*H0021 20010928 khattori	更新確認のＣａｎｃｅｌボタン*)
        // result := ACTID_RET_NG;
        // if	pFrm^.EscKeyKeyDown(pFrm^,VK_F4+VK_MENU)=mrCancel	then	exit;
        // //				pFrm^.Close();
        // pFrm^.Free();
        // result	:= ACTID_RET_OK;
        // end;
        // Dispose( pFrm );
        // end;
        // //	Form CanClose要求
        // ACTID_FORMCANCLOSESTART		:
        // begin
        // pFrm	:=	Pointer(pRec^.m_pChildForm);
        // if pFrm^.CloseQuery() = False then
        // result := ACTID_RET_NG;
        // end;
        // //	Show要求
        // ACTID_SHOWSTART				:
        // begin
        // pFrm	:=	Pointer(pRec^.m_pChildForm);
        // pFrm^.Show();
        // end;
        // //	Hide要求
        // ACTID_HIDESTART				:
        // begin
        // pFrm	:=	Pointer(pRec^.m_pChildForm);
        // if pFrm^.Parent <> nil then	pFrm^.Hide();
        // end;
        // //	Form Close通知
        // ACTID_FORMCLOSEEND			:
        // begin
        // //	処理ﾘｽﾄから削除（UnLoadはしない）
        // result := ACTID_RET_OK;
        // end;
        // (*H0004	20010531 khattori Ｃａｐｔｉｏｎの出し方変更*)
        // //	キャプション変更要求 ( AP -> Menu -> Desktop )
        // ACTID_ACTIVEEND:								// 子ﾌｫｰﾑのｱｸﾃｨﾌﾞ通知
        // begin
        // pFrm := Pointer(pRec^.m_pOwnerForm);		// 子供から発行される為親が自分になる
        // //---<HIS-056> 指示の Activate も実行する---------------------------------------
        // if Assigned(pFrm^.OnActivate) then pFrm^.OnActivate(pFrm^);
        // //------------------------------------------------------------------<HIS-056>---
        // Exparam.iAction := ACTID_FREESTART;
        // Exparam.pRecord := pointer( pFrm^.m_pRec );
        // Exparam.pActionParam := pointer( pRec );
        // TMjsAppRecord(pFrm^.m_pRec^).m_pOwnerEntry( @Exparam );				// 親を呼び出す!!
        // pRec^.m_pOwnerForm:=TMjsAppRecord(pFrm^.m_pRec^).m_pOwnerForm;
        // TMjsAppRecord(pFrm^.m_pRec^).m_pOwnerEntry(pPar);				// 親を呼び出す!!
        // pRec^.m_pOwnerForm:=TMjsAppRecord(pFrm^.m_pRec^).m_pChildForm;
        // //	20010209
        // if Assigned( TAppParam( pPar^ ).pActionParam ) then
        // pFrm^.Caption   := String(TAppParam( pPar^ ).pActionParam^);
        // end;
        // (*H0048 20050516 khattori	操作ガイド番号通知*)
        // //	ＡＬUのみ動作
        // {$IFDEF _WANTYPE_NEW_}
        // ACTID_HELPINDEXSET:
        // begin
        // // 子供から発行される為親が自分になる
        // pFrm			:=	Pointer(pRec^.m_pOwnerForm);
        // Exparam			:=	TAppParam( pPar^ );
        // Exparam.pRecord	:=	Pointer(pFrm^.m_pRec);
        // // メニューを呼び出す!!
        // TMjsAppRecord(pFrm^.m_pRec^).m_pOwnerEntry( @Exparam );
        // end;
        // {$ENDIF}
        // end;
        // end;
        // ******************************************************************************
        // Proccess	:	CreateForm (constructor)
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	pPar : Pointer
        // Return		:	Nothing
        // ******************************************************************************
        //Constructor  CreateForm( pPar)
        public TMAS310000f(object pPar) : base(Application)
        {
            // (*H0002	20010511 khattori 月固定／月可変切替のデフォルト*)
            TMQuery DmqMas;
            TMjsMsgRec infoRec;
            // ---<HIS-044><HIS-045>---------------------------------------------------------
            int iTanNCode;
            int iTanGCode;
            string sBunTable;
            // //	テーブル操作クラス
            // cTCtlIF			:	TMASL311Trn_TblCtrlIF;
            // cTCtlInitParam	:	TMASL311Trn_TblCtrl_InitParam;
            // cCorpDB			:	TDatabase;
            // ---------------------------------------------------------<HIS-044><HIS-045>---
            // //////////////////////////////////////////////////////////////////////////////
            // TMjsAppRecord	bpl 管理構造体
            // メンバ			型		内容				備考
            // m_iGroupCode	Integer	グループコード
            // m_iSystemCode	Integer	システムコード
            // m_iOptionCode	Integer	オプションコード
            // m_iProgramCode	Integer	プログラムコード
            // m_iCorpCode		Integer	会社コード
            // m_iCorpSubCode	Integer	本支店コード
            // m_iCorpID		Integer	会社DB ID			COPDBOpen時のﾊﾟﾗﾒｰﾀで使用。
            // //////////////////////////////////////////////////////////////////////////////
            // (*H0010 20010712 khattori やばすぎ２！！！*)
            m_bTerm = false;
            m_pRec = (((pPar) as TAppParam).pRecord as object);
            if (m_pRec.m_pDBModule == null)
            {
                m_cMDModule = null;
            }
            else
            {
                //@ Undeclared identifier(3): 'TMDataModulef'
                m_cMDModule = TMDataModulef(m_pRec.m_pDBModule);
            }
            g_pDrill = (((pPar) as TAppParam).pActionParam as object);
            // (*Ver.x*)
            // (*H0025	20011217 khattori	マルチ入力*)
            // (*H0019 20010927 khattori	定型仕訳ＦＡＳ対応*)
            g_miSystemCode = m_pRec.m_iSystemCode;
            // (*Ver.x*)
            // (*H0024	20011217 khattori	手形入力*)
            g_miOptionCode = m_pRec.m_iOptionCode;
            // ---<HIS-002>------------------------------------------------------------------
            m_cSubUse = new TMASL310SubPrgUse(m_pRec);
            // ------------------------------------------------------------------<HIS-002>---
            // ////////////////////////////////////////////////////////////////
            // (*H0001	20010409	khattori	処理月による排他*)
            m_iClose = 0;
            m_iExclusive = 0;
            // (*♪♪♪*)
            // (*Ver.x*)
            // (*H0024	20011217 khattori	手形入力*)
            if (!Is_FASMODE())
            {
                // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
                m_cExcept = null;
                m_iRet = Units.MAS310000u.EXCEPT_RET_OK;
                m_nReferMode = 0;
                // (*H0038 20030904 khattori	分散入力<単一入力>*)
                m_iPMPanelDev = 0;
                // 分散は対象外
                if (!IsBunsanMode)
                {
                    fnExceptCheck();
                }
                // 処理不能なら、例外を投げる
                if (m_nReferMode < 0)
                {
                    throw new Exception("");
                }
                // ---<HIS-044><HIS-045>---------------------------------------------------------
                // 分散排他
                if (IsBunsanMode)
                {
                // iTanNCode	:=	rcCOMMONAREA( m_pRec^.m_pCommonArea^ ).TantoNCD;
                // iTanGCode	:=	rcCOMMONAREA( m_pRec^.m_pCommonArea^ ).TantoGCD;
                // if	iTanGCode=-1	then	iTanGCode:=0;
                // cCorpDB	:=	m_cMDModule.COPDBOpen( 0, m_pRec^.m_iCorpID );
                // m_BunKbn01 := 0;
                // DmqMas:=TMQuery.Create(self);
                // m_cMDModule.SetDBInfoToQuery(cCorpDB,DmqMas);
                // with	DmqMas	do
                // begin
                // //	分散入力採用区分
                // Close;
                // SQL.Clear;
                // SQL.Add('select GnPuKbn1 from KbnInfo where reckbn=8');
                // if	Open	then
                // m_BunKbn01 := GetFld('GnPuKbn1').AsInteger;
                // Close;
                // Free;
                // end;
                // if	m_BunKbn01=0	then
                // begin
                // m_iClose:=1;
                // m_cMDModule.COPDBClose( cCorpDB );
                // end
                // else
                // begin
                // cTCtlIF	:=	TMASL311Trn_TblCtrlIF.Create();
                // //	分散テーブル作成
                // cTCtlInitParam.pMjsAppRecord	:=	Pointer(m_pRec);
                // cTCtlInitParam.CopDB			:=	cCorpDB;
                // cTCtlIF.Init(cTCtlInitParam );
                // cTCtlIF.CreateTable(1,iTanGCode,iTanNCode);
                // cTCtlIF.Free;
                // m_cMDModule.COPDBClose( cCorpDB );
                // sBunTable	:=	'BUN'+Format( '%0.8d', [iTanGCode] );
                // //	分散排他
                // m_cSwkExc	:=	TMAS310000SwkExcBun.Create();
                // m_iClose	:=	m_cSwkExc.Init(m_pRec, sBunTable);
                // if	m_iClose<>0	then	m_iExclusive:=	6	//	'排他制御エラーが発生しました。(Init)'
                // else
                // begin
                // m_iClose	:=	m_cSwkExc.InitExc();
                // if		m_iClose=1	then	m_iExclusive:=	12	//	'排他用テーブルがありません。分散仕訳データチェックを実行してください。'
                // else if	m_iClose=-1	then	m_iExclusive:=	10	//	'前回正常終了していません。分散仕訳データチェックを実行してください。'
                // else if	m_iClose<>0	then	m_iExclusive:=	6;	//	'排他制御エラーが発生しました。(InitExc)';
                // end;
                // end;
                // 仕訳排他
                }
                else
                {
                    m_cSwkExc = new TMAS310000SwkExc();
                    m_iClose = m_cSwkExc.Init(m_pRec, "");
                    if (m_iClose != 0)
                    {
                        // '排他制御エラーが発生しました。(Init)'
                        m_iExclusive = 6;
                    }
                    else
                    {
                        m_iClose = m_cSwkExc.InitExc();
                        if (m_iClose ==  -1)
                        {
                            // '前回正常終了していません。マスタ再計算を実行してください。'
                            m_iExclusive = 7;
                        }
                        else if (m_iClose != 0)
                        {
                            m_iExclusive = 6;
                        }
                    // '排他制御エラーが発生しました。(InitExc)';
                    }
                }
                // m_cMASSwkExc:=TMASSwkExc.Create;
                // m_iClose	:=	m_cMASSwkExc.Init(m_pRec);
                // if	m_iClose<>0	then	m_iExclusive:=	6	//	'排他制御エラーが発生しました。(Init)'
                // else
                // begin
                // m_iClose	:=	m_cMASSwkExc.InitExc;
                // if		m_iClose=-1	then	m_iExclusive:=	7	//	'前回正常終了していません。マスタ再計算を実行してください。'
                // else if	m_iClose<>0	then	m_iExclusive:=	6;	//	'排他制御エラーが発生しました。(InitExc)';
                // end;
                // ---------------------------------------------------------<HIS-044><HIS-045>---
                if (m_iExclusive != 0)
                {
                    // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
                    fnExceptTerm();
                    // 財務排他終了処理
                    //@ Unsupported property or method(D): 'm_pSystemArea'
                    //@ Undeclared identifier(3): 'TMASCom'
                    //@ Unsupported property or method(D): 'm_MsgStd'
                    //@ Unsupported property or method(B): 'GetMSG'
                    TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(infoRec, 20, m_iExclusive);
                    // ---<HIS-062> @_@ → 分散仕訳データチェック に変換-----------------------------
                    if (new ArrayList(new int[] {10, 12}).Contains(m_iExclusive))
                    {
                        //@ Unsupported property or method(D): 'm_pSystemArea'
                        //@ Undeclared identifier(3): 'TMASCom'
                        //@ Unsupported property or method(D): 'sMsg'
                        //@ Unsupported property or method(D): 'm_MsgStd'
                        //@ Unsupported property or method(B): 'MsgChange'
                        //@ Unsupported property or method(D): 'sMsg'
                        infoRec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(infoRec.sMsg, "@_@", "分散仕訳データチェック");
                    }
                    // ------------------------------------------------------------------<HIS-062>---
                    //@ Unsupported property or method(D): 'sMsg'
                    //@ Unsupported property or method(D): 'sTitle'
                    //@ Unsupported property or method(D): 'icontype'
                    //@ Unsupported property or method(D): 'btntype'
                    //@ Unsupported property or method(D): 'btndef'
                    //@ Unsupported property or method(D): 'LogType'
                    VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(infoRec.sMsg, infoRec.sTitle, infoRec.icontype, infoRec.btntype, infoRec.btndef, infoRec.LogType);
                    throw new Exception("");
                }
            // (*♪♪♪*)
            }
            m_bfirst = true;
            // ////////////////////////////////////////////////////////////////
            // (*♪♪♪*)
            // (*Ver.x*)
            // (*H0024	20011217 khattori	手形入力*)
            if (!Is_FASMODE())
            {
                // (*H0002	20010511 khattori 月固定／月可変切替のデフォルト*)
                // from ->
                //@ Unsupported property or method(D): 'm_pSystemArea'
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_iMasCommonNo'
                //@ Unsupported property or method(A): 'COPDBOpen'
                m_FCopDBMas = m_cMDModule.COPDBOpen(0, TMASCom(m_pRec.m_pSystemArea).m_iMasCommonNo);
                if (m_FCopDBMas == null)
                {
                    // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
                    fnExceptTerm();
                    // 財務排他終了処理
                    //@ Unsupported property or method(D): 'm_pSystemArea'
                    //@ Undeclared identifier(3): 'TMASCom'
                    //@ Unsupported property or method(C): 'GetStatus'
                    //@ Unsupported property or method(D): 'm_MsgStd'
                    //@ Unsupported property or method(B): 'GetMsg'
                    TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMsg(infoRec, 10000, m_cMDModule.GetStatus);
                    //@ Unsupported property or method(D): 'sMsg'
                    //@ Unsupported property or method(D): 'sTitle'
                    //@ Unsupported property or method(D): 'icontype'
                    //@ Unsupported property or method(D): 'btntype'
                    //@ Unsupported property or method(D): 'btndef'
                    //@ Unsupported property or method(D): 'LogType'
                    VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(infoRec.sMsg, infoRec.sTitle, infoRec.icontype, infoRec.btntype, infoRec.btndef, infoRec.LogType);
                    // ---<HIS-044><HIS-050>---------------------------------------------------------
                    if ((m_cSwkExc != null))
                    {
                        m_cSwkExc.TermExc();
                        m_cSwkExc.Term();
                        m_cSwkExc = null;
                    // インスタンス破棄(nil セットにより内部で破棄される)
                    }
                    // ---------------------------------------------------------<HIS-044><HIS-050>---
                    throw new Exception("");
                }
                else
                {
                    // (*Ver A121 M101*)
                    // (*H0026 20020301 khattori	ＣＲ、００、０００　キー*)
                    m_bCRKey = false;
                    m_iCRKey = 0;
                    m_i00Key = 0;
                    m_i000Key = 0;
                    // ---<HIS-060>------------------------------------------------------------------
                    m_iCodeAssoc = 0;
                    // ------------------------------------------------------------------<HIS-060>---
                    m_iTukiDefault = 0;
                    DmqMas = new TMQuery(this);
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FCopDBMas, DmqMas);
                    // 仕訳入力 月指定区分	0:月固定 1:月可変
                    this.Close();
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'BeginUpdate'
                    DmqMas.SQL.BeginUpdate();
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    DmqMas.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add("select * from UserInfo");
                    // ---<HIS-060>------------------------------------------------------------------
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add("where StaffCode=-1 and");
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add('(');
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add("ItemNo=21");
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add("or ItemNo=23");
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add("or ItemNo=24");
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add("or ItemNo=25");
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add("or ItemNo=53");
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add(')');
                    // SQL.Add('where ((ItemNo=21) or (ItemNo=23) or (ItemNo=24) or (ItemNo=25)) and (StaffCode=-1)');
                    // ------------------------------------------------------------------<HIS-060>---
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'EndUpdate'
                    DmqMas.SQL.EndUpdate();
                    //@ Unsupported property or method(D): 'Open'
                    DmqMas.Open;
                    //@ Unsupported function or procedure: 'eof'
                    while (!eof)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        switch(DmqMas.GetFld("ItemNo").AsInteger)
                        {
                            case 21:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                m_iTukiDefault = DmqMas.GetFld("UserKbn").AsInteger;
                                break;
                            case 23:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                m_iCRKey = DmqMas.GetFld("UserKbn").AsInteger;
                                break;
                            case 24:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                m_i00Key = DmqMas.GetFld("UserKbn").AsInteger;
                                break;
                            case 25:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                m_i000Key = DmqMas.GetFld("UserKbn").AsInteger;
                                break;
                            case 53:
                                // ---<HIS-060>------------------------------------------------------------------
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                m_iCodeAssoc = DmqMas.GetFld("UserKbn").AsInteger;
                                break;
                        // ------------------------------------------------------------------<HIS-060>---
                        }
                        //@ Unsupported property or method(C): 'Next'
                        this.Next;
                    }
                    if (m_iCRKey == 0)
                    {
                        m_iCRKey = (int)('+');
                    }
                    this.Close();
                    //@ Unsupported property or method(C): 'Free'
                    this.Free;
                    //@ Unsupported property or method(A): 'COPDBClose'
                    m_cMDModule.COPDBClose(m_FCopDBMas);
                }
            // (*H0002	20010511 khattori 月固定／月可変切替のデフォルト*)
            // -> to
            // (*♪♪♪*)
            }
            // (*H0003	20010511 khattori ＤＢのオープンに失敗した時の処理*)
            // from ->
            // チェックのみ
            //@ Unsupported property or method(D): 'm_iCorpID'
            //@ Unsupported property or method(A): 'COPDBOpen'
            m_FCopDBMas = m_cMDModule.COPDBOpen(0, m_pRec.m_iCorpID);
            if (m_FCopDBMas == null)
            {
                // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
                fnExceptTerm();
                // 財務排他終了処理
                //@ Unsupported property or method(D): 'm_pSystemArea'
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(C): 'GetStatus'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMsg'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMsg(infoRec, 10000, m_cMDModule.GetStatus);
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                //@ Unsupported property or method(D): 'LogType'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(infoRec.sMsg, infoRec.sTitle, infoRec.icontype, infoRec.btntype, infoRec.btndef, infoRec.LogType);
                // ---<HIS-044><HIS-050>---------------------------------------------------------
                if ((m_cSwkExc != null))
                {
                    m_cSwkExc.TermExc();
                    m_cSwkExc.Term();
                    m_cSwkExc = null;
                // インスタンス破棄(nil セットにより内部で破棄される)
                }
                // ---------------------------------------------------------<HIS-044><HIS-050>---
                throw new Exception("");
            }
            else
            {
                // ＦＡＳから呼ばれた時は、定型仕訳が採用されていなければ動作不可
                // (*Ver.x*)
                // (*H0024	20011217 khattori	手形入力*)
                if (Is_FASMODE())
                {
                    DmqMas = new TMQuery(this);
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FCopDBMas, DmqMas);
                    // 仕訳入力 月指定区分	0:月固定 1:月可変
                    this.Close();
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    DmqMas.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    DmqMas.SQL.Add("select * from KbnInfo where reckbn=2");
                    //@ Unsupported property or method(D): 'Open'
                    DmqMas.Open;
                    // (*H0023 20011024 khattori	初期値変更*)
                    //@ Unsupported property or method(D): 'm_sParameter'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    //@ Unsupported property or method(D): 'm_sParameter'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    if (((m_pRec.m_sParameter == "") && (DmqMas.GetFld("GnPuKbn20").AsInteger == 0)) || ((m_pRec.m_sParameter != "") && (DmqMas.GetFld("GnPuKbn21").AsInteger == 0)))
                    {
                        // if	((m_pRec^.m_sParameter = '')	and	(GetFld('GnPuKbn20').AsInteger=1))	or
                        // ((m_pRec^.m_sParameter <>'')	and	(GetFld('GnPuKbn21').AsInteger=1))	then
                        this.Close();
                        //@ Unsupported property or method(C): 'Free'
                        this.Free;
                        //@ Unsupported property or method(A): 'COPDBClose'
                        m_cMDModule.COPDBClose(m_FCopDBMas);
                        //@ Unsupported property or method(D): 'm_pSystemArea'
                        //@ Unsupported property or method(B): 'TMASCom'
                        //@ Unsupported property or method(C): 'GetStatus'
                        //@ Unsupported property or method(D): 'm_MsgStd'
                        //@ Unsupported property or method(B): 'GetMsg'
                        DmqMas.TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMsg(infoRec, 10000, m_cMDModule.GetStatus);
                        //@ Unsupported property or method(D): 'sMsg'
                        infoRec.sMsg = "定型仕訳が採用されていません。";
                        //@ Unsupported property or method(D): 'sMsg'
                        //@ Unsupported property or method(D): 'sTitle'
                        //@ Unsupported property or method(D): 'icontype'
                        //@ Unsupported property or method(D): 'btntype'
                        //@ Unsupported property or method(D): 'btndef'
                        //@ Unsupported property or method(D): 'LogType'
                        VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(infoRec.sMsg, infoRec.sTitle, infoRec.icontype, infoRec.btntype, infoRec.btndef, infoRec.LogType);
                        throw new Exception("");
                    }
                    this.Close();
                    //@ Unsupported property or method(C): 'Free'
                    this.Free;
                }
            }
            // (*H0003	20010511 khattori ＤＢのオープンに失敗した時の処理*)
            // -> to

        }
        // ******************************************************************************
        // Proccess	:	Form処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	:	FormCreate (OnCreate)
        // ******************************************************************************
        public void FormCreate(System.Object Sender, System.EventArgs _e1)
        {
            int iSlipCount;
            int iWork;
            // (*Ver A123 M102*)
            // (*H0029 20020328 khattori	第１指示のＣａｐｔｉｏｎ切替*)
            object[] arPointer = new object[50 + 1];
            // arPointer		:	Array [0..30] of Pointer;
            int[] iAnalyzeCode;
            enTblList tlTblList;
            object pQuery;
            int iSijiCode;
            // inforec			:	TMjsMsgRec;
            //@ Unsupported property or method(D): 'm_pOwnerPanel'
            if (m_pRec.m_pOwnerPanel == null)
            {
                //@ Unsupported property or method(D): 'm_pOwnerForm'
                this.Parent = ((m_pRec.m_pOwnerForm) as Form);
            }
            else
            {
                //@ Unsupported property or method(D): 'm_pOwnerPanel'
                this.Parent = ((m_pRec.m_pOwnerPanel) as Panel);
            }
            // ---<HIS-028> OnShow へ移動----------------------------------------------------
            this.Dock = System.Windows.Forms.DockStyle.None;
            // Align := alClient;
            // ------------------------------------------------------------------<HIS-028>---
            // 10/24 New
            //@ Unsupported property or method(D): 'm_pSystemArea'
            //@ Undeclared identifier(3): 'TMASCom'
            //@ Unsupported property or method(D): 'SystemArea'
            //@ Unsupported property or method(D): 'SysColorB'
            //@ Unsupported property or method(D): 'm_pSystemArea'
            //@ Undeclared identifier(3): 'TMASCom'
            //@ Unsupported property or method(D): 'SystemArea'
            //@ Unsupported property or method(D): 'SysColorD'
            //@ Unsupported property or method(D): 'm_pSystemArea'
            //@ Undeclared identifier(3): 'TMASCom'
            //@ Unsupported property or method(D): 'SystemArea'
            //@ Unsupported property or method(D): 'SysBaseColorB'
            //@ Unsupported property or method(D): 'm_pSystemArea'
            //@ Undeclared identifier(3): 'TMASCom'
            //@ Unsupported property or method(D): 'SystemArea'
            //@ Unsupported property or method(D): 'SysBaseColorD'
            //@ Unsupported property or method(D): 'm_pCommonArea'
            //@ Undeclared identifier(3): 'MjsColorChange'
            MjsColorChange(((this) as TMAS310000f), TMASCom(m_pRec.m_pSystemArea).SystemArea.SysColorB, TMASCom(m_pRec.m_pSystemArea).SystemArea.SysColorD, TMASCom(m_pRec.m_pSystemArea).SystemArea.SysBaseColorB, TMASCom(m_pRec.m_pSystemArea).SystemArea.SysBaseColorD, ((m_pRec.m_pCommonArea) as rcCOMMONAREA).SysFocusColor);
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            // // 10/25New
            // MjsFontResize(	TMAS310000f( Self )	,Pointer(m_pRec)	);
            // (*H0008 20010703 khattori プレビュー中に裏画面にされた時！*)
            MJSPreIf = new TMjsPreviewIF();
            //@ Unsupported property or method(D): 'm_pCommonArea'
            //@ Unsupported property or method(C): 'Color'
            MTxtFx_Ren.Color = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).SysFocusColor;
            // 選択ウィンドウ操作クラス生成
            SelWnd = new TMAS310SelWndDB(PMPanelWd);
            //@ Unsupported property or method(C): 'Parent'
            SelWnd.Parent = PMPanelWd;
            //@ Unsupported property or method(C): 'Top'
            SelWnd.Top = 0;
            //@ Unsupported property or method(C): 'Left'
            SelWnd.Left = 5;
            // SelWnd.Init(m_pRec);
            // ---<HIS-001>------------------------------------------------------------------
            // サブプログラム呼び出しボタン
            SubPrg = new TSubPrgBtn(this);
            SubPrg.Parent = PMPanelHdTop;
            // ---<HIS-015>------------------------------------------------------------------
            SubPrg.Anchor = new System.Windows.Forms.AnchorStyles[] {System.Windows.Forms.AnchorStyles.Top, System.Windows.Forms.AnchorStyles.Right};
            // ------------------------------------------------------------------<HIS-015>---
            // ---<HIS-029><HIS-008><HIS-005>------------------------------------------------
            //@ Undeclared identifier(3): 'GetZoomRatio'
            SubPrg.Left = 464 * GetZoomRatio((m_pRec as object)) / 100;
            //@ Undeclared identifier(3): 'GetZoomRatio'
            SubPrg.Top = 2 * GetZoomRatio((m_pRec as object)) / 100;
            SubPrg.Visible = true;
            // ------------------------------------------------<HIS-029><HIS-008><HIS-005>---
            SubPrg.OnItemClick = SubMenuClick;
            // ------------------------------------------------------------------<HIS-001>---
            Itm = new TMASL310Item();
            // 指示項目操作クラス生成
            Stb = new TMASL310StatusBar(MStatusBar);
            // ステータスバー操作クラス生成
            Fnc = new TMASL310Func(MSPFunctionBar);
            // ファンクション操作クラス生成
            Ind = new TMASL310Ind();
            // 指示項目操作クラス生成
            Sm = new TMASL310SelMonth();
            // 処理月操作クラス生成
            // 出納帳入力（単一入力以外）
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            if (IsSuitouMode)
            {
                // if	(m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU	)	and
                // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR	)	and
                // (not IsSlipMode									)		then
                // ヘッダー項目入力パネル作成
                //@ Unsupported property or method(C): 'Width'
                PMPanelHdSj.Width = 167;
                //@ Unsupported property or method(D): 'm_pCommonArea'
                //@ Unsupported property or method(D): 'm_pSystemArea'
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'SystemArea'
                //@ Unsupported property or method(D): 'SysColorD'
                PMASLHdRd01 = new TMASL310HeadAc(PMPanelHdRd, PMASLHdRd02, PMASLHdRd03, PMASLHdRd04, 0, Units.MAS310000u.HDRD0X_WIDTH, Units.MAS310000u.HDRD0X_LABEL_WIDTH, ((m_pRec.m_pCommonArea) as rcCOMMONAREA).SysFocusColor, TMASCom(m_pRec.m_pSystemArea).SystemArea.SysColorD);
                //@ Unsupported property or method(D): 'Visible'
                PMPanelHdRd.Visible = true;
                //@ Unsupported property or method(C): 'Enabled'
                PMPanelHdMonthFix.Enabled = false;
                // 月固定のみ
                //@ Unsupported property or method(C): 'Visible'
                EMNumEditBalance.Visible = false;
                // ---<HIS-060>------------------------------------------------------------------
                PMASLHdRd01.m_pCodeAssoc = m_iCodeAssoc;
            // ------------------------------------------------------------------<HIS-060>---
            }
            // 日常処理共通関数クラス生成
            arPointer[0] = this;
            arPointer[1] = PMPanelHd;
            arPointer[2] = PMPanelWd;
            arPointer[3] = PMPanelAp;
            arPointer[4] = PMComboBox2;
            arPointer[5] = PMComboBox3;
            arPointer[6] = PMComboBox4;
            arPointer[7] = EMNumEditInp;
            arPointer[8] = EMNumEditBalance;
            arPointer[9] = PMASLHdRd01;
            arPointer[10] = PMASLHdRd02;
            arPointer[11] = PMASLHdRd03;
            arPointer[12] = PMASLHdRd04;
            arPointer[13] = Sm;
            arPointer[14] = Itm;
            arPointer[15] = Fnc;
            arPointer[16] = Ind;
            arPointer[17] = Stb;
            arPointer[18] = rParam;
            arPointer[19] = SelWnd;
            arPointer[20] = m_cMDModule;
            arPointer[21] = m_pRec;
            arPointer[22] = LMLabelSelMonthVF;
            arPointer[23] = LMLabelSelMonthVN;
            arPointer[24] = PMPanelSelMonth;
            arPointer[25] = LMLabelHd2;
            // ---<HIS-044>------------------------------------------------------------------
            arPointer[26] = m_cSwkExc;
            // ------------------------------------------------------------------<HIS-044>---
            arPointer[27] = TMBtnFusen;
            arPointer[28] = TMBtnOpen;
            // (*H0047 20050418 khattori	一括置換*)
            arPointer[29] = TMBtnLump;
            arPointer[30] = EMNumEditFx_No;
            // (*Ver A123 M102*)
            // (*H0029 20020328 khattori	第１指示のＣａｐｔｉｏｎ切替*)
            arPointer[31] = PMPanelHdSjFst;
            Rt = new TMASL310Root(arPointer);
            Rt.BplList = new ArrayList();
            // (*H0022 20011009 khattori	Ｒｏｏｔ初期処理追加*)
            Rt.Init();
            // (*H0013 20010731 tyamaguchi 入力不可区分、修正／削除区分対応*)
            // (*H0017 20010925 khattori	定型仕訳対応*)
            m_FixKbn16 = 0;
            m_FixKbn20 = 0;
            m_FixKbn21 = 0;
            m_FixKbn22 = 0;
            m_FixKbn23 = 0;
            m_FixKbn29 = 0;
            // ---<HIS-045> 削除 排他テーブル作成前へ移動------------------------------------
            // (*H0034 20030611 khattori	分散入力*)
            // m_BunKbn01	:=	0;			//  分散入力採用区分
            // ------------------------------------------------------------------<HIS-045>---
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
            pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
            if (pQuery != null)
            {
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'Locate'
                if ((TMQuery(pQuery).Locate("RecKbn", 2, new object[] {})) == true)
                {
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_FixKbn16 = TMQuery(pQuery).GetFld("GnPuKbn16").AsInteger;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_FixKbn20 = TMQuery(pQuery).GetFld("GnPuKbn20").AsInteger;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_FixKbn21 = TMQuery(pQuery).GetFld("GnPuKbn21").AsInteger;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_FixKbn22 = TMQuery(pQuery).GetFld("GnPuKbn22").AsInteger;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_FixKbn23 = TMQuery(pQuery).GetFld("GnPuKbn23").AsInteger;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_FixKbn29 = TMQuery(pQuery).GetFld("GnPuKbn29").AsInteger;
                }
            // ---<HIS-045> 削除 排他テーブル作成前へ移動------------------------------------
            // (*H0034 20030611 khattori	分散入力*)
            // if	(TMQuery(pQuery^).Locate('RecKbn',8,[]))=true	then
            // begin
            // m_BunKbn01	:= TMQuery(pQuery^).GetFld('GnPuKbn1').AsInteger;	//  分散入力採用区分
            // end;
            // ------------------------------------------------------------------<HIS-045>---
            }
            // 出納帳入力（単一入力以外）
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            if (IsSuitouMode)
            {
                // if	(m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU	)	and
                // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR	)	and
                // (not IsSlipMode									)		then
                iAnalyzeCode = new int[0];
                tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_CashPara;
                pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                if (pQuery != null)
                {
                    //@ Undeclared identifier(3): 'TMQuery'
                     _wvar1 = TMQuery(pQuery);
                    //@ Unsupported function or procedure: 'eof'
                    while (!eof)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        if (_wvar1.GetFld("ParaKbn").AsInteger == 11)
                        {
                            iAnalyzeCode = new int[iAnalyzeCode.Length + 1];
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            iAnalyzeCode[iAnalyzeCode.Length - 1] = _wvar1.GetFld("AnalyzeCode").AsInteger;
                        }
                        //@ Unsupported property or method(C): 'Next'
                        this.Next;
                    }
                }
                // (*H0015 20010921 tyamaguchi 定型仕訳対応*)
                // (*Ver.x*)
                // (*H0024	20011217 khattori	手形入力*)
                if (Is_FASMODE())
                {
                    PMASLHdRd01.SetBrother(Rt, EMNumEditFx_No, EMNumEditFx_No, PMComboBox3, iAnalyzeCode);
                }
                //@ Unsupported property or method(C): 'Visible'
                else if (PMPanelHdFx.Visible)
                {
                    PMASLHdRd01.SetBrother(Rt, PMComboBox3, EMNumEditFx_No, PMComboBox3, iAnalyzeCode);
                }
                else
                {
                    PMASLHdRd01.SetBrother(Rt, PMComboBox3, PMComboBox3, PMComboBox3, iAnalyzeCode);
                }
            }
            // (*H0037 20030827 khattori	ＡＣＥＬＩＮＫ＜−＞ＭＪＳＬＩＮＫ統合*)
            iWork = 1;
            // iWork:=0;
            // if	(Is_ZAIMU)or(Is_SITEN)	then	iWork:=1;
            arPointer[0] = Rt;
            arPointer[1] = m_pRec;
            arPointer[2] = m_FixKbn20;
            arPointer[3] = m_FixKbn21;
            arPointer[4] = m_FixKbn29;
            arPointer[5] = iWork;
            iSlipCount = Itm.SetRootAddress(arPointer);
            arPointer[0] = Rt;
            arPointer[1] = Itm;
            arPointer[2] = PMComboBox3;
            arPointer[3] = PMComboBox4;
            arPointer[4] = PMPanelHdSjFst;
            arPointer[5] = PMPanelHdSjSnd;
            Ind.SetRootAddress(arPointer);
            arPointer[0] = Rt;
            arPointer[1] = m_pRec;
            Sm.SetRootAddress(arPointer);
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            if (IsSuitouMode)
            {
                iSijiCode = 311000;
            }
            else
            {
                iSijiCode = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU;
            }
            // 処理コードセット
            gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_SIJI_CODE, (iSijiCode as object));
            // 処理モードセット
            iWork = Itm.ReadIniInt(iSijiCode, "Type");
            gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_SIJI_TYPE, iWork);
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            iWork = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_KIND_STANDARD;
            if (IsBunsanMode)
            {
                iWork = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_KIND_BUNSAN;
            }
            gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_KIND, iWork);
            // 日常処理共通関数	外部呼出し関数
            gMASLParam.RVf = gMASL310RootVf;
            // Void
            gMASLParam.RPf = gMASL310RootPf;
            // Pointer
            gMASLParam.RBf = gMASL310RootBf;
            // Boolean
            gMASLParam.RIf = gMASL310RootIf;
            // Integer
            gMASLParam.RSf = gMASL310RootSf;
            // String
            gMASLParam.RWf = gMASL310RootWf;
            // 選択ウィンドウカバー関数
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VINI_DRL_PARM, gMASLParam);
            SelWnd.Init(m_pRec, gMASL310RootIf(VKZ310Cmnu.enIfunc.MASL_IGET_SYORIKBN), m_FixKbn23);
            // 定型ＮＯ表示
            // if 条件(定型仕訳採用)
            //@ Unsupported property or method(D): 'm_iOptionCode'
            if ((m_pRec.m_iOptionCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
            {
                FxReset();
            }
            //@ Unsupported property or method(D): 'ParentColor'
            EMNumEditFx_No.ParentColor = true;
            // 伝票入力
            if (IsSlipMode)
            {
                if (iSlipCount == 0)
                {
                    // 仮払精算伝票等で伝票情報が無い時、（ＦｏｒｍＳｈｏｗで）終了
                    //@ Unsupported property or method(D): 'm_iProgramCode'
                    if (m_pRec.m_iProgramCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN)
                    {
                        m_iClose = 1;
                        m_iExclusive = 7003;
                    }
                }
                // 第２指示を隠す
                if (iSlipCount <= 1)
                {
                    //@ Unsupported property or method(C): 'Width'
                    PMPanelHdSj.Width = 167;
                    //@ Unsupported property or method(C): 'visible'
                    PMComboBox4.visible = false;
                    //@ Unsupported property or method(C): 'visible'
                    PMPanelHdSjSnd.visible = false;
                }
                //@ Unsupported property or method(C): 'Width'
                BMSpBtnShowBalance.Width = 0;
                //@ Unsupported property or method(C): 'Enabled'
                BMSpBtnShowBalance.Enabled = false;
                //@ Unsupported property or method(C): 'Visible'
                EMNumEditBalance.Visible = false;
                TMBtnOpen.Visible = false;
            // ---<HIS-018> 非表示にすると 他のﾂｰﾙﾎﾞﾀﾝの位置がずれる-------------------------
            // (*H0047 20050418 khattori	一括置換*)
            // TMBtnLump.visible:=false;
            // ------------------------------------------------------------------<HIS-018>---
            }
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            fnHighResolve();
            gfirst = false;
        }

        // ---<HIS-024><HIS-035><HIS-042> -----------------------------------------------
        // **************************************************************************
        // Proccess  :	Align 設定要求
        // Parameter : None
        // Return    : None
        // Comment	  : これをしないと何故か Align がおかしい
        // **************************************************************************
        public void FormShow_fnRequestAlign()
        {
            //@ Unsupported property or method(C): 'Align'
            PMPanelAp.Align = System.Windows.Forms.DockStyle.None;
            //@ Unsupported property or method(C): 'Align'
            PMPanelAp.Align = System.Windows.Forms.DockStyle.Fill;
        }

        // ------------------------------------------------<HIS-024><HIS-035><HIS-042>---
        // (*H0048 20050516 khattori	操作ガイド番号通知*)
        // ******************************************************************************
        // Function	:	fnHelpIndexSet												<HELP>
        // ******************************************************************************
        public void FormShow_fnHelpIndexSet()
        {
            TAppParam AppPara;
            rcHELPINFO rcHLP;
            // ＡＬUのみ動作
#if _WANTYPE_NEW_
            //@ Unsupported property or method(D): 'm_iProgramCode'
            rcHLP.Code1 = m_pRec.m_iProgramCode;
            rcHLP.Code2 = 0;
            AppPara.iAction = Units.MAS310000u.ACTID_HELPINDEXSET;
            AppPara.pRecord = (m_pRec as object);
            AppPara.pActionParam = rcHLP;
            ((m_pRec) as TMjsAppRecord).m_pOwnerEntry(AppPara);
#endif

        }

        // ******************************************************************************
        // Proccess	:	FormShow (OnShow)
        // ******************************************************************************
        public void FormShow(Object Sender)
        {
            object pCurControl;
            TMASL310IDrill pMASL310IDrill;
            bool bRetn;
            int iNMonth;
            TMASL310IFunc rFunc;
            // (*H0008 20010703 khattori プレビュー中に裏画面にされた時！*)
            TMjsAppRecord pRec;
            MAS320100DSIParam stParam;
            // ---<HIS-047>------------------------------------------------------------------
            MAS312100DSIParam stParam312;
            // ------------------------------------------------------------------<HIS-047>---
            TMASL310IDrill cDrilNew;
            // (*♪♪♪*)
            //@ Unsupported property or method(C): 'Visible'
            if (!PMPanelAll.Visible)
            {
                return;
            }
            // ---<HIS-029> 削除-------------------------------------------------------------
            // //---<HIS-005> OnShow で設定（マルチスクリーン時変わってしまう　Formの特性?）---
            // //---<HIS-008>------------------------------------------------------------------
            // SubPrg.Left		:= 464	* GetZoomRatio(Pointer(m_pRec)) div 100;
            // SubPrg.Top		:= 2	* GetZoomRatio(Pointer(m_pRec)) div 100;
            // //	SubPrg.Left		:= 464;
            // //	SubPrg.Top		:= 2;
            // //------------------------------------------------------------------<HIS-008>---
            // SubPrg.Visible	:= True;
            // //------------------------------------------------------------------<HIS-005>---
            // ------------------------------------------------------------------<HIS-029>---
            // ---<HIS-006>------------------------------------------------------------------
            // サブプログラム採用有無を設定
            SetSubPrgUse();
            // ------------------------------------------------------------------<HIS-006>---
            // (*Ver.x*)
            // (*H0024	20011217 khattori	手形入力*)
            if (!Is_FASMODE())
            {
                // ////////////////////////////////////////////////////////////////
                // (*H0001	20010409	khattori	処理月による排他*)
                if (m_bfirst == true)
                {
                    m_bfirst = false;
                    // FormCreate でエラーが発生している可能性がある
                    if (m_iClose == 0)
                    {
                        // (*H0038 20030904 khattori	分散入力<単一入力>*)
                        if (!IsSuitouMode)
                        {
                            // ドリルダウン以外
                            // (*H0002	20010511 khattori 月固定／月可変切替のデフォルト*)
                            if ((g_pDrill == null))
                            {
                                if (m_iTukiDefault != 0)
                                {
                                    Sm.Kotei = 1;
                                    SetCaptionBtnFix();
                                }
                            // ドリルダウン　＆　月範囲指定
                            }
                            else if ((((TMASL310IDrill)(g_pDrill)).ToCld.Imnt[0] != ((TMASL310IDrill)(g_pDrill)).ToCld.Imnt[1]))
                            {
                                Sm.Kotei = 1;
                                SetCaptionBtnFix();
                            }
                        }
                        // ---<HIS-044>------------------------------------------------------------------
                        m_iClose = m_cSwkExc.SetExc(0);
                        // ------------------------------------------------------------------<HIS-044>---
                        if (m_iClose ==  -1)
                        {
                            // '仕訳最大端末数に達したため処理できません。'
                            m_iExclusive = 7001;
                        }
                        else if (m_iClose ==  -2)
                        {
                            // '他の端末で仕訳単独処理が実行中のため処理できません。';
                            m_iExclusive = 7002;
                        }
                        else if (m_iClose != 0)
                        {
                            m_iExclusive = 6;
                        }
                    // '排他制御エラーが発生しました。(SetExc)';
                    }
                    // FormCreate で発生したエラーもここで判定
                    if (m_iClose != 0)
                    {
                        //@ Unsupported function or procedure: 'PostMessage'
                        PostMessage(this.Handle, Units.MAS310000u.WM_ONPAINT, 0, 0);
                        new Exception("Abort");
                    }
                // ////////////////////////////////////////////////////////////////
                }
            // (*♪♪♪*)
            }
            // ｼｽﾃﾑ名（年度）‐処理名［画面NO］‐会社ｺｰﾄﾞ 簡略会社名 事業年度 その他附随事項
            // 会計大将‐仕訳入力［010001］‐01001234 ＭＪＳ物産 12/04/01 〜 13/03/31
            // MASSetCaption( m_pRec );
            // ---<HIS-019> MJSBtnVisible は使用しない(必要なボタンが消える現象があったので)-
            // MJSBtnVisible ( Self, true );
            // ------------------------------------------------------------------<HIS-019>---
            // ---<HIS-024><HIS-035><HIS-042>  復活------------------------------------------
            FormShow_fnRequestAlign();
            // //---<HIS-023> Align が正しく機能しないｹｰｽがある--------------------------------
            // //	RequestAlign();
            // //------------------------------------------------------------------<HIS-023>---
            // ------------------------------------------------<HIS-024><HIS-035><HIS-042>---
            // ---<HIS-028>------------------------------------------------------------------
            if (this.Parent == null)
            {
                this.Dock = System.Windows.Forms.DockStyle.None;
            }
            else
            {
                this.Dock = System.Windows.Forms.DockStyle.Fill;
            }
            // ------------------------------------------------------------------<HIS-028>---
            // (*H0048 20050516 khattori	操作ガイド番号通知*)
            FormShow_fnHelpIndexSet();
            pCurControl = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_ACTV_CTRL);
            if (pCurControl == null)
            {
                // (*♪♪♪*)
                // (*Ver.x*)
                // (*H0024	20011217 khattori	手形入力*)
                if (!Is_FASMODE())
                {
                    //@ Unsupported property or method(C): 'Enabled'
                    PMComboBox3.Enabled = false;
                    //@ Unsupported property or method(C): 'Enabled'
                    PMComboBox4.Enabled = false;
                    //@ Unsupported property or method(C): 'SetFocus'
                    PMComboBox2.SetFocus;
                    // ドリルダウン？
                    if (g_pDrill != null)
                    {
                        pMASL310IDrill = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DRL_PARM);
                        pMASL310IDrill.Status = VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT;
                        pMASL310IDrill.ProcCd = ((TMASL310IDrill)(g_pDrill)).ProcCd;
                        pMASL310IDrill.FrPar = ((TMASL310IDrill)(g_pDrill)).ToCld;
                        pMASL310IDrill.ToCld = ((TMASL310IDrill)(g_pDrill)).ToCld;
                        //@ Unsupported property or method(C): 'Enabled'
                        PMPanelSelMonth.Enabled = false;
                        //@ Unsupported property or method(C): 'Enabled'
                        PMComboBox2.Enabled = false;
                        // ドリルダウン　＆　単月指定
                        // (*H0035 20030825 khattori	MJSLINK <-> ACELINK 統一*)
                        // (*H0037 20030827 khattori	ＡＣＥＬＩＮＫ＜−＞ＭＪＳＬＩＮＫ統合*)
                        if ((((TMASL310IDrill)(g_pDrill)).ToCld.Imnt[0] == ((TMASL310IDrill)(g_pDrill)).ToCld.Imnt[1]))
                        {
                            // if	(Is_ZAIMU)or(Is_SITEN)or
                            // (TMASL310IDrill(g_pDrill^).ToCld^.Imnt[0]=TMASL310IDrill(g_pDrill^).ToCld^.Imnt[1])	then
                            //@ Unsupported property or method(C): 'Enabled'
                            PMPanelHdMonthFix.Enabled = false;
                        }
                        //@ Unsupported property or method(C): 'Enabled'
                        BMSpBtnChange.Enabled = false;
                        // ---<HIS-063>------------------------------------------------------------------
                        SubPrg.SetAllItemEnabled(false);
                        // //---<HIS-001><HIS-004><HIS-016><HIS-059>---------------------------------------
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_EXCEL]			:= False;	//	Excel取込
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_YAYOI02]		:= False;	//	弥生会計02-04
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_YAYOI05]		:= False;	//	弥生会計05-
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_KANJYO]		:= False;	//	勘定奉行
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_PCA]			:= False;	//	PCA会計
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_PCA09]		:= False;	//	PCA会計9 V2
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_KAIKEIOU]	:= False;	//	会計王
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_IBEX]		:= False;	//	JDL IBEX出納帳
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_KANTAN]			:= False;	//	ミロクのかんたん！会計
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_HOUJIN_EXPORT]	:= False;	//	ミロク法人会計　データ抽出処理
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_HOUJIN_IMPORT]	:= False;	//	ミロク法人会計　データ受入処理
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_KAIKEI_EXPORT]	:= False;	//	iCompass会計/会計太郎　差分データ送信
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_KAIKEI_IMPORT]	:= False;	//	iCompass会計/会計太郎　差分データ受信
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_ZAIMU_EXPORT]		:= False;	//	ＣＥ会計　差分データ送信
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_ZAIMU_IMPORT]		:= False;	//	ＣＥ会計　差分データ受信
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_VK_EXPORT]		:= False;	//	記帳くん　差分データ送信
                        // SubPrg.ItemEnabled[MASL_PROC_CODE_VK_IMPORT]		:= False;	//	記帳くん　差分データ受信
                        // //---------------------------------------<HIS-001><HIS-004><HIS-016><HIS-059>---
                        // ------------------------------------------------------------------<HIS-063>---
                        //@ Unsupported property or method(C): 'Enabled'
                        BMSpBtnShowBalance.Enabled = false;
                        //@ Unsupported property or method(C): 'Enabled'
                        PMPanelHdSd.Enabled = false;
                        iNMonth = pMASL310IDrill.FrPar.Imnt[0];
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_CUR_MNTH, iNMonth);
                        //@ Unsupported property or method(C): 'Text'
                        PMComboBox2.Text = Sm.CurMonth.sSelMonth;
                        // Comboへの入力月
                        rFunc = Itm.ReadIniRec(pMASL310IDrill.ProcCd);
                        bRetn = Rt.DoAction(rFunc, VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT);
                        if (bRetn == false)
                        {
                            this.Close();
                        }
                    }
                    m_bCB2KeyEnter = false;
                    m_bCB2Select = false;
                    m_bCB2Index =  -1;
                    m_bCB3KeyEnter = false;
                    m_bCB3Index =  -1;
                    m_bCB4KeyEnter = false;
                    m_bCB4Index =  -1;
                // (*♪♪♪*)
                }
                else
                {
                    //@ Unsupported property or method(C): 'Visible'
                    LMLabelHd2.Visible = false;
                    //@ Unsupported property or method(C): 'Visible'
                    BMSpBtnShowBalance.Visible = false;
                    //@ Unsupported property or method(C): 'Visible'
                    PMPanelHdBf.Visible = false;
                    //@ Unsupported property or method(C): 'Visible'
                    PMComboBox2.Visible = false;
                    //@ Unsupported property or method(C): 'Visible'
                    PMPanelSelMonth.Visible = false;
                    //@ Unsupported property or method(C): 'Visible'
                    PMPanelHdMonthFix.Visible = false;
                    ToolBar.Visible = false;
                    //@ Unsupported property or method(C): 'Visible'
                    PMPanelHdSj.Visible = false;
                    InitSelMonth();
                    SetIndOnSelMonth();
                    //@ Unsupported property or method(C): 'ItemIndex'
                    PMComboBox2.ItemIndex = 0;
                    //@ Unsupported property or method(C): 'Items'
                    //@ Unsupported property or method(D): 'Clear'
                    PMComboBox3.Items.Clear;
                    SetIndOnSiji(PMComboBox3, VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_CODE);
                    SetFuncOnSiji(VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_CODE);
                    if (IsSuitouMode)
                    {
                        rFunc = Itm.ReadIniRec(311801);
                    }
                    else
                    {
                        rFunc = Itm.ReadIniRec(310801);
                    }
                    PMComboBox3Select(rFunc);
                // EMNumEditFx_No.SetFocus;
                }
            }
            else
            {
                // 自分の子供か？
                //@ Unsupported property or method(A): 'ContainsControl'
                if (PMPanelHd.ContainsControl(((pCurControl) as Control)))
                {
                    // (*H0008 20010703 khattori プレビュー中に裏画面にされた時！*)
                    ((pCurControl) as Control).Focus();
                }
                else
                {
                    Rt.ProcSelect();
                }
            }
            // (*H0008 20010703 khattori プレビュー中に裏画面にされた時！*)
            // ロードされていたら表示にする
            pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Siw)]) as TMjsAppRecord));
            if (pRec != null)
            {
                stParam.iAction = 11;
                Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, stParam);
            }
            // ロードされていたら表示にする
            pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Mot)]) as TMjsAppRecord));
            if (pRec != null)
            {
                stParam.iAction = 11;
                Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, stParam);
            }
            // ロードされていたら表示にする
            pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Sli)]) as TMjsAppRecord));
            if (pRec != null)
            {
                // ---<HIS-047>------------------------------------------------------------------
                stParam312.iAction = 11;
                Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, stParam312);
            // stParam.iAction	:= 11;
            // rt.BplAction( ACTID_FREESTART+1, pRec, @stParam);
            // ------------------------------------------------------------------<HIS-047>---
            }
            // ロードされていたら表示にする
            pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Slp)]) as TMjsAppRecord));
            if (pRec != null)
            {
                // ---<HIS-047>------------------------------------------------------------------
                stParam312.iAction = 11;
                Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, stParam312);
            // stParam.iAction	:= 11;
            // rt.BplAction( ACTID_FREESTART+1, pRec, @stParam);
            // ------------------------------------------------------------------<HIS-047>---
            }
            // ロードされていたら表示にする
            pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bal)]) as TMjsAppRecord));
            if (pRec != null)
            {
                cDrilNew.ProcCd = 3;
                Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, cDrilNew);
            }
            // (*♪♪♪*)
            // (*Ver.x*)
            // (*H0024	20011217 khattori	手形入力*)
            if (!Is_FASMODE())
            {
                // 月選択リスト表示イベントをpost
                if (m_iExclusive == 0)
                {
                    Timer1.Enabled = true;
                }
            // (*♪♪♪*)
            }
            // (*H0013 20030609 khattori 合併採用区分＝１の時、Ｗｉｎ９８でチェックされない*)
            // if  m_FixKbn16 = 1 then
            //@ Unsupported function or procedure: 'PostMessage'
            PostMessage(this.Handle, Units.MAS310000u.WM_ONPAINT, 0, 0);
        }

        // ******************************************************************************
        // Proccess	:	FormPaint (OnPaint)
        // ******************************************************************************
        public void FormPaint(System.Object Sender, System.Windows.Forms.PaintEventArgs _e1)
        {
            TMjsMsgRec infoRec;
            // (*H0013 20030609 khattori 合併採用区分＝１の時、Ｗｉｎ９８でチェックされない*)
            // (*H0013 20010731 tyamaguchi 入力不可区分、修正／削除区分対応*)
            // if  m_FixKbn16 = 1 then
            // begin
            // TMASCom ( m_pRec^.m_pSystemArea^ ).m_MsgStd.GetMsg(infoRec,20,9);
            // with infoRec do	MjsMessageBoxEx(sMsg,sTitle,icontype,btntype,btndef,LogType);
            // Close;
            // Exit;
            // end;
            // //	出納帳入力（単一入力以外）
            // if	(m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU	)	and
            // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR	)	and
            // (not IsSlipMode									)		then
            // BMSpBtnShowBalance.Visible:=false;

        }

        // ******************************************************************************
        // Proccess	:	FormClose (OnClose)
        // ******************************************************************************
        // Note: the original parameters are Object Sender, ref TCloseAction Action
        public void FormClose(System.Object Sender, System.EventArgs _e1)
        {
            TAppParam AppPrm;
            int idx;
            TMASL310IDrill cDrill;
            // (*切り出した後ばってんなんか押すなよな〜*)
            for (idx = 1; idx <= Rt.BplList.Count; idx ++ )
            {
                cDrill = ((TMASL310IDrill)(Rt.GetDrillParam(idx)));
                if (cDrill.Mine.bCall)
                {
                    if (cDrill.Mine.TCall == System.Windows.Forms.DialogResult.Cancel)
                    {
                        new Exception("Abort");
                    }
                }
            }
            // (*H0005	20010604 khattori Ａｌｔ＋ｘの時、ドリルダウンの修正フラグが渡らない*)
            if ((g_pDrill != null))
            {
                ((TMASL310IDrill)(g_pDrill)).Status = VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_CHILD;
                ((TMASL310IDrill)(g_pDrill)).FrCld = ((TMASL310IDrill)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DRL_PARM))).ToPar;
            }
            //@ Unsupported function: 'Low'
            //@ Unsupported function: 'High'
            for (idx = (int)(Low(enDialogID)); idx <= (int)(High(enDialogID)); idx ++ )
            {
                // ダイアログを呼んだか？
                if (Rt.rp_DialogRec[idx] != null)
                {
                    try {
                        Rt.BplAction(Units.MAS310000u.ACTID_FORMCLOSESTART, Rt.rp_DialogRec[idx]);
                    }
                    catch {
                    }
                    // ---<HIS-004>------------------------------------------------------------------
                    try {
                        if (Rt.rp_DialogRec[idx].m_hChildBpl != 0)
                        {
                            // ------------------------------------------------------------------<HIS-004>---
                            //@ Unsupported function or procedure: 'UnLoadPackage'
                            UnLoadPackage(Rt.rp_DialogRec[idx].m_hChildBpl);
                        }
                    }
                    catch {
                    }
                    try {
                        this.Dispose(Rt.rp_DialogRec[idx]);
                    }
                    catch {
                    }
                    Rt.rp_DialogRec[idx] = null;
                }
            }
            try {
                //@ Unsupported property or method(C): 'Free'
                MJSPreIf.Free;
            }
            catch {
            }
            try {
                //@ Unsupported property or method(C): 'Free'
                Rt.Free;
            }
            catch {
            }
            // 日常処理共通関数クラス破棄
            try {
                //@ Unsupported property or method(C): 'Free'
                PMASLHdRd01.Free;
            }
            catch {
            }
            // ヘッダー項目入力パネル破棄
            try {
                //@ Unsupported property or method(C): 'Free'
                Sm.Free;
            }
            catch {
            }
            // 処理月操作クラス破棄
            try {
                //@ Unsupported property or method(C): 'Free'
                Ind.Free;
            }
            catch {
            }
            // 指示クラス破棄
            try {
                //@ Unsupported property or method(C): 'Free'
                Fnc.Free;
            }
            catch {
            }
            // ファンクション操作クラス破棄
            try {
                //@ Unsupported property or method(C): 'Free'
                Stb.Free;
            }
            catch {
            }
            // ステータスバー操作クラス破棄
            try {
                //@ Unsupported property or method(C): 'Free'
                Itm.Free;
            }
            catch {
            }
            // 指示項目操作クラス生成
            try {
                //@ Unsupported property or method(C): 'Free'
                SelWnd.Free;
            }
            catch {
            }
            // 選択ウィンドウクラス破棄
            // (*♪♪♪*)
            // ---<HIS-044><HIS-050>---------------------------------------------------------
            if (!Is_FASMODE())
            {
                if ((m_cSwkExc != null))
                {
                    try {
                        m_cSwkExc.TermExc();
                    }
                    catch {
                    }
                    try {
                        m_cSwkExc.Term();
                    }
                    catch {
                    }
                    try {
                        m_cSwkExc = null;
                    }
                    catch {
                    }
                // インスタンス破棄(nil セットにより内部で破棄される)
                }
                m_iClose = 0;
            }
            // ---------------------------------------------------------<HIS-044><HIS-050>---
            // (*H0003	20010511 khattori ＤＢのオープンに失敗した時の処理*)
            if (m_FCopDBMas != null)
            {
                //@ Unsupported property or method(A): 'COPDBClose'
                m_cMDModule.COPDBClose(m_FCopDBMas);
            }
            // (*H0010 20010712 khattori やばすぎ２！！！*)
            m_bTerm = true;
            //@ Undeclared identifier(3): 'caFree'
            Action = caFree;
            //@ Unsupported property or method(D): 'm_iDelete'
            m_pRec.m_iDelete = 1;
            AppPrm.iAction = Units.MAS310000u.ACTID_FORMCLOSEEND;
            AppPrm.pRecord = (m_pRec as object);
            AppPrm.pActionParam = null;
            ((m_pRec) as TMjsAppRecord).m_pOwnerEntry(AppPrm);
        }

        // (*H0016 20010921 tyamaguchi インスタンスの解放をOnDestroyに移動*)
        // ******************************************************************************
        // Proccess	:	FormDestroy (OnDestroy)
        // ******************************************************************************
        public void FormDestroy(Object Sender)
        {
            // (*H0020 20010927 khattori	復活！！！*)
            // ---<HIS-001><>HIS-002---------------------------------------------------------
            //@ Unsupported property or method(A): 'Free'
            SubPrg.Free();
            //@ Unsupported property or method(A): 'Free'
            m_cSubUse.Free();
            // ---------------------------------------------------------<HIS-001><HIS-002>---

        }

        // ******************************************************************************
        // Proccess	:	FormActivate (OnActivate)
        // ******************************************************************************
        public void FormActivate(System.Object Sender, System.EventArgs _e1)
        {
            TAppParam AppPrm;
            // 10/25 New
            AppPrm.iAction = Units.MAS310000u.ACTID_ACTIVEEND;
            AppPrm.pRecord = (m_pRec as object);
            AppPrm.pActionParam = null;
            ((m_pRec) as TMjsAppRecord).m_pOwnerEntry(AppPrm);
        }

        // ******************************************************************************
        // Proccess	:	FormHide (OnHide)
        // ******************************************************************************
        public void FormHide(Object Sender)
        {
            int idx;
            TMjsAppRecord pRec;
            MAS320100DSIParam stParam;
            // ---<HIS-047>------------------------------------------------------------------
            MAS312100DSIParam stParam312;
            // ------------------------------------------------------------------<HIS-047>---
            TMASL310IDrill cDrilNew;
            // (*H0010 20010712 khattori やばすぎ２！！！*)
            if (!m_bTerm)
            {
                for (idx = Rt.BplList.Count - 1; idx >= 0; idx-- )
                {
                    pRec = Rt.BplList[idx];
                    if (pRec != null)
                    {
                        Rt.BplAction(Units.MAS310000u.ACTID_HIDESTART, pRec);
                    }
                }
                // (*H0008 20010703 khattori プレビュー中に裏画面にされた時！*)
                // ロードされていたら非表示にする
                pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Siw)]) as TMjsAppRecord));
                if (pRec != null)
                {
                    stParam.iAction = 10;
                    Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, stParam);
                }
                // ロードされていたら非表示にする
                pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Mot)]) as TMjsAppRecord));
                if (pRec != null)
                {
                    stParam.iAction = 10;
                    Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, stParam);
                }
                // ロードされていたら非表示にする
                pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Sli)]) as TMjsAppRecord));
                if (pRec != null)
                {
                    // ---<HIS-047>------------------------------------------------------------------
                    stParam312.iAction = 10;
                    Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, stParam312);
                // stParam.iAction	:= 10;
                // rt.BplAction( ACTID_FREESTART+1, pRec, @stParam);
                // ------------------------------------------------------------------<HIS-047>---
                }
                // ロードされていたら非表示にする
                pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Slp)]) as TMjsAppRecord));
                if (pRec != null)
                {
                    // ---<HIS-047>------------------------------------------------------------------
                    stParam312.iAction = 10;
                    Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, stParam312);
                // stParam.iAction	:= 10;
                // rt.BplAction( ACTID_FREESTART+1, pRec, @stParam);
                // ------------------------------------------------------------------<HIS-047>---
                }
                // ロードされていたら非表示にする
                pRec = (((Rt.rp_DialogRec[(int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bal)]) as TMjsAppRecord));
                if (pRec != null)
                {
                    cDrilNew.ProcCd = 2;
                    Rt.BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, cDrilNew);
                }
            }
            // ---<HIS-019> MJSBtnVisible は使用しない(必要なボタンが消える現象があったので)-
            // // 10/24 New
            // MjsBtnVisible ( Self, false );
            // ------------------------------------------------------------------<HIS-019>---

        }

        // ******************************************************************************
        // Proccess	:	FormCloseQuery (OnCloseQuery)
        // ******************************************************************************
        // Note: the original parameters are Object Sender, ref bool CanClose
        public void FormCloseQuery(System.Object Sender, System.ComponentModel.CancelEventArgs _e1)
        {
            int idx;
            // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
            fnExceptTerm();
            // 財務排他終了処理
            //@ Unsupported function: 'Low'
            //@ Unsupported function: 'High'
            for (idx = (int)(Low(enDialogID)); idx <= (int)(High(enDialogID)); idx ++ )
            {
                // ダイアログを呼んだか？
                if (Rt.rp_DialogRec[idx] != null)
                {
                    if (Rt.BplAction(Units.MAS310000u.ACTID_FORMCANCLOSESTART, Rt.rp_DialogRec[idx]) != Units.MAS310000u.ACTID_RET_OK)
                    {
                        CanClose = false;
                        return;
                    }
                }
            }
            CanClose = Rt.BplCanClose();
        }

        // ---<HIS-015>------------------------------------------------------------------
        // ******************************************************************************
        // Component :	PMPanelAll  ( TMPanel )
        // Event     : OnResize
        // ******************************************************************************
        public void PMPanelAllResize(Object Sender)
        {
            //@ Unsupported property or method(C): 'ClientWidth'
            //@ Unsupported property or method(D): 'ButtonCount'
            //@ Unsupported property or method(D): 'ButtonWidth'
            MSPFunctionBar.ButtonWidth = ((Sender) as Control).ClientWidth / MSPFunctionBar.ButtonCount - 1;
        }

        // ------------------------------------------------------------------<HIS-015>---
        // ******************************************************************************
        // Proccess  : CM_CHILDKEY
        // Parameter : Msg         	TCMChildKey
        // Return    : None
        // Comment	  :
        // TCMChildKey = record
        // Msg			: Cardinal;
        // CharCode	: Word;
        // Unused		: Word;
        // Sender		: TWinControl;
        // Result		: Longint;
        // end;
        // ******************************************************************************
        public void CMChildKey(ref TCMChildKey Msg)
        {
            string sName;
            string sMama;
            string sGrma;
            int idx;
            Keys Shift;
            // (*Ver A121 M101*)
            // (*H0026 20020301 khattori	ＣＲ、００、０００　キー*)
            int iAscii;
            sName = "";
            sMama = "";
            sGrma = "";
            // (*H0033 20030129 khattori	切り出し→最小化→ツリーから選択→Ｅｎｔｅｒ→エラー*)
            //@ Unsupported property or method(C): 'ActiveControl'
            if (Screen.PrimaryScreen.ActiveControl != null)
            {
                //@ Unsupported property or method(C): 'ActiveControl'
                //@ Unsupported property or method(D): 'Name'
                sName = Screen.PrimaryScreen.ActiveControl.Name;
            }
            //@ Unsupported property or method(C): 'ActiveControl'
            //@ Unsupported property or method(D): 'Parent'
            else if (Screen.PrimaryScreen.ActiveControl.Parent != null)
            {
                //@ Unsupported property or method(C): 'ActiveControl'
                //@ Unsupported property or method(D): 'Parent'
                //@ Unsupported property or method(D): 'Name'
                sMama = Screen.PrimaryScreen.ActiveControl.Parent.Name;
            }
            //@ Unsupported property or method(C): 'ActiveControl'
            //@ Unsupported property or method(D): 'Parent'
            //@ Unsupported property or method(D): 'Parent'
            else if (Screen.PrimaryScreen.ActiveControl.Parent.Parent != null)
            {
                //@ Unsupported property or method(C): 'ActiveControl'
                //@ Unsupported property or method(D): 'Parent'
                //@ Unsupported property or method(D): 'Parent'
                //@ Unsupported property or method(D): 'Name'
                sGrma = Screen.PrimaryScreen.ActiveControl.Parent.Parent.Name;
            }
            // if	Screen.ActiveControl<>nil				then	sName:=Screen.ActiveControl.Name;
            // if	Screen.ActiveControl.Parent<>nil		then	sMama:=Screen.ActiveControl.Parent.Name;
            // if	Screen.ActiveControl.Parent.Parent<>nil	then	sGrma:=Screen.ActiveControl.Parent.Parent.Name;
            //@ Undeclared identifier(3): 'MJSKeyDataToShiftState'
            Shift = MJSKeyDataToShiftState(0);
            // (*Ver A121 M101*)
            // (*H0026 20020301 khattori	ＣＲキー　−＞*)
            m_bCRKey = false;
            if ((Shift != new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift}))
            {
                // 連想？
                //@ Unsupported property or method(C): 'ActiveControl'
                //@ Undeclared identifier(3): 'TMAssocEdit'
                if (Screen.PrimaryScreen.ActiveControl is TMAssocEdit)
                {
                    // 仮想キーコード	ー＞	ASCIIコード　に変換
                    //@ Unsupported property or method(C): 'CharCode'
                    iAscii = Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_ASCII_CODE, Msg.CharCode);
                    if (iAscii == m_iCRKey)
                    {
                        m_bCRKey = true;
                        //@ Undeclared identifier(3): 'VK_RETURN'
                        //@ Unsupported property or method(C): 'CharCode'
                        Msg.CharCode = VK_RETURN;
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_WND_SELMODE, m_bCRKey);
                        //@ Unsupported property or method(C): 'ActiveControl'
                        //@ Unsupported property or method(D): 'Parent'
                        //@ Unsupported property or method(D): 'Tag'
                        Screen.PrimaryScreen.ActiveControl.Parent.Tag = 1;
                        //@ Unsupported property or method(C): 'ActiveControl'
                        //@ Undeclared identifier(3): 'TMAssocEdit'
                        //@ Unsupported property or method(C): 'ActiveControl'
                        //@ Unsupported property or method(C): 'CharCode'
                        //@ Unsupported property or method(B): 'OnKeyDown'
                        TMAssocEdit(Screen.PrimaryScreen.ActiveControl).OnKeyDown(Screen.PrimaryScreen.ActiveControl, Msg.CharCode, Shift);
                        // Screen.ActiveControl.Parent.Tag:=0;
                        //@ Unsupported property or method(C): 'CharCode'
                        Msg.CharCode = 0;
                        m_bCRKey = false;
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_WND_SELMODE, m_bCRKey);
                        new Exception("Abort");
                    }
                }
            }
            // (*H0026 20020301 khattori	−＞　ＣＲ、００、０００　キー*)
            // ＴＡＢかコンボボックス＋Ｆ４
            //@ Unsupported property or method(C): 'CharCode'
            //@ Undeclared identifier(3): 'VK_TAB'
            //@ Unsupported property or method(C): 'CharCode'
            //@ Undeclared identifier(3): 'VK_F4'
            if ((Msg.CharCode == VK_TAB) || ((Msg.CharCode == VK_F4) && (sName.Substring(1 - 1 ,10) == "PMComboBox")))
            {
                if ((sName == "PMComboBox2"))
                {
                    //@ Unsupported property or method(C): 'CharCode'
                    PMComboBox2KeyDown(PMComboBox2, ref Msg.CharCode, Shift);
                }
                if ((sName == "PMComboBox3"))
                {
                    //@ Unsupported property or method(C): 'CharCode'
                    PMComboBox3KeyDown(PMComboBox3, ref Msg.CharCode, Shift);
                }
                if ((sName == "PMComboBox4"))
                {
                    //@ Unsupported property or method(C): 'CharCode'
                    PMComboBox4KeyDown(PMComboBox4, ref Msg.CharCode, Shift);
                }
                if ((sGrma == "PMPanelHdRd"))
                {
                    idx = Convert.ToInt32(sMama.Substring(11 - 1 ,1));
                    switch(idx)
                    {
                        case 1:
                            //@ Unsupported property or method(C): 'CharCode'
                            //@ Unsupported property or method(A): 'KeyDown'
                            PMASLHdRd01.EMNumEditCode.KeyDown(Msg.CharCode, Shift);
                            break;
                        case 2:
                            //@ Unsupported property or method(C): 'CharCode'
                            //@ Unsupported property or method(D): 'EMNumEditCode'
                            //@ Unsupported property or method(B): 'KeyDown'
                            PMASLHdRd02.EMNumEditCode.KeyDown(Msg.CharCode, Shift);
                            break;
                        case 3:
                            //@ Unsupported property or method(C): 'CharCode'
                            //@ Unsupported property or method(D): 'EMNumEditCode'
                            //@ Unsupported property or method(B): 'KeyDown'
                            PMASLHdRd03.EMNumEditCode.KeyDown(Msg.CharCode, Shift);
                            break;
                        case 4:
                            //@ Unsupported property or method(C): 'CharCode'
                            //@ Unsupported property or method(D): 'EMNumEditCode'
                            //@ Unsupported property or method(B): 'KeyDown'
                            PMASLHdRd04.EMNumEditCode.KeyDown(Msg.CharCode, Shift);
                            break;
                    }
                }
                if ((sMama == "PMPanelHdFx"))
                {
                    //@ Unsupported property or method(C): 'ActiveControl'
                    //@ Unsupported property or method(C): 'CharCode'
                    FxKeyDown(Screen.PrimaryScreen.ActiveControl, ref Msg.CharCode, Shift);
                }
                if ((sGrma == "PMPanelHdFx"))
                {
                    //@ Unsupported property or method(C): 'ActiveControl'
                    //@ Unsupported property or method(C): 'CharCode'
                    FxKeyDown(Screen.PrimaryScreen.ActiveControl, ref Msg.CharCode, Shift);
                }
                //@ Unsupported property or method(C): 'CharCode'
                Msg.CharCode = 0;
                new Exception("Abort");
            }
            base.CMChildKey();
        }

        // ******************************************************************************
        // Proccess	:	PMPanelHd処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // ******************************************************************************
        // ******************************************************************************
        // procedure	:	PMPanelHdExit
        // ******************************************************************************
        public void PMPanelHdExit(Object Sender)
        {
            // ---<HIS-063>------------------------------------------------------------------
            SubPrg.SetAllItemEnabled(false);
            // //---<HIS-001><HIS-004><HIS-016><HIS-059>---------------------------------------
            // SubPrg.ItemEnabled[MASL_PROC_CODE_EXCEL]			:= False;	//	Excel取込
            // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_YAYOI02]		:= False;	//	弥生会計02-04
            // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_YAYOI05]		:= False;	//	弥生会計05-
            // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_KANJYO]		:= False;	//	勘定奉行
            // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_PCA]			:= False;	//	PCA会計
            // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_PCA09]		:= False;	//	PCA会計9 V2
            // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_KAIKEIOU]	:= False;	//	会計王
            // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_IBEX]		:= False;	//	JDL IBEX出納帳
            // SubPrg.ItemEnabled[MASL_PROC_CODE_KANTAN]			:= False;	//	ミロクのかんたん！会計
            // SubPrg.ItemEnabled[MASL_PROC_CODE_HOUJIN_EXPORT]	:= False;	//	ミロク法人会計　データ抽出処理
            // SubPrg.ItemEnabled[MASL_PROC_CODE_HOUJIN_IMPORT]	:= False;	//	ミロク法人会計　データ受入処理
            // SubPrg.ItemEnabled[MASL_PROC_CODE_KAIKEI_EXPORT]	:= False;	//	iCompass会計/会計太郎　差分データ送信
            // SubPrg.ItemEnabled[MASL_PROC_CODE_KAIKEI_IMPORT]	:= False;	//	iCompass会計/会計太郎　差分データ受信
            // SubPrg.ItemEnabled[MASL_PROC_CODE_ZAIMU_EXPORT]		:= False;	//	ＣＥ会計　差分データ送信
            // SubPrg.ItemEnabled[MASL_PROC_CODE_ZAIMU_IMPORT]		:= False;	//	ＣＥ会計　差分データ受信
            // SubPrg.ItemEnabled[MASL_PROC_CODE_VK_EXPORT]		:= False;	//	記帳くん　差分データ送信
            // SubPrg.ItemEnabled[MASL_PROC_CODE_VK_IMPORT]		:= False;	//	記帳くん　差分データ受信
            // //---------------------------------------<HIS-001><HIS-004><HIS-016><HIS-059>---
            // ------------------------------------------------------------------<HIS-063>---
            //@ Unsupported property or method(C): 'Enabled'
            BMSpBtnShowBalance.Enabled = false;
            // Balance　表示不可
            //@ Unsupported property or method(C): 'Color'
            PMPanelSelMonth.Color = System.Drawing.SystemColors.Window;
            //@ Unsupported property or method(C): 'Color'
            PMPanelHdSjFst.Color = System.Drawing.SystemColors.Window;
            //@ Unsupported property or method(C): 'Color'
            PMPanelHdSjSnd.Color = System.Drawing.SystemColors.Window;
        }

        // ******************************************************************************
        // procedure	:	PMPanelHdEnter
        // ******************************************************************************
        public void PMPanelHdEnter(Object Sender)
        {
            TMASL310IFunc rFunc;
            // (*H0021 20010928 khattori	更新確認のＣａｎｃｅｌボタン*)
            if (Rt.DoAction(rFunc, VKZ310Cmnu.enDrillStatus.MASL_DRILL_BASE))
            {
                // ドリルダウンパラメーターセット
                //@ Unsupported property or method(C): 'Enabled'
                if (PMPanelAp.Enabled == true)
                {
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelAp.Enabled = false;
                }
                // ---<HIS-063>------------------------------------------------------------------
                SubPrg.SetAllItemEnabled(true);
                // //---<HIS-001><HIS-004><HIS-016><HIS-059>---------------------------------------
                // SubPrg.ItemEnabled[MASL_PROC_CODE_EXCEL]			:= True;	//	Excel取込
                // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_YAYOI02]		:= True;	//	弥生会計02-04
                // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_YAYOI05]		:= True;	//	弥生会計05-
                // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_KANJYO]		:= True;	//	勘定奉行
                // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_PCA]			:= True;	//	PCA会計
                // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_PCA09]		:= True;	//	PCA会計9 V2
                // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_KAIKEIOU]	:= True;	//	会計王
                // SubPrg.ItemEnabled[MASL_PROC_CODE_DATA_IBEX]		:= True;	//	JDL IBEX出納帳
                // SubPrg.ItemEnabled[MASL_PROC_CODE_KANTAN]			:= True;	//	ミロクのかんたん！会計
                // SubPrg.ItemEnabled[MASL_PROC_CODE_HOUJIN_EXPORT]	:= True;	//	ミロク法人会計　データ抽出処理
                // SubPrg.ItemEnabled[MASL_PROC_CODE_HOUJIN_IMPORT]	:= True;	//	ミロク法人会計　データ受入処理
                // SubPrg.ItemEnabled[MASL_PROC_CODE_KAIKEI_EXPORT]	:= True;	//	iCompass会計/会計太郎　差分データ送信
                // SubPrg.ItemEnabled[MASL_PROC_CODE_KAIKEI_IMPORT]	:= True;	//	iCompass会計/会計太郎　差分データ受信
                // SubPrg.ItemEnabled[MASL_PROC_CODE_ZAIMU_EXPORT]		:= True;	//	ＣＥ会計　差分データ送信
                // SubPrg.ItemEnabled[MASL_PROC_CODE_ZAIMU_IMPORT]		:= True;	//	ＣＥ会計　差分データ受信
                // SubPrg.ItemEnabled[MASL_PROC_CODE_VK_EXPORT]		:= True;	//	記帳くん　差分データ送信
                // SubPrg.ItemEnabled[MASL_PROC_CODE_VK_IMPORT]		:= True;	//	記帳くん　差分データ受信
                // //---------------------------------------<HIS-001><HIS-004><HIS-016><HIS-059>---
                // ------------------------------------------------------------------<HIS-063>---
                //@ Unsupported property or method(C): 'Enabled'
                BMSpBtnShowBalance.Enabled = true;
                // Balance　表示可能
                // 仕訳単独開放
                // ---<HIS-044><HIS-050>---------------------------------------------------------
                if ((m_cSwkExc != null))
                {
                    m_cSwkExc.SetExc( -2);
                }
            // ---------------------------------------------------------<HIS-044><HIS-050>---
            }
        }

        // ******************************************************************************
        // Proccess	:	PMPanelHdRd処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // ******************************************************************************
        public void PMPanelHdRdExit(Object Sender)
        {
            Rt.Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_Clear);
        }

        // ******************************************************************************
        // Proccess	:	PMComboBox2処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // ******************************************************************************
        // ******************************************************************************
        // procedure	:	PMComboBox2Enter
        // ******************************************************************************
        public void PMComboBox2Enter(Object Sender)
        {
            // アクティヴコントロールに自分をセット
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_ACTV_CTRL, Sender);
            InitSelMonth();
            SetIndOnSelMonth();
            SetCaptionBtnFix;
            SetFuncOnSelMonth();
            // (*H0018 20010926 khattori	定型仕訳排他対応*)
            m_cFixLock.iAction =  -1;
            Rt.GetFixLock(m_cFixLock);
            // 定型ＮＯ表示	(*H0015 20010921 tyamaguchi 定型仕訳対応*)
            // if 条件(定型仕訳採用)
            //@ Unsupported property or method(D): 'm_iOptionCode'
            if ((m_pRec.m_iOptionCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
            {
                FxReset();
            }
            //@ Unsupported property or method(D): 'ParentColor'
            EMNumEditFx_No.ParentColor = true;
            DisableComponent();
            // この辺かな？
            //@ Unsupported property or method(C): 'ItemIndex'
            if ((PMComboBox2.ItemIndex < 0) && (m_bCB2Index >= 0))
            {
                //@ Unsupported property or method(C): 'ItemIndex'
                PMComboBox2.ItemIndex = m_bCB2Index;
            }
            //@ Unsupported property or method(C): 'ItemIndex'
            if (PMComboBox2.ItemIndex < 0)
            {
                //@ Unsupported property or method(C): 'ItemIndex'
                PMComboBox2.ItemIndex = 0;
            }
            //@ Unsupported property or method(D): 'm_pCommonArea'
            //@ Unsupported property or method(C): 'Color'
            PMPanelSelMonth.Color = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).SysFocusColor;
            //@ Unsupported property or method(C): 'Color'
            PMPanelHdSjFst.Color = System.Drawing.SystemColors.Window;
            //@ Unsupported property or method(C): 'Color'
            PMPanelHdSjSnd.Color = System.Drawing.SystemColors.Window;
            //@ Unsupported property or method(D): 'Enabled'
            PMPanelHdRd.Enabled = false;
        }

        // ******************************************************************************
        // Proccess	:	PMComboBox2Exit
        // ******************************************************************************
        public void PMComboBox2Exit(Object Sender)
        {
            //@ Unsupported property or method(C): 'Color'
            PMPanelSelMonth.Color = System.Drawing.SystemColors.Window;
            // ---<HIS-049> KeyDown でフォーカス移動すると KeyUp が発生しない----------------
            m_bCB2KeyEnter = false;
            // ------------------------------------------------------------------<HIS-049>---

        }

        // ******************************************************************************
        // procedure	:	PMComboBox2Click
        // ******************************************************************************
        public void PMComboBox2Click(Object Sender)
        {
            if (!m_bCB2KeyEnter)
            {
                //@ Unsupported property or method(C): 'ItemIndex'
                if (PMComboBox2.ItemIndex >= 0)
                {
                    PMComboBox2Select();
                    // ---<HIS-030>------------------------------------------------------------------
                    SetCaptionBtnFix();
                // ------------------------------------------------------------------<HIS-030>---
                }
            }
        }

        // ******************************************************************************
        // procedure	:	PMComboBox2Change
        // ******************************************************************************
        public void PMComboBox2Change(Object Sender)
        {
            int iNMonth;
            if (m_bCB2Select)
            {
                //@ Unsupported property or method(C): 'ItemIndex'
                PMComboBox2.ItemIndex = m_bCB2Index;
            }
            else
            {
                //@ Unsupported property or method(C): 'Enabled'
                PMComboBox3.Enabled = false;
                //@ Unsupported property or method(C): 'Enabled'
                PMComboBox4.Enabled = false;
                //@ Unsupported property or method(C): 'ItemIndex'
                if (PMComboBox2.ItemIndex >= 0)
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    iNMonth = ((TMASL310IMonth)(Sm[PMComboBox2.ItemIndex])).iInner;
                    Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_CUR_MNTH, iNMonth);
                    SetCaptionBtnFix(1);
                }
            }
            m_bCB2Select = false;
            m_bCB2KeyEnter = false;
        }

        // ******************************************************************************
        // procedure	:	PMComboBox2KeyDown
        // ******************************************************************************
        public void PMComboBox2KeyDown(Object Sender, ref ushort Key, Keys Shift)
        {
            // (*H0009 20010709 khattori Ｃｏｍｂｏの動き調整*)
            m_bCB2KeyEnter = true;
            //@ Undeclared identifier(3): 'VK_ESCAPE'
            //@ Undeclared identifier(3): 'VK_END'
            if ((Key == VK_ESCAPE) || (Key == VK_END))
            {
                EscKeyKeyDown(Sender, Key);
            }
            else
            {
                // m_bCB2KeyEnter	:=	true;
                m_bCB2Select = false;
                //@ Undeclared identifier(3): 'VK_F1'
                //@ Undeclared identifier(3): 'VK_F12'
                if ((Key >= VK_F1) && (Key <= VK_F12))
                {
                    // 月固定／月可変切替ボタン
                    // (*H0038 20030904 khattori	分散入力<単一入力>*)
                    // if	((m_pRec^.m_iProgramCode=MASL_PROC_CODE_TAXITU)	or	IsSlipMode)	and
                    // if	(m_pRec^.m_iProgramCode<>311000)	and
                    //@ Undeclared identifier(3): 'VK_F1'
                    if (!IsSuitouMode && (Sm.CurMonth.iInner != 0) && (Sm.CurMonth.iInner < 40) && (Key == VK_F1))
                    {
                        BMSpBtnMonthFixClick(BMSpBtnMonthFix);
                    }
                    // ファンクショントグリ
                    //@ Undeclared identifier(3): 'VK_F9'
                    if ((Key == VK_F9))
                    {
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_NEXT);
                    }
                }
                // //////////////////////
                // テスト用！！！！！
                // //////////////////////
                //@ Undeclared identifier(3): 'VK_F11'
                if ((Key == VK_F11))
                {
                    m_iPMPanelDev ++;
                }
                //@ Undeclared identifier(3): 'VK_F12'
                if ((Key == VK_F12))
                {
                    //@ Unsupported property or method(C): 'Visible'
                    if (PMPanelDev.Visible)
                    {
                        //@ Unsupported property or method(C): 'Visible'
                        PMPanelDev.Visible = false;
                    }
                    else if ((m_iPMPanelDev > 10))
                    {
                        m_iPMPanelDev = 0;
                        //@ Unsupported property or method(C): 'Caption'
                        if (PMPanelDev.Caption == 'A')
                        {
                            MakeDevPanel();
                        }
                        //@ Unsupported property or method(C): 'Top'
                        PMPanelDev.Top = 0;
                        //@ Unsupported property or method(C): 'Left'
                        PMPanelDev.Left = 0;
                        //@ Unsupported property or method(C): 'Height'
                        PMPanelDev.Height = 2;
                        //@ Unsupported property or method(C): 'Width'
                        PMPanelDev.Width = 2;
                        //@ Unsupported property or method(C): 'Visible'
                        PMPanelDev.Visible = true;
                        //@ Unsupported property or method(C): 'BringToFront'
                        PMPanelDev.BringToFront;
                    }
                }
                // Ｅｎｔｅｒ　ｏｒ　Ｔａｂ
                //@ Undeclared identifier(3): 'VK_RETURN'
                //@ Undeclared identifier(3): 'VK_TAB'
                if (((Key == VK_RETURN) || (Key == VK_TAB)) && (Shift != new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift}))
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    if (PMComboBox2.ItemIndex >= 0)
                    {
                        PMComboBox2Select();
                    }
                }
            }
        }

        // ******************************************************************************
        // procedure	:	PMComboBox2KeyUp
        // ******************************************************************************
        public void PMComboBox2KeyUp(Object Sender, ref ushort Key, Keys Shift)
        {
            int idx1;
            int idx2;
            int idx3;
            int idx4;
            string sSelMonth;
            string sText;
            string sSelText;
            string sCompText;
            int iNMonth;
            m_bCB2KeyEnter = false;
            m_bCB2Select = false;
            // //////////////////////////////////////////////////////////////////////////////////////////////////
            // 処理月の選択を行う
            // 1月と10月、2月と21月等、先頭数字が等しい月が混在する為、'月'＋'.'のように入力文字を作成し、
            // 判別可能にする（　'1.' <-> '10'　'2.' <-> '20'　等）
            // 翌年度第１四半期相当月の入力を可能にする為、'.'＋'月'のように入力文字を作成し、判別可能にする
            // （　'4' <-> '.4'　'20' <-> '.20'　等）
            // //////////////////////////////////////////////////////////////////////////////////////////////////
            // SelText プロパティは，編集領域内の選択された文字群を表します。
            idx2 =  -1;
            idx3 =  -1;
            idx4 =  -1;
            //@ Unsupported property or method(C): 'Text'
            sText = PMComboBox2.Text;
            //@ Unsupported property or method(C): 'SelText'
            sSelText = PMComboBox2.SelText;
            sCompText = sText;
            Rt.RCnm(ref sCompText);
            // カンマ削除
            //@ Unsupported property or method(C): 'Items'
            //@ Unsupported property or method(D): 'Count'
            for (idx1 = 0; idx1 < PMComboBox2.Items.Count; idx1 ++ )
            {
                sSelMonth = ((TMASL310IMonth)(Sm[idx1])).sSelMonth;
                if ((sCompText == sSelMonth))
                {
                    // 5,6,7,etc
                    idx2 = idx1;
                }
                else if (((sCompText + '.') == sSelMonth))
                {
                    // 1.,9.,etc
                    idx3 = idx1;
                }
                else if ((sCompText == sSelMonth.Substring(1 - 1 ,sCompText.Length)))
                {
                    idx4 = idx1;
                }
            // 1,9,etc
            }
            if ((idx2 >= 0))
            {
                if (sText == sCompText)
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    PMComboBox2.ItemIndex = idx2;
                    //@ Unsupported property or method(C): 'Text'
                    PMComboBox2.Text = ((TMASL310IMonth)(Sm[idx2])).sSelMonth + ',';
                    //@ Unsupported property or method(C): 'SelectAll'
                    PMComboBox2.SelectAll;
                }
            }
            else if ((idx3 >= 0))
            {
                //@ Unsupported property or method(C): 'ItemIndex'
                PMComboBox2.ItemIndex = idx3;
                //@ Unsupported property or method(C): 'Text'
                PMComboBox2.Text = ((TMASL310IMonth)(Sm[idx3])).sSelMonth + ',';
                if ((sCompText.Substring(1 - 1 ,1)) == '.')
                {
                    //@ Unsupported property or method(C): 'SelStart'
                    PMComboBox2.SelStart = 2;
                    //@ Unsupported property or method(C): 'SelLength'
                    PMComboBox2.SelLength = 2;
                }
                else
                {
                    //@ Unsupported property or method(C): 'SelStart'
                    PMComboBox2.SelStart = 1;
                    //@ Unsupported property or method(C): 'SelLength'
                    PMComboBox2.SelLength = 2;
                }
            }
            else if ((sSelText == ".,") || (idx4 < 0))
            {
                //@ Unsupported property or method(C): 'SelectAll'
                PMComboBox2.SelectAll;
                Console.Beep();
            }
            //@ Unsupported property or method(C): 'ItemIndex'
            if (PMComboBox2.ItemIndex >= 0)
            {
                //@ Unsupported property or method(C): 'ItemIndex'
                iNMonth = ((TMASL310IMonth)(Sm[PMComboBox2.ItemIndex])).iInner;
                Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_CUR_MNTH, iNMonth);
                SetCaptionBtnFix;
                SetFuncOnSelMonth();
            }
        }

        // ******************************************************************************
        // procedure	:	PMComboBox2Select
        // ******************************************************************************
        public void PMComboBox2Select()
        {
            Control cCompo;
            int iNMonth;
            TMjsMsgRec inforec;
            // ////////////////////////////////////////////////////////////////
            // (*H0001	20010409	khattori	処理月による排他*)
            //@ Unsupported property or method(C): 'ItemIndex'
            iNMonth = ((TMASL310IMonth)(Sm[PMComboBox2.ItemIndex])).iInner;
            if (m_iClose != 0)
            {
                //@ Unsupported property or method(D): 'm_pSystemArea'
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMSG'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(inforec, 20, 8);
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef);
            }
            else
            {
                //@ Unsupported property or method(C): 'Enabled'
                PMComboBox3.Enabled = true;
                //@ Unsupported property or method(A): 'FindNextControl'
                cCompo = this.FindNextControl(PMComboBox2, true, true, false);
                m_bCB2Select = true;
                //@ Unsupported property or method(D): 'ItemIndex'
                m_bCB2Index = PMComboBox2.ItemIndex;
                Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_CUR_MNTH, iNMonth);
                //@ Unsupported property or method(D): 'Text'
                PMComboBox2.Text = ((TMASL310IMonth)(Sm[m_bCB2Index])).sSelMonth + ',';
                //@ Unsupported property or method(D): 'SelectAll'
                PMComboBox2.SelectAll;
                SetCaptionBtnFix(1);
                if (cCompo.CanFocus)
                {
                    cCompo.Focus();
                }
                //@ Unsupported property or method(D): 'ItemIndex'
                PMComboBox2.ItemIndex = m_bCB2Index;
            }
        }

        // ******************************************************************************
        // Proccess	:	PMComboBox3処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // ******************************************************************************
        // ******************************************************************************
        // procedure	:	PMComboBox3Enter
        // ******************************************************************************
        public void PMComboBox3Enter(Object Sender)
        {
            // (*H0006	20010626 khattori 表示からの入力中等でマウスで指示に戻った時、指示が不正*)
            int iNumb;
            TMASL310IFunc rFunc;
            object pFunc;
            if (m_iExclusive == 0)
            {
                // アクティヴコントロールに自分をセット
                Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_ACTV_CTRL, Sender);
                //@ Unsupported property or method(C): 'Items'
                //@ Unsupported property or method(D): 'Clear'
                PMComboBox3.Items.Clear;
                SetIndOnSiji(PMComboBox3, VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_CODE);
                SetFuncOnSiji(VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_CODE);
                // (*H0018 20010926 khattori	定型仕訳排他対応*)
                m_cFixLock.iAction =  -1;
                Rt.GetFixLock(m_cFixLock);
                DisableComponent();
                // 定型ＮＯ表示	(*H0015 20010921 tyamaguchi 定型仕訳対応*)
                // if 条件(定型仕訳採用)
                //@ Unsupported property or method(D): 'm_iOptionCode'
                if ((m_pRec.m_iOptionCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
                {
                    FxReset();
                }
                //@ Unsupported property or method(D): 'ParentColor'
                EMNumEditFx_No.ParentColor = true;
                // この辺かな？
                //@ Unsupported property or method(C): 'ItemIndex'
                if ((PMComboBox3.ItemIndex < 0) && (m_bCB3Index >= 0))
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    PMComboBox3.ItemIndex = m_bCB3Index;
                }
                //@ Unsupported property or method(C): 'ItemIndex'
                if (PMComboBox3.ItemIndex < 0)
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    PMComboBox3.ItemIndex = 0;
                }
                // (*H0006	20010626 khattori 表示からの入力中等でマウスで指示に戻った時、指示が不正*)
                //@ Unsupported property or method(C): 'ItemIndex'
                iNumb = PMComboBox3.ItemIndex + 1;
                pFunc = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb);
                rFunc = ((TMASL310IFunc)(pFunc));
                // ファンクション情報
                //@ Unsupported function or procedure: 'Format'
                //@ Unsupported property or method(C): 'Caption'
                PMPanelHdSjFst.Caption = Format("  %2d ", new int[] {iNumb}) + rFunc.sCaption;
                // PMComboBox3.Text:=IntToStr(iNumb)+',';
                //@ Unsupported property or method(C): 'SelectAll'
                PMComboBox3.SelectAll;
                // (*H0007	20010628 khattori 初期処理中に他のアプリケーションを表示された時*)
                // １回目でない？
                if (gfirst)
                {
                    //@ Unsupported property or method(C): 'Handle'
                    //@ Undeclared identifier(3): 'CB_SHOWDROPDOWN'
                    //@ Unsupported function or procedure: 'PostMessage'
                    PostMessage(PMComboBox3.Handle, CB_SHOWDROPDOWN, 1, 0);
                }
                //@ Unsupported property or method(C): 'Color'
                PMPanelSelMonth.Color = System.Drawing.SystemColors.Window;
                //@ Unsupported property or method(D): 'm_pCommonArea'
                //@ Unsupported property or method(C): 'Color'
                PMPanelHdSjFst.Color = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).SysFocusColor;
                //@ Unsupported property or method(C): 'Color'
                PMPanelHdSjSnd.Color = System.Drawing.SystemColors.Window;
                //@ Unsupported property or method(D): 'Enabled'
                PMPanelHdRd.Enabled = false;
            }
        }

        // ******************************************************************************
        // Proccess	:	PMComboBox3Exit
        // ******************************************************************************
        public void PMComboBox3Exit(Object Sender)
        {
            //@ Unsupported property or method(C): 'Color'
            PMPanelHdSjFst.Color = System.Drawing.SystemColors.Window;
            // ---<HIS-049> KeyDown でフォーカス移動すると KeyUp が発生しない----------------
            m_bCB3KeyEnter = false;
            // ------------------------------------------------------------------<HIS-049>---

        }

        // ******************************************************************************
        // procedure	:	PMComboBox3Click
        // ******************************************************************************
        public void PMComboBox3Click(Object Sender)
        {
            int iNumb;
            TMASL310IFunc rFunc;
            object pFunc;
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 1)
            {
                // ME,2000 で落ちる
                if (!m_bCB3KeyEnter)
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    //@ Unsupported property or method(C): 'Text'
                    if ((PMComboBox3.ItemIndex >= 0) && (Rt.RChk(PMComboBox3.Text) != 2))
                    {
                        //@ Unsupported property or method(C): 'ItemIndex'
                        iNumb = PMComboBox3.ItemIndex + 1;
                        pFunc = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb);
                        rFunc = ((TMASL310IFunc)(pFunc));
                        // ファンクション情報
                        //@ Unsupported function or procedure: 'Format'
                        //@ Unsupported property or method(C): 'Caption'
                        PMPanelHdSjFst.Caption = Format("  %2d ", new int[] {iNumb}) + rFunc.sCaption;
                        //@ Unsupported property or method(C): 'Text'
                        PMComboBox3.Text = (iNumb).ToString() + ',';
                        //@ Unsupported property or method(C): 'SelectAll'
                        PMComboBox3.SelectAll;
                        PMComboBox3Select(rFunc);
                    }
                }
            }
            // ME,2000 で落ちる

        }

        // ******************************************************************************
        // procedure	:	PMComboBox3Change
        // 選択項目を表示する
        // 標準的な動作では２桁のＮＯが取れない為、入力と表示を別コントロールでおこなう。
        // 入力されたＮＯの項目を表示用コントロールにセットする。
        // ******************************************************************************
        public void PMComboBox3Change(Object Sender)
        {
            int iNumb;
            TMASL310IFunc rFunc;
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 1)
            {
                // ME,2000 で落ちる
                if (gfg)
                {
                }
                else
                {
                    if (m_bCB3KeyEnter)
                    {
                        // 項目が選択されているか？
                        //@ Unsupported property or method(C): 'ItemIndex'
                        //@ Unsupported property or method(C): 'ItemIndex'
                        //@ Unsupported property or method(A): 'Items'
                        if ((PMComboBox3.ItemIndex >= 0) && (Rt.RChk(PMComboBox3.Items[PMComboBox3.ItemIndex]) != 2))
                        {
                            //@ Unsupported property or method(C): 'ItemIndex'
                            iNumb = PMComboBox3.ItemIndex + 1;
                            rFunc = ((TMASL310IFunc)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb)));
                            //@ Unsupported function or procedure: 'Format'
                            //@ Unsupported property or method(C): 'Caption'
                            PMPanelHdSjFst.Caption = Format("  %2d ", new int[] {iNumb}) + rFunc.sCaption;
                            if (rFunc.sProg != 'x')
                            {
                                //@ Unsupported property or method(C): 'Caption'
                                PMPanelHdSjSnd.Caption = "";
                                //@ Unsupported property or method(C): 'Enabled'
                                PMComboBox4.Enabled = false;
                                //@ Unsupported property or method(C): 'Items'
                                //@ Unsupported property or method(D): 'Clear'
                                PMComboBox4.Items.Clear;
                                //@ Unsupported property or method(C): 'Text'
                                PMComboBox4.Text = "";
                            }
                        }
                        //@ Unsupported property or method(C): 'SelectAll'
                        PMComboBox3.SelectAll;
                    }
                }
                m_bCB3KeyEnter = false;
            }
            // ME,2000 で落ちる

        }

        // ******************************************************************************
        // procedure	:	PMComboBox3KeyDown
        // ******************************************************************************
        public void PMComboBox3KeyDown(Object Sender, ref ushort Key, Keys Shift)
        {
            string sText;
            int iNumb;
            TMASL310IFunc rFunc;
            object pFunc;
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 1)
            {
                // ME,2000 で落ちる
                // (*H0009 20010709 khattori Ｃｏｍｂｏの動き調整*)
                m_bCB3KeyEnter = true;
                //@ Undeclared identifier(3): 'VK_ESCAPE'
                //@ Undeclared identifier(3): 'VK_END'
                if ((Key == VK_ESCAPE) || (Key == VK_END))
                {
                    EscKeyKeyDown(Sender, Key);
                }
                else
                {
                    // m_bCB3KeyEnter	:=	true;
                    //@ Unsupported property or method(C): 'Text'
                    sText = PMComboBox3.Text;
                    // (* ファンクションキー *)
                    //@ Undeclared identifier(3): 'VK_F1'
                    //@ Undeclared identifier(3): 'VK_F8'
                    if ((VK_F1 <= Key) && (Key <= VK_F8))
                    {
                        //@ Undeclared identifier(3): 'VK_F1'
                        iNumb = Key - VK_F1 + 1;
                        pFunc = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb);
                        //@ Unsupported property or method(A): 'Items'
                        // 処理が割り当てられていないファンクション
                        if ((pFunc == null) || (Rt.RChk(PMComboBox3.Items[iNumb - 1]) == 2))
                        {
                            Console.Beep();
                        }
                        else
                        {
                            rFunc = ((TMASL310IFunc)(pFunc));
                            // ファンクション情報
                            //@ Unsupported function or procedure: 'Format'
                            //@ Unsupported property or method(C): 'Caption'
                            PMPanelHdSjFst.Caption = Format("  %2d ", new int[] {iNumb}) + rFunc.sCaption;
                            //@ Unsupported property or method(C): 'ItemIndex'
                            PMComboBox3.ItemIndex = iNumb - 1;
                            //@ Unsupported property or method(C): 'Text'
                            PMComboBox3.Text = (iNumb).ToString() + ',';
                            //@ Unsupported property or method(C): 'Text'
                            sText = PMComboBox3.Text;
                            //@ Unsupported property or method(C): 'SelectAll'
                            PMComboBox3.SelectAll;
                            PMComboBox3Select(rFunc);
                        }
                    }
                    // (* トグリ *)
                    //@ Undeclared identifier(3): 'VK_F9'
                    if ((Key == VK_F9))
                    {
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_NEXT);
                    }
                    // (* 確定 *)
                    //@ Undeclared identifier(3): 'VK_RETURN'
                    //@ Undeclared identifier(3): 'VK_TAB'
                    //@ Undeclared identifier(3): 'VK_LEFT'
                    if ((Key == VK_RETURN) || (Key == VK_TAB) || (Key == VK_LEFT))
                    {
                        //@ Undeclared identifier(3): 'VK_LEFT'
                        // 後退
                        if ((Shift == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift}) || (Key == VK_LEFT))
                        {
                            //@ Unsupported property or method(D): 'CanFocus'
                            if (PMComboBox2.CanFocus)
                            {
                                //@ Unsupported property or method(D): 'SetFocus'
                                PMComboBox2.SetFocus;
                            }
                            // 出納帳入力（単一入力以外）
                            // (*H0038 20030904 khattori	分散入力<単一入力>*)
                            if (IsSuitouMode)
                            {
                                //@ Unsupported property or method(C): 'Enabled'
                                PMComboBox3.Enabled = false;
                            }
                        // if	(m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU	)	and
                        // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR	)	and
                        // (not IsSlipMode									)		then	PMComboBox3.Enabled:=false;
                        }
                        else
                        {
                            //@ Unsupported property or method(C): 'ItemIndex'
                            //@ Unsupported property or method(C): 'Text'
                            if ((PMComboBox3.ItemIndex >= 0) && (Rt.RChk(PMComboBox3.Text) != 2))
                            {
                                //@ Unsupported property or method(C): 'ItemIndex'
                                iNumb = PMComboBox3.ItemIndex + 1;
                                pFunc = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb);
                                rFunc = ((TMASL310IFunc)(pFunc));
                                // ファンクション情報
                                // (*H0009 20010709 khattori Ｃｏｍｂｏの動き調整*)
                                //@ Unsupported function or procedure: 'Format'
                                //@ Unsupported property or method(C): 'Caption'
                                PMPanelHdSjFst.Caption = Format("  %2d ", new int[] {iNumb}) + rFunc.sCaption;
                                PMComboBox3Select(rFunc);
                            }
                        }
                    }
                    //@ Unsupported property or method(C): 'Text'
                    PMComboBox3.Text = sText;
                }
            }
            // ME,2000 で落ちる

        }

        // ******************************************************************************
        // procedure	:	PMComboBox3KeyUp
        // ******************************************************************************
        public void PMComboBox3KeyUp(Object Sender, ref ushort Key, Keys Shift)
        {
            int iNumb;
            int iChek;
            TMASL310IFunc rFunc;
            string sText;
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 1)
            {
                // ME,2000 で落ちる
                m_bCB3KeyEnter = false;
                // //////////////////////////////////////////////////////////////////////////////////////////////////
                // 選択項目を表示する
                // 標準的な動作では２桁のＮＯが取れない為、入力と表示を別コントロールでおこなう。
                // 入力されたＮＯの項目を表示用コントロールにセットする。
                // //////////////////////////////////////////////////////////////////////////////////////////////////
                //@ Undeclared identifier(3): 'TMComboBox'
                //@ Unsupported property or method(D): 'Name'
                if (TMComboBox(Sender).Name == "PMComboBox3")
                {
                    iChek = 0;
                    //@ Unsupported property or method(C): 'Text'
                    sText = PMComboBox3.Text;
                    if (sText != "")
                    {
                        Rt.RCnm(ref sText);
                        // カンマ削除
                        // 不正文字検索
                        if ((Rt.RChk(sText) == 1) && (sText.Length > 0))
                        {
                            iNumb = Convert.ToInt32(sText);
                            //@ Unsupported property or method(C): 'Items'
                            //@ Unsupported property or method(D): 'Count'
                            // 範囲内
                            if ((iNumb <= PMComboBox3.Items.Count) && (iNumb >= 1))
                            {
                                //@ Unsupported property or method(C): 'Text'
                                PMComboBox3.Text = sText + ',';
                                //@ Unsupported property or method(C): 'Items'
                                //@ Unsupported property or method(D): 'Count'
                                if (iNumb * 10 > PMComboBox3.Items.Count)
                                {
                                    //@ Unsupported property or method(C): 'SelectAll'
                                    PMComboBox3.SelectAll;
                                }
                                else
                                {
                                    //@ Unsupported property or method(C): 'SelStart'
                                    PMComboBox3.SelStart = 1;
                                }
                                //@ Unsupported property or method(C): 'ItemIndex'
                                PMComboBox3.ItemIndex = iNumb - 1;
                                rFunc = ((TMASL310IFunc)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb)));
                                //@ Unsupported property or method(A): 'Items'
                                // 選択不可
                                if (Rt.RChk(PMComboBox3.Items[iNumb - 1]) == 2)
                                {
                                    //@ Unsupported property or method(C): 'Caption'
                                    PMPanelHdSjFst.Caption = "   - " + rFunc.sCaption;
                                }
                                else
                                {
                                    //@ Unsupported function or procedure: 'Format'
                                    //@ Unsupported property or method(C): 'Caption'
                                    PMPanelHdSjFst.Caption = Format("  %2d ", new int[] {iNumb}) + rFunc.sCaption;
                                }
                                if (rFunc.sProg != 'x')
                                {
                                    //@ Unsupported property or method(C): 'Caption'
                                    PMPanelHdSjSnd.Caption = "";
                                    //@ Unsupported property or method(C): 'Enabled'
                                    PMComboBox4.Enabled = false;
                                    //@ Unsupported property or method(C): 'Items'
                                    //@ Unsupported property or method(D): 'Clear'
                                    PMComboBox4.Items.Clear;
                                }
                                iChek = 1;
                            }
                        }
                        if (iChek == 0)
                        {
                            //@ Unsupported property or method(C): 'ItemIndex'
                            if ((Rt.RChk(sText) == 2) && (PMComboBox3.ItemIndex !=  -1))
                            {
                                //@ Unsupported property or method(C): 'ItemIndex'
                                iNumb = PMComboBox3.ItemIndex + 1;
                                rFunc = ((TMASL310IFunc)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb)));
                                // ファンクション情報
                                //@ Unsupported property or method(C): 'Caption'
                                PMPanelHdSjFst.Caption = "   - " + rFunc.sCaption;
                                //@ Unsupported property or method(C): 'Lines'
                                //@ Unsupported property or method(B): 'Add'
                                MMemo1.Lines.Add("PMComboBox3KeyUp !!! " + sText);
                            }
                            else
                            {
                                //@ Unsupported property or method(C): 'SelectAll'
                                PMComboBox3.SelectAll;
                                Console.Beep();
                            }
                        }
                    }
                }
            }
            // ME,2000 で落ちる

        }

        // ******************************************************************************
        // procedure	:	PMComboBox3Select
        // ******************************************************************************
        public void PMComboBox3Select(TMASL310IFunc rFunc)
        {
            Control cCompo;
            bool bChange;
            TMQuery pQuery;
            ushort Key;
            Keys Shift;
            TMjsMsgRec infoRec;
            int iClose;
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 1)
            {
                // ME,2000 で落ちる
                bChange = false;
                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FST_NUMB, rFunc.iNumb);
                // 第１指示の選択指示Ｎｏ
                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_FST_CODE, rFunc.iOpCode);
                // 第１指示の選択処理ｺｰﾄﾞ
                //@ Unsupported property or method(C): 'ItemIndex'
                if (m_bCB3Index != PMComboBox3.ItemIndex)
                {
                    bChange = true;
                }
                //@ Unsupported property or method(C): 'ItemIndex'
                m_bCB3Index = PMComboBox3.ItemIndex;
                // Ｚ＝作成中
                if (rFunc.sProg == 'z')
                {
                    // ''＝該当無し
                    MessageBox.Show((rFunc.iOpCode).ToString() + ' ' + rFunc.sCaption + " Now Making!!!");
                }
                else if (rFunc.sProg == "")
                {
                    // Ｘ＝第二指示有り
                    MessageBox.Show((rFunc.iOpCode).ToString() + ' ' + rFunc.sCaption + " Not Found!!!");
                }
                else if (rFunc.sProg == 'x')
                {
                    if (bChange)
                    {
                        // (*H0009 20010709 khattori Ｃｏｍｂｏの動き調整*)
                        m_bCB4Index =  -1;
                        //@ Unsupported property or method(C): 'Caption'
                        PMPanelHdSjSnd.Caption = "";
                        //@ Unsupported property or method(C): 'Enabled'
                        PMComboBox4.Enabled = false;
                        //@ Unsupported property or method(C): 'Items'
                        //@ Unsupported property or method(D): 'Clear'
                        PMComboBox4.Items.Clear;
                        //@ Unsupported property or method(C): 'Text'
                        PMComboBox4.Text = "";
                    }
                    //@ Unsupported property or method(C): 'Handle'
                    //@ Undeclared identifier(3): 'CB_SHOWDROPDOWN'
                    //@ Unsupported function or procedure: 'PostMessage'
                    PostMessage(PMComboBox3.Handle, CB_SHOWDROPDOWN, 0, 0);
                    //@ Unsupported property or method(C): 'Enabled'
                    PMComboBox4.Enabled = true;
                    gfg = true;
                    //@ Unsupported property or method(C): 'CanFocus'
                    if (PMComboBox4.CanFocus)
                    {
                        //@ Unsupported property or method(C): 'SetFocus'
                        PMComboBox4.SetFocus;
                    }
                    gfg = false;
                // Ｙ＝使用不可
                }
                else if (rFunc.sProg != 'y')
                {
                    //@ Unsupported property or method(C): 'Caption'
                    PMPanelHdSjSnd.Caption = "";
                    //@ Unsupported property or method(C): 'Enabled'
                    PMComboBox4.Enabled = false;
                    //@ Unsupported property or method(C): 'Items'
                    //@ Unsupported property or method(D): 'Clear'
                    PMComboBox4.Items.Clear;
                    gfg = true;
                    //@ Unsupported property or method(C): 'DroppedDown'
                    PMComboBox3.DroppedDown = false;
                    // 科目変更
                    if (rFunc.sProg == "ac-change")
                    {
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DEF_FUNC, null);
                        //@ Unsupported property or method(D): 'Enabled'
                        PMPanelHdRd.Enabled = true;
                        //@ Unsupported property or method(A): 'FindNextControl'
                        cCompo = this.FindNextControl(PMComboBox3, true, true, false);
                        if (cCompo.CanFocus)
                        {
                            cCompo.Focus();
                        }
                    // 定型登録　定型ＮＯへ
                    }
                    else if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                    {
                        // else if	( rFunc.iOpCode =310801 ) then
                        // else if	( rFunc.iOpCode =310801 ) or ( rFunc.iOpCode =311801 ) then
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DEF_FUNC, rFunc);
                        //@ Unsupported property or method(D): 'm_iOptionCode'
                        if ((m_pRec.m_iOptionCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
                        {
                            FxDsp(rFunc.iOpCode);
                        }
                        //@ Unsupported property or method(C): 'Enabled'
                        PMPanelHdFx.Enabled = true;
                        //@ Unsupported property or method(D): 'Color'
                        EMNumEditFx_No.Color = System.Drawing.SystemColors.Window;
                        //@ Unsupported property or method(C): 'Color'
                        MTxtFx_Name.Color = System.Drawing.SystemColors.Window;
                        //@ Unsupported property or method(D): 'SetFocus'
                        EMNumEditFx_No.SetFocus;
                    // 定型有りで入力
                    }
                    //@ Unsupported property or method(C): 'Visible'
                    else if ((PMPanelHdFx.Visible) && (rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU))
                    {
                        // else if	( PMPanelHdFx.Visible ) and ( rFunc.iOpCode=310101 )	then
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DEF_FUNC, rFunc);
                        pQuery = new TMQuery();
                        Rt.GetFxHead(pQuery);
                        // 定型仕訳ヘッダ取得
                        // 定型仕訳登録済み　定型ＮＯへ
                        //@ Unsupported property or method(D): 'RecordCount'
                        if (pQuery.RecordCount > 0)
                        {
                            //@ Unsupported property or method(D): 'm_iOptionCode'
                            if ((m_pRec.m_iOptionCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
                            {
                                FxDsp(rFunc.iOpCode);
                            }
                            //@ Unsupported property or method(C): 'Enabled'
                            PMPanelHdFx.Enabled = true;
                            //@ Unsupported property or method(D): 'Color'
                            EMNumEditFx_No.Color = System.Drawing.SystemColors.Window;
                            //@ Unsupported property or method(C): 'ParentColor'
                            MTxtFx_Name.ParentColor = true;
                            //@ Unsupported property or method(D): 'SetFocus'
                            EMNumEditFx_No.SetFocus;
                        // 定型仕訳登録無し　通常の入力へ
                        }
                        else
                        {
                            //@ Undeclared identifier(3): 'VK_RETURN'
                            Key = VK_RETURN;
                            Shift = new object[] {};
                            FxKeyDown(EMNumEditFx_No, ref Key, Shift);
                            //@ Unsupported property or method(C): 'Enabled'
                            PMPanelHdFx.Enabled = false;
                            //@ Unsupported property or method(D): 'ParentColor'
                            EMNumEditFx_No.ParentColor = true;
                            //@ Unsupported property or method(C): 'ParentColor'
                            MTxtFx_Name.ParentColor = true;
                        }
                    // 出納帳で仕訳入力関連で当該未確定
                    // (*H0038 20030904 khattori	分散入力<単一入力>*)
                    }
                    // else if (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU	)	and
                    // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR	)	and
                    // (not IsSlipMode									)	and
                    else if (IsSuitouMode && (rFunc.iBrotherCode == 310101) && (PMASLHdRd01.m_bEnable == false))
                    {
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DEF_FUNC, rFunc);
                        // 当該へ
                        //@ Unsupported property or method(D): 'Enabled'
                        PMPanelHdRd.Enabled = true;
                        //@ Unsupported property or method(A): 'FindNextControl'
                        cCompo = this.FindNextControl(PMComboBox3, true, true, false);
                        if (cCompo.CanFocus)
                        {
                            cCompo.Focus();
                        }
                    // その他（定型、当該に絡まない動作）
                    }
                    else
                    {
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DEF_FUNC, rFunc);
                        // 出納帳で仕訳入力関連　ドリルダウンパラメータセット
                        // (*H0038 20030904 khattori	分散入力<単一入力>*)
                        // if	(m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU	)	and
                        // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR	)	and
                        // (not IsSlipMode									)	and
                        if (IsSuitouMode && (rFunc.iBrotherCode == 310101))
                        {
                            PMASLHdRd01.SetDrillPar();
                        }
                        iClose = 0;
                        // ---<HIS-044>------------------------------------------------------------------
                        // 一括削除
                        if (rFunc.iOpCode == 310301)
                        {
                            iClose = m_cSwkExc.SetExc( -1);
                        }
                        // ------------------------------------------------------------------<HIS-044>---
                        if (iClose == 0)
                        {
                            Rt.DoAction(rFunc);
                        }
                        else
                        {
                            if (iClose ==  -1)
                            {
                                // '他の端末で仕訳データ更新処理が実行されているため処理できません。'
                                iClose = 8;
                            }
                            else
                            {
                                iClose = 6;
                            }
                            // '排他制御エラーが発生しました。(SetExc)';
                            //@ Unsupported property or method(D): 'm_pSystemArea'
                            //@ Undeclared identifier(3): 'TMASCom'
                            //@ Unsupported property or method(D): 'm_MsgStd'
                            //@ Unsupported property or method(B): 'GetMSG'
                            TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(infoRec, 20, iClose);
                            //@ Unsupported property or method(D): 'sMsg'
                            //@ Unsupported property or method(D): 'sTitle'
                            //@ Unsupported property or method(D): 'icontype'
                            //@ Unsupported property or method(D): 'btntype'
                            //@ Unsupported property or method(D): 'btndef'
                            //@ Unsupported property or method(D): 'LogType'
                            VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(infoRec.sMsg, infoRec.sTitle, infoRec.icontype, infoRec.btntype, infoRec.btndef, infoRec.LogType);
                        }
                    }
                    gfg = false;
                }
            }
            // ME,2000 で落ちる

        }

        // ******************************************************************************
        // Proccess	:	PMComboBox4処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // ******************************************************************************
        // ******************************************************************************
        // procedure	:	PMComboBox4Enter
        // ******************************************************************************
        public void PMComboBox4Enter(Object Sender)
        {
            // アクティヴコントロールに自分をセット
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_ACTV_CTRL, Sender);
            //@ Unsupported property or method(C): 'Items'
            //@ Unsupported property or method(D): 'Clear'
            PMComboBox4.Items.Clear;
            SetIndOnSiji(PMComboBox4, VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE);
            SetFuncOnSiji(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE);
            // (*H0018 20010926 khattori	定型仕訳排他対応*)
            m_cFixLock.iAction =  -1;
            Rt.GetFixLock(m_cFixLock);
            DisableComponent();
            // 伝票入力
            if (IsSlipMode && (Itm.m_iDefaultFunc >  -1))
            {
                //@ Unsupported property or method(C): 'ItemIndex'
                PMComboBox4.ItemIndex = Itm.m_iDefaultFunc - 1;
                Itm.m_iDefaultFunc =  -1;
            }
            else
            {
                // この辺かな？
                // (*H0009 20010709 khattori Ｃｏｍｂｏの動き調整*)
                if (m_bCB4Index >= 0)
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    PMComboBox4.ItemIndex = m_bCB4Index;
                }
                if (m_bCB4Index < 0)
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    PMComboBox4.ItemIndex = 0;
                }
            // if PMComboBox4.ItemIndex <0	then	PMComboBox4.ItemIndex:=0;
            }
            //@ Unsupported property or method(C): 'SelectAll'
            PMComboBox4.SelectAll;
            // (*H0007	20010628 khattori 初期処理中に他のアプリケーションを表示された時*)
            // １回目でない？
            if (gfirst)
            {
                //@ Unsupported property or method(C): 'Handle'
                //@ Undeclared identifier(3): 'CB_SHOWDROPDOWN'
                //@ Unsupported function or procedure: 'PostMessage'
                PostMessage(PMComboBox4.Handle, CB_SHOWDROPDOWN, 1, 0);
            }
            //@ Unsupported property or method(C): 'Color'
            PMPanelSelMonth.Color = System.Drawing.SystemColors.Window;
            //@ Unsupported property or method(C): 'Color'
            PMPanelHdSjFst.Color = System.Drawing.SystemColors.Window;
            //@ Unsupported property or method(D): 'm_pCommonArea'
            //@ Unsupported property or method(C): 'Color'
            PMPanelHdSjSnd.Color = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).SysFocusColor;
        }

        // ******************************************************************************
        // Proccess	:	PMComboBox4Exit
        // ******************************************************************************
        public void PMComboBox4Exit(Object Sender)
        {
            //@ Unsupported property or method(C): 'Color'
            PMPanelHdSjSnd.Color = System.Drawing.SystemColors.Window;
            // ---<HIS-049> KeyDown でフォーカス移動すると KeyUp が発生しない----------------
            m_bCB4KeyEnter = false;
            // ------------------------------------------------------------------<HIS-049>---

        }

        // ******************************************************************************
        // procedure	:	PMComboBox4Click
        // ******************************************************************************
        public void PMComboBox4Click(Object Sender)
        {
            int iNumb;
            TMASL310IFunc rFunc;
            object pFunc;
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 2)
            {
                // ME,2000 で落ちる
                if (!m_bCB4KeyEnter)
                {
                    //@ Unsupported property or method(C): 'ItemIndex'
                    //@ Unsupported property or method(C): 'Text'
                    if ((PMComboBox4.ItemIndex >= 0) && (Rt.RChk(PMComboBox4.Text) != 2))
                    {
                        //@ Unsupported property or method(C): 'ItemIndex'
                        iNumb = PMComboBox4.ItemIndex + 1;
                        pFunc = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb);
                        rFunc = ((TMASL310IFunc)(pFunc));
                        // ファンクション情報
                        PMComboBox4Select(rFunc);
                    }
                }
            }
            // ME,2000 で落ちる

        }

        // ******************************************************************************
        // procedure	:	PMComboBox4Change
        // 選択項目を表示する
        // 標準的な動作では２桁のＮＯが取れない為、入力と表示を別コントロールでおこなう。
        // 入力されたＮＯの項目を表示用コントロールにセットする。
        // ******************************************************************************
        public void PMComboBox4Change(Object Sender)
        {
            // ME,2000 で落ちる
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 2)
            {
                //@ Unsupported property or method(C): 'SelectAll'
                PMComboBox4.SelectAll;
                m_bCB4KeyEnter = false;
            }
            // ME,2000 で落ちる

        }

        // ******************************************************************************
        // procedure	:	PMComboBox4KeyDown
        // ******************************************************************************
        public void PMComboBox4KeyDown(Object Sender, ref ushort Key, Keys Shift)
        {
            string sText;
            Control cCompo;
            int iNumb;
            TMASL310IFunc rFunc;
            object pFunc;
            // ME,2000 で落ちる
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 2)
            {
                // (*H0009 20010709 khattori Ｃｏｍｂｏの動き調整*)
                m_bCB4KeyEnter = true;
                //@ Undeclared identifier(3): 'VK_ESCAPE'
                //@ Undeclared identifier(3): 'VK_END'
                if ((Key == VK_ESCAPE) || (Key == VK_END))
                {
                    EscKeyKeyDown(Sender, Key);
                }
                else
                {
                    // m_bCB4KeyEnter	:=	true;
                    //@ Unsupported property or method(C): 'Text'
                    sText = PMComboBox4.Text;
                    // (* ファンクションキー *)
                    //@ Undeclared identifier(3): 'VK_F1'
                    //@ Undeclared identifier(3): 'VK_F8'
                    if ((Key >= VK_F1) && (Key <= VK_F8))
                    {
                        //@ Undeclared identifier(3): 'VK_F1'
                        iNumb = Key - VK_F1 + 1;
                        pFunc = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb);
                        //@ Unsupported property or method(A): 'Items'
                        // 処理が割り当てられていないファンクション
                        if ((pFunc == null) || (Rt.RChk(PMComboBox4.Items[iNumb - 1]) == 2))
                        {
                            Console.Beep();
                        }
                        else
                        {
                            rFunc = ((TMASL310IFunc)(pFunc));
                            // ファンクション情報
                            //@ Unsupported function or procedure: 'Format'
                            //@ Unsupported property or method(C): 'Caption'
                            PMPanelHdSjSnd.Caption = Format("  %2d ", new int[] {iNumb}) + rFunc.sCaption;
                            //@ Unsupported property or method(C): 'ItemIndex'
                            PMComboBox4.ItemIndex = iNumb - 1;
                            //@ Unsupported property or method(C): 'Text'
                            PMComboBox4.Text = (iNumb).ToString() + ',';
                            //@ Unsupported property or method(C): 'Text'
                            sText = PMComboBox4.Text;
                            //@ Unsupported property or method(C): 'SelectAll'
                            PMComboBox4.SelectAll;
                            PMComboBox4Select(rFunc);
                        }
                    }
                    // (* トグリ *)
                    //@ Undeclared identifier(3): 'VK_F9'
                    if ((Key == VK_F9))
                    {
                        Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_NEXT);
                    }
                    // (* 確定 *)
                    //@ Undeclared identifier(3): 'VK_RETURN'
                    //@ Undeclared identifier(3): 'VK_TAB'
                    //@ Undeclared identifier(3): 'VK_LEFT'
                    if ((Key == VK_RETURN) || (Key == VK_TAB) || (Key == VK_LEFT))
                    {
                        //@ Undeclared identifier(3): 'VK_LEFT'
                        if ((Shift == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift}) || (Key == VK_LEFT))
                        {
                            //@ Unsupported property or method(A): 'FindNextControl'
                            cCompo = this.FindNextControl(((Sender) as Control), false, true, false);
                            if (cCompo.CanFocus)
                            {
                                cCompo.Focus();
                            }
                        }
                        else
                        {
                            //@ Unsupported property or method(C): 'ItemIndex'
                            //@ Unsupported property or method(C): 'Text'
                            if ((PMComboBox4.ItemIndex >= 0) && (Rt.RChk(PMComboBox4.Text) != 2))
                            {
                                //@ Unsupported property or method(C): 'ItemIndex'
                                iNumb = PMComboBox4.ItemIndex + 1;
                                pFunc = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb);
                                rFunc = ((TMASL310IFunc)(pFunc));
                                // ファンクション情報
                                PMComboBox4Select(rFunc);
                            }
                        }
                    }
                    //@ Unsupported property or method(C): 'Text'
                    PMComboBox4.Text = sText;
                }
            }
            // ME,2000 で落ちる

        }

        // ******************************************************************************
        // procedure	:	PMComboBox4KeyUp
        // ******************************************************************************
        public void PMComboBox4KeyUp(Object Sender, ref ushort Key, Keys Shift)
        {
            int iNumb;
            int iChek;
            TMASL310IFunc rFunc;
            string sText;
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 2)
            {
                // ME,2000 で落ちる
                m_bCB4KeyEnter = false;
                // //////////////////////////////////////////////////////////////////////////////////////////////////
                // 選択項目を表示する
                // 標準的な動作では２桁のＮＯが取れない為、入力と表示を別コントロールでおこなう。
                // 入力されたＮＯの項目を表示用コントロールにセットする。
                // //////////////////////////////////////////////////////////////////////////////////////////////////
                //@ Undeclared identifier(3): 'TMComboBox'
                //@ Unsupported property or method(D): 'Name'
                if (TMComboBox(Sender).Name == "PMComboBox4")
                {
                    iChek = 0;
                    //@ Unsupported property or method(C): 'Text'
                    sText = PMComboBox4.Text;
                    if (sText != "")
                    {
                        Rt.RCnm(ref sText);
                        // カンマ削除
                        // 不正文字検索
                        if ((Rt.RChk(sText) == 1) && (sText.Length > 0))
                        {
                            iNumb = Convert.ToInt32(sText);
                            //@ Unsupported property or method(C): 'Items'
                            //@ Unsupported property or method(D): 'Count'
                            // 範囲内
                            if ((iNumb <= PMComboBox4.Items.Count) && (iNumb >= 1))
                            {
                                //@ Unsupported property or method(C): 'Text'
                                PMComboBox4.Text = sText + ',';
                                //@ Unsupported property or method(C): 'Items'
                                //@ Unsupported property or method(D): 'Count'
                                if (iNumb * 10 > PMComboBox4.Items.Count)
                                {
                                    //@ Unsupported property or method(C): 'SelectAll'
                                    PMComboBox4.SelectAll;
                                }
                                else
                                {
                                    //@ Unsupported property or method(C): 'SelStart'
                                    PMComboBox4.SelStart = 1;
                                }
                                //@ Unsupported property or method(C): 'ItemIndex'
                                PMComboBox4.ItemIndex = iNumb - 1;
                                rFunc = ((TMASL310IFunc)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb)));
                                //@ Unsupported property or method(A): 'Items'
                                // 選択不可
                                if (Rt.RChk(PMComboBox4.Items[iNumb - 1]) == 2)
                                {
                                    // +' d'
                                    //@ Unsupported property or method(C): 'Caption'
                                    PMPanelHdSjSnd.Caption = "   - " + rFunc.sCaption;
                                }
                                else
                                {
                                    //@ Unsupported function or procedure: 'Format'
                                    //@ Unsupported property or method(C): 'Caption'
                                    PMPanelHdSjSnd.Caption = Format("  %2d ", new int[] {iNumb}) + rFunc.sCaption;
                                }
                                iChek = 1;
                            }
                        }
                        if (iChek == 0)
                        {
                            //@ Unsupported property or method(C): 'ItemIndex'
                            if ((Rt.RChk(sText) == 2) && (PMComboBox4.ItemIndex !=  -1))
                            {
                                //@ Unsupported property or method(C): 'ItemIndex'
                                iNumb = PMComboBox4.ItemIndex + 1;
                                rFunc = ((TMASL310IFunc)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM, iNumb)));
                                // ファンクション情報
                                //@ Unsupported property or method(C): 'Caption'
                                PMPanelHdSjSnd.Caption = "   - " + rFunc.sCaption;
                                // ;+' e';
                                //@ Unsupported property or method(C): 'Lines'
                                //@ Unsupported property or method(B): 'Add'
                                MMemo1.Lines.Add("PMComboBox4KeyUp !!! " + sText);
                            }
                            else
                            {
                                //@ Unsupported property or method(C): 'SelectAll'
                                PMComboBox4.SelectAll;
                                Console.Beep();
                            }
                        }
                    }
                }
            }
            // ME,2000 で落ちる

        }

        // (*H0048 20050516 khattori	操作ガイド番号通知*)
        // ******************************************************************************
        // Function	:	fnHelpIndexSet												<HELP>
        // ******************************************************************************
        public void PMComboBox4Select_fnHelpIndexSet()
        {
            TAppParam AppPara;
            rcHELPINFO rcHLP;
            // ＡＬUのみ動作
#if _WANTYPE_NEW_
            rcHLP.Code1 = rFunc.iOpCode;
            rcHLP.Code2 = 0;
            AppPara.iAction = Units.MAS310000u.ACTID_HELPINDEXSET;
            AppPara.pRecord = (m_pRec as object);
            AppPara.pActionParam = rcHLP;
            ((m_pRec) as TMjsAppRecord).m_pOwnerEntry(AppPara);
#endif

        }

        // ******************************************************************************
        // procedure	:	PMComboBox4Select
        // ******************************************************************************
        public void PMComboBox4Select(TMASL310IFunc rFunc)
        {
            string sText;
            int iNumb;
            TMQuery pQuery;
            ushort Key;
            Keys Shift;
            if (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER) == 2)
            {
                // ME,2000 で落ちる
                //@ Unsupported property or method(C): 'ItemIndex'
                m_bCB4Index = PMComboBox4.ItemIndex;
                //@ Unsupported property or method(C): 'Text'
                sText = PMComboBox4.Text;
                Rt.RCnm(ref sText);
                // カンマ削除	20001023
                //@ Unsupported property or method(C): 'ItemIndex'
                iNumb = PMComboBox4.ItemIndex;
                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_SND_NUMB, rFunc.iNumb);
                // 第２指示の選択処理Ｎｏ
                gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_SND_CODE, rFunc.iOpCode);
                // 第２指示の選択処理ｺｰﾄﾞ
                if (rFunc.sProg == 'z')
                {
                    MessageBox.Show((rFunc.iOpCode).ToString() + ' ' + rFunc.sCaption + " Now Making!!!");
                }
                else if (rFunc.sProg == "")
                {
                    MessageBox.Show((rFunc.iOpCode).ToString() + ' ' + rFunc.sCaption + " Not Found!!!");
                }
                else if (rFunc.sProg != 'y')
                {
                    // gfg:=true;
                    // (*Ver.x*)
                    // (*H0026 20020111 khattori	第２指示もセットする。*)
                    Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DEF_FUNC, rFunc);
                    //@ Unsupported property or method(C): 'DroppedDown'
                    PMComboBox4.DroppedDown = false;
                    // 定型登録　定型ＮＯへ
                    if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                    {
                        //@ Unsupported property or method(D): 'm_iOptionCode'
                        if ((m_pRec.m_iOptionCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
                        {
                            FxDsp(rFunc.iOpCode);
                        }
                        //@ Unsupported property or method(C): 'Enabled'
                        PMPanelHdFx.Enabled = true;
                        //@ Unsupported property or method(D): 'Color'
                        EMNumEditFx_No.Color = System.Drawing.SystemColors.Window;
                        //@ Unsupported property or method(C): 'Color'
                        MTxtFx_Name.Color = System.Drawing.SystemColors.Window;
                        //@ Unsupported property or method(D): 'SetFocus'
                        EMNumEditFx_No.SetFocus;
                    // 定型有りで入力
                    }
                    //@ Unsupported property or method(C): 'Visible'
                    else if ((PMPanelHdFx.Visible) && (rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU))
                    {
                        pQuery = new TMQuery();
                        Rt.GetFxHead(pQuery);
                        // 定型仕訳ヘッダ取得
                        // 定型仕訳登録済み　定型ＮＯへ
                        //@ Unsupported property or method(D): 'RecordCount'
                        if (pQuery.RecordCount > 0)
                        {
                            //@ Unsupported property or method(D): 'm_iOptionCode'
                            if ((m_pRec.m_iOptionCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
                            {
                                FxDsp(rFunc.iOpCode);
                            }
                            //@ Unsupported property or method(C): 'Enabled'
                            PMPanelHdFx.Enabled = true;
                            //@ Unsupported property or method(D): 'Color'
                            EMNumEditFx_No.Color = System.Drawing.SystemColors.Window;
                            //@ Unsupported property or method(C): 'ParentColor'
                            MTxtFx_Name.ParentColor = true;
                            //@ Unsupported property or method(D): 'SetFocus'
                            EMNumEditFx_No.SetFocus;
                        // 定型仕訳登録無し　通常の入力へ
                        }
                        else
                        {
                            //@ Undeclared identifier(3): 'VK_RETURN'
                            Key = VK_RETURN;
                            Shift = new object[] {};
                            FxKeyDown(EMNumEditFx_No, ref Key, Shift);
                            //@ Unsupported property or method(C): 'Enabled'
                            PMPanelHdFx.Enabled = false;
                            //@ Unsupported property or method(D): 'ParentColor'
                            EMNumEditFx_No.ParentColor = true;
                            //@ Unsupported property or method(C): 'ParentColor'
                            MTxtFx_Name.ParentColor = true;
                        }
                    }
                    else
                    {
                        Rt.DoAction(rFunc);
                    }
                // gfg:=false;
                }
                //@ Unsupported property or method(C): 'ItemIndex'
                PMComboBox4.ItemIndex = iNumb;
                //@ Unsupported property or method(C): 'Text'
                PMComboBox4.Text = sText + ',';
                // PMComboBox4.Refresh;
                //@ Unsupported function or procedure: 'Format'
                //@ Unsupported property or method(C): 'Caption'
                PMPanelHdSjSnd.Caption = Format("  %2d ", new int[] {iNumb + 1}) + rFunc.sCaption;
                // (*H0048 20050516 khattori	操作ガイド番号通知*)
                PMComboBox4Select_fnHelpIndexSet();
            }
            // ME,2000 で落ちる

        }

        // 選択ウィンドウカバー関数
        // (*H0021 20010928 khattori	更新確認のＣａｎｃｅｌボタン*)
        // ******************************************************************************
        // Proccess	:	EscKeyKeyDown
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Sender: TObject
        // Return		:	Nothing
        // ******************************************************************************
        // (*H0021 20010928 khattori	更新確認のＣａｎｃｅｌボタン*)
        public virtual ushort EscKeyKeyDown(Object Sender, ushort Key)
        {
            ushort result;
            TMjsMsgRec inforec;
            int iBalance;
            enTblList tlTblList;
            object pQuery;
            TMASL310IDrill cDrill;
            int idx;
            // メニューからの終了要求
            //@ Undeclared identifier(3): 'VK_F4'
            //@ Undeclared identifier(3): 'VK_MENU'
            if (Key == (VK_F4 + VK_MENU))
            {
                result = System.Windows.Forms.DialogResult.Yes;
            }
            else
            {
                if ((Sender.GetType().FullName == "TMComboBox") && (((Sender) as ComboBox).DroppedDown == true))
                {
                    // (*Ver A122 M101*)
                    // (*H0026 20020328 khattori	エスケープキーでドロップダウンを閉じる*)
                    //@ Undeclared identifier(3): 'VK_ESCAPE'
                    //@ Undeclared identifier(3): 'VK_END'
                    if ((Key == VK_ESCAPE) || (Key == VK_END))
                    {
                        ((Sender) as ComboBox).DroppedDown = false;
                    }
                    // if	Key=VK_END	then	TComboBox(Sender).DroppedDown:=false;
                    return result;
                }
                iBalance = 0;
                // 出納帳以外でバランスエラー有り？
                //@ Unsupported property or method(C): 'Value'
                //@ Unsupported property or method(C): 'Font'
                //@ Unsupported property or method(D): 'Color'
                // (*H0038 20030904 khattori	分散入力<単一入力>*)
                if (((EMNumEditBalance.Value != 0) || (EMNumEditBalance.Font.Color == System.Drawing.Color.Red)) && !IsSuitouMode)
                {
                    // (m_pRec^.m_iProgramCode=MASL_PROC_CODE_TAXITU)			then
                    tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
                    pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                    if (pQuery != null)
                    {
                        //@ Undeclared identifier(3): 'TMQuery'
                        //@ Unsupported property or method(B): 'Locate'
                        if ((TMQuery(pQuery).Locate("RecKbn", 2, new object[] {})) == true)
                        {
                            //@ Undeclared identifier(3): 'TMQuery'
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            iBalance = TMQuery(pQuery).GetFld("GnPuKbn9").AsInteger;
                        }
                    }
                }
                if ((iBalance == 1))
                {
                    // バランスエラーが起きています。よろしいですか？
                    //@ Unsupported property or method(D): 'm_pSystemArea'
                    //@ Undeclared identifier(3): 'TMASCom'
                    //@ Unsupported property or method(D): 'm_MsgStd'
                    //@ Unsupported property or method(B): 'GetMSG'
                    TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(inforec, 20, 4);
                    //@ Unsupported property or method(D): 'sMsg'
                    //@ Unsupported property or method(D): 'sTitle'
                    //@ Unsupported property or method(D): 'icontype'
                    //@ Unsupported property or method(D): 'btntype'
                    //@ Unsupported property or method(D): 'btndef'
                    result = VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef);
                }
                else
                {
                    // 仕訳入力を終了します。\nよろしいですか？
                    //@ Unsupported property or method(D): 'm_pSystemArea'
                    //@ Undeclared identifier(3): 'TMASCom'
                    //@ Unsupported property or method(D): 'm_MsgStd'
                    //@ Unsupported property or method(B): 'GetMSG'
                    TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(inforec, 20, 5);
                    // (*H0012 20010730 tyamaguchi 終了処理メッセージ変更(出納帳用作成)*)
                    // (*Ver A123 M103*)
                    // (*H0032 20020501 khattori	終了処理メッセージ変更(手形用作成)*)
                    //@ Unsupported property or method(D): 'm_iOptionCode'
                    if ((m_pRec.m_iOptionCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
                    {
                        //@ Unsupported property or method(D): 'm_pSystemArea'
                        //@ Undeclared identifier(3): 'TMASCom'
                        //@ Unsupported property or method(D): 'sMsg'
                        // 単一入力
                        // (*H0038 20030904 khattori	分散入力<単一入力>*)
                        //@ Unsupported property or method(D): 'm_MsgStd'
                        //@ Unsupported property or method(B): 'MsgChange'
                        //@ Unsupported property or method(D): 'sMsg'
                        inforec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "@_@", "手形入力");
                    }
                    else if (IsBaseMode)
                    {
                        // else if	(m_pRec^.m_iProgramCode=MASL_PROC_CODE_TAXITU)	or
                        // if	(m_pRec^.m_iProgramCode=MASL_PROC_CODE_TAXITU)	or
                        // (m_pRec^.m_iProgramCode=MASL_PROC_CODE_MONTHR)	then
                        //@ Unsupported property or method(D): 'm_pSystemArea'
                        //@ Undeclared identifier(3): 'TMASCom'
                        //@ Unsupported property or method(D): 'sMsg'
                        // 伝票入力
                        //@ Unsupported property or method(D): 'm_MsgStd'
                        //@ Unsupported property or method(B): 'MsgChange'
                        //@ Unsupported property or method(D): 'sMsg'
                        inforec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "@_@", "仕訳入力");
                    }
                    else if (IsSlipMode)
                    {
                        //@ Unsupported property or method(D): 'm_pSystemArea'
                        //@ Undeclared identifier(3): 'TMASCom'
                        //@ Unsupported property or method(D): 'sMsg'
                        // 出納帳
                        //@ Unsupported property or method(D): 'm_MsgStd'
                        //@ Unsupported property or method(B): 'MsgChange'
                        //@ Unsupported property or method(D): 'sMsg'
                        inforec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "@_@", "伝票入力");
                    }
                    else
                    {
                        //@ Unsupported property or method(D): 'm_pSystemArea'
                        //@ Undeclared identifier(3): 'TMASCom'
                        //@ Unsupported property or method(D): 'sMsg'
                        //@ Unsupported property or method(D): 'm_MsgStd'
                        //@ Unsupported property or method(B): 'MsgChange'
                        //@ Unsupported property or method(D): 'sMsg'
                        inforec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "@_@", "出納帳入力");
                    }
                    //@ Unsupported property or method(D): 'sMsg'
                    //@ Unsupported property or method(D): 'sTitle'
                    //@ Unsupported property or method(D): 'icontype'
                    //@ Unsupported property or method(D): 'btntype'
                    //@ Unsupported property or method(D): 'btndef'
                    result = VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef);
                }
            }
            // 仕訳更新を実行してＦｏｒｍを閉じる。
            // 定型仕訳の更新でキャンセルされたときはＡｂｏｒｔされる為、Ｆｏｒｍは閉じない。
            if (result == System.Windows.Forms.DialogResult.Yes)
            {
                for (idx = 1; idx <= Rt.BplList.Count; idx ++ )
                {
                    cDrill = ((TMASL310IDrill)(Rt.GetDrillParam(idx)));
                    if (cDrill.Mine.bCall)
                    {
                        if (cDrill.Mine.TCall == System.Windows.Forms.DialogResult.Cancel)
                        {
                            result = System.Windows.Forms.DialogResult.Cancel;
                            // 仕訳更新
                            return result;
                        }
                    }
                }
                this.Close();
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	:	BMSpBtnExitClick
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Sender: TObject
        // Return		:	Nothing
        // ******************************************************************************
        public void BMSpBtnExitClick(Object Sender)
        {
            // ---<HIS-017> Alt+X が微妙に動きが違うのでPostする(Alt押下のせい？) -----------
            //@ Unsupported function or procedure: 'PostMessage'
            PostMessage(this.Handle, Units.MAS310000u.WM_TERM, (int)this, 0);
            // EscKeyKeyDown(Sender);
            // ------------------------------------------------------------------<HIS-017>---

        }

        // ******************************************************************************
        // Proccess	:	BMSpBtnChangeClick
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Sender: TObject
        // Return		:	Nothing
        // ******************************************************************************
        public void BMSpBtnChangeClick(Object Sender)
        {
            TAppParam AppPrm;
            // (*H0045 20050303 khattori	項目修正*)
            bool bChange;
            //@ Unsupported property or method(C): 'Enabled'
            if (BMSpBtnChange.Enabled == true)
            {
                // (*H0045 20050303 khattori	項目修正*)
                bChange = true;
                Rt.Bfnc(VKZ310Cmnu.enBfunc.MASL_BGET_CHG_OWNER, bChange);
                // (*H0048 20050516 khattori	操作ガイド番号通知*)
                // ---<HIS-019> 復活 (これをしないと埋込がおかしくなる)--------------------------
                //@ Unsupported property or method(C): 'Visible'
                PMPanelAll.Visible = false;
                // ------------------------------------------------------------------<HIS-019>---
                this.Visible = false;
                // (*H0045 20050303 khattori	項目修正*)
                bChange = false;
                Rt.Bfnc(VKZ310Cmnu.enBfunc.MASL_BGET_CHG_OWNER, bChange);
                if (this.Parent == null)
                {
                    // (*	---->	H0045	下に移動 (2005/02/10)
                    // // 10/24 New
                    // AppPrm.iAction			:=	ACTID_DOCKINGINEND;
                    // AppPrm.pRecord			:=	Pointer(m_pRec);
                    // AppPrm.pActionParam		:=	nil;
                    // TMjsAppRecord(m_pRec^).m_pOwnerEntry(@AppPrm);
                    // //	---->	H0045	下に移動 (2005/02/10)	*)
                    //@ Unsupported property or method(D): 'm_pOwnerPanel'
                    if (m_pRec.m_pOwnerPanel == null)
                    {
                        //@ Unsupported property or method(D): 'm_pOwnerForm'
                        this.Parent = ((m_pRec.m_pOwnerForm) as Form);
                    }
                    else
                    {
                        //@ Unsupported property or method(D): 'm_pOwnerPanel'
                        this.Parent = ((m_pRec.m_pOwnerPanel) as Panel);
                    }
                    this.Dock = System.Windows.Forms.DockStyle.Fill;
                    this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.None;
                    this.StartPosition = System.Windows.Forms.FormStartPosition.WindowsDefaultLocation;
                    //@ Unsupported property or method(C): 'Caption'
                    BMSpBtnChange.Caption = "切出(&G)";
                    // ---->	H0045	上から移動 (2005/02/10)
                    AppPrm.iAction = Units.MAS310000u.ACTID_DOCKINGINEND;
                    AppPrm.pRecord = (m_pRec as object);
                    AppPrm.pActionParam = null;
                    ((m_pRec) as TMjsAppRecord).m_pOwnerEntry(AppPrm);
                // ---->	H0045	上から移動 (2005/02/10)
                }
                else
                {
                    // (*	---->	H0045	下に移動 (2005/02/10)
                    // // 10/24 New
                    // AppPrm.iAction			:=	ACTID_DOCKINGOUTEND;
                    // AppPrm.pRecord			:=	Pointer(m_pRec);
                    // AppPrm.pActionParam		:=	nil;
                    // TMjsAppRecord(m_pRec^).m_pOwnerEntry(@AppPrm);
                    // //	---->	H0045	下に移動 (2005/02/10)	*)
                    this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.Sizable;
                    this.Dock = System.Windows.Forms.DockStyle.None;
                    this.Parent = null;
                    this.StartPosition = System.Windows.Forms.FormStartPosition.WindowsDefaultLocation;
                    // ↓<H0046>
                    // ClientWidth				:=	945;
                    // ClientHeight			:=	622;
                    //@ Undeclared identifier(3): 'GetZoomRatio'
                    //@ Unsupported property or method(C): 'ClientWidth'
                    this.ClientWidth = Convert.ToInt64(945 * GetZoomRatio((m_pRec as object)) / 100);
                    //@ Undeclared identifier(3): 'GetZoomRatio'
                    //@ Unsupported property or method(C): 'ClientHeight'
                    this.ClientHeight = Convert.ToInt64(622 * GetZoomRatio((m_pRec as object)) / 100);
                    // ---<HIS-022> 削除 <HIS-015> ここでもセットしないと効かないらしい--------------
                    // PMPanelAll.Constraints.MinWidth		:= PMPanelAll.ClientWidth;
                    // ---------------------------------------------------------<HIS-022><HIS-015>---
                    // ↑
                    //@ Unsupported property or method(C): 'Caption'
                    BMSpBtnChange.Caption = "埋込(&G)";
                    // ---->	H0045	上から移動 (2005/02/10)
                    //@ Unsupported property or method(D): 'iAction'
                    AppPrm.iAction = Units.MAS310000u.ACTID_DOCKINGOUTEND;
                    //@ Unsupported property or method(D): 'pRecord'
                    AppPrm.pRecord = (m_pRec as object);
                    //@ Unsupported property or method(D): 'pActionParam'
                    AppPrm.pActionParam = null;
                    ((m_pRec) as TMjsAppRecord).m_pOwnerEntry(AppPrm);
                // ---->	H0045	上から移動 (2005/02/10)
                }
                //@ Unsupported property or method(D): 'Items'
                //@ Unsupported property or method(D): 'Clear'
                PMComboBox2.Items.Clear;
                SetIndOnSelMonth();
                //@ Unsupported property or method(D): 'Items'
                //@ Unsupported property or method(D): 'Clear'
                PMComboBox3.Items.Clear;
                SetIndOnSiji(PMComboBox3, VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_CODE);
                //@ Unsupported property or method(C): 'Items'
                //@ Unsupported property or method(D): 'Clear'
                PMComboBox4.Items.Clear;
                SetIndOnSiji(PMComboBox4, VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE);
                //@ Unsupported property or method(C): 'Visible'
                PMPanelAll.Visible = true;
                this.Visible = true;
            }
        }

        // ******************************************************************************
        // Proccess	:	BMSpBtnMonthFix(月固定／月可変)処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Sender: TObject
        // Return		:	Nothing
        // ******************************************************************************
        public void BMSpBtnMonthFixClick(Object Sender)
        {
            Sm.Kotei = 1 - Sm.Kotei;
            SetCaptionBtnFix();
            // (*♪♪♪♪♪　Ｓｐｅｃｉａｌ　！！！　*)
            if (Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_ACTV_CTRL) == PMComboBox2)
            {
                SetFuncOnSelMonth();
            }
        }

        // ******************************************************************************
        // Proccess	:	BMSpBtnShowBalanceClick(バランス表示)処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Sender: TObject
        // Return		:	Nothing
        // ******************************************************************************
        public void BMSpBtnShowBalanceClick(Object Sender)
        {
            TMASL310IFunc rFunc;
            rFunc = Itm.ReadIniRec(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BALANCE);
            Rt.DoAction(rFunc);
        }

        // ------------------------------------------------------------------<HIS-017>---
        // ---<HIS-001>------------------------------------------------------------------
        // ---<HIS-001>------------------------------------------------------------------
        // ******************************************************************************
        // Component : SubPrg ( TSubPrgBtn )
        // Event     : OnItemClick
        // Parameter : idx				Integer			MASL_PROC_CODE_xxxx
        // Comment	  :	サブプログラム の MenuItem を クリックした時に発生
        // ******************************************************************************
        protected void SubMenuClick(int idx)
        {
            TMASL310IFunc rFunc;
            // 月が選択されていなかったら先頭の月を選択する(開始してすぐクリックされたケース)
            //@ Unsupported property or method(C): 'Caption'
            if (PMPanelSelMonth.Caption == "")
            {
                PMComboBox2Change(PMComboBox2);
            }
            rFunc = Itm.ReadIniRec(idx);
            // あれば実行(ダミーとしてないケースがある)
            if (rFunc.iOpCode == idx)
            {
                Rt.DoAction(rFunc);
            }
        }

        // ------------------------------------------------------------------<HIS-001>---
        // ---<HIS-006>------------------------------------------------------------------
        // ------------------------------------------------------------------<HIS-001>---
        // ---<HIS-006>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	サブプログラムの採用を設定する
        // Parameter : None
        // Return    : None
        // ******************************************************************************
        protected void SetSubPrgUse()
        {
            // **************//
            // 非表示設定  //
            // **************//
            // ---<HIS-033>------------------------------------------------------------------
            // 事務所以外(顧問先、FAS)は非表示
            // 出納帳、伝票入力、分散入力は非表示
            if (!Is_JIMUSYO() || !IsBaseMode || IsBunsanMode)
            {
                // if not Is_JIMUSYO or IsBunsanMode then
                // ------------------------------------------------------------------<HIS-033>---
                // ---<HIS-063>------------------------------------------------------------------
                SubPrg.SetAllItemVisible(false);
                // SubPrg.ItemVisible[MASL_PROC_CODE_EXCEL]			:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_DATA_YAYOI02]		:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_DATA_YAYOI05]		:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_DATA_KANJYO]		:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_DATA_PCA]			:= False;
                // //---<HIS-059>------------------------------------------------------------------
                // SubPrg.ItemVisible[MASL_PROC_CODE_DATA_PCA09]		:= False;
                // //------------------------------------------------------------------<HIS-059>---
                // SubPrg.ItemVisible[MASL_PROC_CODE_DATA_KAIKEIOU]	:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_DATA_IBEX]		:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_KANTAN]			:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_HOUJIN_EXPORT]	:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_HOUJIN_IMPORT]	:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_KAIKEI_EXPORT]	:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_KAIKEI_IMPORT]	:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_ZAIMU_EXPORT]		:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_ZAIMU_IMPORT]		:= False;
                // //---<HIS-016>------------------------------------------------------------------
                // SubPrg.ItemVisible[MASL_PROC_CODE_VK_EXPORT]		:= False;
                // SubPrg.ItemVisible[MASL_PROC_CODE_VK_IMPORT]		:= False;
                // //------------------------------------------------------------------<HIS-016>---
                // ------------------------------------------------------------------<HIS-063>---
                return;
            // オフライン
            }
            else if (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE)
            {
            // ---<HIS-032> オフライン対応---------------------------------------------------
            // SubPrg.ItemVisible[MASL_PROC_CODE_KAIKEI_EXPORT]	:= False;			//	iCompass会計/会計太郎　差分データ送信
            // SubPrg.ItemVisible[MASL_PROC_CODE_KAIKEI_IMPORT]	:= False;			//	iCompass会計/会計太郎　差分データ受信
            // SubPrg.ItemVisible[MASL_PROC_CODE_ZAIMU_EXPORT]		:= False;			//	ＣＥ会計　差分データ送信
            // SubPrg.ItemVisible[MASL_PROC_CODE_ZAIMU_IMPORT]		:= False;			//	ＣＥ会計　差分データ受信
            // //---<HIS-016>------------------------------------------------------------------
            // SubPrg.ItemVisible[MASL_PROC_CODE_VK_EXPORT]		:= False;			//	記帳くん　差分データ送信
            // SubPrg.ItemVisible[MASL_PROC_CODE_VK_IMPORT]		:= False;			//	記帳くん　差分データ受信
            // //------------------------------------------------------------------<HIS-016>---
            // ------------------------------------------------------------------<HIS-032>---
            }
            // ************//
            // 採用設定  //
            // ************//
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_EXCEL] = m_cSubUse.IsUseExcel();
            // Excel取込
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_YAYOI02] = m_cSubUse.IsUseYayoi02();
            // 弥生会計02-04
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_YAYOI05] = m_cSubUse.IsUseYayoi05();
            // 弥生会計05-
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_KANJYO] = m_cSubUse.IsUseKanjyo();
            // 勘定奉行
            // ---<HIS-064>------------------------------------------------------------------
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_KANJYOi] = m_cSubUse.IsUseKanjyoi();
            // 勘定奉行i
            // ------------------------------------------------------------------<HIS-064>---
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_PCA] = m_cSubUse.IsUsePca();
            // PCA会計
            // ---<HIS-059>------------------------------------------------------------------
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_PCA09] = m_cSubUse.IsUsePca09();
            // PCA会計9 V2
            // ------------------------------------------------------------------<HIS-059>---
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_KAIKEIOU] = m_cSubUse.IsUseKaikeiou();
            // 会計王
            // ---<HIS-064>------------------------------------------------------------------
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_KAIKEIOU11] = m_cSubUse.IsUseKaikeiou11();
            // 会計王11
            // ------------------------------------------------------------------<HIS-064>---
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_DATA_IBEX] = m_cSubUse.IsUseIbex();
            // JDL IBEX出納帳
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KANTAN] = m_cSubUse.IsUseKantan();
            // ミロクのかんたん！会計
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_HOUJIN_EXPORT] = m_cSubUse.IsUseHoujin();
            // ミロク法人会計　データ抽出処理
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_HOUJIN_IMPORT] = m_cSubUse.IsUseHoujin();
            // ミロク法人会計　データ受入処理
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KAIKEI_EXPORT] = m_cSubUse.IsUseKaikei();
            // iCompass会計/会計太郎　差分データ送信
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KAIKEI_IMPORT] = m_cSubUse.IsUseKaikei();
            // iCompass会計/会計太郎　差分データ受信
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_ZAIMU_EXPORT] = m_cSubUse.IsUseZaimu();
            // ＣＥ会計　差分データ送信
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_ZAIMU_IMPORT] = m_cSubUse.IsUseZaimu();
            // ＣＥ会計　差分データ受信
            // ---<HIS-016>------------------------------------------------------------------
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_VK_EXPORT] = m_cSubUse.IsUseVK();
            // 記帳くん　差分データ送信
            SubPrg.ItemUse[VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_VK_IMPORT] = m_cSubUse.IsUseVK();
            // 記帳くん　差分データ受信
            // ------------------------------------------------------------------<HIS-016>---

        }

        // ------------------------------------------------------------------<HIS-006>---
        // ******************************************************************************
        // Proccess	:	PMPanel(for ComboBox)処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Sender: TObject
        // Return		:	Nothing
        // ******************************************************************************
        public void PMPanelSelMonthClick(Object Sender)
        {
            //@ Unsupported property or method(D): 'CanFocus'
            if (PMComboBox2.CanFocus)
            {
                //@ Unsupported property or method(D): 'SetFocus'
                PMComboBox2.SetFocus;
            }
        }

        public void PMPanelHdSjFstClick(Object Sender)
        {
            //@ Unsupported property or method(D): 'CanFocus'
            if (PMComboBox3.CanFocus)
            {
                //@ Unsupported property or method(D): 'SetFocus'
                PMComboBox3.SetFocus;
            }
        }

        public void PMPanelHdSjSndClick(Object Sender)
        {
            //@ Unsupported property or method(C): 'CanFocus'
            if (PMComboBox4.CanFocus)
            {
                //@ Unsupported property or method(C): 'SetFocus'
                PMComboBox4.SetFocus;
            }
        }

        // ******************************************************************************
        // Component	:	Form
        // Event		:	InitSelMonth
        // Name		:	K.Hattori(MJS)
        // ******************************************************************************
        public virtual void InitSelMonth()
        {
            enTblList tlTblList;
            object pQuery;
            //@ Unsupported property or method(D): 'Items'
            //@ Unsupported property or method(D): 'Count'
            if (PMComboBox2.Items.Count == 0)
            {
                tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_DTMAIN;
                pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                if (pQuery != null)
                {
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    Sm.WaSei = TMQuery(pQuery).GetFld("YearKbn").AsInteger;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    Sm.EntStr = TMQuery(pQuery).GetFld("strmonth").AsInteger;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsDateTime'
                    //@ Unsupported function or procedure: 'FormatDateTime'
                    Sm.TrmStr = Convert.ToInt32(FormatDateTime("yyyymmdd", TMQuery(pQuery).GetFld("kstdate").AsDateTime));
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsDateTime'
                    //@ Unsupported function or procedure: 'FormatDateTime'
                    Sm.TrmEnd = Convert.ToInt32(FormatDateTime("yyyymmdd", TMQuery(pQuery).GetFld("keddate").AsDateTime));
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    Sm.Gettyuu = TMQuery(pQuery).GetFld("mstday").AsInteger;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    Sm.Kessan = TMQuery(pQuery).GetFld("middlekbn").AsInteger;
                }
                // (*♪♪♪*)
                // (*Ver.x*)
                // (*H0024	20011217 khattori	手形入力*)
                if (!Is_FASMODE())
                {
                    Sm.Init(PMComboBox2, m_cMDModule);
                }
                else
                {
                    Sm.Init();
                }
            }
        }

        // ******************************************************************************
        // Component	:	Form
        // Event		:	SetIndOnSelMonth
        // Name		:	K.Hattori(MJS)
        // ******************************************************************************
        protected void SetIndOnSelMonth()
        {
            int idx1;
            string sMonth;
            // if PMComboBox2.Items.Count=0then
            //@ Unsupported property or method(D): 'Items'
            //@ Unsupported property or method(D): 'Count'
            if (PMComboBox2.Items.Count == 0)
            {
                //@ Unsupported property or method(D): 'Items'
                //@ Unsupported property or method(D): 'Clear'
                PMComboBox2.Items.Clear;
                for (idx1 = 0; idx1 < Sm.Count; idx1 ++ )
                {
                    sMonth = ((TMASL310IMonth)(Sm[idx1])).sSelMonth + ",\"" + ((TMASL310IMonth)(Sm[idx1])).sViewFix + "\",\"" + ((TMASL310IMonth)(Sm[idx1])).sViewNext + "\",\"" + ((TMASL310IMonth)(Sm[idx1])).sViewMonth + "\",\"　　　" + ((TMASL310IMonth)(Sm[idx1])).sViewTerm + '\"';
                    //@ Unsupported property or method(D): 'Items'
                    //@ Unsupported property or method(B): 'Add'
                    PMComboBox2.Items.Add(sMonth);
                }
                ((PMComboBox2) as ComboBox).MaxLength = 4;
            }
        }

        // ******************************************************************************
        // Proccess	:	SetCaptionBtnFix(月固定／月可変)処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Sender: TObject
        // Return		:	Nothing
        // ******************************************************************************
        protected void SetCaptionBtnFix(int iEnabled)
        {
            bool bKotei;
            bKotei = true;
            // 出納帳入力以外
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            if (!IsSuitouMode)
            {
                // if	(m_pRec^.m_iProgramCode=MASL_PROC_CODE_TAXITU	)	or
                // (IsSlipMode										)	then
                // ドリルダウン以外　＆　当期
                if ((g_pDrill == null))
                {
                    // ---<HIS-052>------------------------------------------------------------------
                    if ((Sm.CurMonth.iInner != 0))
                    {
                        // if	(Sm.CurMonth.iInner<>0) and (Sm.CurMonth.iInner<40)	then	bKotei	:=	false
                        // ------------------------------------------------------------------<HIS-052>---
                        bKotei = false;
                    }
                // ドリルダウン　＆　月範囲指定
                }
                else if ((((TMASL310IDrill)(g_pDrill)).ToCld.Imnt[0] != ((TMASL310IDrill)(g_pDrill)).ToCld.Imnt[1]))
                {
                    // sm.Kotei:=	1;
                    bKotei = false;
                }
            }
            // 月固定
            if (bKotei)
            {
                //@ Unsupported property or method(C): 'Caption'
                BMSpBtnMonthFix.Caption = Units.MAS310000u.arStr[0];
                //@ Unsupported property or method(C): 'Enabled'
                PMPanelHdMonthFix.Enabled = false;
            }
            else
            {
                //@ Unsupported property or method(C): 'Caption'
                BMSpBtnMonthFix.Caption = Units.MAS310000u.arStr[Sm.Kotei];
                if (iEnabled == 0)
                {
                    //@ Unsupported property or method(C): 'Enabled'
                    PMPanelHdMonthFix.Enabled = true;
                }
                // (*H0035 20030825 khattori	MJSLINK <-> ACELINK 統一*)
                // (*H0037 20030827 khattori	ＡＣＥＬＩＮＫ＜−＞ＭＪＳＬＩＮＫ統合*)
                // if	not ((Is_ZAIMU)or(Is_SITEN))	then
                //@ Unsupported property or method(C): 'Enabled'
                if (PMPanelHdMonthFix.Enabled)
                {
                    //@ Unsupported property or method(C): 'Caption'
                    //@ Unsupported property or method(C): 'Caption'
                    BMSpBtnMonthFix.Caption = BMSpBtnMonthFix.Caption + "(&K)";
                }
            }
        }

        // ******************************************************************************
        // Component	:	Form
        // Event		:	SetFuncOnSelMonth
        // Name		:	K.Hattori(MJS)
        // ******************************************************************************
        protected void SetFuncOnSelMonth()
        {
            int iOwner;
            int iPage;
            TMASL310IFunc prFunc;
            // ファンクションセット
            ArrayList cList;
            cList = new ArrayList();
            // (* 月固定/月可変 *)
            // 出納帳入力以外	＆	当期
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            // if	((m_pRec^.m_iProgramCode=MASL_PROC_CODE_TAXITU)	or	(IsSlipMode)) and
            if (!IsSuitouMode && (Sm.CurMonth.iInner != 0) && (Sm.CurMonth.iInner < 40))
            {
                prFunc = new TMASL310IFunc();
                prFunc.sCaption = Units.MAS310000u.arStr[1 - Sm.Kotei];
                prFunc.bEnabled = true;
                cList.Add(prFunc);
            // ファンクションセット
            }
            else
            {
                cList.Add(null);
            }
            iPage = 0;
            iOwner = 1;
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_ITEMS, cList, iOwner);
            // ファンクション一括セット（セットのみ）
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_PAGE, iPage);
            // ファンクション頁セット
            cList.Clear();
            //@ Unsupported property or method(C): 'Free'
            cList.Free;
        }

        // ******************************************************************************
        // Component	:	Form
        // Event		:	SetIndOnSiji
        // Name		:	K.Hattori(MJS)
        // ******************************************************************************
        protected void SetIndOnSiji(Object Sender, enIfunc iFunc)
        {
            int iIndex;
            int iNumb;
            string sIndex;
            int iCode;
            TMASL310IFunc rFunc;
            int iHassei;
            int iSearch;
            enTblList tlTblList;
            object pQuery;
            int iNotUpdateKbn;
            if (((Sender) as ComboBox).Items.Count == 0)
            {
                ((Sender) as ComboBox).Items.Clear();
                iCode = gMASL310RootIf(iFunc);
                iHassei = 0;
                tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_DTMAIN;
                pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                if (pQuery != null)
                {
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iHassei = TMQuery(pQuery).GetFld("DataKbn").AsInteger;
                }
                iIndex = 1;
                iNumb = 1;
                iSearch = 1;
                // ０でなければよい
                while (true)
                {
                    rFunc = Itm.ReadIniRec(iCode, iIndex);
                    if (rFunc.iOpCode <= 0)
                    {
                        break;
                    }
                    // ドリルダウン専用を除く
                    if (rFunc.iLevl != 400)
                    {
                        //@ Unsupported function or procedure: 'Format'
                        sIndex = Format("%d", new int[] {iNumb});
                        // ///////////////////////////////////////////////
                        // ランク外
                        if (rFunc.sProg == 'y')
                        {
                            sIndex = '-';
                        }
                        // ///////////////////////////////////////////////
                        if (((rFunc.iMode == 1) && (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_CHANGEABLE, Sm.CurMonth.iInner, iHassei) != (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_OK))) || (((rFunc.iMode == 2) || (rFunc.iMode == 4) || (rFunc.iMode == 6)) && (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_CHANGEABLE, Sm.CurMonth.iInner, iHassei, iSearch) != (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_OK))) || ((Sm.CurMonth.iInner == 0) && ((rFunc.iStyl == 1) || (rFunc.iMode == 12) || (rFunc.iMode == 13))))
                        {
                            sIndex = '-';
                        }
                        // (*H0013 20010731 tyamaguchi 修正／削除区分対応*)
                        iNotUpdateKbn = 0;
                        tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
                        pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                        if (pQuery != null)
                        {
                            //@ Undeclared identifier(3): 'TMQuery'
                            //@ Unsupported property or method(B): 'Locate'
                            if ((TMQuery(pQuery).Locate("RecKbn", 2, new object[] {})) == true)
                            {
                                //@ Undeclared identifier(3): 'TMQuery'
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                iNotUpdateKbn = TMQuery(pQuery).GetFld("GnPuKbn19").AsInteger;
                            }
                        }
                        if ((new ArrayList(new int[] {2, 4}).Contains(rFunc.iMode)) && (iNotUpdateKbn == 1))
                        {
                            sIndex = '-';
                        }
                        ((Sender) as ComboBox).Items.Add(sIndex + ',' + rFunc.sCaption);
                        iNumb ++;
                    }
                    iIndex = iIndex + 1;
                }
                ((Sender) as ComboBox).MaxLength = 3;
            }
        }

        // ******************************************************************************
        // Component	:	Form
        // Event		:	SetFuncOnSiji
        // Name		:	K.Hattori(MJS)
        // ******************************************************************************
        protected void SetFuncOnSiji(enIfunc iFunc)
        {
            ArrayList cList;
            int iIndex;
            int iCode;
            TMASL310IFunc rFunc;
            TMASL310IFunc prFunc;
            // ファンクションセット
            int iHassei;
            int iSearch;
            enTblList tlTblList;
            object pQuery;
            int iOwner;
            int iPage;
            int iNotUpdateKbn;
            cList = new ArrayList();
            iHassei = 0;
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_DTMAIN;
            pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
            if (pQuery != null)
            {
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                iHassei = TMQuery(pQuery).GetFld("DataKbn").AsInteger;
            }
            iCode = gMASL310RootIf(iFunc);
            iIndex = 1;
            // (*♪♪♪♪♪*)
            iSearch = 1;
            // ０でなければよい
            while (true)
            {
                rFunc = Itm.ReadIniRec(iCode, iIndex);
                if (rFunc.iOpCode <= 0)
                {
                    break;
                }
                // ドリルダウン専用を除く
                if (rFunc.iLevl != 400)
                {
                    // ///////////////////////////////////////////////
                    // ランク外
                    if (rFunc.sProg == 'y')
                    {
                        rFunc.bEnabled = false;
                    }
                    // ///////////////////////////////////////////////
                    // (* 指示ファンクション *)
                    if (((rFunc.iMode == 1) && (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_CHANGEABLE, Sm.CurMonth.iInner, iHassei) != (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_OK))) || (((rFunc.iMode == 2) || (rFunc.iMode == 4) || (rFunc.iMode == 6)) && (Rt.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_CHANGEABLE, Sm.CurMonth.iInner, iHassei, iSearch) != (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_OK))) || ((Sm.CurMonth.iInner == 0) && ((rFunc.iStyl == 1) || (rFunc.iMode == 12) || (rFunc.iMode == 13))))
                    {
                        rFunc.bEnabled = false;
                    }
                    // (*H0013 20010731 tyamaguchi 修正／削除区分対応*)
                    iNotUpdateKbn = 0;
                    tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
                    pQuery = Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                    if (pQuery != null)
                    {
                        //@ Undeclared identifier(3): 'TMQuery'
                        //@ Unsupported property or method(B): 'Locate'
                        if ((TMQuery(pQuery).Locate("RecKbn", 2, new object[] {})) == true)
                        {
                            //@ Undeclared identifier(3): 'TMQuery'
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            iNotUpdateKbn = TMQuery(pQuery).GetFld("GnPuKbn19").AsInteger;
                        }
                    }
                    if ((new ArrayList(new int[] {2, 4}).Contains(rFunc.iMode)) && (iNotUpdateKbn == 1))
                    {
                        rFunc.bEnabled = false;
                    }
                    prFunc = new TMASL310IFunc();
                    prFunc = rFunc;
                    cList.Add(prFunc);
                }
                iIndex = iIndex + 1;
            }
            iPage = 0;
            if (iFunc == VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_CODE)
            {
                iOwner = 1;
            }
            else
            {
                iOwner = 2;
            }
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_ITEMS, cList, iOwner);
            Rt.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_PAGE, iPage);
            cList.Clear();
            //@ Unsupported property or method(C): 'Free'
            cList.Free;
        }

        // procedure	EscKeyKeyDown(Sender: TObject; const Key: Word=0);
        protected void WMOnPaint(ref TMessage Msg)
        {
            int iMessageId;
            TMjsMsgRec inforec;
            // ---<HIS-034>------------------------------------------------------------------
            if (this.Parent == null)
            {
                this.Dock = System.Windows.Forms.DockStyle.None;
            }
            else
            {
                this.Dock = System.Windows.Forms.DockStyle.Fill;
            }
            // ------------------------------------------------------------------<HIS-034>---
            // 出納帳入力（単一入力以外）
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            if (IsSuitouMode)
            {
                // if	(m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU	)	and
                // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR	)	and
                // (not IsSlipMode									)		then
                //@ Unsupported property or method(C): 'Visible'
                BMSpBtnShowBalance.Visible = false;
            }
            if (m_iExclusive != 0)
            {
                iMessageId = m_iExclusive;
                if (m_iExclusive > 7000)
                {
                    iMessageId = 8;
                }
                //@ Unsupported property or method(D): 'm_pSystemArea'
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMSG'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(inforec, 20, iMessageId);
                if (m_iExclusive == 7001)
                {
                    //@ Unsupported property or method(D): 'sMsg'
                    inforec.sMsg = "仕訳最大端末数に達したため処理できません。";
                }
                if (m_iExclusive == 7002)
                {
                    //@ Unsupported property or method(D): 'sMsg'
                    inforec.sMsg = "他の端末で仕訳単独処理が実行中のため処理できません。";
                }
                if (m_iExclusive == 7003)
                {
                    //@ Unsupported property or method(D): 'sMsg'
                    inforec.sMsg = "伝票情報が登録されていない為、処理できません。";
                }
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef);
                this.Close();
                return;
            }
            // (*H0013 20030609 khattori 合併採用区分＝１の時、Ｗｉｎ９８でチェックされない*)
            if (m_FixKbn16 == 1)
            {
                //@ Unsupported property or method(D): 'm_pSystemArea'
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMsg'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMsg(inforec, 20, 9);
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                //@ Unsupported property or method(D): 'LogType'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef, inforec.LogType);
                this.Close();
                return;
            }
            // (*H0034 20030611 khattori	分散入力*)
            // 分散入力採用区分
            if ((m_BunKbn01 == 0) && IsBunsanMode)
            {
                //@ Unsupported property or method(D): 'm_pSystemArea'
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMsg'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMsg(inforec, 20, 9);
                Console.Beep();
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                //@ Unsupported property or method(D): 'LogType'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("分散入力が採用されていません。", inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef, inforec.LogType);
                // with infoRec do	MjsMessageBoxEx(sMsg,sTitle,icontype,btntype,btndef,LogType);
                this.Close();
                return;
            }
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            // iTanGCode:=rcCOMMONAREA( m_pRec^.m_pCommonArea^ ).TantoGCD;
            // 分散単一入力時、担当者管理必須
            //@ Unsupported property or method(D): 'm_pCommonArea'
            if (IsBaseMode && IsBunsanMode && (((m_pRec.m_pCommonArea) as rcCOMMONAREA).TantoNCD ==  -1))
            {
                //@ Unsupported property or method(D): 'm_pSystemArea'
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMsg'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMsg(inforec, 20, 9);
                Console.Beep();
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                //@ Unsupported property or method(D): 'LogType'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("担当者管理が採用されていません。", inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef, inforec.LogType);
                // with infoRec do	MjsMessageBoxEx(sMsg,sTitle,icontype,btntype,btndef,LogType);
                this.Close();
                return;
            }
        }

        // ---<HIS-019>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	CM_DIALOGCHAR
        // Parameter : Msg			TCMDialogChar	(= TWMKey)
        // Return    : None
        // Comment	  :	ﾆｰﾓﾆｯｸ (&x) の制御をする	MJSBtnVisible の代替処理
        // History	  : <HIS-019>
        // ******************************************************************************
        protected void CMDialogChar(ref TCMDialogChar Msg)
        {
            // ｱｸﾃｨﾌﾞでない場合(裏に隠れているなど)は無効
            //@ Unsupported property or method(C): 'ActiveControl'
            //@ Unsupported property or method(A): 'ContainsControl'
            if (this.ContainsControl(Screen.PrimaryScreen.ActiveControl))
            {
                base.CMDialogChar();
            }
        }

        // ------------------------------------------------------------------<HIS-019>---
        // ---<HIS-017>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	終了処理
        // Parameter : Msg.WParam		TObject			Sender ｺﾝﾎﾟｰﾈﾝﾝﾄ
        // Return    : None
        // History	  :	<HIS-017>
        // ******************************************************************************
        protected void WMTerm(ref TMessage Msg)
        {
            //@ Unsupported property or method(C): 'WParam'
            EscKeyKeyDown(((Msg.WParam) as Object));
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 日常処理共通関数
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 戻り値なし
        protected void gMASL310RootVf(enVfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            switch(enPar)
            {
                case VKZ310Cmnu.enVfunc.MASL_VSET_FCS_FSIJI:
                    if ((g_pDrill != null) && (Rt.m_pDrillLevel == 1))
                    {
                        // (*H0005	20010604 khattori Ａｌｔ＋ｘの時、ドリルダウンの修正フラグが渡らない*)
                        this.Close();
                        new Exception("Abort");
                    }
                    // 仕訳単独開放
                    // ---<HIS-044><HIS-050>---------------------------------------------------------
                    if ((m_cSwkExc != null))
                    {
                        m_cSwkExc.SetExc( -2);
                    }
                    break;
            // ---------------------------------------------------------<HIS-044><HIS-050>---
            }
            Rt.Vfnc(enPar, pPar1, pPar2, pPar3);
        }

        protected void gMASL310RootVf(enVfunc enPar)
        {
            gMASL310RootVf(enPar, null);
        }

        protected void gMASL310RootVf(enVfunc enPar, object pPar1)
        {
            gMASL310RootVf(enPar, pPar1, null);
        }

        protected void gMASL310RootVf(enVfunc enPar, object pPar1, object pPar2)
        {
            gMASL310RootVf(enPar, pPar1, pPar2, null);
        }

        // 戻り値なし
        // 戻り値Pointer型
        protected object gMASL310RootPf(enPfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            object result;
            try {
                result = Rt.Pfnc(enPar, pPar1, pPar2, pPar3);
            }
            catch {
                Rt.LogWrite("TMAS310000f.gMASL310RootPf で例外発生！");
            }
            return result;
        }

        protected object gMASL310RootPf(enPfunc enPar)
        {
            return gMASL310RootPf(enPar, null);
        }

        protected object gMASL310RootPf(enPfunc enPar, object pPar1)
        {
            return gMASL310RootPf(enPar, pPar1, null);
        }

        protected object gMASL310RootPf(enPfunc enPar, object pPar1, object pPar2)
        {
            return gMASL310RootPf(enPar, pPar1, pPar2, null);
        }

        // 〃　Pointer型
        // 戻り値Boolean型
        protected bool gMASL310RootBf(enBfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            bool result;
            try {
                result = Rt.Bfnc(enPar, pPar1, pPar2, pPar3);
            }
            catch {
                Rt.LogWrite("TMAS310000f.gMASL310RootBf で例外発生！");
            }
            return result;
        }

        protected bool gMASL310RootBf(enBfunc enPar)
        {
            return gMASL310RootBf(enPar, null);
        }

        protected bool gMASL310RootBf(enBfunc enPar, object pPar1)
        {
            return gMASL310RootBf(enPar, pPar1, null);
        }

        protected bool gMASL310RootBf(enBfunc enPar, object pPar1, object pPar2)
        {
            return gMASL310RootBf(enPar, pPar1, pPar2, null);
        }

        // 〃　Boolean型
        // 戻り値Integer型
        protected int gMASL310RootIf(enIfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            int result;
            try {
                result = Rt.Ifnc(enPar, pPar1, pPar2, pPar3);
            }
            catch {
                Rt.LogWrite("TMAS310000f.gMASL310RootIf で例外発生！");
            }
            return result;
        }

        protected int gMASL310RootIf(enIfunc enPar)
        {
            return gMASL310RootIf(enPar, null);
        }

        protected int gMASL310RootIf(enIfunc enPar, object pPar1)
        {
            return gMASL310RootIf(enPar, pPar1, null);
        }

        protected int gMASL310RootIf(enIfunc enPar, object pPar1, object pPar2)
        {
            return gMASL310RootIf(enPar, pPar1, pPar2, null);
        }

        // 〃　Integer型
        // 戻り値String型
        protected string gMASL310RootSf(enSfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            string result;
            try {
                result = Rt.Sfnc(enPar, pPar1, pPar2, pPar3);
            }
            catch {
                Rt.LogWrite("TMAS310000f.gMASL310RootSf で例外発生！");
            }
            return result;
        }

        protected string gMASL310RootSf(enSfunc enPar)
        {
            return gMASL310RootSf(enPar, null);
        }

        protected string gMASL310RootSf(enSfunc enPar, object pPar1)
        {
            return gMASL310RootSf(enPar, pPar1, null);
        }

        protected string gMASL310RootSf(enSfunc enPar, object pPar1, object pPar2)
        {
            return gMASL310RootSf(enPar, pPar1, pPar2, null);
        }

        // 〃　String型
        // 選択ウィンドウカバー関数
        protected object gMASL310RootWf(enWfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            object result;
            try {
                result = Rt.Wfnc(enPar, pPar1, pPar2, pPar3);
            }
            catch {
                Rt.LogWrite("TMAS310000f.gMASL310RootWf で例外発生！");
            }
            return result;
        }

        protected object gMASL310RootWf(enWfunc enPar)
        {
            return gMASL310RootWf(enPar, null);
        }

        protected object gMASL310RootWf(enWfunc enPar, object pPar1)
        {
            return gMASL310RootWf(enPar, pPar1, null);
        }

        protected object gMASL310RootWf(enWfunc enPar, object pPar1, object pPar2)
        {
            return gMASL310RootWf(enPar, pPar1, pPar2, null);
        }

        // ------------------------------------------------------------------<HIS-006>---
        // //////////////////////////////////////////
        // テスト用ボタン制御部
        // ******************************************************************************
        // MakeDevPanel
        // ******************************************************************************
        protected void MakeDevPanel()
        {
            int idx;
            TMSpeedButton Btn;
            TMNumEdit Num;
            TMTxtEdit Txt;
            for (idx = 0; idx <= 19; idx ++ )
            {
                Btn = new TMSpeedButton(PMPanelDev);
                //@ Unsupported property or method(C): 'Parent'
                Btn.Parent = PMPanelDev;
                //@ Unsupported property or method(C): 'Tag'
                Btn.Tag = idx + 1;
                //@ Unsupported property or method(C): 'Left'
                Btn.Left = 14 + (idx % 5) * 80;
                //@ Unsupported property or method(C): 'Top'
                Btn.Top = 14 + (idx / 5) * 20;
                //@ Unsupported property or method(C): 'Width'
                Btn.Width = 80;
                //@ Unsupported property or method(C): 'Height'
                Btn.Height = 20;
                //@ Unsupported property or method(C): 'Caption'
                Btn.Caption = (idx + 1).ToString();
                //@ Unsupported property or method(C): 'OnClick'
                Btn.OnClick = BMSpBtnDevxxClick;
                //@ Unsupported property or method(C): 'Flat'
                Btn.Flat = true;
                gcrCont[idx] = ((Btn) as Control);
                Num = new TMNumEdit(PMPanelDev);
                //@ Unsupported property or method(C): 'Parent'
                Num.Parent = PMPanelDev;
                //@ Unsupported property or method(C): 'Left'
                Num.Left = 14 + (idx % 5) * 80;
                //@ Unsupported property or method(C): 'Top'
                Num.Top = 104 + (idx / 5) * 20;
                //@ Unsupported property or method(C): 'Width'
                Num.Width = 80;
                //@ Unsupported property or method(C): 'Height'
                Num.Height = 20;
                //@ Unsupported property or method(C): 'TabStop'
                Num.TabStop = false;
                gcrCont[idx + 20] = ((Num) as Control);
                Txt = new TMTxtEdit(PMPanelDev);
                //@ Unsupported property or method(C): 'Parent'
                Txt.Parent = PMPanelDev;
                //@ Unsupported property or method(C): 'Left'
                Txt.Left = 14 + (idx % 5) * 80;
                //@ Unsupported property or method(C): 'Top'
                Txt.Top = 194 + (idx / 5) * 20;
                //@ Unsupported property or method(C): 'Width'
                Txt.Width = 80;
                //@ Unsupported property or method(C): 'Height'
                Txt.Height = 20;
                //@ Unsupported property or method(C): 'TabStop'
                Txt.TabStop = false;
                gcrCont[idx + 40] = ((Txt) as Control);
            }
        }

        // ******************************************************************************
        // Proccess	:	BMSpBtnDevxxClick
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Sender
        // Return		:	Nothing
        // ******************************************************************************
        public void BMSpBtnDevxxClick(Object Sender)
        {
            TMQuery m_FdqInfo;
            TMQuery m_FdqInfo2;
            TMjsMsgRec infoRec;
            TMASKoekiSet m_KoekiSet;
            string sText;
            int iIndex;
            int iWork;
            int[] irAcc = new int[1 + 1];
            enTblList tlTblList;
            object pQuery;
            TMASL310IDrParam pParam;
            //@ Undeclared identifier(3): 'TMSpeedButton'
            //@ Unsupported property or method(D): 'Tag'
            switch(TMSpeedButton(Sender).Tag)
            {
                case 1:
                    if (MessageBox.Show("drop optimizer ok?", Application.ProductName, System.Windows.Forms.MessageBoxButtons.YesNo| System.Windows.Forms.MessageBoxButtons.YesNo, System.Windows.Forms.MessageBoxIcon.Question) == System.Windows.Forms.DialogResult.Yes)
                    {
                        m_FdqInfo = new TMQuery();
                        m_FdqInfo = new TMQuery(this);
                        //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                        m_cMDModule.SetDBInfoToQuery(m_FCopDBMas, m_FdqInfo);
                        this.Close();
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(D): 'Clear'
                        m_FdqInfo.SQL.Clear;
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("drop optimizer statistics;");
                        //@ Unsupported property or method(D): 'Open'
                        m_FdqInfo.Open;
                    }
                    break;
                case 2:
                    break;
                case 3:
                    break;
                case 4:
                    break;
                case 5:
                    break;
                case 6:
                    break;
                case 7:
                    break;
                case 8:
                    break;
                case 9:
                    //@ Undeclared identifier(3): 'TMNumEdit'
                    //@ Unsupported property or method(D): 'value'
                    iWork = Convert.ToInt64(TMNumEdit(gcrCont[23]).value);
                    gMASL310RootVf(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_KIND, iWork);
                    break;
                case 10:
                    //@ Undeclared identifier(3): 'TMNumEdit'
                    //@ Unsupported property or method(D): 'value'
                    TMNumEdit(gcrCont[20]).value = g_miSystemCode;
                    //@ Undeclared identifier(3): 'TMNumEdit'
                    //@ Unsupported property or method(D): 'value'
                    TMNumEdit(gcrCont[21]).value = ((TMASL310IFunc)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DEF_FUNC))).iOpCode;
                    //@ Undeclared identifier(3): 'TMNumEdit'
                    //@ Unsupported property or method(D): 'value'
                    TMNumEdit(gcrCont[22]).value = ((TMASL310IFunc)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DEF_FUNC))).iMode;
                    //@ Undeclared identifier(3): 'TMNumEdit'
                    //@ Unsupported property or method(D): 'value'
                    TMNumEdit(gcrCont[23]).value = gMASL310RootIf(VKZ310Cmnu.enIfunc.MASL_IGET_PROC_KIND);
                    //@ Undeclared identifier(3): 'TMNumEdit'
                    //@ Unsupported property or method(D): 'value'
                    TMNumEdit(gcrCont[24]).value = 777;
                    //@ Undeclared identifier(3): 'TMTxtEdit'
                    //@ Unsupported property or method(D): 'text'
                    TMTxtEdit(gcrCont[42]).text = ((TMASL310IFunc)(Rt.Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DEF_FUNC))).sCaption;
                    //@ Undeclared identifier(3): 'TMTxtEdit'
                    //@ Unsupported property or method(D): 'text'
                    TMTxtEdit(gcrCont[43]).text = "777";
                    break;
                case 11:
                    break;
                case 12:
                    break;
                case 13:
                    break;
                case 14:
                    break;
                case 15:
                    break;
                case 16:
                    break;
                case 17:
                    break;
                case 18:
                    break;
                case 19:
                    break;
                case 20:
                    //@ Unsupported property or method(C): 'Left'
                    //@ Unsupported property or method(C): 'Left'
                    PMPanelSelMonth.Left = 438 - PMPanelSelMonth.Left;
                    //@ Unsupported property or method(C): 'Left'
                    //@ Unsupported property or method(C): 'Left'
                    PMPanelHdSjFst.Left = 94 - PMPanelHdSjFst.Left;
                    //@ Unsupported property or method(C): 'Width'
                    //@ Unsupported property or method(C): 'Width'
                    PMPanelHdSjFst.Width = 198 - PMPanelHdSjFst.Width;
                    //@ Unsupported property or method(C): 'Left'
                    //@ Unsupported property or method(C): 'Left'
                    PMPanelHdSjSnd.Left = 358 - PMPanelHdSjSnd.Left;
                    //@ Unsupported property or method(C): 'Width'
                    //@ Unsupported property or method(C): 'Width'
                    PMPanelHdSjSnd.Width = 198 - PMPanelHdSjSnd.Width;
                    break;
            }
        }

        public void Timer1Timer(System.Object Sender, System.EventArgs _e1)
        {
            // (*H0007	20010628 khattori 初期処理中に他のアプリケーションを表示された時*)
            Timer1.Enabled = false;
            // １回目＆ＭＪＳデスクトップがアクティブ＆ドリルダウンでない？
            //@ Unsupported property or method(C): 'Active'
            if ((gfirst == false) && Application.Active && (g_pDrill == null))
            {
                //@ Unsupported property or method(C): 'ActiveControl'
                //@ Unsupported property or method(C): 'ActiveControl'
                //@ Unsupported property or method(C): 'ActiveControl'
                if ((Screen.PrimaryScreen.ActiveControl == PMComboBox2) || (Screen.PrimaryScreen.ActiveControl == PMComboBox3) || (Screen.PrimaryScreen.ActiveControl == PMComboBox4))
                {
                    //@ Unsupported property or method(C): 'ActiveControl'
                    //@ Undeclared identifier(3): 'TMComboBox'
                    //@ Unsupported property or method(D): 'DroppedDown'
                    if (!TMComboBox(Screen.PrimaryScreen.ActiveControl).DroppedDown)
                    {
                        //@ Unsupported property or method(C): 'ActiveControl'
                        //@ Undeclared identifier(3): 'TMComboBox'
                        //@ Unsupported property or method(D): 'DroppedDown'
                        TMComboBox(Screen.PrimaryScreen.ActiveControl).DroppedDown = true;
                    }
                }
            }
            gfirst = true;
        }

        public void MIxxClick(System.Object Sender, System.EventArgs _e1)
        {
            //@ Unsupported property or method(C): 'ImageIndex'
            TMBtnFusen.ImageIndex = ((Sender) as MenuItem).ImageIndex;
            // 下１桁目：ユーザー選択付箋　下２桁目：ｶﾚﾝﾄの付箋区分　それ以上：ｶﾚﾝﾄｺﾝﾎﾟｰﾈﾝﾄのTag
            // ユーザー選択付箋のセット
            //@ Unsupported property or method(C): 'ImageIndex'
            TMBtnFusen.Tag = TMBtnFusen.Tag / 10 * 10 + ((Sender) as MenuItem).ImageIndex;
        }

        // ******************************************************************************
        // Proccess	:	DisableComponent
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/08/21
        // Parameter	:	Nothing
        // Return		:	Nothing
        // ******************************************************************************
        protected void DisableComponent()
        {
            TMBtnFusen.Enabled = false;
            TMBtnOpen.Enabled = false;
            //@ Unsupported property or method(C): 'Down'
            TMBtnOpen.Down = false;
            // (*H0047 20050418 khattori	一括置換*)
            TMBtnLump.Enabled = false;
        }

        // **************************************************************************
        // Component  :   MFurigana ( TMFurigana )
        // フリガナコンポーネント
        // Event      :   CompositionStr
        // Name       :   T.Yamaguchi
        // **************************************************************************
        public void MFuriganaCompositionStr(Object Sender, string Value)
        {
            FxFurigana(Value);
        }

        // ------------------------------------------------------------------<HIS-020>---
        // ******************************************************************************
        // Proccess	:	入力制御
        // ******************************************************************************
        public virtual bool IsBaseMode(int iPrgCode)
        {
            bool result;
            int iCode;
            bool bBase;
            iCode = iPrgCode;
            if (iCode == 0)
            {
                //@ Unsupported property or method(D): 'm_iProgramCode'
                iCode = m_pRec.m_iProgramCode;
            }
            bBase = false;
            switch(iCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU_BUN:
                    // (*H0038 20030904 khattori	分散入力<単一入力>*)
                    bBase = true;
                    break;
            // MASL_PROC_CODE_MONTHR:		bBase	:=	true;
            }
            result = bBase;
            return result;
        }

        // 入力制御
        // (*H0038 20030904 khattori	分散入力<単一入力>*)
        // (*H0038 20030904 khattori	分散入力<単一入力>*)
        // ******************************************************************************
        // Proccess	:	出納帳
        // ******************************************************************************
        public virtual bool IsSuitouMode(int iPrgCode)
        {
            bool result;
            int iCode;
            bool bBase;
            iCode = iPrgCode;
            if (iCode == 0)
            {
                //@ Unsupported property or method(D): 'm_iProgramCode'
                iCode = m_pRec.m_iProgramCode;
            }
            bBase = false;
            // (*H0038 20030904 khattori	分散入力<単一入力>*)
            // if	(m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU		)	and
            // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR		)	and
            if (!IsBaseMode && !IsSlipMode)
            {
                bBase = true;
            }
            result = bBase;
            return result;
        }

        // 出納帳
        // ******************************************************************************
        // Proccess	:	伝票制御
        // ******************************************************************************
        public virtual bool IsSlipMode(int iPrgCode)
        {
            bool result;
            int iCode;
            bool bSlip;
            iCode = iPrgCode;
            if (iCode == 0)
            {
                //@ Unsupported property or method(D): 'm_iProgramCode'
                iCode = m_pRec.m_iProgramCode;
            }
            bSlip = false;
            switch(iCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                    // ミロク型指示
                    // コクヨ型指示
                    // 入金伝票指示
                    // 出金伝票指示
                    // 仮払精算指示
                    // ミロク型指示
                    // コクヨ型指示
                    // 入金伝票指示
                    // 出金伝票指示
                    // 仮払精算指示
                    bSlip = true;
                    break;
            }
            result = bSlip;
            return result;
        }

        // 伝票制御
        // ******************************************************************************
        // Proccess	:	分散
        // ******************************************************************************
        public virtual bool IsBunsanMode(int iPrgCode)
        {
            bool result;
            int iCode;
            bool bSlip;
            iCode = iPrgCode;
            if (iCode == 0)
            {
                //@ Unsupported property or method(D): 'm_iProgramCode'
                iCode = m_pRec.m_iProgramCode;
            }
            bSlip = false;
            switch(iCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                    // (*H0038 20030904 khattori	分散入力<単一入力>*)
                    // 単一入力分散仕訳指示
                    // ミロク型指示
                    // コクヨ型指示
                    // 入金伝票指示
                    // 出金伝票指示
                    // 仮払精算指示
                    bSlip = true;
                    break;
            }
            result = bSlip;
            return result;
        }

        // 分散入力
        // ******************************************************************************
        // Proccess	:	ＦＡＳ
        // ******************************************************************************
        protected bool Is_FASMODE()
        {
            bool result;
            bool bSlip;
            bSlip = false;
            if ((g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_FASENTRY) || Is_ZFASCS() || Is_ZFASMN())
            {
                bSlip = true;
            }
            result = bSlip;
            return result;
        }

        // ＦＡＳ
        // ******************************************************************************
        // Proccess	:	財務基本（事務所）
        // ******************************************************************************
        protected bool Is_JIMUSYO()
        {
            bool result;
            bool bSlip;
            bSlip = false;
            if ((g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE))
            {
                bSlip = true;
            }
            result = bSlip;
            return result;
        }

        // 事務所
        // ******************************************************************************
        // Proccess	:	財務基本（本店）
        // ******************************************************************************
        protected bool Is_ZAIMU()
        {
            bool result;
            bool bSlip;
            bSlip = false;
            if ((g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZAIMU) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZAIMU_K) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZAIMU_G) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZAIMU_S) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZAIMU_H))
            {
                bSlip = true;
            }
            result = bSlip;
            return result;
        }

        // 財務基本（本店）
        // ******************************************************************************
        // Proccess	:	財務基本（支店）
        // ******************************************************************************
        protected bool Is_SITEN()
        {
            bool result;
            bool bSlip;
            bSlip = false;
            if ((g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_SITEN) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_SITEN_K) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_SITEN_G) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_SITEN_S) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_SITEN_H))
            {
                bSlip = true;
            }
            result = bSlip;
            return result;
        }

        // 財務基本（支店）
        // ******************************************************************************
        // Proccess	:	財務大将FAS（CS用）
        // ******************************************************************************
        protected bool Is_ZFASCS()
        {
            bool result;
            bool bSlip;
            bSlip = false;
            if ((g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASCS) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASCS_K) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASCS_G) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASCS_S) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASCS_H))
            {
                bSlip = true;
            }
            result = bSlip;
            return result;
        }

        // 財務大将FAS（CS用）
        // ******************************************************************************
        // Proccess	:	財務大将FAS（管理者用）
        // ******************************************************************************
        protected bool Is_ZFASMN()
        {
            bool result;
            bool bSlip;
            bSlip = false;
            if ((g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASMN) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASMN_K) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASMN_G) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASMN_S) || (g_miSystemCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_ZFASMN_H))
            {
                bSlip = true;
            }
            result = bSlip;
            return result;
        }

        // サブプログラム採用判定クラス
        // ------------------------------------------------------------------<HIS-002>---
        // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
        // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
        // **********************************************************************
        // *		Proccess	:	財務排他処理
        // *		Name		:	K.Hattori
        // *		Date		:	2003/08/20
        // **********************************************************************
        protected void fnExceptCheck()
        {
            TMJSMsgRec stMessageRec;
            try {
                m_cExcept = new TMasExceptIF(m_pRec);
                m_nReferMode = 1;
                // 500番の排他
                m_iRet = m_cExcept.SetExcept(500);
                if (m_iRet != Units.MAS310000u.EXCEPT_RET_OK)
                {
                    // 初期処理失敗
                    m_nReferMode =  -1;
                }
                else if ((m_cExcept.Status100 != 0))
                {
                    m_nReferMode =  -2;
                }
            // 他で排他中
            }
            catch {
                m_nReferMode =  -1;
            // 初期処理失敗
            }
            switch(m_nReferMode)
            {
                case  -1:
                    Console.Beep();
                    //@ Undeclared identifier(3): 'mjError'
                    //@ Undeclared identifier(3): 'mjDefOk'
                    //@ Undeclared identifier(3): 'MjsMessageBox'
                    MjsMessageBox("排他制御処理の初期処理に失敗しました。", mjError, mjDefOk);
                    break;
                case  -2:
                    m_cExcept.ResetTerm();
                    Console.Beep();
                    //@ Unsupported property or method(D): 'm_pSystemArea'
                    //@ Undeclared identifier(3): 'TMASCom'
                    //@ Unsupported property or method(D): 'm_MsgStd'
                    //@ Unsupported property or method(B): 'GetMSG'
                    TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(stMessageRec, 10, 112);
                    //@ Unsupported property or method(D): 'sMsg'
                    //@ Unsupported property or method(D): 'sTitle'
                    //@ Unsupported property or method(D): 'icontype'
                    //@ Unsupported property or method(D): 'btntype'
                    //@ Unsupported property or method(D): 'btndef'
                    //@ Unsupported property or method(D): 'LogType'
                    VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(stMessageRec.sMsg, stMessageRec.sTitle, stMessageRec.icontype, stMessageRec.btntype, stMessageRec.btndef, stMessageRec.LogType);
                    break;
            }
        }

        // **********************************************************************
        // *		Proccess	:	財務排他終了処理
        // *		Name		:	K.Hattori
        // *		Date		:	2003/08/20
        // **********************************************************************
        protected void fnExceptTerm()
        {
            if (m_cExcept != null)
            {
                m_cExcept.ResetTerm();
                //@ Unsupported property or method(C): 'Free'
                m_cExcept.Free;
                m_cExcept = null;
                m_iRet = Units.MAS310000u.EXCEPT_RET_OK;
                m_nReferMode = 0;
            }
        }

        public int fnHighResolve_fnConvert(int iBase)
        {
            int result;
            //@ Undeclared identifier(3): 'GetZoomRatio'
            result = iBase * GetZoomRatio((m_pRec as object)) / 100;
            return result;
        }

        // 財務大将FAS（管理者用）
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        // **********************************************************************
        // *		Proccess	:	高解像度対応
        // *		Name		:	K.Hattori
        // *		Date		:	2004/12/13
        // **********************************************************************
        protected void fnHighResolve()
        {
            int itemp;
            //@ Undeclared identifier(3): 'MjsFontResize'
            MjsFontResize(((this) as TMAS310000f), (m_pRec as object));
            // ---<HIS-015>------------------------------------------------------------------
            // ---<HIS-022> 削除(標準サイズより小さくするのを認める)-------------------------
            // //	標準サイズより小さくさせない(横幅のみ)
            // PMPanelAll.Constraints.MinWidth		:= fnConvert(945);
            // ------------------------------------------------------------------<HIS-022>---
            // ここで設定しないとサイズがずれる(OnCreateイベントではNG)
            //@ Unsupported property or method(C): 'Anchors'
            SelWnd.Anchors = new System.Windows.Forms.AnchorStyles[] {System.Windows.Forms.AnchorStyles.Left, System.Windows.Forms.AnchorStyles.Top, System.Windows.Forms.AnchorStyles.Right, System.Windows.Forms.AnchorStyles.Bottom};
            // ------------------------------------------------------------------<HIS-015>---
            //@ Unsupported property or method(D): 'Top'
            //@ Unsupported property or method(C): 'Top'
            PMPanelSelMonth.Top = PMComboBox2.Top + 3;
            //@ Unsupported property or method(D): 'Left'
            //@ Unsupported property or method(C): 'Left'
            PMPanelSelMonth.Left = PMComboBox2.Left + 2;
            //@ Unsupported property or method(D): 'Top'
            //@ Unsupported property or method(C): 'Top'
            PMPanelHdSjFst.Top = PMComboBox3.Top + 3;
            //@ Unsupported property or method(D): 'Left'
            //@ Unsupported property or method(C): 'Left'
            PMPanelHdSjFst.Left = PMComboBox3.Left + 2;
            //@ Unsupported property or method(C): 'Top'
            //@ Unsupported property or method(C): 'Top'
            PMPanelHdSjSnd.Top = PMComboBox4.Top + 3;
            //@ Unsupported property or method(C): 'Left'
            //@ Unsupported property or method(C): 'Left'
            PMPanelHdSjSnd.Left = PMComboBox4.Left + 2;
            ToolBar.Left = fnHighResolve_fnConvert(ToolBar.Left);
            ToolBar.Top = fnHighResolve_fnConvert(ToolBar.Top);
            ToolBar.Height = fnHighResolve_fnConvert(ToolBar.Height);
            ToolBar.Width = fnHighResolve_fnConvert(ToolBar.Width);
            //@ Unsupported property or method(C): 'ButtonHeight'
            //@ Unsupported property or method(C): 'ButtonHeight'
            ToolBar.ButtonHeight = fnHighResolve_fnConvert(ToolBar.ButtonHeight);
            //@ Unsupported property or method(C): 'ButtonWidth'
            //@ Unsupported property or method(C): 'ButtonWidth'
            ToolBar.ButtonWidth = fnHighResolve_fnConvert(ToolBar.ButtonWidth);
        }

    } // end TMAS310000f

    // 呼び出し関数の定義
    // THandle   = Integer;								// Habdle型の定義
    // ==============================================================================
    // Bpl管理構造体
    // 2000 /  7 / xx	( xxx )		新規作成
    // 2000 /  8 / 21	( Mon )		m_sParameter 追加
    // 2000 /  8 / 22	( Tue )		m_OptionCode 追加
    // m_iAppID → m_iPrgCD 変更
    // 2000 /  8 / 30	( Wed )		m_iCorpID 追加
    // 2000 /  9 / 18	( Mon )		m_iExecMode 追加
    // 2000 /  9 / 19	( Tue )		m_iRank 追加
    // 2000 /  9 / 28	( Thu )		m_iPrgCD → m_iProgramCode 変更
    // 2000 / 10 / 16	( Mon )		m_pExpModule 追加
    // 2001 /  2 /  8	( Thu )		m_ProgramName 追加
    // 2005 /  5 / 18	( Wed )		予備拡張
    // ==============================================================================
    public struct TMjsAppRecord
    {
        public int m_iGroupCode;
        // グループコード
        public int m_iSystemCode;
        // システムコード
        public int m_iOptionCode;
        // オプションコード
        public int m_iProgramCode;
        // プログラムコード
        public int m_iCorpCode;
        // 会社コード
        public int m_iCorpSubCode;
        // 本支店コード
        public int m_iCorpID;
        // 会社 ID ( COPDBOpen パラメータ )
        public int m_iDelete;
        // 削除フラグ
        public int m_iExecMode;
        // 動作環境フラグ
        public int m_iRank;
        // 処理ランク
        public string m_ProgramName;
        // プログラム名称
        public long m_hChildBpl;
        // 子 bpl ハンドル
        public TAppEntry m_pChildEntry;
        // 子 bpl AppEntry 関数ポインタ
        public object m_pChildForm;
        // 子 bpl Form ポインタ
        public TAppEntry m_pOwnerEntry;
        // 親 bpl AppEntry 関数ポインタ
        public object m_pOwnerForm;
        // 親 bpl Form ポインタ
        public object m_pOwnerPanel;
        // 親 bpl Panel ポインタ
        public object m_pDBModule;
        // 共通DBモジュール ポインタ
        public object m_pExpModule;
        // 排他制御モジュール・ポインタ
        public object m_pCommonArea;
        // MJS共通メモリ ポインタ
        public object m_pSystemArea;
        // システム共通メモリ
        public string m_sParameter;
        // プログラム情報 登録パラメータ
        // 2005-05-18 S		予備拡張
        public int[] m_iMARData;
        // 数値型
        public string[] m_sMARData;
        // 文字型
        public DateTime[] m_dMARData;
        // 日付型
        public object[] m_pMARData;
    } // end TMjsAppRecord

    // ==============================================================================
    // AppEntryﾊﾟﾗﾒｰﾀ構造体
    // 2000 /  7 / xx	( xxx )		新規作成
    // 2005 /  5 / 18	( Wed )		予備拡張
    // ==============================================================================
    public struct TAppParam
    {
        public int iAction;
        // 処理番号
        public TMjsAppRecord pRecord;
        // bpl 管理構造体 ポインタ
        public object pActionParam;
        // 処理別パラメータ ポインタ
        // 2005-05-18 S		予備拡張
        public int[] m_iTAPData;
        // 数値型
        public string[] m_sTAPData;
        // 文字型
        public DateTime[] m_dTAPData;
        // 日付型
        public object[] m_pTAPData;
    } // end TAppParam

    // ==============================================================================
    // 共通情報 構造体
    // 2000 /  8 / 21	( Mon )		新規作成
    // 2000 /  8 / 22	( Tue )		MEM_MenuType 追加
    // MEM_StfMenuPtn 削除
    // MEM_SysTreeColor 削除
    // MEM_SysPanelColor 削除
    // 2000 /  8 / 30	( Wed )		再構成
    // 2000 /  9 / 18	( Mon )		StaffNo → TantoNaibuCD 変更
    // StaffRank → Rank 変更
    // SysPrifix → SysPrefix 変更
    // SysDBPrifix → SysDBPrefix 変更
    // SysColorB 追加
    // SysColorD 追加
    // JimFlg 追加
    // SVOSType 追加
    // SVDBType 追加
    // MainSVName 追加
    // ObjectFlg 追加
    // 2000 /  9 / 28	( Thu )		TantoNaibuCD → TantoNCD 変更
    // SysPrefix 削除
    // SysDBPrefix 削除
    // SysColorB 削除
    // SysColorD 削除
    // MenuType 削除
    // MainSVKey 追加
    // 2001 /  2 /  8	( Thu )		TantoGCD　追加
    // TantoName　追加
    // SysName 追加
    // Rank 削除
    // 2001 / 5 / 1				APLogServer 追加
    // APLogFolder 追加
    // 2004 / 12 / 3				ZoomRatio 追加
    // 2005 /  2 / 16				ComMemRsvSw1〜5 追加
    // ComMemRsvFlg1〜5 追加
    // ComMemRsvNo1〜5 追加
    // ComMemRsvCode1〜5 追加
    // ComMemRsvTxt1〜5 追加
    // 2005 /  2 / 23				WANDBSvrName 追加
    // WANDBPath 追加
    // WANType 追加
    // WANReserveStr 追加
    // 2005 / 3 / 10               UserYear      追加
    // SysMenuType   追加
    // 2005 / 5 /  2               pCMNFuncM     		追加
    // ComMemRsvPointer1	追加
    // ComMemRsvPointer2	追加
    // ComMemRsvPointer3	追加
    // ==============================================================================
    public struct rcCOMMONAREA
    {
        public int TantoNCD;
        // 担当者内部コード
        public int TantoGCD;
        // 担当者外部コード
        public string TantoName;
        // 担当者名称
        public int UserDefNo;
        // ﾃﾞﾌｫﾙﾄ顧問先NO
        public int UserNo;
        // 選択顧問先NO
        public string SysRoot;
        // ｻｰﾊﾞﾙｰﾄﾌｫﾙﾀﾞ
        public string SysCliRoot;
        // ｸﾗｲｱﾝﾄﾙｰﾄﾌｫﾙﾀﾞ
        public string MjsPath;
        // MJS 起動サーバパス
        public string APLogSerevr;
        // LOG出力ｻｰﾊﾞｰ名
        public string APLogFolder;
        // LOG出力ﾌｫﾙﾀﾞｰ名
        public int SysFocusColor;
        // ﾌｫｰｶｽｶﾗｰ
        public string SysFontName;
        // フォント名称
        public int SysFontSize;
        // フォントサイズ
        public int JimFlg;
        // 事務所総合区分
        public int SVOSType;
        // サーバ OS 種類
        public int SVDBType;
        // サーバ DB 種類
        public string MainSVName;
        // サーバ名称
        public string MainSVKey;
        // サーバ環境名
        public int ObjectFlg;
        // 導入先区分
        public int ZoomRatio;
        // 画面表示拡大率
        public int ComMemRsvSw1;
        // 共通ﾒﾓﾘ予備ＳＷ１
        public int ComMemRsvSw2;
        // 共通ﾒﾓﾘ予備ＳＷ２
        public int ComMemRsvSw3;
        // 共通ﾒﾓﾘ予備ＳＷ３
        public int ComMemRsvSw4;
        // 共通ﾒﾓﾘ予備ＳＷ４
        public int ComMemRsvSw5;
        // 共通ﾒﾓﾘ予備ＳＷ５
        public int ComMemRsvFlg1;
        // 0:AL,ML  1:AL2  2:AL3
        public int ComMemRsvFlg2;
        // シリーズID
        public int ComMemRsvFlg3;
        // 共通ﾒﾓﾘ予備区分３
        public int ComMemRsvFlg4;
        // 共通ﾒﾓﾘ予備区分４
        public int ComMemRsvFlg5;
        // 共通ﾒﾓﾘ予備区分５
        public int ComMemRsvNo1;
        // 共通ﾒﾓﾘ予備ＮＯ１
        public int ComMemRsvNo2;
        // 共通ﾒﾓﾘ予備ＮＯ２
        public int ComMemRsvNo3;
        // 共通ﾒﾓﾘ予備ＮＯ３
        public int ComMemRsvNo4;
        // 共通ﾒﾓﾘ予備ＮＯ４
        public int ComMemRsvNo5;
        // 共通ﾒﾓﾘ予備ＮＯ５
        public int ComMemRsvCode1;
        // 共通ﾒﾓﾘ予備コード１
        public int ComMemRsvCode2;
        // 共通ﾒﾓﾘ予備コード２
        public int ComMemRsvCode3;
        // 共通ﾒﾓﾘ予備コード３
        public int ComMemRsvCode4;
        // 共通ﾒﾓﾘ予備コード４
        public int ComMemRsvCode5;
        // 共通ﾒﾓﾘ予備コード５
        public string ComMemRsvTxt1;
        // 業務ﾒﾆｭｰ､ｽﾃﾙｽのﾊﾟﾗﾒｰﾀ
        public string ComMemRsvTxt2;
        // メニュー用表示倍率
        public string ComMemRsvTxt3;
        // 共通ﾒﾓﾘ予備ﾃｷｽﾄ３
        public string ComMemRsvTxt4;
        // 共通ﾒﾓﾘ予備ﾃｷｽﾄ４
        public string ComMemRsvTxt5;
        // 共通ﾒﾓﾘ予備ﾃｷｽﾄ５
        public string WANDBSvrName;
        // WAN対応データベースサーバ名
        public string WANDBPath;
        // WAN対応データベースサーバローカルパス名
        public int WANType;
        // WAN対応動作区分
        public string WANReserveStr;
        // WAN対応予約文字列
        public int UserYear;
        // 顧問先処理年度
        public int SysMenuType;
        // ｼｽﾃﾑﾒﾆｭｰﾀｲﾌﾟ
        public object pCMNFuncM;
        // CMNFuncMﾎﾟｲﾝﾀ(現在未使用)
        public object ComMemRsvPointer1;
        // 共通ﾒﾓﾘ予備ﾎﾟｲﾝﾀ１
        public object ComMemRsvPointer2;
        // 共通ﾒﾓﾘ予備ﾎﾟｲﾝﾀ２
        public object ComMemRsvPointer3;
    } // end rcCOMMONAREA

    // ==============================================================================
    // [注意]
    // ｼｽﾃﾑ共通ﾒﾓﾘの構造体はここで定義しちゃ駄目!!!、なんだけど．．．まぁいいか？
    // ==============================================================================
    // システムメモリ 構造体
    // 2000 /  9 / 28	( Thu )		新規作成
    // 2001 /  2 /  8	( Thu )		SysName　追加
    // TantoRank　追加
    // 2005 /  5 / 18	( Wed )		予備拡張
    // ==============================================================================
    public struct rcSYSTEMAREA
    {
        public int SysYear;
        // システム年度 ( 西暦 )
        public int MenuType;
        // システムメニュー動作区分(0:通常,1:管理者,2:CS,3:開発)
        public string SysPrefix;
        // システムプリフィックス
        public string SysDBPrefix;
        // DB プリフィックス
        public int SysColorB;
        // システム・カラー ( 淡 )
        public int SysColorD;
        // システム・カラー ( 濃 )
        public int SysBaseColorB;
        // システム・ベース・カラー ( 淡 )
        public int SysBaseColorD;
        // システム・ベース・カラー ( 濃 )
        public string SysName;
        // システム名称
        public int TantoRank;
        // 担当者ランク
        // 2005-05-18 S		予備拡張
        public int[] m_iSYSData;
        // 数値型
        public string[] m_sSYSData;
        // 文字型
        public DateTime[] m_dSYSData;
        // 日付型
        public object[] m_pSYSData;
    } // end rcSYSTEMAREA

    // 仮受・仮払消費税
    public struct TUkeHarai
    {
        public byte[] tniUseKbn;
        // 採用区分
        public int iKmkCode;
        // 科目コード
        public int iSubCode;
        // 細目科目コード(諸口)
        public string strBmnCode;
        // 部門コード(諸口)
        public string strHoj1Code;
        // 第１補助コード(諸口)
        public string strHoj2Code;
    } // end TUkeHarai

    // 仕訳管理情報
    public struct TSwkCInfo
    {
        public int tniLstHSrNo;
        // 最終検索ＮＯ（ヘッダ）
        public int tniLstDSrNo;
        // 最終検索ＮＯ（明細）
        public int iSwkENum;
    } // end TSwkCInfo

    // エラーコード
    // エラーなし
    // 初期処理がされていない
    // 最大件数オーバー
    // VKZL310Trn.Bplロードエラー
    // VKZL310TrnInit関数アドレス取得エラー
    // TVKZL310Trnクラス作成エラー
    // 出力パラメータを参照
    // 更新結果を参照
    // 他で使用中
    // ヘッダが追加または修正で明細が無い
    // その他エラー
    // パラメータエラー
    // テーブルへの書き込みに失敗
    // 資金繰実績更新で、該当の資金マスタが存在しない。
    // 消費税集計マスタ[TaxSM]更新処理で消費税分類コードが見つからない。
    // オーバフロー(金額が有効桁数を超えた。)
    // 貸借のどちらかの科目が存在しない。
    // テーブルが存在しない
    // カラムが存在しない
    // キー重複
    // NULL不可項目がNULLで追加・更新された
    // ロックエラー
    // 共通情報
    public struct TVKZL310TrnCmnInfo
    {
        // システム基本情報(MasInfo)
        public int iSwkMaxCnt;
        // 仕訳最大登録件数
        // 会社基本情報(DTMAIN)
        public byte tniDataKbn;
        // データ区分（発生区分）
        public byte tniStrMonth;
        // 仕訳入力開始月
        public byte tniMargeKbn;
        // 合併データ区分 0:なし 1:本支店合併 2:関係会社合併
        public byte tniMailKbn;
        // メール会計区分
        public byte ctniPublicKbn;
        // 公益法人区分
        public byte ctniPubSwkInpKbn;
        // 公益法人仕訳入力方法
        public byte ctniPubSwkExpKbn;
        // 自動仕訳展開区分
        // 特定科目情報(KmkInfo)
        public int iSpeCode010301;
        // 複合科目コード
        public int iSpeCode010302;
        // 資金複合科目コード
        public int iSAdjKmkCode;
        // 売上調整科目コード
        public int iBAdjKmkCode;
        // 仕入調整科目コード
        // マスタ基本情報(MasterInfo)
        public byte[] tniMstUse;
        // 採用区分
        public byte[] tniMstrKbn1;
        // 配賦採用区分
        public string[] strSpHojyoCd1;
        // B/S共通部門コード
        public byte tniKojKbn1;
        // 完成工事振替区分
        public byte tniKojKbn2;
        // 完成工事売上高自動振替区分
        // 区分情報(KbnInfo)
        public byte iKbnInfo6;
        // メール会計（支店）レコードの存在の有無 0:存在しない 1:存在する
        public byte tniHisKbn;
        // 仕訳修正履歴採用区分
        public byte tniHisKbn2;
        // 仕訳修正履歴採用区分(強制処理)
        public short smiHisDelay;
        // 仕訳修正履歴猶予日数
        public byte[] tniEleAcc;
        // 電子帳簿区分
        public byte tniJoinHisKbn;
        // 仕訳データ連結履歴作成
        public byte tniJoinHisKbn2;
        // 仕訳データ連結履歴作成(強制処理)
        public byte[] tniCashKbn;
        // 資金単位集計区分
        // 管理科目基本マスタ(SKmkMA)
        public int iDepoGCode;
        // 預金預入コード
        public byte tniDepoDCKbn;
        // 預金預入正残区分
        public int iDrawGCode;
        // 預金払出コード
        public byte tniDrawDCKbn;
        // 預金払出正残区分
        // 消費税基本情報(TaxInfo)
        public byte tniAccProKbn;
        // 会計処理区分
        public byte tniCotKbn;
        // 申告システム区分
        public byte tniMonthEnd;
        // 税抜処理区分
        public byte tniTaxKbn2;
        // 消費税部門別集計区分
        // 勘定科目基本マスタ(KmkMA)
        public TUkeHarai recUke;
        // 仮受消費税
        public TUkeHarai recHar;
        // 仮払消費税
        // 月次確定情報(MFixInfo)
        public byte[] tniFixKbn;
        // 月次確定区分
        // 仕訳管理情報(SwkCInfo)
        public TSwkCInfo[] recSwkCInfo;
        // 仕訳情報(最終検索ＮＯ、件数)
        // 本支店合併詳細条件(CorpAddInfo2)
        public int iCAddNum;
        // 合併仕訳生成区分 0:なし 1:月次合併 2:取引毎合併 3:日時合併
        // その他
        public byte tniSwkCKbn;
        // 仕訳管理区分
        public int iProcCode;
        // 処理コード
        public int iTantoCode;
        // 担当者コード
        public string strTantoName;
        // 担当者名
        public int iSystemCode;
        // システムコード
        public int iAitSwkInpKbn;
        // 連結処理での相手側仕訳発生区分
        public byte tniAutoDenNo;
        // 伝票番号自動付番区分　　０：任意入力 １：自動付番（前回＋１）２：ｼｽﾃﾑ自動付番
        public byte tniAutoDenKbn;
        // 伝票番号自動付番区分２　０：なし １：月次型　２：通年型
        public byte tniJidoFuban;
        // 検索ＮＯ自動付番 0:自動付番する 1:自動付番しない
        public byte iSwkInpKbn;
    } // end TVKZL310TrnCmnInfo

    // 仕訳ヘッダ
    public struct TVKZL310TrnHRec
    {
        public byte IUDKbn;
        // 処理区分
        public byte SwkHDKbn;
        // 仕訳ヘッダデータセットフラグ
        public byte HSrchNoAutoSet;
        // ヘッダ検索ＮＯ自動付番区分
        public DateTime DenDate;
        // 伝票日付
        public byte NMonth;
        // 仕訳内部月
        public byte SwkInpKbn;
        // 仕訳発生区分
        public byte DataClass;
        // データ種別
        public byte SwkForm;
        // 仕訳入力形式
        public int HSrchNo;
        // ヘッダ検索ＮＯ
        public string RHSrchNo;
        // 相手側検索ＮＯ
        public string DenNo;
        // 伝票ＮＯ
        public string LeafNo;
        // 証憑ＮＯ
        public string BusCode;
        // 入力部署コード
        public int BusHSrchNo;
        // 入力部署検索NO
        public byte DenClass;
        // 伝票種別NO
        public DateTime BDenDate;
        // 伝票日付
        public byte BNMonth;
        // 仕訳内部月
        public int BHSrchNo;
        // ヘッダ検索ＮＯ
        public byte StaffKbn02;
        // 担当者区分
        public int StaffCode02;
        // 担当者コード
        public string StaffName02;
        // 担当者名
        public DateTime UpdateTime02;
        // 入力修正日時
        public byte OkKbn02;
        // 承認区分
        public string OkComnt02;
        // 承認コメント
        public byte StaffKbn03;
        // 担当者区分
        public int StaffCode03;
        // 担当者コード
        public string StaffName03;
        // 担当者名
        public DateTime UpdateTime03;
        // 入力修正日時
        public byte OkKbn03;
        // 承認区分
        public string OkComnt03;
        // 承認コメント
        public byte StaffKbn11;
        // 担当者区分
        public int StaffCode11;
        // 担当者コード
        public string StaffName11;
        // 担当者名
        public DateTime UpdateTime11;
        // 入力修正日時
        public byte OkKbn11;
        // 承認区分
        public string OkComnt11;
        // 承認コメント
        public byte StaffKbn12;
        // 担当者区分
        public int StaffCode12;
        // 担当者コード
        public string StaffName12;
        // 担当者名
        public DateTime UpdateTime12;
        // 入力修正日時
        public byte OkKbn12;
        // 承認区分
        public string OkComnt12;
        // 承認コメント
        public byte StaffKbn21;
        // 担当者区分
        public int StaffCode21;
        // 担当者コード
        public string StaffName21;
        // 担当者名
        public DateTime UpdateTime21;
        // 入力修正日時
        public byte OkKbn21;
        // 承認区分
        public string OkComnt21;
        // 承認コメント
        public byte StaffKbn22;
        // 担当者区分
        public int StaffCode22;
        // 担当者コード
        public string StaffName22;
        // 担当者名
        public DateTime UpdateTime22;
        // 入力修正日時
        public byte OkKbn22;
        // 承認区分
        public string OkComnt22;
        // 承認コメント
        public byte StaffKbn23;
        public int StaffCode23;
        public string StaffName23;
        public DateTime UpdateTime23;
        // 入力修正日時
        public byte OkKbn23;
        public string OkComnt23;
        public byte StaffKbn31;
        // 担当者区分
        public int StaffCode31;
        // 担当者コード
        public string StaffName31;
        // 担当者名
        public DateTime UpdateTime31;
        // 入力修正日時
        public byte OkKbn31;
        // 承認区分
        public string OkComnt31;
        // 承認コメント
        public byte StaffKbn32;
        // 担当者区分
        public int StaffCode32;
        // 担当者コード
        public string StaffName32;
        // 担当者名
        public DateTime UpdateTime32;
        // 入力修正日時
        public byte OkKbn32;
        // 承認区分
        public string OkComnt32;
        // 承認コメント
        public byte StaffKbn41;
        // 担当者区分
        public int StaffCode41;
        // 担当者コード
        public string StaffName41;
        // 担当者名
        public DateTime UpdateTime41;
        // 入力修正日時
        public byte OkKbn41;
        // 承認区分
        public string OkComnt41;
        // 承認コメント
        public byte StaffKbn42;
        // 担当者区分
        public int StaffCode42;
        // 担当者コード
        public string StaffName42;
        // 担当者名
        public DateTime UpdateTime42;
        // 入力修正日時
        public byte OkKbn42;
        // 承認区分
        public string OkComnt42;
        // 承認コメント
        public byte StaffKbn51;
        // 担当者区分
        public int StaffCode51;
        // 担当者コード
        public string StaffName51;
        // 担当者名
        public DateTime UpdateTime51;
        // 入力修正日時
        public byte OkKbn51;
        // 承認区分
        public string OkComnt51;
        // 承認コメント
        public byte StaffKbn52;
        // 担当者区分
        public int StaffCode52;
        // 担当者コード
        public string StaffName52;
        // 担当者名
        public DateTime UpdateTime52;
        // 入力修正日時
        public byte OkKbn52;
        // 承認区分
        public string OkComnt52;
        // 承認コメント
        public byte FusenKbn;
        // 付箋区分
        public string FusenCmnt;
        // 付箋コメント
        public byte HSrchNoAutoSetF;
        // ヘッダ検索ＮＯ自動付番区分
        public byte DenDateF;
        // 伝票日付
        public byte NMonthF;
        // 仕訳内部月
        public byte SwkInpKbnF;
        // 仕訳発生区分
        public byte DataClassF;
        // データ種別
        public byte SwkFormF;
        // 仕訳入力形式
        public byte HSrchNoF;
        // ヘッダ検索ＮＯ
        public byte RHSrchNoF;
        // 相手側検索ＮＯ
        public byte DenNoF;
        // 伝票ＮＯ
        public byte LeafNoF;
        // 証憑ＮＯ
        public byte BusCodeF;
        // 入力部署コード
        public byte BusHSrchNoF;
        // 入力部署検索NO
        public byte DenClassF;
        // 伝票種別NO
        public byte BDenDateF;
        // 伝票日付
        public byte BNMonthF;
        // 仕訳内部月
        public byte BHSrchNoF;
        // ヘッダ検索ＮＯ
        public byte StaffKbn02F;
        // 担当者区分
        public byte StaffCode02F;
        // 担当者コード
        public byte StaffName02F;
        // 担当者名
        public byte UpdateTime02F;
        // 入力修正日時
        public byte OkKbn02F;
        // 承認区分
        public byte OkComnt02F;
        // 承認コメント
        public byte StaffKbn03F;
        // 担当者区分
        public byte StaffCode03F;
        // 担当者コード
        public byte StaffName03F;
        // 担当者名
        public byte UpdateTime03F;
        // 入力修正日時
        public byte OkKbn03F;
        // 承認区分
        public byte OkComnt03F;
        // 承認コメント
        public byte StaffKbn11F;
        // 担当者区分
        public byte StaffCode11F;
        // 担当者コード
        public byte StaffName11F;
        // 担当者名
        public byte UpdateTime11F;
        // 入力修正日時
        public byte OkKbn11F;
        // 承認区分
        public byte OkComnt11F;
        // 承認コメント
        public byte StaffKbn12F;
        // 担当者区分
        public byte StaffCode12F;
        // 担当者コード
        public byte StaffName12F;
        // 担当者名
        public byte UpdateTime12F;
        // 入力修正日時
        public byte OkKbn12F;
        // 承認区分
        public byte OkComnt12F;
        // 承認コメント
        public byte StaffKbn21F;
        // 担当者区分
        public byte StaffCode21F;
        // 担当者コード
        public byte StaffName21F;
        // 担当者名
        public byte UpdateTime21F;
        // 入力修正日時
        public byte OkKbn21F;
        // 承認区分
        public byte OkComnt21F;
        // 承認コメント
        public byte StaffKbn22F;
        // 担当者区分
        public byte StaffCode22F;
        // 担当者コード
        public byte StaffName22F;
        // 担当者名
        public byte UpdateTime22F;
        // 入力修正日時
        public byte OkKbn22F;
        // 承認区分
        public byte OkComnt22F;
        // 承認コメント
        public byte StaffKbn23F;
        public byte StaffCode23F;
        public byte StaffName23F;
        public byte UpdateTime23F;
        // 入力修正日時
        public byte OkKbn23F;
        public byte OkComnt23F;
        public byte StaffKbn31F;
        // 担当者区分
        public byte StaffCode31F;
        // 担当者コード
        public byte StaffName31F;
        // 担当者名
        public byte UpdateTime31F;
        // 入力修正日時
        public byte OkKbn31F;
        // 承認区分
        public byte OkComnt31F;
        // 承認コメント
        public byte StaffKbn32F;
        // 担当者区分
        public byte StaffCode32F;
        // 担当者コード
        public byte StaffName32F;
        // 担当者名
        public byte UpdateTime32F;
        // 入力修正日時
        public byte OkKbn32F;
        // 承認区分
        public byte OkComnt32F;
        // 承認コメント
        public byte StaffKbn41F;
        // 担当者区分
        public byte StaffCode41F;
        // 担当者コード
        public byte StaffName41F;
        // 担当者名
        public byte UpdateTime41F;
        // 入力修正日時
        public byte OkKbn41F;
        // 承認区分
        public byte OkComnt41F;
        // 承認コメント
        public byte StaffKbn42F;
        // 担当者区分
        public byte StaffCode42F;
        // 担当者コード
        public byte StaffName42F;
        // 担当者名
        public byte UpdateTime42F;
        // 入力修正日時
        public byte OkKbn42F;
        // 承認区分
        public byte OkComnt42F;
        // 承認コメント
        public byte StaffKbn51F;
        // 担当者区分
        public byte StaffCode51F;
        // 担当者コード
        public byte StaffName51F;
        // 担当者名
        public byte UpdateTime51F;
        // 入力修正日時
        public byte OkKbn51F;
        // 承認区分
        public byte OkComnt51F;
        // 承認コメント
        public byte StaffKbn52F;
        // 担当者区分
        public byte StaffCode52F;
        // 担当者コード
        public byte StaffName52F;
        // 担当者名
        public byte UpdateTime52F;
        // 入力修正日時
        public byte OkKbn52F;
        // 承認区分
        public byte OkComnt52F;
        // 承認コメント
        public byte FusenKbnF;
        // 付箋区分
        public byte FusenCmntF;
    } // end TVKZL310TrnHRec

    // 仕訳明細
    public struct TVKZL310TrnDRec
    {
        public byte IUDKbn;
        // 処理区分
        public byte SwkDTKbn;
        // 仕訳明細データセットフラグ
        public byte NMonth;
        // 仕訳内部月
        public byte SwkInpKbn;
        // 仕訳発生区分
        public int DSrchNo;
        // 明細検索ＮＯ
        public int BDSrchNo;
        // 明細検索ＮＯ(更新前) 内部処理でのみ使用
        public int RowNo;
        // 伝票明細ＮＯ
        public int HSrchNo;
        // 仕訳ヘッダ検索ＮＯ
        public string RDSrchNo;
        // 相手側明細検索ＮＯ
        public int DKmkCode;
        // 科目コード
        public int DSubCode;
        // 細目科目コード
        public string DBmnCode;
        // 部門コード
        public string DSegCode1;
        // セグメントコード１
        public byte DHojKbn1;
        // 第１補助区分
        public string DHojCode1;
        // 第１補助コード
        public byte DHojKbn2;
        // 第２補助区分
        public string DHojCode2;
        // 第２補助コード
        public string DKojCode;
        // 工事コード
        public string DKsyCode;
        // 工種コード
        public string DBsBmnCd;
        // 仮受/仮払消費税部門コード
        public string DBankCode;
        // 銀行コード
        public byte DTaxKbn;
        // 消費税売上／仕入区分
        public byte DTypeCd;
        // 業種コード
        public byte DTaxInc;
        // 税抜／税込区分
        public int CKmkCode;
        // 科目コード
        public int CSubCode;
        // 細目科目コード
        public string CBmnCode;
        // 部門コード
        public string CSegCode1;
        // セグメントコード１
        public byte CHojKbn1;
        // 第１補助区分
        public string CHojCode1;
        // 第１補助コード
        public byte CHojKbn2;
        // 第２補助区分
        public string CHojCode2;
        // 第２補助コード
        public string CKojCode;
        // 工事コード
        public string CKsyCode;
        // 工種コード
        public string CBsBmnCd;
        // 仮受/仮払消費税部門コード
        public string CBankCode;
        // 銀行コード
        public byte CTaxKbn;
        // 消費税売上／仕入区分
        public byte CTypeCd;
        // 業種コード
        public byte CTaxInc;
        // 税抜／税込区分
        public byte CashKbn;
        // 資金繰入力区分
        public byte CashCode;
        // 資金繰コード
        public byte TaxCode;
        // 消費税コード
        public short TaxRate;
        // 消費税率区分
        public byte ExcptRate;
        // 例外税率区分
        public byte TaxInpKbn;
        // 外税同時入力区分
        public decimal InpSum;
        // 金額（入力金額）
        public decimal TaxSum;
        // 消費税額
        public byte InpPoInt;
        // 金額小数点桁数
        public byte TaxPoInt;
        // 消費税額小数点桁数
        public int LimitDate;
        // 期日
        public string Tekiyo;
        // 摘要
        public int TekiCd1;
        // 固定摘要コード１
        public int TekiCd2;
        // 固定摘要コード２
        public int TekiCd3;
        // 固定摘要コード３
        public int TekiCd4;
        // 固定摘要コード４
        public int TekiCd5;
        // 固定摘要コード５
        public byte NonAcc;
        // 非会計データ区分
        public byte ImgKbn;
        // ＯＣＲイメージ摘要区分
        public byte SwkInpKbn2;
        // 仕訳発生区分(修正)
        public DateTime FirstDate;
        // 初回入力日時
        public byte FkSetKbn;
        // 複合セット処理区分
        public int DKmkCode2;
        // 借方第２科目コード
        public int CKmkCode2;
        // 貸方第２科目コード
        public int DKmkKbn2;
        // 借方第２科目セット区分
        public int CKmkKbn2;
        // 貸方第２科目セット区分
        public string BusCode;
        // 入力部署コード
        public int BusDSrchNo;
        // 入力部署検索NO
        public byte StaffKbn01;
        // 担当者区分
        public int StaffCode01;
        // 担当者コード
        public string StaffName01;
        // 担当者名
        public DateTime UpdateTime01;
        // 入力修正日時
        public byte FusenKbn;
        // 付箋区分
        public string FusenCmnt;
        // 付箋コメント
        public byte SwkAIKbn;
        // 仕訳付加情報セットフラグ
        public int FKmkCode;
        // 複合勘定科目コード
        public int FSubCode;
        // 複合細目科目コード
        public string FBmnCode;
        // 複合部門コード
        public string FSegCode1;
        // 複合セグメントコード
        public string FHojCode1;
        // 複合第1補助コード
        public string FHojCode2;
        // 複合第2補助コード
        public string FKojCode;
        // 複合工事コード
        public string FKsyCode;
        // 複合工種コード
        public string NumValue1;
        // 番号１（請求書ＮＯ）
        public string NumValue2;
        // 番号２（契約書ＮＯ）
        public string BillNum;
        // 手形番号
        public string BillCNum;
        // 手形管理番号
        public byte BillClass;
        // 手形種別
        public string BillRank;
        // 手形信用度
        public int DateIssue;
        // 手形振出日
        public string DrawName;
        // 手形振出人
        public string ExgPlace;
        // 支払場所
        public byte FinCode;
        // 顛末コード
        public string FinBank;
        // 顛末銀行コード
        public int HndKmkCd;
        // 譲渡勘定科目コード
        public int HndSubCd;
        // 譲渡細目科目コード
        public string HndHojCd;
        // 譲渡先コード
        public int ChgComCd;
        // 付替先会社コード
        public short ChgBraCd;
        // 付替先本支店コード
        public byte ChgDCKbn;
        // 貸借区分
        public int ChgKmkCd;
        // 相手科目コード
        public int ChgSubCd;
        // 相手細目科目コード
        public string ChgBmnCd;
        // 相手部門コード
        public string ChgHojCd1;
        // 相手第１補助コード
        public string ChgHojCd2;
        // 相手第２補助コード
        public string ChgKojCd;
        // 相手工事コード
        public string ChgKsyCd;
        // 相手工種コード
        public int ChgDate;
        // 期日
        public int ChgAitCd;
        // 本支店勘定コード
        public byte ChgTaxCd;
        // 消費税コード
        public short ChgTaxRate;
        // 消費税率区分
        public byte ChgTypeCd;
        // 業種区分
        public decimal ChgTaxSum;
        // 消費税額
        public string ChgNum1;
        // 番号１（請求書ＮＯ）
        public string ChgNum2;
        // 番号２（契約書ＮＯ）
        public decimal InpSum2;
        // 数量 (外貨金額)
        public decimal TaxSum2;
        // 単価 (外貨レート)
        public byte InpPoInt2;
        // 数量小数点桁数
        public byte TaxPoInt2;
        // 単価小数点桁数
        public int FinDate;
        // 受取手形顛末処理日
        public int SwkDicNo;
        // 仕訳辞書NO
        public byte SaddKbn1;
        public short SaddKbn2;
        public short SaddKbn3;
        // 借方番号
        public string DNumValue1;
        // 番号１（請求書ＮＯ）
        public string DNumValue2;
        // 番号２（契約書ＮＯ）
        public string DNumValue3;
        // 番号３
        public string DNumValue4;
        // 番号４
        public string DNumValue5;
        // 番号５
        public string DNumValue6;
        // 番号６
        public string DNumValue7;
        // 番号７
        public string DNumValue8;
        // 番号８
        public string DNumValue9;
        // 番号９
        public string DNumValue10;
        // 番号１０
        // 貸方番号
        public string CNumValue1;
        // 番号１（請求書ＮＯ）
        public string CNumValue2;
        // 番号２（契約書ＮＯ）
        public string CNumValue3;
        // 番号３
        public string CNumValue4;
        // 番号４
        public string CNumValue5;
        // 番号５
        public string CNumValue6;
        // 番号６
        public string CNumValue7;
        // 番号７
        public string CNumValue8;
        // 番号８
        public string CNumValue9;
        // 番号９
        public string CNumValue10;
        // 番号１０
        // 借方可変区分
        public byte DSubKbn;
        // 科目別補助科目コード区分
        public byte DBmnKbn;
        // 部門コード区分
        public byte DSeg1Kbn;
        // セグメントコード１区分
        public byte DHojyo1Kbn;
        // 第１補助コード区分
        public byte DHojyo2Kbn;
        // 第２補助コード区分
        public byte DKojKbn;
        // 工事コード区分
        public byte DKsyKbn;
        // 工種コード区分
        // 貸方可変区分
        public byte CSubKbn;
        // 科目別補助科目コード区分
        public byte CBmnKbn;
        // 部門コード区分
        public byte CSeg1Kbn;
        // セグメントコード１区分
        public byte CHojyo1Kbn;
        // 第１補助コード区分
        public byte CHojyo2Kbn;
        // 第２補助コード区分
        public byte CKojKbn;
        // 工事コード区分
        public byte CKsyKbn;
        // 工種コード区分
        public string ChgSegCd1;
        // セグメントコード１
        public int ChgTaxKbn;
        // 消費税売上／仕入区分
        public int ChgExcptRate;
        // 例外税率区分
        public int ChgCashCd;
        // 資金繰コード
        public string ChgBillNum;
        // 手形番号
        public string ChgBillCNum;
        // 手形管理番号
        public byte ExeCode00;
        // 特殊処理コード
        public byte ExeKbn00;
        // 修正／削除不可区分
        public DateTime ExeDTime00;
        // 実行日時
        public string ErrMess00;
        // エラーメッセージ
        public byte ExeCode01;
        // 特殊処理コード
        public byte ExeKbn01;
        // 修正／削除不可区分
        public DateTime ExeDTime01;
        // 実行日時
        public string ErrMess01;
        // エラーメッセージ
        public byte ExeCode03;
        // 特殊処理コード
        public byte ExeKbn03;
        // 修正／削除不可区分
        public DateTime ExeDTime03;
        // 実行日時
        public string ErrMess03;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署入力受信
        // ----------------------------------------------------------
        public byte ExeCode04;
        // 特殊処理コード
        public byte ExeKbn04;
        // 修正／削除不可区分
        public DateTime ExeDTime04;
        // 実行日時
        public string ErrMess04;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署承認／保留
        // ----------------------------------------------------------
        public byte ExeCode05;
        // 特殊処理コード
        public byte ExeKbn05;
        // 修正／削除不可区分
        public DateTime ExeDTime05;
        // 実行日時
        public string ErrMess05;
        // エラーメッセージ
        public byte ExeCode11;
        // 特殊処理コード
        public byte ExeKbn11;
        // 修正／削除不可区分
        public DateTime ExeDTime11;
        // 実行日時
        public string ErrMess11;
        // エラーメッセージ
        public byte ExeCode12;
        // 特殊処理コード
        public byte ExeKbn12;
        // 修正／削除不可区分
        public DateTime ExeDTime12;
        // 実行日時
        public string ErrMess12;
        // エラーメッセージ
        public byte ExeCode13;
        // 特殊処理コード
        public byte ExeKbn13;
        // 修正／削除不可区分
        public DateTime ExeDTime13;
        // 実行日時
        public string ErrMess13;
        // エラーメッセージ
        public byte ExeCode21;
        // 特殊処理コード
        public byte ExeKbn21;
        // 修正／削除不可区分
        public DateTime ExeDTime21;
        // 実行日時
        public string ErrMess21;
        // エラーメッセージ
        public byte ExeCode22;
        // 特殊処理コード
        public byte ExeKbn22;
        // 修正／削除不可区分
        public DateTime ExeDTime22;
        // 実行日時
        public string ErrMess22;
        // エラーメッセージ
        public byte ExeCode23;
        // 特殊処理コード
        public byte ExeKbn23;
        // 修正／削除不可区分
        public DateTime ExeDTime23;
        // 実行日時
        public string ErrMess23;
        // エラーメッセージ
        public byte ExeCode24;
        // 特殊処理コード
        public byte ExeKbn24;
        // 修正／削除不可区分
        public DateTime ExeDTime24;
        // 実行日時
        public string ErrMess24;
        // エラーメッセージ
        public byte ExeCode31;
        // 特殊処理コード
        public byte ExeKbn31;
        // 修正／削除不可区分
        public DateTime ExeDTime31;
        // 実行日時
        public string ErrMess31;
        // エラーメッセージ
        public byte ExeCode32;
        // 特殊処理コード
        public byte ExeKbn32;
        // 修正／削除不可区分
        public DateTime ExeDTime32;
        // 実行日時
        public string ErrMess32;
        // エラーメッセージ
        public byte ExeCode33;
        // 特殊処理コード
        public byte ExeKbn33;
        // 修正／削除不可区分
        public DateTime ExeDTime33;
        // 実行日時
        public string ErrMess33;
        // エラーメッセージ
        public byte ExeCode34;
        // 特殊処理コード
        public byte ExeKbn34;
        // 修正／削除不可区分
        public DateTime ExeDTime34;
        // 実行日時
        public string ErrMess34;
        // エラーメッセージ
        public byte ExeCode35;
        // 特殊処理コード
        public byte ExeKbn35;
        // 修正／削除不可区分
        public DateTime ExeDTime35;
        // 実行日時
        public string ErrMess35;
        // エラーメッセージ
        public byte ExeCode41;
        // 特殊処理コード
        public byte ExeKbn41;
        // 修正／削除不可区分
        public DateTime ExeDTime41;
        // 実行日時
        public string ErrMess41;
        // エラーメッセージ
        public byte ExeCode42;
        // 特殊処理コード
        public byte ExeKbn42;
        // 修正／削除不可区分
        public DateTime ExeDTime42;
        // 実行日時
        public string ErrMess42;
        // エラーメッセージ
        public byte ExeCode43;
        // 特殊処理コード
        public byte ExeKbn43;
        // 修正／削除不可区分
        public DateTime ExeDTime43;
        // 実行日時
        public string ErrMess43;
        // エラーメッセージ
        public byte ExeCode44;
        // 特殊処理コード
        public byte ExeKbn44;
        // 修正／削除不可区分
        public DateTime ExeDTime44;
        // 実行日時
        public string ErrMess44;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 仮払い精算済
        // ----------------------------------------------------------
        public byte ExeCode51;
        // 特殊処理コード
        public byte ExeKbn51;
        // 修正／削除不可区分
        public DateTime ExeDTime51;
        // 実行日時
        public string ErrMess51;
        // エラーメッセージ
        public byte JNMonth21;
        // 自動仕訳内部月
        public byte JSwkInpKbn21;
        // 自動仕訳発生区分
        public int JDSrchNo21;
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth22;
        // 自動仕訳内部月
        public byte JSwkInpKbn22;
        // 自動仕訳発生区分
        public int JDSrchNo22;
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth23;
        // 自動仕訳内部月
        public byte JSwkInpKbn23;
        // 自動仕訳発生区分
        public int JDSrchNo23;
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth24;
        // 自動仕訳内部月
        public byte JSwkInpKbn24;
        // 自動仕訳発生区分
        public int JDSrchNo24;
        // 自動仕訳明細検索ＮＯ
        public byte NMonthF;
        // 仕訳内部月
        public byte SwkInpKbnF;
        // 仕訳発生区分
        public byte DSrchNoF;
        // 明細検索ＮＯ
        public byte BDSrchNoF;
        // 明細検索ＮＯ(更新前) 内部処理でのみ使用
        public byte RowNoF;
        // 伝票明細ＮＯ
        public byte HSrchNoF;
        // 仕訳ヘッダ検索ＮＯ
        public byte RDSrchNoF;
        // 相手側明細検索ＮＯ
        public byte DKmkCodeF;
        // 科目コード
        public byte DSubCodeF;
        // 細目科目コード
        public byte DBmnCodeF;
        // 部門コード
        public byte DSegCode1F;
        // セグメントコード１
        public byte DHojKbn1F;
        // 第１補助区分
        public byte DHojCode1F;
        // 第１補助コード
        public byte DHojKbn2F;
        // 第２補助区分
        public byte DHojCode2F;
        // 第２補助コード
        public byte DKojCodeF;
        // 工事コード
        public byte DKsyCodeF;
        // 工種コード
        public byte DBsBmnCdF;
        // 仮受/仮払消費税部門コード
        public byte DBankCodeF;
        // 銀行コード
        public byte DTaxKbnF;
        // 消費税売上／仕入区分
        public byte DTypeCdF;
        // 業種コード
        public byte DTaxIncF;
        // 税抜／税込区分
        public byte CKmkCodeF;
        // 科目コード
        public byte CSubCodeF;
        // 細目科目コード
        public byte CBmnCodeF;
        // 部門コード
        public byte CSegCode1F;
        // セグメントコード１
        public byte CHojKbn1F;
        // 第１補助区分
        public byte CHojCode1F;
        // 第１補助コード
        public byte CHojKbn2F;
        // 第２補助区分
        public byte CHojCode2F;
        // 第２補助コード
        public byte CKojCodeF;
        // 工事コード
        public byte CKsyCodeF;
        // 工種コード
        public byte CBsBmnCdF;
        // 仮受/仮払消費税部門コード
        public byte CBankCodeF;
        // 銀行コード
        public byte CTaxKbnF;
        // 消費税売上／仕入区分
        public byte CTypeCdF;
        // 業種コード
        public byte CTaxIncF;
        // 税抜／税込区分
        public byte CashKbnF;
        // 資金繰入力区分
        public byte CashCodeF;
        // 資金繰コード
        public byte TaxCodeF;
        // 消費税コード
        public byte TaxRateF;
        // 消費税率区分
        public byte ExcptRateF;
        // 例外税率区分
        public byte TaxInpKbnF;
        // 外税同時入力区分
        public byte InpSumF;
        // 金額（入力金額）
        public byte TaxSumF;
        // 消費税額
        public byte InpPoIntF;
        // 金額小数点桁数
        public byte TaxPoIntF;
        // 消費税額小数点桁数
        public byte LimitDateF;
        // 期日
        public byte TekiyoF;
        // 摘要
        public byte TekiCd1F;
        // 固定摘要コード１
        public byte TekiCd2F;
        // 固定摘要コード２
        public byte TekiCd3F;
        // 固定摘要コード３
        public byte TekiCd4F;
        // 固定摘要コード４
        public byte TekiCd5F;
        // 固定摘要コード５
        public byte NonAccF;
        // 非会計データ区分
        public byte ImgKbnF;
        // ＯＣＲイメージ摘要区分
        public byte SwkInpKbn2F;
        // 仕訳発生区分(修正)
        public byte FirstDateF;
        // 初回入力日時
        public byte FkSetKbnF;
        // 複合セット処理区分
        public byte DKmkCode2F;
        // 借方第２科目コード
        public byte CKmkCode2F;
        // 貸方第２科目コード
        public byte DKmkKbn2F;
        // 借方第２科目セット区分
        public byte CKmkKbn2F;
        // 貸方第２科目セット区分
        public byte BusCodeF;
        // 入力部署コード
        public byte BusDSrchNoF;
        // 入力部署検索NO
        public byte StaffKbn01F;
        // 担当者区分
        public byte StaffCode01F;
        // 担当者コード
        public byte StaffName01F;
        // 担当者名
        public byte UpdateTime01F;
        // 入力修正日時
        public byte FusenKbnF;
        // 付箋区分
        public byte FusenCmntF;
        // 付箋コメント
        public byte SwkAIKbnF;
        // 仕訳付加情報セットフラグ
        public byte FKmkCodeF;
        // 複合勘定科目コード
        public byte FSubCodeF;
        // 複合細目科目コード
        public byte FBmnCodeF;
        // 複合部門コード
        public byte FSegCode1F;
        // 複合セグメントコード
        public byte FHojCode1F;
        // 複合第1補助コード
        public byte FHojCode2F;
        // 複合第2補助コード
        public byte FKojCodeF;
        // 複合工事コード
        public byte FKsyCodeF;
        // 複合工種コード
        public byte NumValue1F;
        // 番号１（請求書ＮＯ）
        public byte NumValue2F;
        // 番号２（契約書ＮＯ）
        public byte BillNumF;
        // 手形番号
        public byte BillCNumF;
        // 手形管理番号
        public byte BillClassF;
        // 手形種別
        public byte BillRankF;
        // 手形信用度
        public byte DateIssueF;
        // 手形振出日
        public byte DrawNameF;
        // 手形振出人
        public byte ExgPlaceF;
        // 支払場所
        public byte FinCodeF;
        // 顛末コード
        public byte FinBankF;
        // 顛末銀行コード
        public byte HndKmkCdF;
        // 譲渡勘定科目コード
        public byte HndSubCdF;
        // 譲渡細目科目コード
        public byte HndHojCdF;
        // 譲渡先コード
        public byte ChgComCdF;
        // 付替先会社コード
        public byte ChgBraCdF;
        // 付替先本支店コード
        public byte ChgDCKbnF;
        // 貸借区分
        public byte ChgKmkCdF;
        // 相手科目コード
        public byte ChgSubCdF;
        // 相手細目科目コード
        public byte ChgBmnCdF;
        // 相手部門コード
        public byte ChgHojCd1F;
        // 相手第１補助コード
        public byte ChgHojCd2F;
        // 相手第２補助コード
        public byte ChgKojCdF;
        // 相手工事コード
        public byte ChgKsyCdF;
        // 相手工種コード
        public byte ChgDateF;
        // 期日
        public byte ChgAitCdF;
        // 本支店勘定コード
        public byte ChgTaxCdF;
        // 消費税コード
        public byte ChgTaxRateF;
        // 消費税率区分
        public byte ChgTypeCdF;
        // 業種区分
        public byte ChgTaxSumF;
        // 消費税額
        public byte ChgNum1F;
        // 番号１（請求書ＮＯ）
        public byte ChgNum2F;
        // 番号２（契約書ＮＯ）
        public byte InpSum2F;
        // 数量 (外貨金額)
        public byte TaxSum2F;
        // 単価 (外貨レート)
        public byte InpPoInt2F;
        // 数量小数点桁数
        public byte TaxPoInt2F;
        // 単価小数点桁数
        public byte FinDateF;
        // 受取手形顛末処理日
        public byte SwkDicNoF;
        // 仕訳辞書NO
        public byte SaddKbn1F;
        public byte SaddKbn2F;
        public byte SaddKbn3F;
        // 借方番号
        public byte DNumValue1F;
        // 番号１（請求書ＮＯ）
        public byte DNumValue2F;
        // 番号２（契約書ＮＯ）
        public byte DNumValue3F;
        // 番号３
        public byte DNumValue4F;
        // 番号４
        public byte DNumValue5F;
        // 番号５
        public byte DNumValue6F;
        // 番号６
        public byte DNumValue7F;
        // 番号７
        public byte DNumValue8F;
        // 番号８
        public byte DNumValue9F;
        // 番号９
        public byte DNumValue10F;
        // 番号１０
        // 貸方番号
        public byte CNumValue1F;
        // 番号１（請求書ＮＯ）
        public byte CNumValue2F;
        // 番号２（契約書ＮＯ）
        public byte CNumValue3F;
        // 番号３
        public byte CNumValue4F;
        // 番号４
        public byte CNumValue5F;
        // 番号５
        public byte CNumValue6F;
        // 番号６
        public byte CNumValue7F;
        // 番号７
        public byte CNumValue8F;
        // 番号８
        public byte CNumValue9F;
        // 番号９
        public byte CNumValue10F;
        // 番号１０
        // 借方可変区分
        public byte DSubKbnF;
        // 科目別補助科目コード区分
        public byte DBmnKbnF;
        // 部門コード区分
        public byte DSeg1KbnF;
        // セグメントコード１区分
        public byte DHojyo1KbnF;
        // 第１補助コード区分
        public byte DHojyo2KbnF;
        // 第２補助コード区分
        public byte DKojKbnF;
        // 工事コード区分
        public byte DKsyKbnF;
        // 工種コード区分
        // 貸方可変区分
        public byte CSubKbnF;
        // 科目別補助科目コード区分
        public byte CBmnKbnF;
        // 部門コード区分
        public byte CSeg1KbnF;
        // セグメントコード１区分
        public byte CHojyo1KbnF;
        // 第１補助コード区分
        public byte CHojyo2KbnF;
        // 第２補助コード区分
        public byte CKojKbnF;
        // 工事コード区分
        public byte CKsyKbnF;
        // 工種コード区分
        public byte ChgSegCd1F;
        // セグメントコード１
        public byte ChgTaxKbnF;
        // 消費税売上／仕入区分
        public byte ChgExcptRateF;
        // 例外税率区分
        public byte ChgCashCdF;
        // 資金繰コード
        public byte ChgBillNumF;
        // 手形番号
        public byte ChgBillCNumF;
        // 手形管理番号
        public byte ExeCode00F;
        // 特殊処理コード
        public byte ExeKbn00F;
        // 修正／削除不可区分
        public byte ExeDTime00F;
        // 実行日時
        public byte ErrMess00F;
        // エラーメッセージ
        public byte ExeCode01F;
        // 特殊処理コード
        public byte ExeKbn01F;
        // 修正／削除不可区分
        public byte ExeDTime01F;
        // 実行日時
        public byte ErrMess01F;
        // エラーメッセージ
        public byte ExeCode03F;
        // 特殊処理コード
        public byte ExeKbn03F;
        // 修正／削除不可区分
        public byte ExeDTime03F;
        // 実行日時
        public byte ErrMess03F;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署入力受信
        // ----------------------------------------------------------
        public byte ExeCode04F;
        // 特殊処理コード
        public byte ExeKbn04F;
        // 修正／削除不可区分
        public byte ExeDTime04F;
        // 実行日時
        public byte ErrMess04F;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署承認／保留
        // ----------------------------------------------------------
        public byte ExeCode05F;
        // 特殊処理コード
        public byte ExeKbn05F;
        // 修正／削除不可区分
        public byte ExeDTime05F;
        // 実行日時
        public byte ErrMess05F;
        // エラーメッセージ
        public byte ExeCode11F;
        // 特殊処理コード
        public byte ExeKbn11F;
        // 修正／削除不可区分
        public byte ExeDTime11F;
        // 実行日時
        public byte ErrMess11F;
        // エラーメッセージ
        public byte ExeCode12F;
        // 特殊処理コード
        public byte ExeKbn12F;
        // 修正／削除不可区分
        public byte ExeDTime12F;
        // 実行日時
        public byte ErrMess12F;
        // エラーメッセージ
        public byte ExeCode13F;
        // 特殊処理コード
        public byte ExeKbn13F;
        // 修正／削除不可区分
        public byte ExeDTime13F;
        // 実行日時
        public byte ErrMess13F;
        // エラーメッセージ
        public byte ExeCode21F;
        // 特殊処理コード
        public byte ExeKbn21F;
        // 修正／削除不可区分
        public byte ExeDTime21F;
        // 実行日時
        public byte ErrMess21F;
        // エラーメッセージ
        public byte ExeCode22F;
        // 特殊処理コード
        public byte ExeKbn22F;
        // 修正／削除不可区分
        public byte ExeDTime22F;
        // 実行日時
        public byte ErrMess22F;
        // エラーメッセージ
        public byte ExeCode23F;
        // 特殊処理コード
        public byte ExeKbn23F;
        // 修正／削除不可区分
        public byte ExeDTime23F;
        // 実行日時
        public byte ErrMess23F;
        // エラーメッセージ
        public byte ExeCode24F;
        // 特殊処理コード
        public byte ExeKbn24F;
        // 修正／削除不可区分
        public byte ExeDTime24F;
        // 実行日時
        public byte ErrMess24F;
        // エラーメッセージ
        public byte ExeCode31F;
        // 特殊処理コード
        public byte ExeKbn31F;
        // 修正／削除不可区分
        public byte ExeDTime31F;
        // 実行日時
        public byte ErrMess31F;
        // エラーメッセージ
        public byte ExeCode32F;
        // 特殊処理コード
        public byte ExeKbn32F;
        // 修正／削除不可区分
        public byte ExeDTime32F;
        // 実行日時
        public byte ErrMess32F;
        // エラーメッセージ
        public byte ExeCode33F;
        // 特殊処理コード
        public byte ExeKbn33F;
        // 修正／削除不可区分
        public byte ExeDTime33F;
        // 実行日時
        public byte ErrMess33F;
        // エラーメッセージ
        public byte ExeCode34F;
        // 特殊処理コード
        public byte ExeKbn34F;
        // 修正／削除不可区分
        public byte ExeDTime34F;
        // 実行日時
        public byte ErrMess34F;
        // エラーメッセージ
        public byte ExeCode35F;
        // 特殊処理コード
        public byte ExeKbn35F;
        // 修正／削除不可区分
        public byte ExeDTime35F;
        // 実行日時
        public byte ErrMess35F;
        // エラーメッセージ
        public byte ExeCode41F;
        // 特殊処理コード
        public byte ExeKbn41F;
        // 修正／削除不可区分
        public byte ExeDTime41F;
        // 実行日時
        public byte ErrMess41F;
        // エラーメッセージ
        public byte ExeCode42F;
        // 特殊処理コード
        public byte ExeKbn42F;
        // 修正／削除不可区分
        public byte ExeDTime42F;
        // 実行日時
        public byte ErrMess42F;
        // エラーメッセージ
        public byte ExeCode43F;
        // 特殊処理コード
        public byte ExeKbn43F;
        // 修正／削除不可区分
        public byte ExeDTime43F;
        // 実行日時
        public byte ErrMess43F;
        // エラーメッセージ
        public byte ExeCode44F;
        // 特殊処理コード
        public byte ExeKbn44F;
        // 修正／削除不可区分
        public byte ExeDTime44F;
        // 実行日時
        public byte ErrMess44F;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 仮払い精算済
        // ----------------------------------------------------------
        public byte ExeCode51F;
        // 特殊処理コード
        public byte ExeKbn51F;
        // 修正／削除不可区分
        public byte ExeDTime51F;
        // 実行日時
        public byte ErrMess51F;
        // エラーメッセージ
        public byte JNMonth21F;
        // 自動仕訳内部月
        public byte JSwkInpKbn21F;
        // 自動仕訳発生区分
        public byte JDSrchNo21F;
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth22F;
        // 自動仕訳内部月
        public byte JSwkInpKbn22F;
        // 自動仕訳発生区分
        public byte JDSrchNo22F;
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth23F;
        // 自動仕訳内部月
        public byte JSwkInpKbn23F;
        // 自動仕訳発生区分
        public byte JDSrchNo23F;
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth24F;
        // 自動仕訳内部月
        public byte JSwkInpKbn24F;
        // 自動仕訳発生区分
        public byte JDSrchNo24F;
    } // end TVKZL310TrnDRec

    // OCRイメージ摘要
    public struct TVKZL310TrnIRec
    {
        public byte IUDKbn;
        // 処理区分
        public byte NMonth;
        // 仕訳内部月
        public int DSrchNo;
        // 明細検索ＮＯ
        public Bitmap ImgTeki;
        // イメージ摘要
        public byte NMonthF;
        // 仕訳内部月
        public byte DSrchNoF;
        // 明細検索ＮＯ
        public byte ImgTekiF;
    } // end TVKZL310TrnIRec

    // 仕訳証憑イメージ
    public struct TVKZL310TrnLIRec
    {
        public byte IUDKbn;
        // 処理区分
        public byte NMonth;
        // 仕訳内部月
        public int DSrchNo;
        // 明細検索ＮＯ
        // LeafImg			: TBitmap;												// 証憑イメージデータ	//<LEAF>DEL
        public Object LeafImg;
        // //<LEAF>ADD
        public byte ImgKbn;
        // イメージ区分
        public byte NMonthF;
        // 仕訳内部月
        public byte DSrchNoF;
        // 明細検索ＮＯ
        public byte LeafImgF;
        // イメージ摘要
        public byte ImgKbnF;
    } // end TVKZL310TrnLIRec

    // マスタ更新テンポラリ
    public struct TVKZL310TrnMRec
    {
        public byte IUDKbn;
        // 処理区分
        public DateTime DenDate;
        // 伝票日付
        public byte DataClass;
        // データ種別
        public byte NMonth;
        // 仕訳内部月
        public int DSrchNo;
        // 明細検索ＮＯ
        public int RowNo;
        // 伝票明細ＮＯ
        public int HSrchNo;
        // 仕訳ヘッダ検索ＮＯ
        public int DKmkCode;
        // 科目コード
        public int DSubCode;
        // 科目別補助コード
        public string DBmnCode;
        // 部門コード
        public string DSegCode1;
        // セグメントコード１
        public byte DHojKbn1;
        // 第１補助区分
        public string DHojCode1;
        // 第１補助コード
        public byte DHojKbn2;
        // 第２補助区分
        public string DHojCode2;
        // 第２補助コード
        public string DKojCode;
        // 工事コード
        public string DKsyCode;
        // 工種コード
        public string DBsBmnCd;
        // 仮受/仮払消費税部門コード
        public string DBankCode;
        // 銀行コード
        public byte DTaxKbn;
        // 消費税売上／仕入区分
        public byte DTypeCd;
        // 業種コード
        public byte DTaxInc;
        // 税抜／税込区分
        public int CKmkCode;
        // 科目コード
        public int CSubCode;
        // 科目別補助コード
        public string CBmnCode;
        // 部門コード
        public string CSegCode1;
        // セグメントコード１
        public byte CHojKbn1;
        // 第１補助区分
        public string CHojCode1;
        // 第１補助コード
        public byte CHojKbn2;
        // 第２補助区分
        public string CHojCode2;
        // 第２補助コード
        public string CKojCode;
        // 工事コード
        public string CKsyCode;
        // 工種コード
        public string CBsBmnCd;
        // 仮受/仮払消費税部門コード
        public string CBankCode;
        // 銀行コード
        public byte CTaxKbn;
        // 消費税売上／仕入区分
        public byte CTypeCd;
        // 業種コード
        public byte CTaxInc;
        // 税抜／税込区分
        public byte CashKbn;
        // 資金繰入力区分
        public byte CashCode;
        // 資金繰コード
        public byte TaxCode;
        // 消費税コード
        public short TaxRate;
        // 消費税率区分
        public byte ExcptRate;
        // 例外税率区分
        public byte TaxInpKbn;
        // 外税同時入力区分
        public decimal InpSum;
        // 金額（入力金額）
        public decimal TaxSum;
        // 消費税額
        public byte InpPoInt;
        // 金額小数点桁数
        public byte TaxPoInt;
        // 消費税額小数点桁数
        public byte NonAcc;
        // 非会計データ区分
        public int DKmkCode2;
        // 借方第２科目コード
        public int CKmkCode2;
        // 貸方第２科目コード
        public int DKmkKbn2;
        // 借方第２科目セット区分
        public int CKmkKbn2;
        // 貸方第２科目セット区分
        public byte UdKbnDKmk;
        // 科目
        public byte UdKbnDSub;
        // 科目別補助
        public byte UdKbnDHoj1;
        // 第１補助
        public byte UdKbnDHoj2;
        // 第２補助
        public byte UdKbnDBmn;
        // 部門
        public byte UdKbnDSeg1;
        // セグメント１
        public byte UdKbnDSeg2;
        // セグメント２
        public byte UdKbnDSeg3;
        // セグメント３
        public byte UdKbnDSeg4;
        // セグメント４
        public byte UdKbnDBmnH1;
        // 部門別第１補助
        public byte UdKbnDBmnH2;
        // 部門別第２補助
        public byte UdKbnDSeg1H1;
        // セグメント１別第１補助
        public byte UdKbnDSeg1H2;
        // セグメント１別第２補助
        public byte UdKbnDSeg2H1;
        // セグメント２別第１補助
        public byte UdKbnDSeg2H2;
        // セグメント２別第２補助
        public byte UdKbnDSeg3H1;
        // セグメント３別第１補助
        public byte UdKbnDSeg3H2;
        // セグメント３別第２補助
        public byte UdKbnDSeg4H1;
        // セグメント４別第１補助
        public byte UdKbnDSeg4H2;
        // セグメント４別第２補助
        public byte UdKbnDKoj;
        // 工事
        public byte UdKbnDKsy;
        // 工種
        public byte UdKbnCKmk;
        // 科目
        public byte UdKbnCSub;
        // 科目別補助
        public byte UdKbnCHoj1;
        // 第１補助
        public byte UdKbnCHoj2;
        // 第２補助
        public byte UdKbnCBmn;
        // 部門
        public byte UdKbnCSeg1;
        // セグメント１
        public byte UdKbnCSeg2;
        // セグメント２
        public byte UdKbnCSeg3;
        // セグメント３
        public byte UdKbnCSeg4;
        // セグメント４
        public byte UdKbnCBmnH1;
        // 部門別第１補助
        public byte UdKbnCBmnH2;
        // 部門別第２補助
        public byte UdKbnCSeg1H1;
        // セグメント１別第１補助
        public byte UdKbnCSeg1H2;
        // セグメント１別第２補助
        public byte UdKbnCSeg2H1;
        // セグメント２別第１補助
        public byte UdKbnCSeg2H2;
        // セグメント２別第２補助
        public byte UdKbnCSeg3H1;
        // セグメント３別第１補助
        public byte UdKbnCSeg3H2;
        // セグメント３別第２補助
        public byte UdKbnCSeg4H1;
        // セグメント４別第１補助
        public byte UdKbnCSeg4H2;
        // セグメント４別第２補助
        public byte UdKbnCKoj;
        // 工事
        public byte UdKbnCKsy;
        // 工種
        public byte UdKbnCash;
        // 資金
        public byte UdKbnTax;
    } // end TVKZL310TrnMRec

    public struct TVKZL310TrnSwkRec
    {
        public TVKZL310TrnHRec[] HRec;
        public TVKZL310TrnDRec[] DRec;
        public TVKZL310TrnIRec[] IRec;
        public TVKZL310TrnLIRec[] LIRec;
    } // end TVKZL310TrnSwkRec

    public struct TVKZL310TrnParamC
    {
        public TMjsAppRecord pMjsAppRecord;
        public TDataBase CopDB;
    } // end TVKZL310TrnParamC

    public struct TVKZL310TrnParamI
    {
        public byte tniSwkCKbn;
        // 1:仕訳入力 2:分散入力 3:定型仕訳
        public int iTantoCode;
        // 担当者コード
        public string strTantoName;
        // 担当者名
        public byte tniMailKbn;
        // 0:ＤＢのデフォルト 1:同期なし
        public byte tniHisKbn;
        // 修正履歴区分 1:履歴に載せない(強制処理)
        public byte tniJoinHisKbn;
        // 連結履歴区分 1:履歴に載せない(強制処理)
        public int iProcCode;
        // 処理コード 310000:仕訳処理 920300:マスタ再計算
        public int iSystemCode;
        // システムコード
        public byte iJidoFuban;
        // 検索ＮＯ自動付番 0:自動付番する 1:自動付番しない
        public byte iSwkInpKbn;
    } // end TVKZL310TrnParamI

    // 出力パラメータ
    public struct TVKZL310TrnParamO
    {
        public TMjsMsgRec MjsMsgRec;
    } // end TVKZL310TrnParamO

    // その他パラメータ
    public struct TVKZL310TrnParamE
    {
        public int Interval;
        // ロックリトライ間隔（単位はミリ秒）
        public int LockKbn;
        // ロック区分 0:ロックなし 0以外:ロックあり
        public int NGNMonth;
        // ロックエラー内部月
        public int RetryCount;
        // ロックリトライカウント
        public int DenNoSet;
        // 伝票NO自動付番区分
        // 0:伝票NO入力区分（KbnInfo.GnPuKbn12（RecKbn = 2））に従う
        // 1:伝票NO自動付番しない
        public int AccOKDel;
        // 経理承認（上位承認）削除
        // 0:何もしない
        // 1:削除する
        public int TukeKbn;
    } // end TVKZL310TrnParamE

    public struct TVKZL310TrnSwkResult
    {
        public int SwkKbn;
        // 1:ヘッダ 2:明細
        public int SwkHSrcNo;
        // ヘッダ検索ＮＯ
        public int SwkDSrcNo;
        // 明細検索ＮＯ
        public int RowNo;
        // 伝票明細ＮＯ
        public int ErrCode;
        // エラーコード
        public string TableName;
        // テーブル名
        public int SwkENum;
        // 仕訳入力件数
        public decimal DCDiffSum;
        // 貸借バランスの差額
        public int BalanceKbn;
        // バランス一致区分 0:一致 1:不一致
        public int LstSrNo;
        // 最終検索ＮＯ
        public int DenNo;
    } // end TVKZL310TrnSwkResult

    // 月情報
    public struct TVKZL310TrnMonthInfo
    {
        public int SwkENum;
        // 仕訳入力件数
        public decimal DCDiffSum;
        // 貸借バランスの差額
        public int BalanceKbn;
        // バランス一致区分 0:一致 1:不一致
        public int LstHSrNo;
        // 最終検索ＮＯ（ヘッダ）
        public int LstDSrNo;
    } // end TVKZL310TrnMonthInfo

    public struct TVKZL310TrnSumResult
    {
        public int SwkHSrcNo;
        // ヘッダ検索ＮＯ
        public int SwkDSrcNo;
        // 明細検索ＮＯ
        public int RowNo;
        // 伝票明細ＮＯ
        public int ErrCode;
        // エラーコード
        public string TableName;
        // テーブル名
        public int HojyoKbn;
    } // end TVKZL310TrnSumResult

    // 初期処理パラメータ
    public struct TVKZL310TrnParam
    {
        public TVKZL310TrnParamC ParamC;
        public TVKZL310TrnParamI ParamI;
        public TVKZL310TrnParamO ParamO;
    } // end TVKZL310TrnParam

    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310FixIFI
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // ******************************************************************************
    // 定型仕訳ヘッダ
    public struct TVKZL310FixHRec
    {
        public TVKZL310TrnHRec HRec;
        // 仕訳ヘッダ
        public int GCode;
        // 定型NO
        public string LongName;
        // 定型仕訳名称
        public string RenChar;
        // 連想シンボル
        public int TeikeiClass;
        // 出納帳定型種別
        public byte GCodeF;
        // 定型NO
        public byte LongNameF;
        // 定型仕訳名称
        public byte RenCharF;
        // 連想シンボル
        public byte TeikeiClassF;
    } // end TVKZL310FixHRec

    // 定型仕訳明細
    public struct TVKZL310FixDRec
    {
        public TVKZL310TrnDRec DRec;
        // 仕訳明細
        public byte DCKbn;
        // 当該科目貸借区分
        public byte TekiInpKbn;
        // 摘要入力区分
        public string DenNo;
        // 伝票ＮＯ
        public byte FxKbn1;
        // 定型用フリー区分
        public byte FxKbn2;
        // 定型用フリー区分
        public byte FxKbn3;
        // 定型用フリー区分
        public byte FxKbn4;
        // 定型用フリー区分
        public byte FxKbn5;
        // 定型用フリー区分
        public byte DBmnTou;
        // 借方部門当該区分
        public byte DShaTou;
        // 借方社員当該区分
        public byte CBmnTou;
        // 貸方部門当該区分
        public byte CShaTou;
        // 貸方社員当該区分
        public byte DCKbnF;
        // 当該科目貸借区分
        public byte TekiInpKbnF;
        // 摘要入力区分
        public byte DenNoF;
        // 伝票ＮＯ
        public byte FxKbn1F;
        // 定型用フリー区分
        public byte FxKbn2F;
        // 定型用フリー区分
        public byte FxKbn3F;
        // 定型用フリー区分
        public byte FxKbn4F;
        // 定型用フリー区分
        public byte FxKbn5F;
        // 定型用フリー区分
        public byte DBmnTouF;
        // 借方部門当該区分
        public byte DShaTouF;
        // 借方社員当該区分
        public byte CBmnTouF;
        // 貸方部門当該区分
        public byte CShaTouF;
    } // end TVKZL310FixDRec

    public struct TVKZL310FixSwkRec
    {
        public TVKZL310FixHRec[] HRec;
        public TVKZL310FixDRec[] DRec;
    } // end TVKZL310FixSwkRec

    // {$I VKZL311TrnIF_VK07I.inc}	//	分散更新
    // {$I MASL310EntryIFI.inc}
    // *****************************************************************************
    // System			:	ACELINK会計ｼｽﾃﾑ
    // Program			:	公益法人第２・３科目展開ｸﾗｽ
    // Name			:	T.Yamaguchi(MJS)
    // Create 			:	2001/11/09
    // Comment			:
    // History			:
    // <HIS-002>	2005/10/03	T.Yamaguchi
    // 公益法人新基準の対応
    // *****************************************************************************
    // type
    // *****************************************************************************
    // System			:	ACELINK会計ｼｽﾃﾑ
    // Program			:	公益法人第２・３科目展開ｸﾗｽ
    // Name			:	T.Yamaguchi(MJS)
    // Create 			:	2001/11/09
    // Comment			:
    // History			:
    // 2002/02/01	T.Yamaguchi		・社会福祉法人科目組み合わせ修正
    // 2005/10/03	T.Yamaguchi		・新公益法人科目組み合わせ新規追加
    // 2006/12/11	T.Yamaguchi		・新公益法人科目組み合わせ修正(H18.12.08 AL(公益) 科目性格／組合せ.xls)
    // 2006/12/27	T.Yamaguchi		・新公益法人科目組み合わせ修正(H18.12.27 AL(公益) 科目性格／組合せ.xls)
    // 2007/04/17	T.Yamaguchi		・科目組み合わせリストに相手区分を追加
    // 2012/01/19	T.Yamaguchi		・新社会福祉法人科目組み合わせ追加
    // 2014/07/22	T.Yamaguchi		・新学校法人科目組み合わせ(Ｈ27年基準)追加
    // *****************************************************************************
    // Type
    // 科目組み合わせリスト
    public struct TKoekiPatternRec
    {
        public int[] ariCharCode;
        // 性格コード		配列：[0]=借方 [1]=貸方
        public int[] ariDspKbn;
        // 表示区分		配列：[0]=借方 [1]=貸方		0:　なし	1:　借方第２	2:　貸方第２	11:借方第３		12:　貸方第３
        public bool[] arbInpKbn;
        // 入力区分		配列：[0]=消費 [1]=資金		True:　展開する		False:　展開しない
        public bool bPatKbn;
    } // end TKoekiPatternRec

    // 科目詳細情報(第１科目)
    public struct TKoekiKmkInfo
    {
        public int iCharCode;
        // 性格コード
        public int[] ari2KmkCd;
        // 第２科目コード  配列：[0]=借方 [1]=貸方
        public int[] ari3KmkCd;
    } // end TKoekiKmkInfo

    // 公益法人科目組み合わせ
    // 新公益法人科目組み合わせ
    // 学校法人科目組み合わせ
    // 新学校法人科目組み合わせ
    // 宗教法人科目組み合わせ
    // 社会福祉法人科目組み合わせ
    // 新社会福祉法人科目組み合わせ
    // __MASKOEKISETI_INC__
    // *****************************************************************************
    // System			:	ACELINK 会計／MJSLINK 財務
    // Program			:	公益法人第２・３科目展開クラス(マスター読み込み)
    // Name			:	T.Yamaguchi(MJS)
    // Create 			:	2012/08/24
    // Comment			:
    // History			:
    // *****************************************************************************
    // type
    public struct TKoekiMst_KmkMA
    {
        // 勘定科目基本マスタ
        // iMasterKbn     	: Integer;                        	//  マスタ区分                      1:勘定科目 2:科目別補助
        // iSumKbn        	: Integer;                        	//  実在／合計区分                  0:実在 1：合計
        // iRecordKbn     	: Integer;                        	//  レコード区分                    0:正規レコード 1:削除レコード 9:一時レコード
        public int iGCode;
        // 外部コード                      数字6桁
        // iSubCode       	: Integer;                        	//  科目別補助コード                数字6桁
        // iRenChar       	: String;                         	//  連想シンボル                    半角10文字
        public string sLongName;
        // 正式名称                        全角12文字（全半角混在） ※科目別補助は15文字まで
        public string sSimpleName;
    } // end TKoekiMst_KmkMA

    public struct TKoekiMst_KmkMB
    {
        // 勘定科目詳細情報
        // iMasterKbn 		: Integer; 				   			//  マスタ区分                1:勘定科目 2:科目別補助
        // iSumKbn         : Integer;                    	    //  実在／合計区分            0:実在 1：合計
        public int iGCode;
        // 外部コード                数字6桁
        // iSubCode        : Integer;                          //  科目別補助コード          数字6桁
        // dUpdateTime     : TDateTime;                        //  更新日時                  YYYY/MM/DD HH:MM:SS
        // iDecoKbn        : Integer;                          //  装飾区分                  0:なし 1:【 】 2:（ ） 3:〔 〕 4:＜ ＞ 5:(( )) 6:{  }
        // iMinusKbn       : Integer;                          //  マイナス印刷区分          0:なし 1:あり
        // iSagakuKbn      : Integer;                          //  差額印刷区分              0:なし 1:あり
        // iProfitKbn      : Integer;                          //  利益印刷区分              0:なし 1:あり
        // iTotalKbn       : Integer;                          //  合計表示区分              0:なし 1:あり
        // iruikeiKbn      : Integer;                          //  累計集計区分              0:累計あり 1:累計なし
        // iAveKbn         : Integer;                          //  平均値採用区分            0:なし 1:あり
        // iLevelKbn       : Integer;                          //  合計第２レベル区分        0:なし 1:あり
        // iSpKmkCode      : Integer;                          //  特殊合計科目コード
        // iPLCutKbn       : Integer;                          //  収入／支出除去区分
        // iReverseKbn     : Integer;                          //  仕訳データ逆転区分        0:なし 1:あり（そのまま逆転） 2:あり（マイナスして逆転）
        // iMTekiPrn       : Integer;                          //  元帳摘要欄起票者印字区分  0:印字しない 1:印字する
        // iOutKbn1      : Integer;                          //
        // iOutKbn2      : Integer;                          //
        // iOutKbn3      : Integer;                          //
        // iOutKbn4      : Integer;                          //
        // iOutKbn5      : Integer;                          //
        // iOutKbn6        : Integer;                          //  科目別補助電子帳簿採用区分
        // iTaniCode       : Integer;                          //  単位コード
        // sMinusName      : String;                          	//  マイナス変換科目名
        // iFixChgRate     : Integer;                          //  変動費比率
        // iCostRate       : Integer;                          //  個別原価率
        // iElRate1      : Integer;                          //
        // iElRate2      : Integer;                          //
        // iHisKbn         : Integer;                          //  履歴管理区分
        // iEBook1Kbn      : Integer;                          //  第1補助電子帳簿採用区分
        // iEBook2kbn      : Integer;                          //  第2補助電子帳簿採用区分
        public int iCharCode2;
        // 性格コード２
        public int iD2KmkCd;
        // 借方第２科目コード
        public int iD3KmkCd;
        // 借方第３科目コード
        public int iC2KmkCd;
        // 貸方第２科目コード
        public int iC3KmkCd;
    } // end TKoekiMst_KmkMB

    // ﾃｰﾌﾞﾙID
    // __MASKOEKISET_MSTI_INC__
    // *****************************************************************************
    // System			:	ACELINK 会計／MJSLINK 財務
    // Program			:	公益法人第２・３科目展開クラス(マスター読み込み)
    // Name			:	T.Yamaguchi(MJS)
    // Create 			:	2012/08/24
    // Comment			:
    // History			:
    // *****************************************************************************
    // type
    // キャッシュベース
    public class TKoekiCache
    {
        protected object FDb = null;
        protected TMDataModulef FDModule = null;
        protected List<string> FItems = null;
        // ------------------------------------------------------------------<HIS-002>---
        // *****************************************************************************
        // System			:	ACELINK 会計／MJSLINK 財務
        // Program			:	公益法人第２・３科目展開クラス(マスター読み込み)
        // Name			:	T.Yamaguchi(MJS)
        // Create 			:	2012/08/24
        // Comment			:
        // History			:
        // *****************************************************************************
        // TKoekiCache
        // ******************************************************************************
        // Proccess  :	Constructor
        // Parameter : cMod		TMDataModulef
        // cDb			TDatabase
        // Return    : None
        // ******************************************************************************
        //Constructor  Create( cMod,  cDb)
        public TKoekiCache(TMDataModulef cMod, TDatabase cDb)
        {
            FDModule = cMod;
            FDb = cDb;
            FItems = new List<string>();
            //@ Unsupported property or method(C): 'Sorted'
            FItems.Sorted = true;
        }
        // ******************************************************************************
        // Proccess  :	Destructor
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TKoekiCache()
        {
            Clear();
            //@ Unsupported property or method(A): 'Free'
            FItems.Free();
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess  :	クリア処理
        // ******************************************************************************
        public void Clear()
        {
            int idx;
            for (idx = 0; idx < FItems.Count; idx ++ )
            {
                //@ Unsupported property or method(A): 'Values'
                FreeRec((FItems.Values[idx] as object));
            }
            FItems.Clear();
        }

        // ******************************************************************************
        // Proccess  :	データ取得
        // Parameter : sCd			String			検索コード
        // Return    : Pointer						対象レコードのポインタ
        // ******************************************************************************
        public object GetData(string sCd)
        {
            object result;
            int idx;
            // キャッシュ検索
            idx = FItems.IndexOf(sCd);
            if (idx >  -1)
            {
                //@ Unsupported property or method(A): 'Values'
                result = (FItems.Values[idx] as object);
                return result;
            }
            // キャッシュになければ読み込んでキャッシュに追加
            result = ReadRec(sCd);
            if (result != null)
            {
                FItems.Add(sCd, ((result) as Object));
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	FItems に格納されているレコードの破棄
        // Comment	  :	処理は派生クラスで行う
        // ******************************************************************************
        public virtual void FreeRec(object Value)
        {
            // 何もしない

        }

        // ******************************************************************************
        // Proccess  :	レコード読み込み
        // Comment	  :	処理は派生クラスで行う
        // ******************************************************************************
        public virtual object ReadRec(string Key)
        {
            object result;
            result = null;
            return result;
        }

    } // end TKoekiCache

    // キャッシュ（KmkMA）
    public class TKoekiCache_KmkMA: TKoekiCache
    {
        public TKoekiCache(TMDataModulef cMod, TDatabase cDb) : base(cMod, cDb)
        {
        }
        // TKoekiCache_KmkMA
        // ******************************************************************************
        // Proccess  :	FItems に格納されているレコードの破棄
        // ******************************************************************************
        public override void FreeRec(object Value)
        {
            TKoekiMst_KmkMA pRec;
            if (Value != null)
            {
                pRec = Value;
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
            }
        }

        // ******************************************************************************
        // Proccess  :	データ読込
        // Parameter : Key			String		検索キー（科目外部コード）
        // Return    : Pointer					PKoekiMst_KmkMA
        // ******************************************************************************
        public override object ReadRec(string Key)
        {
            object result;
            TKoekiMst_KmkMA pRec;
            TMQuery cQue;
            pRec = null;
            cQue = new TMQuery(null);
            //@ Unsupported property or method(C): 'SQL'
             _wvar1 = cQue.SQL;
            try {
                //@ Unsupported property or method(D): 'UniDirectional'
                _wvar1.UniDirectional = true;
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                this.FDModule.SetDBInfoToQuery(this.FDb, cQue);
                //@ Unsupported property or method(B): 'BeginUpdate'
                _wvar1.BeginUpdate();
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("SELECT");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("GCode");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add(",LongName");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add(",SimpleName");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("FROM KmkMA");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("WHERE");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("MasterKbn=1");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("AND SumKbn=0");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("AND RecordKbn=0");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("AND GCode=" + Key);
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("AND SubCode=0");
                //@ Unsupported property or method(B): 'EndUpdate'
                _wvar1.EndUpdate();
                //@ Unsupported property or method(B): 'Open'
                if (_wvar1.Open())
                {
                    //@ Unsupported function or procedure: 'Eof'
                    if (!Eof)
                    {
                        pRec = new TKoekiMst_KmkMA();
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        pRec.iGCode = _wvar1.GetFld("GCode").AsInteger;
                        // 科目外部コード
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsString'
                        pRec.sLongName = _wvar1.GetFld("LongName").AsString;
                        // 正式名称
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsString'
                        pRec.sSimpleName = _wvar1.GetFld("SimpleName").AsString;
                    // 簡略名称
                    }
                    //Warning: unsupport Close
                    Close();
                }
            } finally {
                //@ Unsupported property or method(B): 'Free'
                cQue.Free();
            }
            result = pRec;
            return result;
        }

    } // end TKoekiCache_KmkMA

    // キャッシュ（KmkMB）
    public class TKoekiCache_KmkMB: TKoekiCache
    {
        public TKoekiCache(TMDataModulef cMod, TDatabase cDb) : base(cMod, cDb)
        {
        }
        // TKoekiCache_KmkMB
        // ******************************************************************************
        // Proccess  :	FItems に格納されているレコードの破棄
        // ******************************************************************************
        public override void FreeRec(object Value)
        {
            TKoekiMst_KmkMB pRec;
            if (Value != null)
            {
                pRec = Value;
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
            }
        }

        // ******************************************************************************
        // Proccess  :	データ読込
        // Parameter : Key			String		検索キー（科目外部コード）
        // Return    : Pointer					PKoekiMst_KmkMB
        // ******************************************************************************
        public override object ReadRec(string Key)
        {
            object result;
            TKoekiMst_KmkMB pRec;
            TMQuery cQue;
            pRec = null;
            cQue = new TMQuery(null);
            //@ Unsupported property or method(C): 'SQL'
             _wvar1 = cQue.SQL;
            try {
                //@ Unsupported property or method(D): 'UniDirectional'
                _wvar1.UniDirectional = true;
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                this.FDModule.SetDBInfoToQuery(this.FDb, cQue);
                //@ Unsupported property or method(B): 'BeginUpdate'
                _wvar1.BeginUpdate();
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("SELECT");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("GCode");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add(",CharCode2");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add(",D2KmkCd");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add(",D3KmkCd");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add(",C2KmkCd");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add(",C3KmkCd");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("FROM KmkMB");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("WHERE");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("MasterKbn=1");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("AND SumKbn=0");
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("AND GCode=" + Key);
                //@ Unsupported property or method(B): 'Add'
                _wvar1.Add("AND SubCode=0");
                //@ Unsupported property or method(B): 'EndUpdate'
                _wvar1.EndUpdate();
                //@ Unsupported property or method(B): 'Open'
                if (_wvar1.Open())
                {
                    //@ Unsupported function or procedure: 'Eof'
                    if (!Eof)
                    {
                        pRec = new TKoekiMst_KmkMB();
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        pRec.iGCode = _wvar1.GetFld("GCode").AsInteger;
                        // 科目外部コード
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        pRec.iCharCode2 = _wvar1.GetFld("CharCode2").AsInteger;
                        // 性格コード２
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        pRec.iD2KmkCd = _wvar1.GetFld("D2KmkCd").AsInteger;
                        // 借方第２科目コード
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        pRec.iD3KmkCd = _wvar1.GetFld("D3KmkCd").AsInteger;
                        // 借方第３科目コード
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        pRec.iC2KmkCd = _wvar1.GetFld("C2KmkCd").AsInteger;
                        // 貸方第２科目コード
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        pRec.iC3KmkCd = _wvar1.GetFld("C3KmkCd").AsInteger;
                    // 貸方第３科目コード
                    }
                    //Warning: unsupport Close
                    Close();
                }
            } finally {
                //@ Unsupported property or method(B): 'Free'
                cQue.Free();
            }
            result = pRec;
            return result;
        }

    } // end TKoekiCache_KmkMB

    // マスター読み込みクラス
    public class TMASKoekiSet_Mst
    {
        public TKoekiMst_KmkMA KmkMA
        {
          get {
            return m_rcKmkMA;
          }
        }
        public TKoekiMst_KmkMB KmkMB
        {
          get {
            return m_rcKmkMB;
          }
        }
        private TKoekiCache_KmkMA m_cMstKmkMA = null;
        private TKoekiCache_KmkMB m_cMstKmkMB = null;
        private TKoekiMst_KmkMA m_rcKmkMA = null;
        private TKoekiMst_KmkMB m_rcKmkMB = null;
        // TMASKoekiSet_Mst
        // ******************************************************************************
        // Proccess  :	Constructor
        // ******************************************************************************
        //Constructor  Create()
        public TMASKoekiSet_Mst()
        {
            // 特になし

        }
        // ******************************************************************************
        // Proccess  :	Destructor
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TMASKoekiSet_Mst()
        {
            //@ Unsupported property or method(A): 'Free'
            m_cMstKmkMA.Free();
            //@ Unsupported property or method(A): 'Free'
            m_cMstKmkMB.Free();
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess  :	初期処理
        // Parameter : cMod		TMDataModulef
        // cDb			TDatabase
        // Return    : None
        // ******************************************************************************
        public void Init(object cMod, object cDb)
        {
            m_cMstKmkMA = new TKoekiCache_KmkMA(cMod, cDb);
            m_cMstKmkMB = new TKoekiCache_KmkMB(cMod, cDb);
        }

        // ******************************************************************************
        // Proccess  :	キャッシュクリア
        // Parameter : None
        // Return    : None
        // ******************************************************************************
        public void Clear()
        {
            m_cMstKmkMA.Clear();
            m_cMstKmkMB.Clear();
        }

        // ******************************************************************************
        // Proccess  :	データ取得
        // Parameter : iTblID			Integer			テーブルＩＤ
        // iGCode			Integer			科目外部コード
        // Return    : Boolean			True: 取得成功	False:取得失敗
        // ******************************************************************************
        public bool GetData(int iTblID, int iGCode)
        {
            bool result;
            result = GetData(iTblID, (iGCode).ToString());
            return result;
        }

        public bool GetData(int iTblID, string sGCode)
        {
            bool result;
            object pRec;
            result = false;
            switch(iTblID)
            {
                case Units.MAS310000u.KTbl_KmkMA:
                    pRec = m_cMstKmkMA.GetData(sGCode);
                    if (pRec == null)
                    {
                        return result;
                    }
                    m_rcKmkMA = ((pRec) as TKoekiMst_KmkMA);
                    break;
                case Units.MAS310000u.KTbl_KmkMB:
                    pRec = m_cMstKmkMB.GetData(sGCode);
                    if (pRec == null)
                    {
                        return result;
                    }
                    m_rcKmkMB = ((pRec) as TKoekiMst_KmkMB);
                    break;
                default:
                    return result;
                    break;
            }
            result = true;
            return result;
        }

        // __MASKOEKISET_MSTB_INC__
#endif
    } // end TMASKoekiSet_Mst

    // __MASKOEKISET_MSTH_INC__
    public class TMASKoekiSet
    {
        // Published 宣言
        public int Status
        {
          get {
            return m_fStatus;
          }
        }
        // 展開状態
        public int DKmkKbn2
        {
          get {
            return m_fDKmkKbn2;
          }
        }
        // 借方第２科目セット区分
        public int DKmkCode2
        {
          get {
            return m_fDKmkCode2;
          }
        }
        // 借方第２科目コード（表示）
        public string DKmkLName2
        {
          get {
            return m_fDKmkLName2;
          }
        }
        // 借方第２科目正式名称（表示）
        public string DKmkSName2
        {
          get {
            return m_fDKmkSName2;
          }
        }
        // 借方第２科目簡略名称（表示）
        public int CKmkKbn2
        {
          get {
            return m_fCKmkKbn2;
          }
        }
        // 貸方第２科目セット区分
        public int CKmkCode2
        {
          get {
            return m_fCKmkCode2;
          }
        }
        // 貸方第２科目コード（表示）
        public string CKmkLName2
        {
          get {
            return m_fCKmkLName2;
          }
        }
        // 貸方第２科目正式名称（表示）
        public string CKmkSName2
        {
          get {
            return m_fCKmkSName2;
          }
        }
        // Private 宣言
        private TMASKoekiSet_Mst m_cMst = null;
        // ﾏｽﾀ読込み関係ｸﾗｽ
        private int m_iKoekiKbn = 0;
        // 公益法人区分      		0=一般法人 1=公益法人 2=学校法人 3=宗教法人 4=社会福祉法人
        private int m_iType = 0;
        // 仕訳入力方法      		0=消費収支 1=資金収支
        private int m_iTenkaiKbn = 0;
        // 自動仕訳展開区分      	0=なし 	   1=あり
        // ---<HIS-002>------------------------------------------------------------------
        private int m_iKijyun = 0;
        // 会計基準				0=基準 1=指針 2=授産 3=保育所 4=NPO 5=公益新基準
        // ------------------------------------------------------------------<HIS-002>---
        private TKoekiKmkInfo[] m_arKmkInfo;
        // 第１科目詳細情報  		配列：[0]=借方 [1]=貸方
        private bool m_InitFlg = false;
        // 初期処理(Init)済ﾌﾗｸﾞ    True=初期処理済 False=初期処理済ではない
        private int m_fStatus = 0;
        // 展開状態
        // 0=展開する
        // -1=展開しない（組み合わせが存在しない）
        // -2=展開しない（入力区分が入力不可）
        // -3=展開しない（一般法人）
        // -4=展開しない（詳細情報が取得できない）
        // -5=展開しない（該当する第２科目が存在しない）
        // -9=展開しない（その他）
        private int m_fDKmkKbn2 = 0;
        // 借方第２科目セット区分
        private int m_fDKmkCode2 = 0;
        // 借方第２科目コード  （表示）
        private string m_fDKmkLName2 = String.Empty;
        // 借方第２科目正式名称（表示）
        private string m_fDKmkSName2 = String.Empty;
        // 借方第２科目簡略名称（表示）
        private int m_fCKmkKbn2 = 0;
        // 貸方第２科目セット区分
        private int m_fCKmkCode2 = 0;
        // 貸方第２科目コード  （表示）
        private string m_fCKmkLName2 = String.Empty;
        // 貸方第２科目正式名称（表示）
        private string m_fCKmkSName2 = String.Empty;
        // Public 宣言
        // function AppEntry(pPar: Pointer) : Integer;
        // exports
        // AppEntry;
        // ---<HIS-007>------------------------------------------------------------------
        // ------------------------------------------------------------------<HIS-007>---
        // *****************************************************************************
        // System			:	ACELINK会計ｼｽﾃﾑ
        // Program			:	公益法人第２・３科目展開ｸﾗｽ
        // Name			:	T.Yamaguchi(MJS)
        // Create 			:	2001/11/09
        // Comment			:
        // History			:
        // <HIS-001>	2005/07/21	T.Yamaguchi
        // 自動仕訳展開区分 2:あり（仕訳組合せチェックなし）を追加
        // <HIS-002>	2005/10/03	T.Yamaguchi
        // 公益法人新基準の対応
        // <HIS-003>	2007/04/17	T.Yamaguchi
        // 公益法人新基準の仕様対応
        // <HIS-004>	2008/12/02	T.Yamaguchi
        // 会計基準追加対応
        // <HIS-005>	2011/08/25	T.Yamaguchi
        // 社会福祉法人新基準の対応
        // <HIS-006>	2014/07/22	T.Yamaguchi
        // 学校法人新基準の対応
        // *****************************************************************************
        // ******************************************************************************
        // Proccess	:	ｺﾝｽﾄﾗｸﾀ
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:	Nothing
        // Return		:
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TMASKoekiSet() : base()
        {
            m_cMst = new TMASKoekiSet_Mst();
        }
        // ******************************************************************************
        // Proccess	:	ﾃﾞｽﾄﾗｸﾀ
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:	Nothing
        // Return		:
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TMASKoekiSet()
        {
            //@ Unsupported property or method(A): 'Free'
            m_cMst.Free();
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	:	初期処理
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:	TMDataModulef	: DBModuleｵﾌﾞｼﾞｪｸﾄ
        // TDatabase		: DBｵﾌﾞｼﾞｪｸﾄ
        // Integer         : 公益法人区分  	0=一般法人 1=公益法人 2=学校法人 3=宗教法人 4=社会福祉法人
        // Integer         : 仕訳入力方法  	0=消費収支 1=資金収支
        // Integer			: 自動仕訳展開区分  0=なし 	   1=あり	  2=あり(仕訳組合せﾁｪｯｸなし)
        // Return		:	Integer			: 処理結果			0=OK	他=NG
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        public int Init(TMDataModulef cMDModule, TDatabase cCorpDB, int iKoekiKbn, int iType, int iTenkaiKbn)
        {
            int result;
            m_InitFlg = false;
            m_cMst.Init(cMDModule, cCorpDB);
            // DB関連付け処理
            m_iKoekiKbn = iKoekiKbn;
            // 公益法人区分
            m_iType = iType;
            // 仕訳入力方法
            m_iTenkaiKbn = iTenkaiKbn;
            // 自動仕訳展開区分
            // ---<HIS-002>------------------------------------------------------------------
            // 会計基準取得
            GetKijyun(cMDModule, cCorpDB);
            // ------------------------------------------------------------------<HIS-002>---
            // ﾊﾟﾗﾒｰﾀﾁｪｯｸ
            if (!(m_iKoekiKbn >= 0 && m_iKoekiKbn<= 4))
            {
                // NG: 公益法人区分
                result =  -1;
            }
            else if (!(m_iType >= 0 && m_iType<= 1))
            {
                // NG: 仕訳入力方法
                // ---<HIS-001>------------------------------------------------------------------
                result =  -2;
            }
            else if (!(m_iTenkaiKbn >= 0 && m_iTenkaiKbn<= 2))
            {
                // NG: 自動仕訳展開区分
                // else if not(m_iTenkaiKbn in[0..1]) then result := -3    //  NG: 自動仕訳展開区分
                // ------------------------------------------------------------------<HIS-001>---
                result =  -3;
            }
            else
            {
                m_InitFlg = true;
                result = 0;
            }
            // OK

            return result;
        }

        public int Init(TMDataModulef cMDModule, object cCorpDB)
        {
            int result;
            TMQuery cQuery;
            m_InitFlg = false;
            m_iKoekiKbn =  -1;
            m_iType =  -1;
            m_iTenkaiKbn =  -1;
            m_cMst.Init(cMDModule, cCorpDB);
            // DB関連付け処理
            cQuery = new TMQuery(null);
            try {
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                cMDModule.SetDBInfoToQuery(cCorpDB, cQuery);
                // 公益法人区分取得
                //Warning: unsupport Close
                Close();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Clear'
                cQuery.SQL.Clear();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                cQuery.SQL.Add("Select ComKbn4 From DTMAIN");
                //@ Unsupported property or method(B): 'Open'
                cQuery.Open();
                //@ Unsupported function or procedure: 'Eof'
                if (!Eof)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_iKoekiKbn = cQuery.GetFld("ComKbn4").AsInteger;
                }
                // 公益法人仕訳入力方法取得
                //Warning: unsupport Close
                Close();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Clear'
                cQuery.SQL.Clear();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                cQuery.SQL.Add("Select GnPuKbn1,GnPuKbn2 From KbnInfo Where RecKbn=13");
                //@ Unsupported property or method(B): 'Open'
                cQuery.Open();
                //@ Unsupported function or procedure: 'Eof'
                if (!Eof)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_iType = cQuery.GetFld("GnPuKbn1").AsInteger;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_iTenkaiKbn = cQuery.GetFld("GnPuKbn2").AsInteger;
                }
                //Warning: unsupport Close
                Close();
                //@ Unsupported property or method(A): 'Free'
                this.Free();
            }
            catch {
                //@ Unsupported property or method(B): 'Free'
                cQuery.Free();
            }
            // ---<HIS-002>------------------------------------------------------------------
            // 会計基準取得
            GetKijyun(cMDModule, cCorpDB);
            // ------------------------------------------------------------------<HIS-002>---
            // ﾊﾟﾗﾒｰﾀﾁｪｯｸ
            if (!(m_iKoekiKbn >= 0 && m_iKoekiKbn<= 4))
            {
                // NG: 公益法人区分
                result =  -1;
            }
            else if (!(m_iType >= 0 && m_iType<= 1))
            {
                // NG: 仕訳入力方法
                // ---<HIS-001>------------------------------------------------------------------
                result =  -2;
            }
            else if (!(m_iTenkaiKbn >= 0 && m_iTenkaiKbn<= 2))
            {
                // NG: 自動仕訳展開区分
                // else if not(m_iTenkaiKbn in[0..1]) then result := -3    //  NG: 自動仕訳展開区分
                // ------------------------------------------------------------------<HIS-001>---
                result =  -3;
            }
            else
            {
                m_InitFlg = true;
                result = 0;
            }
            // OK

            return result;
        }

        // ******************************************************************************
        // Proccess	:	第２・３科目展開処理
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:	array of Integer	: 第１科目ｺｰﾄﾞ	[0]=借方 [1]=貸方
        // Boolean				: 科目名称取得	True=取得する False=取得しない(ﾃﾞﾌｫﾙﾄ)
        // Return		:	Boolean				: 展開結果		True=展開する False=展開しない
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        public bool Exec(int[] ariKmkCode, bool bName)
        {
            bool result;
            bool bRet;
            int iRet;
            try {
                // ﾌﾟﾛﾊﾟﾃｨ初期化
                Clear();
                m_fStatus = 0;
                iRet =  -9;
                while (true)
                {
                    // 初期処理がされていない
                    if (!m_InitFlg)
                    {
                        m_fStatus =  -9;
                        // -9=展開しない（その他）
                        break;
                    }
                    // 一般法人は展開しない
                    if (m_iKoekiKbn == 0)
                    {
                        m_fStatus =  -3;
                        // -3=展開しない（一般法人）
                        break;
                    }
                    // 自動展開をしない
                    if (m_iTenkaiKbn == 0)
                    {
                        m_fStatus =  -4;
                        // -4=展開しない（自動展開なし）
                        break;
                    }
                    // 第１科目の詳細情報取得
                    bRet = GetKmkInfo(ariKmkCode);
                    if (!bRet)
                    {
                        m_fStatus =  -5;
                        // -5=展開しない（詳細情報が取得できない）
                        break;
                    }
                    switch(m_iKoekiKbn)
                    {
                        case 1:
                            // 科目組み合わせ
                            // ---<HIS-002>------------------------------------------------------------------
                            // 公益新基準
                            // ---<HIS-004>------------------------------------------------------------------
                            if (new ArrayList(new int[] {5, 7}).Contains(m_iKijyun))
                            {
                                // if m_iKijyun = 5 then
                                // ------------------------------------------------------------------<HIS-004>---
                                // 公益法人
                                iRet = SearchPattern(Units.MAS310000u.KPATLIST_1N);
                            }
                            else
                            {
                                iRet = SearchPattern(Units.MAS310000u.KPATLIST_1);
                            }
                            break;
                        case 2:
                            // 公益法人
                            // 1: iRet := SearchPattern(KPATLIST_1);		//  公益法人
                            // ------------------------------------------------------------------<HIS-002>---
                            // ---<HIS-006>------------------------------------------------------------------
                            if (m_iKijyun == 9)
                            {
                                // 学校法人(新)
                                iRet = SearchPattern(Units.MAS310000u.KPATLIST_2N);
                            }
                            else
                            {
                                iRet = SearchPattern(Units.MAS310000u.KPATLIST_2);
                            }
                            break;
                        case 3:
                            // 学校法人
                            // 2: iRet := SearchPattern(KPATLIST_2);       //  学校法人
                            // ------------------------------------------------------------------<HIS-006>---
                            iRet = SearchPattern(Units.MAS310000u.KPATLIST_3);
                            break;
                        case 4:
                            // 宗教法人
                            // ---<HIS-005>------------------------------------------------------------------
                            if (m_iKijyun == 8)
                            {
                                // 社会福祉法人(新)
                                iRet = SearchPattern(Units.MAS310000u.KPATLIST_4N);
                            }
                            else
                            {
                                iRet = SearchPattern(Units.MAS310000u.KPATLIST_4);
                            }
                            break;
                    // 社会福祉法人
                    // 4: iRet := SearchPattern(KPATLIST_4);       //  社会福祉法人
                    // ------------------------------------------------------------------<HIS-005>---
                    }
                    if (iRet < 0)
                    {
                        m_fStatus = iRet;
                        // 0=展開する -1,-2,-4=展開しない
                        break;
                    }
                    // 科目名称取得
                    if (bName)
                    {
                        bRet = GetKmkName(m_fDKmkCode2, m_fCKmkCode2);
                        if (!bRet)
                        {
                            Clear();
                            m_fStatus =  -6;
                            // -6=展開しない（該当する第２科目が存在しない）
                            break;
                        }
                    }
                    break;
                }
                if (m_fStatus < 0)
                {
                    result = false;
                }
                else
                {
                    result = true;
                }
            }
            catch {
                result = false;
                Clear();
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	:	ｷｬｯｼｭ領域のｸﾘｱ
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:	Nothing
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        public void CashClear()
        {
            m_cMst.Clear();
        }

        // 貸方第２科目簡略名称（表示）
        // ******************************************************************************
        // Proccess	:	ﾌﾟﾛﾊﾟﾃｨのｸﾘｱ
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:	Nothing
        // Return		:   Nothing
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        private void Clear()
        {
            m_fStatus =  -9;
            // 展開状態
            m_fDKmkKbn2 = 0;
            // 借方表示区分（仮名）
            m_fDKmkCode2 = 0;
            // 借方第２科目コード  （表示）
            m_fDKmkLName2 = "";
            // 借方第２科目正式名称（表示）
            m_fDKmkSName2 = "";
            // 借方第２科目簡略名称（表示）
            m_fCKmkKbn2 = 0;
            // 貸方表示区分（仮名）
            m_fCKmkCode2 = 0;
            // 貸方第２科目コード  （表示）
            m_fCKmkLName2 = "";
            // 貸方第２科目正式名称（表示）
            m_fCKmkSName2 = "";
            // 貸方第２科目簡略名称（表示）

        }

        // ******************************************************************************
        // Proccess	:	科目詳細情報取得
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:	array of Integer	: 第１科目ｺｰﾄﾞ[0]=借方 [1]=貸方
        // Return		:   Boolean				: 処理の成否	True: OK	False: NG
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        private bool GetKmkInfo(int[] ariGCode)
        {
            bool result;
            int iDC;
            bool bRet;
            result = true;
            for (iDC = 0; iDC <= 1; iDC ++ )
            {
                bRet = m_cMst.GetData(Units.MAS310000u.KTbl_KmkMB, ariGCode[iDC]);
                if (bRet)
                {
                    // OK
                    m_arKmkInfo[iDC].iCharCode = m_cMst.KmkMB.iCharCode2;
                    // 性格コード２
                    m_arKmkInfo[iDC].ari2KmkCd[0] = m_cMst.KmkMB.iD2KmkCd;
                    // 借方第２科目コード
                    m_arKmkInfo[iDC].ari2KmkCd[1] = m_cMst.KmkMB.iC2KmkCd;
                    // 貸方第２科目コード
                    m_arKmkInfo[iDC].ari3KmkCd[0] = m_cMst.KmkMB.iD3KmkCd;
                    // 借方第３科目コード
                    m_arKmkInfo[iDC].ari3KmkCd[1] = m_cMst.KmkMB.iC3KmkCd;
                // 貸方第３科目コード
                }
                else
                {
                    // NG
                    result = false;
                    m_arKmkInfo[iDC].iCharCode = 0;
                    m_arKmkInfo[iDC].ari2KmkCd[0] = 0;
                    m_arKmkInfo[iDC].ari2KmkCd[1] = 0;
                    m_arKmkInfo[iDC].ari3KmkCd[0] = 0;
                    m_arKmkInfo[iDC].ari3KmkCd[1] = 0;
                }
            }
            // for

            return result;
        }

        // //////////////////////////////////////////////////////////////////////////
        // 表示区分から第２・３科目コードを取得
        public int SearchPattern_fnGetGCode(int iDsp)
        {
            int result;
            switch(iDsp)
            {
                case 1:
                    result = m_arKmkInfo[0].ari2KmkCd[0];
                    break;
                case 2:
                    result = m_arKmkInfo[0].ari3KmkCd[0];
                    break;
                case 11:
                    result = m_arKmkInfo[1].ari2KmkCd[1];
                    break;
                case 12:
                    result = m_arKmkInfo[1].ari3KmkCd[1];
                    break;
                default:
                    result = 0;
                    break;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	:	科目組み合わせ検索&展開処理
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:   array of TKoekiPatternRec	: 科目組み合わせリスト
        // Return		:	Boolean                     : 処理結果
        // 0=あり
        // -1=なし（組み合わせが存在しない）
        // -2=なし（入力区分が入力不可）
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        private int SearchPattern(TKoekiPatternRec[] arPatList)
        {
            int result;
            int iLoop;
            result =  -1;
            for (iLoop = 0; iLoop <= arPatList.GetUpperBound(0); iLoop ++ )
            {
                // 貸借第１科目の性格コードの組み合わせが一致するものを探す
                if ((m_arKmkInfo[0].iCharCode == arPatList[iLoop].ariCharCode[0]) && (m_arKmkInfo[1].iCharCode == arPatList[iLoop].ariCharCode[1]))
                {
                    // ---<HIS-001>------------------------------------------------------------------
                    // 仕訳組合せﾁｪｯｸの有無(m_iTenkaiKbn = 2:仕訳組合せﾁｪｯｸなし)
                    if (m_iTenkaiKbn == 2)
                    {
                        // -4=展開しない（自動展開なし）
                        result =  -4;
                    }
                    else
                    {
                        result =  -2;
                    }
                    // -2=展開しない（入力区分が入力不可）
                    // result := -2;
                    // ------------------------------------------------------------------<HIS-001>---
                    // 入力区分が入力可のときに展開する
                    if (arPatList[iLoop].arbInpKbn[m_iType] == true)
                    {
                        result = 0;
                        m_fDKmkKbn2 = arPatList[iLoop].ariDspKbn[0];
                        m_fDKmkCode2 = SearchPattern_fnGetGCode(m_fDKmkKbn2);
                        m_fCKmkKbn2 = arPatList[iLoop].ariDspKbn[1];
                        m_fCKmkCode2 = SearchPattern_fnGetGCode(m_fCKmkKbn2);
                        // ---<HIS-003>------------------------------------------------------------------
                        // 貸借両方が展開されているか(一方のみでは展開しない)
                        if (arPatList[iLoop].bPatKbn)
                        {
                            if (!((m_fDKmkCode2 > 0) && (m_fCKmkCode2 > 0)))
                            {
                                Clear();
                                result =  -6;
                            // -6=展開しない（該当する第２科目が存在しない）
                            }
                        }
                    // ------------------------------------------------------------------<HIS-003>---
                    }
                    break;
                }
            }
            // for

            return result;
        }

        // ******************************************************************************
        // Proccess	:	科目名称取得
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/11/09
        // Parameter	:	Integer				: 借方外部コード
        // Integer				: 貸方外部コード
        // Return		:   Boolean				: 処理の成否	True: OK	False: NG
        // History		:	YYYY/MM/DD		X.XXXXX
        // ******************************************************************************
        private bool GetKmkName(int iDGCode, int iCGCode)
        {
            bool result;
            int iDC;
            bool bRet;
            int[] ariGCode = new int[1 + 1];
            result = true;
            ariGCode[0] = iDGCode;
            ariGCode[1] = iCGCode;
            for (iDC = 0; iDC <= 1; iDC ++ )
            {
                // 科目ｺｰﾄﾞ=0 は無視
                if (ariGCode[iDC] == 0)
                {
                    continue;
                }
                bRet = m_cMst.GetData(Units.MAS310000u.KTbl_KmkMA, ariGCode[iDC]);
                if (bRet)
                {
                    // OK
                    if (iDC == 0)
                    {
                        m_fDKmkLName2 = m_cMst.KmkMA.sLongName;
                        // 借方第２科目正式名称（表示）
                        m_fDKmkSName2 = m_cMst.KmkMA.sSimpleName;
                    // 借方第２科目簡略名称（表示）
                    }
                    else
                    {
                        m_fCKmkLName2 = m_cMst.KmkMA.sLongName;
                        // 貸方第２科目正式名称（表示）
                        m_fCKmkSName2 = m_cMst.KmkMA.sSimpleName;
                    // 貸方第２科目簡略名称（表示）
                    }
                }
                else
                {
                    // NG
                    result = false;
                    break;
                }
            }
            // for

            return result;
        }

        // ---<HIS-002>------------------------------------------------------------------
        // ---<HIS-002>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	会計基準取得
        // Parameter :	TMDataModulef		: DBModuleｵﾌﾞｼﾞｪｸﾄ
        // TDatabase			: DBｵﾌﾞｼﾞｪｸﾄ
        // Return    : None
        // ******************************************************************************
        private void GetKijyun(TMDataModulef cMDModule, object cCorpDB)
        {
            TMQuery cQuery;
            cQuery = new TMQuery(null);
            try {
                try {
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    cMDModule.SetDBInfoToQuery(cCorpDB, cQuery);
                    // 公益法人区分取得
                    //Warning: unsupport Close
                    Close();
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Clear'
                    cQuery.SQL.Clear();
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    cQuery.SQL.Add("Select ComKbn4 From DTMAIN");
                    //@ Unsupported property or method(B): 'Open'
                    cQuery.Open();
                    //@ Unsupported function or procedure: 'Eof'
                    if (!Eof)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        m_iKoekiKbn = cQuery.GetFld("ComKbn4").AsInteger;
                    }
                    // 公益法人仕訳入力方法取得
                    //Warning: unsupport Close
                    Close();
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Clear'
                    cQuery.SQL.Clear();
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    cQuery.SQL.Add("Select GnPuKbn3 From KbnInfo Where RecKbn=13");
                    //@ Unsupported property or method(B): 'Open'
                    cQuery.Open();
                    //@ Unsupported function or procedure: 'Eof'
                    if (!Eof)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        m_iKijyun = cQuery.GetFld("GnPuKbn3").AsInteger;
                    }
                    //Warning: unsupport Close
                    Close();
                }
                catch {
                    m_iKijyun = 0;
                }
            } finally {
                //@ Unsupported property or method(B): 'Free'
                cQuery.Free();
            }
        }

    } // end TMASKoekiSet

    // __MASKOEKISETH_INC__
    // (*verx*)
    // (*H0012 20011213 khattori	マルチ入力！*)
    // (*Ver A123 M102*)
    // (*H0026 20020328 khattori	第１指示のＣａｐｔｉｏｎ切替*)
    // (*H0045 20050303 khattori	項目修正*)
    // (*H0047 20050418 khattori	一括置換*)
    // <HIS-004> 2006/10/17 T.Yamaguchi	サブプログラム メニュー追加(他社データ取込 他)
    // <HIS-007> 2006/12/28 T.Yamaguchi	サブプログラム呼び出し時に指示から排他(会社別処理単独)をかける
    // <HIS-014> 2007/05/08 T.Yamaguchi	コクヨ伝票、部署伝票 対応
    // <HIS-044> 2008/08/20 T.Yamaguchi	仕訳排他 対応
    // <HIS-051> 2008/11/17 T.Yamaguchi	GetFixLock() 変更
    // ******************************************************************************
    // System		: 新会計大将
    // Program		: 仕訳ｳｨﾝﾄﾞｳｺﾝﾎﾟｰﾈﾝﾄ
    // ProgramID	: MAS310SelWndH
    // Name		: Y.Sato
    // Create		: 2000/09/21
    // Comment		: 仕訳ｳｨﾝﾄﾞｳｲﾝｸﾙｰﾄﾞﾌｧｲﾙ
    // History		: 2000/11/01	Y.Sato		・ﾏｳｽﾎｲｰﾙの不具合を修正
    // : 2000/11/02	Y.Sato		・TSelWndPanelｺｰﾄﾞ幅設定ﾌﾟﾛﾊﾟﾃｨ追加
    // : 2000/11/07	Y.Sato		・複数会社DB対応
    // : 2000/11/08	Y.Sato		・ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択区分を追加
    // Y.Sato		・連想入力対応
    // : 2000/11/20	Y.Sato		・ｳｨﾝﾄﾞｳ表示桁数自動ｾｯﾄ対応
    // : 2000/11/24	Y.Sato		・適用開始年月日,適用終了年月日を考慮
    // : 2000/11/29	Y.Sato		・連想絞込みで表示されていないﾃﾞｰﾀも選択できるように修正
    // : 2001/01/09	Y.Sato		・固定摘要チェック関数を追加
    // : 2001/02/05	Y.Sato		・固定摘要表示で仕訳辞書摘要も表示
    // : 2001/02/08	Y.Sato		・表示用と検索用で配列を別に持つ
    // : 2001/04/27	Y.Sato		・表示処理で表示件数を返せるようにする
    // ******************************************************************************
    // (*H0001	20020219 khattori ＣＲ！！！*)
    // (*20020225 khattori	件数が多い時、表示が遅くなる*)
    // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
    // <HIS-060> 2009/09/07 T.Yamaguchi	ウィンドウ コードによる絞り込み機能を追加
    // ******************************************************************************
    // System		: 新会計大将
    // Program		: 仕訳ｳｨﾝﾄﾞｳｽﾚｯﾄﾞ
    // ProgramID	: MAS310SelWndThreadH
    // Name		: Y.Sato
    // Create		: 2000/11/09
    // Comment		: 仕訳ｳｨﾝﾄﾞｳｽﾚｯﾄﾞｲﾝｸﾙｰﾄﾞﾌｧｲﾙ
    // History		: 2000/12/01	Y.Sato		･ﾃﾞﾌｫﾙﾄのｽﾚｯﾄﾞ優先度をtpLowerに変更
    // ******************************************************************************
    // ******************************************************************************
    // TMAS310SelWndThread
    // ******************************************************************************
    // 固定摘要分類
    public struct TWTblDataTekiTree
    {
        public int BasedCode;
        // 固定摘要ｺｰﾄﾞ
        public TWTekiTreeData[] TekiTreeData;
    } // end TWTblDataTekiTree

    public class TMAS310SelWndThread: Thread
    {
        // Private 宣言
        private TMjsAppRecord m_pRec = null;
        private object m_cCorpDB = null;
        private TMDataModulef m_cMDModule = null;
        private TMASCom m_cSysCom = null;
        private object mqCop = null;
        private TWMasterInfo MasterInfo = null;
        private int m_iSyoriKubun = 0;
        // ﾏｽﾀ基本情報
        private int PIndex = 0;
        private TWTableID TableID;
        // 処理中のﾃｰﾌﾞﾙ
        private TWTblData[] TblList;
        private TWTblDataTekiTree[] TekiTree;
        // Public 宣言
        // __MASKOEKISETB_INC__
        // ******************************************************************************
        // Proccess	:	TMASL310Root
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // (*H0001	20010522 khattori 初期処理失敗時のメッセージに出す処理名*)
        // (*H0002	20010601 khattori 送付時確定がだめ*)
        // (*H0003	20010619 khattori 月可変の時、翌期の日付が入ってしまう*)
        // (*H0004 20010725 tyamaguchi 付箋ボタン対応*)
        // (*H0005	20010731 tyamaguchi	入力不可区分、修正／削除区分対応*)
        // (*H0006 20010820 tyamaguchi コード拡大ボタン対応*)
        // (*H0007 20010921 tyamaguchi 定型仕訳対応*)
        // (*H0008 20010926 khattori 定型仕訳 排他対応*)
        // (*H0009 20010926 khattori 定型仕訳 戻り場所を定型ＮＯに*)
        // (*H0010 20010928 khattori	更新確認のＣａｎｃｅｌボタン*)
        // (*ver5*)
        // (*H0011 20011116 khattori	ドリルダウンがマスタ更新してくれない？*)
        // (*verx*)
        // (*H0012 20011213 khattori	マルチ入力！*)
        // (*ver1.20*)
        // (*H0013 20020222 khattori	バランス更新！*)
        // (*Ver A123 M102*)
        // (*H0014 20020328 khattori	第１指示のＣａｐｔｉｏｎ切替*)
        // (*H0015 20020328 khattori	連想入力モード*)
        // (*Ver Axxx Mxxx*)
        // (*H0016 20020501 khattori 分散入力*)
        // (*H0017 20020522 khattori 伝票入力*)
        // (*H0018 20030124 khattori 翌期表示*)
        // (*H0019 20030718 khattori	syuusei 20030220 ni tsuika sita ronnri ga nuketa*)
        // (*H0038 20030904 khattori	分散入力<単一入力>*)
        // (*H0045 20050303 khattori	項目修正*)
        // (*H0047 20050418 khattori	一括置換*)
        // <HIS-001> 2006/02/15 T.Yamaguchi	サブプログラムボタン ＆ Excel取込 対応
        // <HIS-004> 2006/10/17 T.Yamaguchi	サブプログラム メニュー追加(他社データ取込 他)
        // <HIS-007> 2006/12/28 T.Yamaguchi	サブプログラム呼び出し時に指示から排他(会社別処理単独)をかける
        // <HIS-013> 2007/05/08 T.Yamaguchi	Root関数の一部をML版より移植
        // <HIS-014> 2007/05/08 T.Yamaguchi	伝票 対応
        // <HIS-025> 2007/11/19 T.Yamaguchi	本店−部署 対応 (ML より)
        // <HIS-036> 2008/06/04 T.Yamaguchi	MAS312101⇔MAS312102 のドリルダウンでエラーになる
        // <HIS-044> 2008/08/20 T.Yamaguchi	仕訳排他 対応
        // <HIS-046> 2008/09/01 T.Yamaguchi	分散入力で定型が使えない
        // <HIS-051> 2008/11/17 T.Yamaguchi	GetFixLock() 変更
        // <HIS-052> 2009/01/09 T.Yamaguchi	翌期の月可変を可能にする
        // <HIS-055> 2009/03/16 T.Yamaguchi	連想モード Vista 対応
        // <HIS-057> 2009/04/21 T.Yamaguchi	<HIS-052>不具合 当期⇔翌期の判断が不十分(月またがりが考慮されていない)
        // <HIS-072> 2011/11/10 T.Yamaguchi	日付チェック不備(会計期間 1/1〜12/31 で仕訳入力開始月のガードがかからない)
        // <VK03201> 20111111 T.Yamaguchi	日付チェック関数 仕訳入力開始月の考慮が不十分
        // <VK04001> 20130426 T.Yamaguchi	定型修正 連想の変更が反映されない
        // ******************************************************************************
        // System		: 新会計大将
        // Program		: 仕訳ｳｨﾝﾄﾞｳｺﾝﾎﾟｰﾈﾝﾄ
        // ProgramID	: MAS310SelWndB
        // Name		: Y.Sato
        // Create		: 2000/09/21
        // Comment		: 仕訳ｳｨﾝﾄﾞｳｲﾝｸﾙｰﾄﾞﾌｧｲﾙ
        // History		: 2000/10/31	Y.Sato		・取引先対応
        // ・非消費税仕訳対応
        // : 2000/11/01	Y.Sato		・ﾏｳｽﾎｲｰﾙの不具合を修正
        // : 2000/11/02	Y.Sato		・TSelWndPanelｺｰﾄﾞ幅設定ﾌﾟﾛﾊﾟﾃｨ追加
        // : 2000/11/06	Y.Sato		・借方/貸方表示区分を変更
        // : 2000/11/07	Y.Sato		・複数会社DB対応
        // : 2000/11/08	Y.Sato		・ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択区分を追加
        // Y.Sato		・消費税はｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択なし
        // Y.Sato		・連想入力対応
        // : 2000/11/13	Y.Sato		・資金繰科目前期繰越は表示しない
        // : 2000/11/20	Y.Sato		・ｳｨﾝﾄﾞｳ表示桁数自動ｾｯﾄ対応
        // : 2000/11/21	Y.Sato		・ｽｷｰﾏ変更対応(固定摘要ﾏｽﾀ)
        // : 2000/11/22	Y.Sato		・固定摘要表示列切り換え対応
        // : 2000/11/24	Y.Sato		・適用開始年月日,適用終了年月日を考慮
        // : 2000/11/29	Y.Sato		・連想絞込みで表示されていないﾃﾞｰﾀも選択できるように修正
        // Y.Sato		・ｳｨﾝﾄﾞｳ非表示のときﾃﾞｰﾀ選択できるように修正
        // Y.Sato		・非表示選択のときｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択不可
        // : 2000/12/07	Y.Sato		・勘定科目表示に貸借入力のみを考慮
        // : 2000/12/18	Y.Sato		・勘定科目表示の不具合を修正
        // : 2000/12/20	Y.Sato		・部門がP/Lのみ採用のときP/L部門+諸口を表示するように修正
        // : 2000/12/21	Y.Sato		・細目科目表示の不具合修正
        // : 2000/12/25	Y.Sato		・セグメント表示対応
        // : 2001/01/09	Y.Sato		・固定摘要チェック関数を追加
        // : 2001/01/12	Y.Sato		・検索で該当データがなかったときはウィンドウパラメータをクリアする
        // : 2001/01/22	Y.Sato		・摘要残優先表示を変更
        // : 2001/02/05	Y.Sato		・固定摘要表示で仕訳辞書摘要も表示
        // ・工事表示を修正（入力区分を参照する）
        // : 2001/02/06	Y.Sato		・科目表示のとき要約分析コードを複数参照する
        // : 2001/02/07	Y.Sato		・科目表示でウィンドウ表示順序を考慮
        // : 2001/02/08	Y.Sato		・科目表示のとき分析コードを複数参照する（要約分析コードは参照しない）
        // Y.Sato		・表示用と検索用で配列を別に持つ
        // : 2001/02/09	Y.Sato		・表示パラメータに固定摘要ウィンドウ表示パターンを追加
        // : 2001/04/26	Y.Sato		・仕訳入力区分が入力不可でも表示する
        // ・消費税の仮払９を変更
        // : 2001/04/27	Y.Sato		・表示処理で表示件数を返せるようにする
        // : 2001/05/07	Y.Sato		・摘要残優先表示のとき、科目で絞り込む
        // : 2001/05/08	Y.Sato		・摘要残優先表示の変更
        // : 2001/05/10	Y.Sato		・仕訳辞書摘要表示対応
        // : 2001/05/11	Y.Sato		・固定摘要科目連想表示の色を緑から黒に変更
        // : 2001/05/14	Y.Sato		・細目科目表示の不具合を修正
        // : 2001/05/16	Y.Sato		・ウィンドウ表示順序のとき、空白は非表示
        // ******************************************************************************
        // (*♪♪♪♪♪　Ｓｐｅｃｉａｌ　！！！　*)
        // (*H0001	20010529 khattori ウィンドウ表示順序のとき、空白は非表示ー＞出納帳の当該だけ*)
        // (*H0002 20010614 khattori syuusei 消費税文言変更*)
        // (*H0003 20010620 khattori syuusei 入力不可科目、非会計科目の表示*)
        // (*H0004 20010710 khattori ＆が変！*)
        // (*Ver.6*)
        // (*H0005 20011206 khattori 顧問先でウィンドウ表示順序を見る時、事務所のところを見る*)
        // (*H0006	20020219 khattori ＣＲ！！！*)
        // (*Ver1.01*)
        // (*20020225 khattori	件数が多い時、表示が遅くなる*)
        // (*Ver A123 M103*)
        // (*H0030 20020501 khattori	手形入力対応（以外検索）*)
        // (*Ver A??? M108*)
        // (*H0030 20021017 khattori	非会計科目の部門ウィンドウが諸口だけでは不満らしい*)
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        // (*H0045 20050303 T.Shimada	解像度対応。114%時に2桁コードが切れてしまうので、拡大率の考慮を追加。*)
        // <HIS-015> 2007/05/31 T.Yamaguchi	画面サイズ可変 対応
        // <HIS-058> 2009/05/25 T.Yamaguchi	ウィンドウ(消費税仕入パターン)変更
        // <HIS-060> 2009/09/07 T.Yamaguchi	ウィンドウ コードによる絞り込み機能を追加
        // <HIS-061> 2009/10/06 T.Yamaguchi	ウィンドウ 連想で入力不可科目が表示される
        // <HIS-075> 2012/04/20 T.Yamaguchi	非課税売上対応部門 対応
        // <HIS-078> 2013/06/26 T.Yamaguchi	消費税コード追加「15」「16」「25」「26」
        // <HIS-084> 2014/06/04 T.Yamaguchi	消費税コード文言変更「34 有価証券売上等(非課税)」
#if !__MAS310SELWNDB_INC__
#define __MAS310SELWNDB_INC__
        // ******************************************************************************
        // System		: 新会計大将
        // Program		: 仕訳ｳｨﾝﾄﾞｳｽﾚｯﾄﾞ
        // ProgramID	: MAS310SelWndThreadB
        // Name		: Y.Sato
        // Create		: 2000/11/09
        // Comment		: 仕訳ｳｨﾝﾄﾞｳｽﾚｯﾄﾞｲﾝｸﾙｰﾄﾞﾌｧｲﾙ
        // History		: 2000/11/21	Y.Sato		・ｽｷｰﾏ変更対応(固定摘要ﾏｽﾀ)
        // : 2000/12/01	Y.Sato		・固定摘要の読込が遅かったのを修正
        // : 2000/12/04	Y.Sato		・DBｵｰﾌﾟﾝを変更
        // : 2000/12/20	Y.Sato		・部門がP/Lのみ採用のときP/L部門+諸口を表示するように修正
        // : 2000/12/21	Y.Sato		・細目科目表示の不具合修正
        // : 2001/01/09	Y.Sato		・固定摘要表示の不具合修正
        // : 2001/02/05	Y.Sato		・固定摘要表示で仕訳辞書摘要も表示
        // ・工事表示を修正（入力区分を参照する）
        // : 2001/02/08	Y.Sato		・レコード読込でNULLの考慮
        // : 2001/02/09	Y.Sato		・メール会計対応（勘定科目の表示／印刷不可区分の見方を変更）
        // : 2001/04/25	Y.Sato		・正式名称が空でも表示する
        // ・仕訳入力区分が入力不可でも表示する
        // : 2001/05/10	Y.Sato		・仕訳辞書摘要表示対応
        // ******************************************************************************
        // (*20020222 khattori	件数が多い時、初期処理が長くなる*)
#if !__MAS310SELWNDTHREADB_INC__
#define __MAS310SELWNDTHREADB_INC__
        // ******************************************************************************
        // TMAS310SelWndThread
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: pRec			Pointer
        // : TableID		ﾃｰﾌﾞﾙID
        // : MasterInfo	ﾏｽﾀ基本情報
        // : OnTerminate	ｽﾚｯﾄﾞ終了時呼ばれる関数
        // Return		: なし
        // History		: 2000/12/04	Y.Sato		･DBｵｰﾌﾟﾝを変更
        // ******************************************************************************
        //Constructor  Create( pRec,  TableID,  MasterInfo,  iSyoriKubun,  Priority,  OnTerminate)
        public TMAS310SelWndThread(object pRec, TWTableID TableID, TWMasterInfo MasterInfo, int iSyoriKubun, TThreadPriority Priority, TNotifyEvent OnTerminate) : base(false)
        {
            // constructor TMAS310SelWndThread.Create(pRec: Pointer; TableID: TWTableID; MasterInfo: TWMasterInfo; Priority: TThreadPriority; OnTerminate: TNotifyEvent = nil);
            m_pRec = pRec;
            //@ Undeclared identifier(3): 'TMDataModulef'
            m_cMDModule = TMDataModulef(m_pRec.m_pDBModule);
            //@ Undeclared identifier(3): 'TMASCom'
            m_cSysCom = TMASCom(m_pRec.m_pSystemArea);
            //@ Unsupported property or method(A): 'COPDBOpen'
            m_cCorpDB = m_cMDModule.COPDBOpen(0, m_pRec.m_iCorpID);
            if (m_cCorpDB != null)
            {
                mqCop = new TMQuery(null);
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                m_cMDModule.SetDBInfoToQuery(m_cCorpDB, mqCop);
            }
            this.TableID = TableID;
            this.MasterInfo = MasterInfo;
            this.Priority = Priority;
            //@ Unsupported property or method(C): 'OnTerminate'
            this.OnTerminate = OnTerminate;
            this.m_iSyoriKubun = iSyoriKubun;
        }
        public TMAS310SelWndThread(object pRec, TWTableID TableID, TWMasterInfo MasterInfo, int iSyoriKubun, TThreadPriority Priority)
           : this(pRec, TableID, MasterInfo, iSyoriKubun, Priority, null)
        {
        }

        // ******************************************************************************
        // Proccess	: ｽﾚｯﾄﾞ終了処理
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TMAS310SelWndThread()
        {
            base.Destroy();
            if (m_cCorpDB != null)
            {
                //@ Unsupported property or method(D): 'Free'
                mqCop.Free;
                //@ Unsupported property or method(A): 'COPDBClose'
                m_cMDModule.COPDBClose(m_cCorpDB);
                m_cCorpDB = null;
            }
        }
        // ******************************************************************************
        // Proccess	: ｽﾚｯﾄﾞ処理
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public override void Execute()
        {
            // (*20020222 khattori	件数が多い時、初期処理が長くなる*)
            int ILoop;
            int Index;
            //@ Undeclared identifier(3): 'Synchronize'
            Synchronize(GetCount());
            PIndex = Index;
            // (*20020222 khattori	件数が多い時、初期処理が長くなる*)
            if (TblList.Length > 0)
            {
                for (ILoop = 0; ILoop <= ((TblList.GetUpperBound(0) + 1) / 100); ILoop ++ )
                {
                    //@ Unsupported property or method(C): 'Terminated'
                    if (this.Terminated)
                    {
                        break;
                    }
                    Index = ILoop * 100;
                    //@ Undeclared identifier(3): 'Synchronize'
                    Synchronize(GetRecord());
                }
            }
            // for Index := 0 to High(TblList) do
            // begin
            // if Terminated then	Break;
            // Synchronize(GetRecord);
            // end;

        }

        // ******************************************************************************
        // Proccess	: ﾚｺｰﾄﾞ件数を取得
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: なし
        // Return		: なし
        // History		: 2000/11/21	Y.Sato		・ｽｷｰﾏ変更対応(固定摘要ﾏｽﾀ)
        // : 2000/12/20	Y.Sato		・部門がP/Lのみ採用のときP/L部門+諸口を表示するように修正
        // : 2000/12/21	Y.Sato		・細目科目表示の不具合修正
        // : 2001/01/09	Y.Sato		・固定摘要表示の不具合修正
        // : 2001/02/05	Y.Sato		・固定摘要表示で仕訳辞書摘要も表示
        // ・工事表示を修正（入力区分を参照する）
        // : 2001/02/08	Y.Sato		・レコード読込でNULLの考慮
        // : 2001/02/09	Y.Sato		・メール会計対応（勘定科目の表示／印刷不可区分の見方を変更）
        // : 2001/05/10	Y.Sato		・仕訳辞書摘要表示対応
        // ******************************************************************************
        private void GetCount()
        {
            int Index1;
            int Index2;
            string MasterKbn;
            int DataKbn;
            // データ区分（発生区分）
            int ComKbn3;
            // メール会計区分
            string sSql;
            try {
                DataKbn = 0;
                ComKbn3 = 0;
                switch(TableID)
                {
                    case VKZ310Cmnu.TWTableID.wtiKanjoKmk:
                        MasterKbn = '1';
                        break;
                    case VKZ310Cmnu.TWTableID.wtiSaimkKmk:
                        // 勘定科目
                        MasterKbn = '2';
                        break;
                    case VKZ310Cmnu.TWTableID.wtiCash:
                        // 細目科目
                        MasterKbn = '3';
                        break;
                    case VKZ310Cmnu.TWTableID.wtiGinko:
                        // 資金繰科目
                        MasterKbn = "21";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiTrhksaki:
                        // 銀行
                        MasterKbn = "22";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiTkisaki:
                        // 取引先
                        MasterKbn = "22";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiSirsaki:
                        // 得意先
                        MasterKbn = "22";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiShain:
                        // 仕入先
                        MasterKbn = "25";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiHanyo1:
                        // 社員
                        MasterKbn = "31";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiHanyo2:
                        // 汎用補助1
                        MasterKbn = "32";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiHanyo3:
                        // 汎用補助2
                        MasterKbn = "33";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiHanyo4:
                        // 汎用補助3
                        MasterKbn = "34";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiHanyo5:
                        // 汎用補助4
                        MasterKbn = "35";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiBumon:
                        // 汎用補助5
                        MasterKbn = "41";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiSeg1:
                        // 部門
                        MasterKbn = "42";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiSeg2:
                        // セグメント１
                        MasterKbn = "43";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiSeg3:
                        // セグメント２
                        MasterKbn = "44";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiSeg4:
                        // セグメント３
                        MasterKbn = "45";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiKoji:
                        // セグメント４
                        MasterKbn = "51";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiKosh:
                        // 工事
                        MasterKbn = "52";
                        break;
                    case VKZ310Cmnu.TWTableID.wtiTeki:
                        // 工種
                        MasterKbn = "61";
                        break;
                    default:
                        // 固定摘要
                        MasterKbn = '0';
                        break;
                }
                switch(TableID)
                {
                    case VKZ310Cmnu.TWTableID.wtiKanjoKmk:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn == 1))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT DataKbn, ComKbn3 FROM DTMAIN");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'Eof'
                            if (!mqCop.Eof)
                            {
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                DataKbn = mqCop.GetFld("DataKbn").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                ComKbn3 = mqCop.GetFld("ComKbn3").AsInteger;
                            }
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM KmkMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            // mqCop.SQL.Add('AND LongName <> '''''					);		// 正式名称が空は非表示 2001/04/25 削除 正式名称が空でも表示する
                            // (*20030109 khattori *)
                            if ((DataKbn != 0) && (m_iSyoriKubun == 0))
                            {
                                // if (ComKbn3 = 1) and (DataKbn <> 0) and (m_iSyoriKubun=0) then
                                // if (ComKbn3 <> 1) or (DataKbn <> 0) then
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                mqCop.SQL.Add("AND (NonDspKbn = 0 OR NonDspKbn IS NULL)");
                            }
                            // 表示／印刷不可区分
                            // mqCop.SQL.Add('AND (InputKbn <> 9 OR InputKbn IS NULL)'	);		// 仕訳入力区分が入力不可は非表示 2001/04/25 削除 仕訳入力区分が入力不可でも表示する
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, RenChar, SimpleName, StartDate, EndDate, AnalyzeCode, SumAnaCode, DCKbn, InputKbn";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    case VKZ310Cmnu.TWTableID.wtiSaimkKmk:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn == 1))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM KmkMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, SubCode, RenChar, SimpleName, StartDate, EndDate";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode, SubCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    case VKZ310Cmnu.TWTableID.wtiCash:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn == 1))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM SKmkMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND (AnalyzeCode <> 12 OR AnalyzeCode IS NULL)");
                            // 前期繰越以外
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, SimpleName";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    case VKZ310Cmnu.TWTableID.wtiGinko:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn == 1))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM HojyoMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, RenChar, SimpleName, StartDate, EndDate";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    case VKZ310Cmnu.TWTableID.wtiTrhksaki:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn == 1))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM HojyoMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, RenChar, SimpleName, HojyoKbn1, HojyoKbn2, StartDate, EndDate";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    case VKZ310Cmnu.TWTableID.wtiTkisaki:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn == 1))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM HojyoMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND HojyoKbn1 = 1");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, RenChar, SimpleName, StartDate, EndDate";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    case VKZ310Cmnu.TWTableID.wtiSirsaki:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn == 1))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM HojyoMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND HojyoKbn2 = 1");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, RenChar, SimpleName, StartDate, EndDate";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    // Modify the A .. B: VKZ310Cmnu.TWTableID.wtiShain .. VKZ310Cmnu.TWTableID.wtiHanyo5
                    case VKZ310Cmnu.TWTableID.wtiShain:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn == 1))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM HojyoMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, RenChar, SimpleName, StartDate, EndDate";
                            if ((TableID == VKZ310Cmnu.TWTableID.wtiShain))
                            {
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Strings'
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Strings'
                                mqCop.SQL.Strings[1] = mqCop.SQL.Strings[1] + ", SectionCode";
                            }
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    // Modify the A .. B: VKZ310Cmnu.TWTableID.wtiBumon .. VKZ310Cmnu.TWTableID.wtiSeg4
                    case VKZ310Cmnu.TWTableID.wtiBumon:
                        // P/Lのみ採用 or B/S&P/L採用
                        if ((mqCop != null) && ((MasterInfo.UseKbn == 1) || (MasterInfo.UseKbn == 2)))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM HojyoMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            if (MasterInfo.UseKbn == 1)
                            {
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                mqCop.SQL.Add("AND (HojyoKbn2 = 0 OR NCode = 0)");
                            }
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, RenChar, SimpleName, NCode, HojyoKbn1, HojyoKbn2, StartDate, EndDate";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    case VKZ310Cmnu.TWTableID.wtiKoji:
                        // 採用あり
                        if ((mqCop != null) && (MasterInfo.UseKbn > 0))
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(GCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM HojyoMA WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumKbn = 0");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND RecordKbn = 0");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "GCode, RenChar, SimpleName, BunCode, FinishDate";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("ORDER BY GCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                    case VKZ310Cmnu.TWTableID.wtiTeki:
                        if (mqCop != null)
                        {
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("SELECT");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("COUNT(DISTINCT BasedCode) AS RecCnt");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("FROM TekiTree WHERE");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("MasterKbn = " + MasterKbn);
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("AND SumCode > 0");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TekiTree = new TWTblDataTekiTree[mqCop.GetFld("RecCnt").AsInteger];
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "COUNT(BasedCode) AS RecCnt";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add("GROUP BY BasedCode ORDER BY BasedCode");
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                            for (Index1 = 0; Index1 <= TekiTree.GetUpperBound(0); Index1 ++ )
                            {
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TekiTree[Index1].TekiTreeData = new TWTekiTreeData[mqCop.GetFld("RecCnt").AsInteger];
                                //@ Unsupported property or method(D): 'Next'
                                mqCop.Next;
                            }
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[1] = "TekiKbn, SumCode, BasedCode";
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Count'
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Strings'
                            mqCop.SQL.Strings[mqCop.SQL.Count - 1] = "ORDER BY BasedCode, SumCode";
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                            for (Index1 = 0; Index1 <= TekiTree.GetUpperBound(0); Index1 ++ )
                            {
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TekiTree[Index1].BasedCode = mqCop.GetFld("BasedCode").AsInteger;
                                for (Index2 = 0; Index2 <= TekiTree[Index1].TekiTreeData.GetUpperBound(0); Index2 ++ )
                                {
                                    //@ Unsupported property or method(B): 'GetFld'
                                    //@ Unsupported property or method(D): 'AsInteger'
                                    TekiTree[Index1].TekiTreeData[Index2].TekiKbn = mqCop.GetFld("TekiKbn").AsInteger;
                                    //@ Unsupported property or method(B): 'GetFld'
                                    //@ Unsupported property or method(D): 'AsInteger'
                                    TekiTree[Index1].TekiTreeData[Index2].SumCode = mqCop.GetFld("SumCode").AsInteger;
                                    //@ Unsupported property or method(D): 'Next'
                                    mqCop.Next;
                                }
                                if (TekiTree[Index1].TekiTreeData.GetUpperBound(0) < 0)
                                {
                                    //@ Unsupported property or method(D): 'Next'
                                    mqCop.Next;
                                }
                            }
                            sSql = "SELECT COUNT(GCode) AS RecCnt FROM TekiMA WHERE" + " MasterKbn = " + MasterKbn + " AND SumKbn = 0" + " AND RecordKbn = 0";
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add(sSql);
                            // mqCop.SQL.Add('SELECT'						);
                            // mqCop.SQL.Add(	'COUNT(GCode) AS RecCnt'	);
                            // mqCop.SQL.Add('FROM TekiMA WHERE'			);
                            // mqCop.SQL.Add(	'MasterKbn = ' + MasterKbn	);
                            // mqCop.SQL.Add('AND SumKbn = 0'				);
                            // mqCop.SQL.Add('AND RecordKbn = 0'			);
                            // 2001/05/10
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            TblList = new TWTblData[mqCop.GetFld("RecCnt").AsInteger];
                            sSql = "SELECT" + " TekiMA.GCode AS GCode,RenChar,TekiChar,SectionCode,ZanKbn,SwDicKbn" + ",DKmkCode,DSubCode,DBmnCode,DSeg1Code,DHojyo1Code,DHojyo2Code,DKojCode,DKsyCode" + ",CKmkCode,CSubCode,CBmnCode,CSeg1Code,CHojyo1Code,CHojyo2Code,CKojCode,CKsyCode" + " FROM TekiMA LEFT OUTER JOIN SwDicTeki ON SwDicTeki.MasterKbn = 61 AND TekiMA.GCode = SwDicTeki.GCode AND TekiMA.SwDicKbn = 1" + " WHERE TekiMA.MasterKbn = " + MasterKbn + " AND SumKbn = 0 AND RecordKbn = 0" + " ORDER BY TekiMA.GCode";
                            //@ Unsupported property or method(D): 'Close'
                            mqCop.Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            mqCop.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            mqCop.SQL.Add(sSql);
                            // mqCop.SQL.Strings[1]	:= 'GCode, RenChar, TekiChar, SectionCode, ZanKbn, SwDicKbn';	2001/05/10
                            // mqCop.SQL.Add('ORDER BY GCode'				);	2001/05/10
                            //@ Unsupported property or method(D): 'Open'
                            mqCop.Open;
                            //@ Unsupported property or method(D): 'First'
                            mqCop.First;
                        }
                        break;
                }
            }
            catch {
                MessageBox.Show("選択ウィンドウで予期せぬエラーが発生しました。仕訳入力を終了してください。");
            }
        }

        // **************************************************************************
        // Proccess	: 適用開始年月日と適用終了年月日をｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/11/24
        // Parameter	: var StartDate	適用開始年月日
        // : var EndDate	適用終了年月日
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // **************************************************************************
        public void GetRecord_SetDate(ref int StartDate, ref int EndDate)
        {
            // 適用開始年月日
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'Value'
            //@ Undeclared identifier(3): 'null'
            if (mqCop.GetFld("StartDate").Value == null)
            {
                StartDate = 0;
            }
            else
            {
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsDateTime'
                //@ Undeclared identifier(3): 'MjsDateToInt8'
                StartDate = MjsDateToInt8(mqCop.GetFld("StartDate").AsDateTime);
            }
            // 適用終了年月日
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'Value'
            //@ Undeclared identifier(3): 'null'
            if (mqCop.GetFld("EndDate").Value == null)
            {
                EndDate = 0;
            }
            else
            {
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsDateTime'
                //@ Undeclared identifier(3): 'MjsDateToInt8'
                EndDate = MjsDateToInt8(mqCop.GetFld("EndDate").AsDateTime);
            }
        }

        // ******************************************************************************
        // Proccess	: ﾚｺｰﾄﾞﾃﾞｰﾀを取得
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: なし
        // Return		: なし
        // History		: 2001/01/09	Y.Sato		・固定摘要表示の不具合修正
        // : 2001/02/05	Y.Sato		・固定摘要表示で仕訳辞書摘要も表示
        // ・工事表示を修正（入力区分を参照する）
        // : 2001/05/10	Y.Sato		・仕訳辞書摘要表示対応
        // ******************************************************************************
        // (*20020222 khattori	件数が多い時、初期処理が長くなる*)
        private void GetRecord()
        {
            int Index1;
            int Index2;
            // (*20020222 khattori	件数が多い時、初期処理が長くなる*)
            int ILoop;
            try {
                // (*20020222 khattori	件数が多い時、初期処理が長くなる*)
                for (ILoop = PIndex; ILoop <= TblList.GetUpperBound(0); ILoop ++ )
                {
                    if (mqCop != null)
                    {
                        switch(TableID)
                        {
                            case VKZ310Cmnu.TWTableID.wtiKanjoKmk:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                //@ Unsupported property or method(A): 'SetDspCodeAttr'
                                TblList[ILoop].RecData.Code = m_cSysCom.SetDspCodeAttr(mqCop.GetFld("GCode").AsString, MasterInfo.CodeDigit, MasterInfo.CodeAttr);
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Name = mqCop.GetFld("SimpleName").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Ren = mqCop.GetFld("RenChar").AsString;
                                TblList[ILoop].RecData.Color = System.Drawing.Color.Black;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].KmkData.AnalyzeCode = mqCop.GetFld("AnalyzeCode").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].KmkData.SumAnaCode = mqCop.GetFld("SumAnaCode").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].KmkData.DCKbn = mqCop.GetFld("DCKbn").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].KmkData.InputKbn = mqCop.GetFld("Inputkbn").AsInteger;
                                GetRecord_SetDate(ref TblList[ILoop].StartDate, ref TblList[ILoop].EndDate);
                                break;
                            case VKZ310Cmnu.TWTableID.wtiSaimkKmk:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                //@ Unsupported property or method(A): 'SetDspCodeAttr'
                                TblList[ILoop].RecData.Code = m_cSysCom.SetDspCodeAttr(mqCop.GetFld("GCode").AsString, MasterInfo.CodeDigit, MasterInfo.CodeAttr);
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Name = mqCop.GetFld("SimpleName").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Ren = mqCop.GetFld("RenChar").AsString;
                                TblList[ILoop].RecData.Color = System.Drawing.Color.Black;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].KmkData.SubCode = mqCop.GetFld("SubCode").AsInteger;
                                GetRecord_SetDate(ref TblList[ILoop].StartDate, ref TblList[ILoop].EndDate);
                                break;
                            case VKZ310Cmnu.TWTableID.wtiCash:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                //@ Unsupported property or method(A): 'SetDspCodeAttr'
                                TblList[ILoop].RecData.Code = m_cSysCom.SetDspCodeAttr(mqCop.GetFld("GCode").AsString, MasterInfo.CodeDigit, MasterInfo.CodeAttr);
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Name = mqCop.GetFld("SimpleName").AsString;
                                TblList[ILoop].RecData.Ren = "";
                                TblList[ILoop].RecData.Color = System.Drawing.Color.Black;
                                break;
                            // Modify the A .. B: VKZ310Cmnu.TWTableID.wtiGinko, VKZ310Cmnu.TWTableID.wtiTkisaki .. VKZ310Cmnu.TWTableID.wtiHanyo5
                            case VKZ310Cmnu.TWTableID.wtiGinko:
                            case VKZ310Cmnu.TWTableID.wtiTkisaki:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                //@ Unsupported property or method(A): 'SetDspCodeAttr'
                                TblList[ILoop].RecData.Code = m_cSysCom.SetDspCodeAttr(mqCop.GetFld("GCode").AsString, MasterInfo.CodeDigit, MasterInfo.CodeAttr);
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Name = mqCop.GetFld("SimpleName").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Ren = mqCop.GetFld("RenChar").AsString;
                                TblList[ILoop].RecData.Color = System.Drawing.Color.Black;
                                if ((TableID == VKZ310Cmnu.TWTableID.wtiShain))
                                {
                                    //@ Unsupported property or method(B): 'GetFld'
                                    //@ Unsupported property or method(D): 'AsString'
                                    TblList[ILoop].TekiData.SectionCode = mqCop.GetFld("SectionCode").AsString;
                                }
                                GetRecord_SetDate(ref TblList[ILoop].StartDate, ref TblList[ILoop].EndDate);
                                break;
                            case VKZ310Cmnu.TWTableID.wtiTrhksaki:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                //@ Unsupported property or method(A): 'SetDspCodeAttr'
                                TblList[ILoop].RecData.Code = m_cSysCom.SetDspCodeAttr(mqCop.GetFld("GCode").AsString, MasterInfo.CodeDigit, MasterInfo.CodeAttr);
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Name = mqCop.GetFld("SimpleName").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Ren = mqCop.GetFld("RenChar").AsString;
                                TblList[ILoop].RecData.Color = System.Drawing.Color.Black;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].HojyoData.HojyoKbn1 = mqCop.GetFld("HojyoKbn1").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].HojyoData.HojyoKbn2 = mqCop.GetFld("HojyoKbn2").AsInteger;
                                GetRecord_SetDate(ref TblList[ILoop].StartDate, ref TblList[ILoop].EndDate);
                                break;
                            // Modify the A .. B: VKZ310Cmnu.TWTableID.wtiBumon .. VKZ310Cmnu.TWTableID.wtiSeg4
                            case VKZ310Cmnu.TWTableID.wtiBumon:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                //@ Unsupported property or method(A): 'SetDspCodeAttr'
                                TblList[ILoop].RecData.Code = m_cSysCom.SetDspCodeAttr(mqCop.GetFld("GCode").AsString, MasterInfo.CodeDigit, MasterInfo.CodeAttr);
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Name = mqCop.GetFld("SimpleName").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Ren = mqCop.GetFld("RenChar").AsString;
                                TblList[ILoop].RecData.Color = System.Drawing.Color.Black;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].HojyoData.NCode = mqCop.GetFld("NCode").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].HojyoData.HojyoKbn1 = mqCop.GetFld("HojyoKbn1").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].HojyoData.HojyoKbn2 = mqCop.GetFld("HojyoKbn2").AsInteger;
                                GetRecord_SetDate(ref TblList[ILoop].StartDate, ref TblList[ILoop].EndDate);
                                break;
                            case VKZ310Cmnu.TWTableID.wtiKoji:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                //@ Unsupported property or method(A): 'SetDspCodeAttr'
                                TblList[ILoop].RecData.Code = m_cSysCom.SetDspCodeAttr(mqCop.GetFld("GCode").AsString, MasterInfo.CodeDigit, MasterInfo.CodeAttr);
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Name = mqCop.GetFld("SimpleName").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Ren = mqCop.GetFld("RenChar").AsString;
                                TblList[ILoop].RecData.Color = System.Drawing.Color.Black;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].HojyoData.BunCode = mqCop.GetFld("BunCode").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsDateTime'
                                TblList[ILoop].HojyoData.FinishDate = mqCop.GetFld("FinishDate").AsDateTime;
                                break;
                            case VKZ310Cmnu.TWTableID.wtiKosh:
                                break;
                            case VKZ310Cmnu.TWTableID.wtiTeki:
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                //@ Unsupported property or method(A): 'SetDspCodeAttr'
                                TblList[ILoop].RecData.Code = m_cSysCom.SetDspCodeAttr(mqCop.GetFld("GCode").AsString, MasterInfo.CodeDigit, MasterInfo.CodeAttr);
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Name = mqCop.GetFld("TekiChar").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].RecData.Ren = mqCop.GetFld("RenChar").AsString;
                                TblList[ILoop].RecData.Color = System.Drawing.Color.Black;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.SectionCode = mqCop.GetFld("SectionCode").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].TekiData.ZanKbn = mqCop.GetFld("ZanKbn").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].TekiData.SwDicKbn = mqCop.GetFld("SwDicKbn").AsInteger;
                                // 2001/05/10
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].TekiData.DKmkCode = mqCop.GetFld("DKmkCode").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.DSubCode = mqCop.GetFld("DSubCode").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.DBmnCode = mqCop.GetFld("DBmnCode").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.DSeg1Code = mqCop.GetFld("DSeg1Code").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.DHojyo1Code = mqCop.GetFld("DHojyo1Code").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.DHojyo2Code = mqCop.GetFld("DHojyo2Code").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.DKojCode = mqCop.GetFld("DKojCode").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.DKsyCode = mqCop.GetFld("DKsyCode").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                TblList[ILoop].TekiData.CKmkCode = mqCop.GetFld("CKmkCode").AsInteger;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.CSubCode = mqCop.GetFld("CSubCode").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.CBmnCode = mqCop.GetFld("CBmnCode").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.CSeg1Code = mqCop.GetFld("CSeg1Code").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.CHojyo1Code = mqCop.GetFld("CHojyo1Code").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.CHojyo2Code = mqCop.GetFld("CHojyo2Code").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.CKojCode = mqCop.GetFld("CKojCode").AsString;
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                TblList[ILoop].TekiData.CKsyCode = mqCop.GetFld("CKsyCode").AsString;
                                for (Index1 = 0; Index1 <= TekiTree.GetUpperBound(0); Index1 ++ )
                                {
                                    if ((TekiTree[Index1].BasedCode).ToString() == TblList[ILoop].RecData.Code)
                                    {
                                        TblList[ILoop].TekiData.TekiTreeData = new TWTekiTreeData[TekiTree[Index1].TekiTreeData.GetUpperBound(0) + 1];
                                        for (Index2 = 0; Index2 <= TblList[ILoop].TekiData.TekiTreeData.GetUpperBound(0); Index2 ++ )
                                        {
                                            TblList[ILoop].TekiData.TekiTreeData[Index2].TekiKbn = TekiTree[Index1].TekiTreeData[Index2].TekiKbn;
                                            TblList[ILoop].TekiData.TekiTreeData[Index2].SumCode = TekiTree[Index1].TekiTreeData[Index2].SumCode;
                                        }
                                        break;
                                    }
                                    if (TekiTree[Index1].BasedCode > Convert.ToInt32(TblList[ILoop].RecData.Code))
                                    {
                                        break;
                                    }
                                }
                                break;
                        }
                        // case
                        // with
                        //@ Unsupported property or method(D): 'Next'
                        mqCop.Next;
                    }
                    // if
                    if (ILoop == PIndex + 99)
                    {
                        break;
                    }
                }
            // for
            }
            catch {
                MessageBox.Show("選択ウィンドウで予期せぬエラーが発生しました。仕訳入力を終了してください。");
            }
        }

    } // end TMAS310SelWndThread

    // ﾏｽﾀ基本情報
    public class TMAS310SelWndThreads
    {
    //@ Undeclared identifier(3): 'tpLower'
        // Private 宣言
        private object m_pRec = null;
        private TWMasterInfo[] MasterInfo;
        // ﾏｽﾀ基本情報
        private int m_iSyoriKubun = 0;
        // ﾏｽﾀ基本情報
        private object Priority = null;
        private TWTableID ProcTableID;
        // 処理中のﾃｰﾌﾞﾙ
        private TWTableID[] TableSet;
        // 処理対象ﾃｰﾌﾞﾙ
        private bool Terminated = false;
        private TMAS310SelWndThread[] ThreadList;
        // Public 宣言
        // ******************************************************************************
        // TMAS310SelWndThreads
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: pRec			Pointer
        // : TableSet		処理ﾃｰﾌﾞﾙ
        // : MasterInfo	ﾏｽﾀ基本情報
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create( pRec,  TableSet,  MasterInfo,  iSyoriKubun,  Priority)
        public TMAS310SelWndThreads(object pRec, TWTableID[] TableSet, TWMasterInfo[] MasterInfo, int iSyoriKubun, object Priority)
        {
            // constructor TMAS310SelWndThreads.Create(pRec: Pointer; TableSet: TWTableSet; MasterInfo: TWMasterInfoList; Priority: TThreadPriority);
            TWTableID TableID;
            m_pRec = pRec;
            if ((new ArrayList(TableSet).Contains(VKZ310Cmnu.TWTableID.wtiTkisaki)) || (new ArrayList(TableSet).Contains(VKZ310Cmnu.TWTableID.wtiSirsaki)))
            {
                // 得意先と仕入先は取引先で処理
                this.TableSet = TableSet + new TWTableID[] {VKZ310Cmnu.TWTableID.wtiTrhksaki} - new TWTableID[] {VKZ310Cmnu.TWTableID.wtiTkisaki, VKZ310Cmnu.TWTableID.wtiSirsaki};
            }
            else
            {
                this.TableSet = TableSet;
            }
            this.MasterInfo = MasterInfo;
            this.Priority = Priority;
            this.m_iSyoriKubun = iSyoriKubun;
            Terminated = false;
            //@ Unsupported function: 'Low'
            //@ Unsupported function: 'High'
            for (TableID = Low(TWTableID); TableID <= High(TWTableID); TableID ++ )
            {
                if (new ArrayList(this.TableSet).Contains(TableID))
                {
                    ThreadList[TableID] = new TMAS310SelWndThread(m_pRec, TableID, MasterInfo[TableID], m_iSyoriKubun, Priority, ThreadListTerminate);
                    ProcTableID = TableID;
                    break;
                }
            }
        }
        // ******************************************************************************
        // Proccess	: ｽﾚｯﾄﾞ終了処理
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TMAS310SelWndThreads()
        {
            TWTableID TableID;
            Terminated = true;
            //@ Unsupported function: 'Low'
            //@ Unsupported function: 'High'
            for (TableID = Low(TWTableID); TableID <= High(TWTableID); TableID ++ )
            {
                if (ThreadList[TableID] != null)
                {
                    //@ Unsupported property or method(C): 'Free'
                    ThreadList[TableID].Free;
                }
            }
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: ﾚｺｰﾄﾞを取得
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: TableID		ﾃｰﾌﾞﾙID
        // Return		: TWTblList		取得ﾃﾞｰﾀ
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public TWTblData[] GetRecList(object TableID)
        {
            TWTblData[] result;
            int Index;
            int iRecCnt;
            TWTableID TableIDWk;
            TableIDWk = TableID;
            if (new ArrayList(new object[] {VKZ310Cmnu.TWTableID.wtiTkisaki, VKZ310Cmnu.TWTableID.wtiSirsaki}).Contains(TableIDWk))
            {
                TableID = VKZ310Cmnu.TWTableID.wtiTrhksaki;
            }
            // 得意先と仕入先は取引先で処理
            // 未取得
            if (ThreadList[TableID] == null)
            {
                if (TableID != ProcTableID)
                {
                    //@ Unsupported property or method(C): 'Suspended'
                    ThreadList[ProcTableID].Suspended = true;
                }
                ThreadList[TableID] = new TMAS310SelWndThread(m_pRec, TableID, MasterInfo[TableID], m_iSyoriKubun, Priority);
                ThreadList[TableID].Sleep();
                if (TableID != ProcTableID)
                {
                    //@ Unsupported property or method(C): 'Suspended'
                    ThreadList[ProcTableID].Suspended = false;
                }
            }
            else if (!Terminated)
            {
                ThreadList[TableID].Sleep();
            }
            // 得意先、仕入先
            if (new ArrayList(new object[] {VKZ310Cmnu.TWTableID.wtiTkisaki, VKZ310Cmnu.TWTableID.wtiSirsaki}).Contains(TableIDWk))
            {
                iRecCnt = 0;
                result = new TWTblData[ThreadList[TableID].TblList.GetUpperBound(0) + 1];
                for (Index = 0; Index <= ThreadList[TableID].TblList.GetUpperBound(0); Index ++ )
                {
                    if ((TableIDWk == VKZ310Cmnu.TWTableID.wtiTkisaki) && (ThreadList[TableID].TblList[Index].HojyoData.HojyoKbn1 == 1) || (TableIDWk == VKZ310Cmnu.TWTableID.wtiSirsaki) && (ThreadList[TableID].TblList[Index].HojyoData.HojyoKbn2 == 1))
                    {
                        result[iRecCnt] = ThreadList[TableID].TblList[Index];
                        iRecCnt ++;
                    }
                }
                result = new TWTblData[iRecCnt];
            }
            else
            {
                result = ThreadList[TableID].TblList;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: ﾚｺｰﾄﾞを読む
        // Name		: Y.Sato
        // Date		: 2000/11/10
        // Parameter	: TableID		ﾃｰﾌﾞﾙID
        // : MasterInfo	ﾏｽﾀ基本情報
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void ReadRec(object TableID, object MasterInfo)
        {
            if (new ArrayList(new object[] {VKZ310Cmnu.TWTableID.wtiTkisaki, VKZ310Cmnu.TWTableID.wtiSirsaki}).Contains(TableID))
            {
                TableID = VKZ310Cmnu.TWTableID.wtiTrhksaki;
            }
            // 得意先と仕入先は取引先で処理
            this.MasterInfo[TableID] = MasterInfo;
            // 取得済 or 取得中
            if (ThreadList[TableID] != null)
            {
                //@ Unsupported property or method(C): 'Free'
                ThreadList[TableID].Free;
                ThreadList[TableID] = null;
            // 未取得
            }
            else if (!(new ArrayList(TableSet).Contains(TableID)))
            {
                TableSet = TableSet + new object[] {TableID};
            }
            // ｽﾚｯﾄﾞが終了している
            if (Terminated)
            {
                Terminated = false;
                ThreadList[TableID] = new TMAS310SelWndThread(m_pRec, TableID, MasterInfo, m_iSyoriKubun, Priority, ThreadListTerminate);
                ProcTableID = TableID;
            }
        }

        // ******************************************************************************
        // Proccess	: ｽﾚｯﾄﾞの優先度を変える
        // Name		: Y.Sato
        // Date		: 2000/11/22
        // Parameter	: Priority
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetPriority(TThreadPriority Priority)
        {
            this.Priority = Priority;
            if (!Terminated && (ThreadList[ProcTableID] != null))
            {
                ThreadList[ProcTableID].Priority = Priority;
            }
        }

        // ******************************************************************************
        // Proccess	: ｽﾚｯﾄﾞを停止再開する
        // Name		: Y.Sato
        // Date		: 2000/11/21
        // Parameter	: Suspended		True:停止
        // :				False:実行
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetSuspended(bool Suspended)
        {
            if (!Terminated && (ThreadList[ProcTableID] != null))
            {
                //@ Unsupported property or method(C): 'Suspended'
                ThreadList[ProcTableID].Suspended = Suspended;
            }
        }

        // ******************************************************************************
        // Component	: ThreadList	(TMAS310SelWndThread)
        // Event		: OnTerminate
        // Name		: Y.Sato
        // History		: 2000/12/04	Y.Sato		･終了したｽﾚｯﾄﾞはDBを閉じる
        // ******************************************************************************
        private void ThreadListTerminate(Object Sender)
        {
            TWTableID TableID;
            if (!Terminated)
            {
                //@ Unsupported property or method(D): 'Free'
                ThreadList[ProcTableID].mqCop.Free;
                //@ Unsupported property or method(A): 'COPDBClose'
                ThreadList[ProcTableID].m_cMDModule.COPDBClose(ThreadList[ProcTableID].m_cCorpDB);
                ThreadList[ProcTableID].m_cCorpDB = null;
                //@ Unsupported function: 'Low'
                //@ Unsupported function: 'High'
                for (TableID = Low(TWTableID); TableID <= High(TWTableID); TableID ++ )
                {
                    if ((new ArrayList(TableSet).Contains(TableID)) && (ThreadList[TableID] == null))
                    {
                        ThreadList[TableID] = new TMAS310SelWndThread(m_pRec, TableID, MasterInfo[TableID], m_iSyoriKubun, Priority, ThreadListTerminate());
                        ProcTableID = TableID;
                        break;
                    }
                }
                if (((Sender) as TMAS310SelWndThread).TableID == ProcTableID)
                {
                    Terminated = true;
                }
            }
        }

#endif
    } // end TMAS310SelWndThreads

    // 5;
    // MAS310SELWND_THREAD_TABLE1	= [wtiKanjoKmk..wtiGinko,wtiKoji,wtiKosh];
    // ******************************************************************************
    // TSelWndLabel
    // ******************************************************************************
    public class TSelWndLabel: Label
    {
        // Public 宣言
        // ******************************************************************************
        // TSelWndLabel
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: AOwner	TComponent
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create( AOwner)
        public TSelWndLabel(object AOwner) : base(AOwner)
        {
            this.AutoSize = false;
            this.TextAlign = System.Drawing.ContentAlignment.MiddleCenter;
        }
        // ******************************************************************************
        // Proccess	: DblClick
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public override void DblClick()
        {
            base.DblClick();
            ((this.Parent) as TSelWndPanel).DblClick();
        }

        // ******************************************************************************
        // Proccess	: MouseUp
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: Button
        // : Shift
        // : X
        // : Y
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public override void MouseUp(MouseButtons Button, Keys Shift, int X, int Y)
        {
            base.MouseUp();
            ((this.Parent) as TSelWndPanel).MouseUp(Button, Shift, X, Y);
        }

    } // end TSelWndLabel

    // ******************************************************************************
    // TSelWndPanel
    // ******************************************************************************
    public class TSelWndPanel: Panel
    {
    //@ Undeclared identifier(3): 'WM_SIZE'
        // Published 宣言
        public int CodeWidth
        {
          get {
            return FCodeWidth;
          }
          set {
            SetCodeWidth(value);
          }
        }
        // Private 宣言
        private int FCodeWidth = 0;
        private TSelWndLabel WndLblCode = null;
        // ｺｰﾄﾞ表示ﾗﾍﾞﾙ
        private TSelWndLabel WndLblName = null;
        // 名称表示ﾗﾍﾞﾙ
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        private TMjsAppRecord m_pRec = null;
        // Public 宣言
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        // ******************************************************************************
        // TSelWndPanel
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2000/08/21
        // Parameter	: AOwner	TComponent
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        //Constructor  Create( AOwner,  pRec)
        public TSelWndPanel(object AOwner, object pRec) : base(AOwner)
        {
            // constructor TSelWndPanel.Create(AOwner: TComponent);
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            m_pRec = pRec;
            FCodeWidth = 42;
            //@ Undeclared identifier(3): 'bvNone'
            //@ Unsupported property or method(C): 'BevelInner'
            this.BevelInner = bvNone;
            //@ Undeclared identifier(3): 'bvNone'
            //@ Unsupported property or method(C): 'BevelOuter'
            this.BevelOuter = bvNone;
            this.BorderStyle = System.Windows.Forms.FormBorderStyle.None;
            //@ Unsupported property or method(C): 'ParentColor'
            this.ParentColor = true;
            WndLblCode = new TSelWndLabel(this);
            WndLblName = new TSelWndLabel(this);
            WndLblCode.Parent = this;
            WndLblCode.Font.Name = "ＭＳ Ｐ明朝";
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            //@ Unsupported property or method(A): 'GetZoomRatio'
            WndLblCode.Font.Size = 10 * WndLblCode.GetZoomRatio((m_pRec as object)) / 100;
            // Font.Size	:= 10;
            WndLblCode.Left = Units.MAS310000u.MAS310SELWND_SPACE_CODE;
            WndLblCode.Top = 0;
            // (*H0004 20010710 khattori ＆が変！*)
            //@ Unsupported property or method(C): 'ShowAccelChar'
            WndLblCode.ShowAccelChar = false;
            WndLblName.Parent = this;
            WndLblName.Anchor = new System.Windows.Forms.AnchorStyles[] {System.Windows.Forms.AnchorStyles.Left, System.Windows.Forms.AnchorStyles.Top, System.Windows.Forms.AnchorStyles.Right, System.Windows.Forms.AnchorStyles.Bottom};
            WndLblName.Font.Name = "ＭＳ Ｐゴシック";
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            //@ Unsupported property or method(A): 'GetZoomRatio'
            WndLblName.Font.Size = 11 * WndLblName.GetZoomRatio((m_pRec as object)) / 100;
            // Font.Size	:= 11;
            WndLblName.Top = 0;
            // (*H0004 20010710 khattori ＆が変！*)
            //@ Unsupported property or method(C): 'ShowAccelChar'
            WndLblName.ShowAccelChar = false;
            CodeWidth = WndLblCode.Width;
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2000/08/21
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TSelWndPanel()
        {
            //@ Unsupported property or method(C): 'Free'
            WndLblCode.Free;
            //@ Unsupported property or method(C): 'Free'
            WndLblName.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: DblClick
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: なし
        // Return		: なし
        // History		: 2001/02/07	Y.Sato		・コードが空のときは選択不可
        // ******************************************************************************
        public override void DblClick()
        {
            base.DblClick();
            if (WndLblCode.Text != "")
            {
                // if (WndLblCode.Caption <> '') or (WndLblName.Caption <> '') then	2001/02/07
                this.BackColor = System.Drawing.Color.Black - this.BackColor;
                //@ Unsupported property or method(C): 'Color'
                //@ Unsupported property or method(C): 'Color'
                WndLblCode.Font.Color = System.Drawing.Color.White - WndLblCode.Font.Color;
                //@ Unsupported property or method(C): 'Color'
                //@ Unsupported property or method(C): 'Color'
                WndLblName.Font.Color = System.Drawing.Color.White - WndLblName.Font.Color;
            }
        }

        // ******************************************************************************
        // Proccess	: MouseUp
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: Button
        // : Shift
        // : X
        // : Y
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public override void MouseUp(MouseButtons Button, Keys Shift, int X, int Y)
        {
            base.MouseUp();
            if (this.BackColor != ((this.Parent) as TSelWndBase).BackColor)
            {
                this.BackColor = ((this.Parent) as TSelWndBase).BackColor;
                //@ Unsupported property or method(C): 'Color'
                //@ Unsupported property or method(C): 'Color'
                WndLblCode.Font.Color = System.Drawing.Color.White - WndLblCode.Font.Color;
                //@ Unsupported property or method(C): 'Color'
                //@ Unsupported property or method(C): 'Color'
                WndLblName.Font.Color = System.Drawing.Color.White - WndLblName.Font.Color;
                TSelWnd _wvar1 = ((((this.Parent) as TSelWndBase).Parent) as TSelWnd);
                if (_wvar1.WndParam != null)
                {
                    _wvar1.WndParam.Code = WndLblCode.Text;
                    _wvar1.WndParam.Name = WndLblName.Text;
                    if (_wvar1.WndParam.Sender != null)
                    {
                        //@ Unsupported property or method(C): 'WM_KEYDOWN'
                        //@ Unsupported property or method(C): 'VK_RETURN'
                        //@ Unsupported function or procedure: 'PostMessage'
                        PostMessage(((_wvar1.WndParam.Sender) as Control).Handle, _wvar1.WM_KEYDOWN, _wvar1.VK_RETURN, 0);
                    }
                }
            }
        }

        // ******************************************************************************
        // Proccess	: ｺｰﾄﾞ部の幅をｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/11/02
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetCodeWidth(int Value)
        {
            if ((Value > 0) && (Value != FCodeWidth))
            {
                FCodeWidth = Value;
                // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
                //@ Undeclared identifier(3): 'GetZoomRatio'
                WndLblCode.Width = FCodeWidth * GetZoomRatio((m_pRec as object)) / 100;
                //@ Undeclared identifier(3): 'GetZoomRatio'
                WndLblName.Left = (Units.MAS310000u.MAS310SELWND_SPACE_CODE + FCodeWidth + Units.MAS310000u.MAS310SELWND_SPACE_NAME) * GetZoomRatio((m_pRec as object)) / 100;
            // WndLblCode.Width	:= FCodeWidth;
            // WndLblName.Left		:= MAS310SELWND_SPACE_CODE + FCodeWidth + MAS310SELWND_SPACE_NAME;
            }
            WndLblName.Width = this.Width - WndLblName.Left;
        }

        // ******************************************************************************
        // Proccess	: WMSize
        // Name		: Y.Sato
        // Date		: 2000/11/20
        // Parameter	: var Message	TWMSize
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void WMSize(ref TWMSize Message)
        {
            base.WMSize();
            //@ Unsupported property or method(C): 'Height'
            WndLblCode.Height = Message.Height;
            //@ Unsupported property or method(C): 'Height'
            WndLblName.Height = Message.Height;
            // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
            CodeWidth = FCodeWidth;
            // SetCodeWidth(WndLblCode.Width);

        }

    } // end TSelWndPanel

    // ******************************************************************************
    // TSelWndBase
    // ******************************************************************************
    public class TSelWndBase: Panel
    {
    //@ Undeclared identifier(3): 'WM_VSCROLL'
        // Public 宣言
        // ******************************************************************************
        // TSelWndBase
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2000/11/01
        // Parameter	: AOwner	TComponent
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create( AOwner)
        public TSelWndBase(object AOwner) : base(AOwner)
        {
            this.Anchor = new System.Windows.Forms.AnchorStyles[] {System.Windows.Forms.AnchorStyles.Left, System.Windows.Forms.AnchorStyles.Top, System.Windows.Forms.AnchorStyles.Right, System.Windows.Forms.AnchorStyles.Bottom};
            //@ Undeclared identifier(3): 'bvNone'
            //@ Unsupported property or method(C): 'BevelInner'
            this.BevelInner = bvNone;
            //@ Undeclared identifier(3): 'bvNone'
            //@ Unsupported property or method(C): 'BevelOuter'
            this.BevelOuter = bvNone;
            this.BorderStyle = System.Windows.Forms.FormBorderStyle.None;
            this.Left = 0;
            //@ Unsupported property or method(C): 'ParentColor'
            this.ParentColor = true;
            this.Top = 0;
        }
        // Private 宣言
        // ******************************************************************************
        // Proccess	: WMVScroll
        // Name		: Y.Sato
        // Date		: 2000/11/01
        // Parameter	: var Message	TWMVScroll
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void WMVScroll(ref TWMVScroll Message)
        {
            base.WMVScroll();
            ((this.Parent) as TSelWnd).WMVScroll(ref Message);
        }

    } // end TSelWndBase

    // ウィンドウレコードリスト
    public class TSelWnd: Panel
    {
    //@ Undeclared identifier(3): 'WM_CREATE'
    //@ Undeclared identifier(3): 'WM_VSCROLL'
        // Published 宣言
        // (*H0001	20020219 khattori ＣＲ！！！*)
        public bool InnerCode
        {
          get {
            return FInnerCode;
          }
          set {
            SetInnerCode(value);
          }
        }
        public bool AutoSize
        {
          get {
            return FAutoSize;
          }
          set {
            SetAutoSize(value);
          }
        }
        public ContentAlignment CodeAlignment
        {
          get {
            return FCodeAlignment;
          }
          set {
            SetCodeAlignment(value);
          }
        }
        public int CodeWidth
        {
          get {
            return FCodeWidth;
          }
          set {
            SetCodeWidth(value);
          }
        }
        public int ColCount
        {
          get {
            return FColCount;
          }
          set {
            SetColCount(value);
          }
        }
        public int ColSize
        {
          get {
            return FColSize;
          }
          set {
            SetColSize(value);
          }
        }
        public int RowCount
        {
          get {
            return FRowCount;
          }
          set {
            SetRowCount(value);
          }
        }
        public int RowSize
        {
          get {
            return FRowSize;
          }
          set {
            SetRowSize(value);
          }
        }
        // Private 宣言
        // (*H0001	20020219 khattori ＣＲ！！！*)
        private bool FInnerCode = false;
        private int FCRMode = 0;
        private bool FAutoSize = false;
        private ContentAlignment FCodeAlignment = null;
        private int FCodeWidth = 0;
        private int FColCount = 0;
        private int FColSize = 0;
        private int FRowCount = 0;
        private int FRowSize = 0;
        private object WndBase = null;
        private TWRecData[] RecListDsp;
        // 表示データ
        private int DspPage = 0;
        // 表示中のﾍﾟｰｼﾞ
        private TSelWndPanel[] WndPnl;
        // ｳｨﾝﾄﾞｳﾊﾟﾈﾙ
        private TWParam WndParam = null;
        // ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ
        private TWRecData[] WndRecList;
        // ウィンドウレコードリスト
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        private object m_pRec = null;
        private int m_ColSize = 0;
        // Public 宣言
        // ******************************************************************************
        // TSelWnd
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: AOwner	TComponent
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create( AOwner)
        public TSelWnd(object AOwner) : base(AOwner)
        {
            FAutoSize = true;
            FCodeAlignment = System.Drawing.ContentAlignment.TopLeft;
            FCodeWidth = 42;
            FColCount = 5;
            FRowCount = 5;
            DspPage = 1;
            //@ Undeclared identifier(3): 'bvNone'
            //@ Unsupported property or method(C): 'BevelInner'
            this.BevelInner = bvNone;
            //@ Undeclared identifier(3): 'bvNone'
            //@ Unsupported property or method(C): 'BevelOuter'
            this.BevelOuter = bvNone;
            this.BorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle;
            this.BackColor = System.Drawing.SystemColors.Window;
            this.Height = 84;
            this.Width = 935;
            WndBase = new TSelWndBase(this);
            WndBase.Parent = this;
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2000/11/01
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TSelWnd()
        {
            int iIndex;
            // ﾊﾟﾈﾙを破棄
            for (iIndex = 0; iIndex <= WndPnl.GetUpperBound(0); iIndex ++ )
            {
                //@ Unsupported property or method(C): 'Free'
                WndPnl[iIndex].Free;
            }
            //@ Unsupported property or method(C): 'Free'
            WndBase.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: 表示をｸﾘｱ
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Clear()
        {
            int iIndex;
            RecListDsp = new TWRecData[0];
            WndRecList[0] = new TWRecData[0];
            WndRecList[1] = new TWRecData[0];
            for (iIndex = 0; iIndex <= WndPnl.GetUpperBound(0); iIndex ++ )
            {
                WndPnl[iIndex].WndLblCode.Text = "";
                WndPnl[iIndex].WndLblName.Text = "";
            }
            ScrollInfoSet(1, 1);
            // ｽｸﾛｰﾙﾊﾞｰの情報をｾｯﾄ

        }

        // 表示をｸﾘｱ
        // (*H0001	20020219 khattori ＣＲ！！！*)
        // ******************************************************************************
        // Proccess	: 表示処理
        // Name		: Y.Sato
        // Date		: 2000/08/25
        // Parameter	: RecordList	ﾃﾞｰﾀ
        // : DspParam		表示ﾊﾟﾗﾒｰﾀ
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        // (*H0001	20020219 khattori ＣＲ！！！*)
        public void Dsp(TWRecData[] RecList, TWDspParam DspParam, bool bDspMode)
        {
            // procedure TSelWnd.Dsp(RecList: TWRecList; DspParam: TWDspParam);
            int iIndex;
            int iCount;
            RecListDsp = new TWRecData[RecList.Length];
            WndRecList[1] = new TWRecData[RecList.Length];
            iCount = 0;
            for (iIndex = 0; iIndex <= RecList.GetUpperBound(0); iIndex ++ )
            {
                // ﾌｨﾙﾀがOFF or 名称が空でない
                if (!DspParam.Filt || (RecList[iIndex].Name != ""))
                {
                    RecListDsp[iCount].Code = RecList[iIndex].Code;
                    RecListDsp[iCount].Name = RecList[iIndex].Name;
                    RecListDsp[iCount].Ren = RecList[iIndex].Ren;
                    RecListDsp[iCount].Color = RecList[iIndex].Color;
                    //@ Unsupported property or method(D): 'Code'
                    WndRecList[1][iCount].Code = RecList[iIndex].Code;
                    //@ Unsupported property or method(D): 'Name'
                    WndRecList[1][iCount].Name = RecList[iIndex].Name;
                    //@ Unsupported property or method(D): 'Ren'
                    WndRecList[1][iCount].Ren = RecList[iIndex].Ren;
                    //@ Unsupported property or method(D): 'Color'
                    WndRecList[1][iCount].Color = RecList[iIndex].Color;
                    iCount ++;
                }
            }
            if (iCount != RecList.GetUpperBound(0) + 1)
            {
                RecListDsp = new TWRecData[iCount];
                WndRecList[1] = new TWRecData[iCount];
            }
            // (*H0006	20020219 khattori ＣＲ！！！*)
            if (!bDspMode)
            {
                FInnerCode = false;
            }
            ScrollInfoSet(DspParam.Page);
            // ｽｸﾛｰﾙﾊﾞｰの情報をｾｯﾄ
            //@ Undeclared identifier(3): 'scPosition'
            Scroll(scPosition, DspParam.Page);
            // 表示をｽｸﾛｰﾙ

        }

        public void Dsp(TWRecData[] RecList, TWDspParam DspParam)
        {
            Dsp(RecList, DspParam, false);
        }

        // 表示
        // procedure Dsp(RecList: TWRecList; DspParam: TWDspParam);					// 表示
        // ******************************************************************************
        // Proccess	: 表示中のﾍﾟｰｼﾞを取得
        // Name		: Y.Sato
        // Date		: 2000/09/26
        // Parameter	: なし
        // Return		: Integer		ﾍﾟｰｼﾞ数
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int GetDspPage()
        {
            int result;
            result = DspPage;
            return result;
        }

        // 表示中のﾍﾟｰｼﾞを取得
        // ******************************************************************************
        // Proccess	: KeyDown
        // Name		: Y.Sato
        // Date		: 2000/08/24
        // Parameter	: var Key
        // : Shift
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public override void KeyDown(ref ushort Key, Keys Shift)
        {
            base.KeyDown();
            switch(Key)
            {
                //@ Undeclared identifier(3): 'VK_HOME'
                case VK_HOME:
                    if (Shift == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Control})
                    {
                        //@ Undeclared identifier(3): 'scTop'
                        Scroll(scTop);
                    }
                    break;
                // 一番上にｽｸﾛｰﾙ
                //@ Undeclared identifier(3): 'VK_END'
                case VK_END:
                    if (Shift == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Control})
                    {
                        //@ Undeclared identifier(3): 'scBottom'
                        Scroll(scBottom);
                    }
                    break;
                // 一番下にｽｸﾛｰﾙ
                //@ Undeclared identifier(3): 'VK_PRIOR'
                case VK_PRIOR:
                    //@ Undeclared identifier(3): 'scPageUp'
                    Scroll(scPageUp);
                    break;
                // 上にｽｸﾛｰﾙ
                //@ Undeclared identifier(3): 'VK_NEXT'
                case VK_NEXT:
                    //@ Undeclared identifier(3): 'scPageDown'
                    Scroll(scPageDown);
                    break;
            // 下にｽｸﾛｰﾙ
            }
        }

        // ｷｰﾀﾞｳﾝ処理
        // ******************************************************************************
        // Proccess	: ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀをｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/09/04
        // Parameter	: PWndParam		Pointer
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void ParamSet(object PWndParam)
        {
            WndParam = PWndParam;
        }

        // ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀをｾｯﾄ
        // ******************************************************************************
        // Proccess	: ﾌﾟﾛﾊﾟﾃｨを取得
        // Name		: Y.Sato
        // Date		: 2000/09/21
        // Parameter	: var WProperty	TWProperty
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void PropertyGet(ref TWProperty WProperty)
        {
            WProperty.AutoSize = FAutoSize;
            WProperty.CodeAlignment = FCodeAlignment;
            WProperty.CodeWidth = FCodeWidth;
            WProperty.ColCount = FColCount;
            WProperty.ColSize = FColSize;
            WProperty.RowCount = FRowCount;
            WProperty.RowSize = FRowSize;
        }

        // ﾌﾟﾛﾊﾟﾃｨを取得
        // ******************************************************************************
        // Proccess	: ﾌﾟﾛﾊﾟﾃｨを設定
        // Name		: Y.Sato
        // Date		: 2000/09/21
        // Parameter	: WProperty		TWProperty
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void PropertySet(TWProperty WProperty)
        {
            bool bVisible;
            FAutoSize = WProperty.AutoSize;
            m_ColSize = WProperty.ColSize;
            if (m_ColSize < 0)
            {
                WProperty.ColSize = 0;
            }
            bVisible = WndBase.Visible;
            if (bVisible)
            {
                WndBase.Visible = false;
            }
            // ﾊﾟﾈﾙを非表示にして高速化
            CodeAlignment = WProperty.CodeAlignment;
            CodeWidth = WProperty.CodeWidth;
            DspInit(FAutoSize, WProperty.ColCount, WProperty.ColSize, WProperty.RowCount, WProperty.RowSize);
            Redraw();
            // 再描画
            if (bVisible)
            {
                WndBase.Visible = true;
            }
            // ﾊﾟﾈﾙを表示する

        }

        // ﾌﾟﾛﾊﾟﾃｨを設定
        // ---<HIS-060>------------------------------------------------------------------
        // ---<HIS-060>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	連想入力処理(ウィンドウ絞込)
        // Parameter : RenObj		TCustomEdit		入力コンポーネント
        // iFld		Integer			絞込対象  0:連想  1:コード
        // sRen		String			連想文字列(iFld<>0 時)
        // Return    : None
        // Comment	  :	sRen は、連想＋コード の絞込で使用する
        // 連想で絞り込まれなかったときの 連想＋コード では sRen=' '
        // History	  :	<HIS-060>
        // ******************************************************************************
        public void RenChange(TextBox RenObj, int iFld, string sRen)
        {
            int iIndex;
            int iCount;
            string sSub;
            string sTxt;
            bool bNum;
            TWRecData[] pRecList;
            bNum = false;
            sSub = RenObj.Text;
            // 数字の場合、前ゼロを考慮(前ゼロを除く)
            //@ Undeclared identifier(3): 'TMNumEdit'
            if ((sSub != "") && (RenObj is TMNumEdit))
            {
                bNum = true;
                //@ Undeclared identifier(3): 'TMNumEdit'
                //@ Unsupported property or method(D): 'Value'
                sSub = (Convert.ToInt64(TMNumEdit(RenObj).Value)).ToString();
            }
            // 連想絞込 or 連想＋コード絞込	は、全件から絞込
            // コード絞込						は、現在表示中のウィンドウデータから絞込
            if ((iFld == 0) || (iFld == 1) && (sRen != ""))
            {
                pRecList = WndRecList[0];
            }
            else
            {
                pRecList = WndRecList[1];
            }
            // 連想で絞り込まずに 連想＋コード の場合
            if (sRen == ' ')
            {
                sRen = "";
            }
            // 連想絞込では sRen は無効
            if ((iFld == 0) && (sRen != ""))
            {
                sRen = "";
            }
            RecListDsp = new TWRecData[pRecList.Length];
            iCount = 0;
            for (iIndex = 0; iIndex <= pRecList.GetUpperBound(0); iIndex ++ )
            {
                // ---<HIS-061>------------------------------------------------------------------
                // 入力不可科目は除外
                if (pRecList[iIndex].Name == "＝入力不可科目＝")
                {
                    continue;
                }
                // ------------------------------------------------------------------<HIS-061>---
                if (iFld == 0)
                {
                    sTxt = pRecList[iIndex].Ren;
                }
                else if (iFld == 1)
                {
                    sTxt = pRecList[iIndex].Code;
                }
                else
                {
                    sTxt = "";
                }
                // 数字の場合、前ゼロを考慮(前ゼロを除く)
                if (bNum)
                {
                    sTxt = (Convert.ToInt64(sTxt)).ToString();
                }
                // 検索文字が空 or 該当ﾃﾞｰﾀ
                if (((sSub == "") || (sTxt.IndexOf(sSub) == 1)) && ((sRen == "") || (pRecList[iIndex].Ren.IndexOf(sRen) == 1)))
                {
                    RecListDsp[iCount].Code = pRecList[iIndex].Code;
                    RecListDsp[iCount].Name = pRecList[iIndex].Name;
                    RecListDsp[iCount].Ren = pRecList[iIndex].Ren;
                    RecListDsp[iCount].Color = pRecList[iIndex].Color;
                    iCount ++;
                }
            }
            RecListDsp = new TWRecData[iCount];
            ScrollInfoSet;
            // ｽｸﾛｰﾙﾊﾞｰの情報をｾｯﾄ
            PageDsp(1);
            // 表示

        }

        public void RenChange(TextBox RenObj)
        {
            RenChange(RenObj, 0);
        }

        public void RenChange(TextBox RenObj, int iFld)
        {
            RenChange(RenObj, iFld, "");
        }

        // 連想入力処理
        // procedure RenChange(RenObj: TCustomEdit);									// 連想入力処理
        // ------------------------------------------------------------------<HIS-060>---
        // //******************************************************************************
        // //		Proccess	: 連想入力処理
        // //		Name		: Y.Sato
        // //		Date		: 2000/11/08
        // //		Parameter	: RenObj		連想入力ｵﾌﾞｼﾞｪｸﾄ
        // //		Return		: なし
        // //		History		: 9999/99/99	X.Xxxx
        // //									XXXXXXXXXXXXXXXXXX
        // //******************************************************************************
        // procedure TSelWnd.RenChange(RenObj: TCustomEdit);
        // var
        // iIndex	: Integer;
        // iCount	: Integer;
        // begin
        // SetLength(RecListDsp, Length(WndRecList[0]));
        // iCount := 0;
        // for iIndex := 0 to High(WndRecList[0]) do
        // begin
        // // 検索文字が空 or 該当ﾃﾞｰﾀ
        // if (RenObj.Text = '') or (Pos(RenObj.Text, WndRecList[0][iIndex].Ren) = 1) then
        // begin
        // RecListDsp[iCount].Code 	:= WndRecList[0][iIndex].Code;
        // RecListDsp[iCount].Name 	:= WndRecList[0][iIndex].Name;
        // RecListDsp[iCount].Color	:= WndRecList[0][iIndex].Color;
        // Inc(iCount);
        // end;
        // end;
        // SetLength(RecListDsp, iCount);
        // ScrollInfoSet;																// ｽｸﾛｰﾙﾊﾞｰの情報をｾｯﾄ
        // PageDsp(1);																	// 表示
        // end;
        // ------------------------------------------------------------------<HIS-060>---
        // ******************************************************************************
        // Proccess	: ﾃﾞｰﾀを検索
        // Name		: Y.Sato
        // Date		: 2000/09/29
        // Parameter	: SearchCode	検索ｺｰﾄﾞ
        // : WndSelect		ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択区分
        // True:ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択あり
        // False:ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択なし (ﾃﾞﾌｫﾙﾄ)
        // Return		: Boolean		True:ﾃﾞｰﾀあり
        // False:ﾃﾞｰﾀなし
        // History		: 2000/11/08	Y.Sato		・ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択区分を追加
        // : 2000/11/29	Y.Sato		・連想絞込みで表示されていないﾃﾞｰﾀも選択できるように修正
        // : 2001/01/12	Y.Sato		・検索で該当データがなかったときはウィンドウパラメータをクリアする
        // : 2001/02/07	Y.Sato		・コードが空のときは関数を抜ける
        // ******************************************************************************
        public bool SearchData(string SearchCode, bool WndSelect)
        {
            bool result;
            int iIndex;
            int iPos;
            result = false;
            if (WndParam != null)
            {
                WndParam.Code = "";
                WndParam.Name = "";
            }
            if (SearchCode == "")
            {
                return result;
            }
            // 2001/02/07
            if (!WndSelect)
            {
                // リストを検索
                for (iIndex = 0; iIndex <= WndRecList[0].GetUpperBound(0); iIndex ++ )
                {
                    // 該当ﾃﾞｰﾀ
                    //@ Unsupported property or method(D): 'Code'
                    //@ Unsupported property or method(D): 'Name'
                    if ((WndRecList[0][iIndex].Code == SearchCode) && (WndRecList[0][iIndex].Name != "＝入力不可科目＝"))
                    {
                        // if SearchCode = WndRecList[0][iIndex].Code then
                        if (WndParam != null)
                        {
                            //@ Unsupported property or method(D): 'Code'
                            WndParam.Code = WndRecList[0][iIndex].Code;
                            //@ Unsupported property or method(D): 'Name'
                            WndParam.Name = WndRecList[0][iIndex].Name;
                        }
                        result = true;
                        break;
                    }
                }
            // (*H0006	20020219 khattori ＣＲ！！！*)
            // ﾘｽﾄにﾃﾞｰﾀ無い and ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択あり
            }
            else
            {
                // if not Result and	( WndSelect or FInnerCode ) then
                // if not Result and WndSelect then
                // ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞを検索
                //@ Unsupported function or procedure: 'Val'
                Val(SearchCode, iIndex, iPos);
                // 検索ｺｰﾄﾞが数値
                if (iPos == 0)
                {
                    iIndex -= 1;
                    if ((iIndex >= 0) && (iIndex < FRowCount * FColCount))
                    {
                        // ｳｨﾝﾄﾞｳの該当する位置にﾃﾞｰﾀが存在する
                        if (WndPnl[iIndex].WndLblCode.Text != "")
                        {
                            if (WndParam != null)
                            {
                                WndParam.Code = RecListDsp[iIndex + (DspPage - 1) * FRowCount * FColCount].Code;
                                WndParam.Name = RecListDsp[iIndex + (DspPage - 1) * FRowCount * FColCount].Name;
                            }
                            result = true;
                        }
                    }
                }
            }
            return result;
        }

        // ﾃﾞｰﾀを検索
        // ******************************************************************************
        // Proccess	: ﾊﾟﾈﾙｻｲｽﾞをｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/11/20
        // Parameter	: CodeWidth		ｺｰﾄﾞ部の幅
        // : NameWidth		名称部の幅
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetPanelSize(int CodeWidth, int NameWidth)
        {
            bool bVisible;
            bVisible = WndBase.Visible;
            if (bVisible)
            {
                WndBase.Visible = false;
            }
            // ﾊﾟﾈﾙを非表示にして高速化
            // ｺｰﾄﾞ部の幅変更あり and ﾊﾟﾈﾙの幅変更あり
            if ((CodeWidth > 0) && (NameWidth > 0))
            {
                ColSize = Units.MAS310000u.MAS310SELWND_SPACE_CODE + CodeWidth + Units.MAS310000u.MAS310SELWND_SPACE_NAME + NameWidth;
                CodeWidth = CodeWidth;
            // ｺｰﾄﾞ部の幅変更あり and ﾊﾟﾈﾙの幅変更なし
            }
            else if ((CodeWidth > 0) && (NameWidth == 0))
            {
                CodeWidth = CodeWidth;
            // ｺｰﾄﾞ部の幅変更なし and ﾊﾟﾈﾙの幅変更あり
            }
            else if ((CodeWidth == 0) && (NameWidth > 0))
            {
                CodeWidth = FColSize - Units.MAS310000u.MAS310SELWND_SPACE_CODE - Units.MAS310000u.MAS310SELWND_SPACE_NAME - NameWidth;
            }
            if (bVisible)
            {
                WndBase.Visible = true;
            }
            // ﾊﾟﾈﾙを表示する

        }

        // ******************************************************************************
        // Proccess	: 検索用レコードリストをセット
        // Name		: Y.Sato
        // Date		: 2001/02/08
        // Parameter	: RecordList	ﾃﾞｰﾀ
        // : DspParam		表示ﾊﾟﾗﾒｰﾀ
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetRecListSrc(TWRecData[] RecList, TWDspParam DspParam)
        {
            int iIndex;
            int iCount;
            WndRecList[0] = new TWRecData[RecList.Length];
            iCount = 0;
            for (iIndex = 0; iIndex <= RecList.GetUpperBound(0); iIndex ++ )
            {
                // フィルタがOFF or 名称が空でない
                if (!DspParam.Filt || (RecList[iIndex].Name != ""))
                {
                    //@ Unsupported property or method(D): 'Code'
                    WndRecList[0][iCount].Code = RecList[iIndex].Code;
                    //@ Unsupported property or method(D): 'Name'
                    WndRecList[0][iCount].Name = RecList[iIndex].Name;
                    //@ Unsupported property or method(D): 'Ren'
                    WndRecList[0][iCount].Ren = RecList[iIndex].Ren;
                    //@ Unsupported property or method(D): 'Color'
                    WndRecList[0][iCount].Color = RecList[iIndex].Color;
                    iCount ++;
                }
            }
            if (iCount != RecList.Length)
            {
                WndRecList[0] = new TWRecData[iCount];
            }
        }

        // Protected 宣言
        // ******************************************************************************
        // Proccess	: DoMouseWheelDown
        // Name		: Y.Sato
        // Date		: 2000/08/23
        // Parameter	: Shift			TShiftState
        // : MousePos		TPoint
        // Return		: Boolean
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public override bool DoMouseWheelDown(Keys Shift, Point MousePos)
        {
            bool result;
            base.DoMouseWheelDown(Shift, MousePos);
            result = true;
            //@ Undeclared identifier(3): 'scPageDown'
            Scroll(scPageDown);
            // 下にｽｸﾛｰﾙ

            return result;
        }

        // ******************************************************************************
        // Proccess	: DoMouseWheelUp
        // Name		: Y.Sato
        // Date		: 2000/08/23
        // Parameter	: Shift			TShiftState
        // : MousePos		TPoint
        // Return		: Boolean
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public override bool DoMouseWheelUp(Keys Shift, Point MousePos)
        {
            bool result;
            base.DoMouseWheelUp(Shift, MousePos);
            result = true;
            //@ Undeclared identifier(3): 'scPageUp'
            Scroll(scPageUp);
            // 上にｽｸﾛｰﾙ

            return result;
        }

        // ******************************************************************************
        // Proccess	: Resize
        // Name		: Y.Sato
        // Date		: 2000/08/25
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public override void Resize()
        {
            // ---<HIS-015>------------------------------------------------------------------
            int iPos;
            // ------------------------------------------------------------------<HIS-015>---
            base.Resize();
            if (FAutoSize)
            {
                // ---<HIS-015>------------------------------------------------------------------
                iPos = DspPage;
                // ------------------------------------------------------------------<HIS-015>---
                if (m_ColSize < 0)
                {
                    DspInit(FAutoSize, FColCount, 0, FRowCount, 0);
                    m_ColSize = 0;
                }
                else
                {
                    // ---<HIS-015> ｻｲｽﾞ変更でｻｲｽﾞを維持するのは無意味-------------------------------
                    DspInit(FAutoSize, FColCount, 0, FRowCount, 0);
                }
                // DspInit(FAutoSize, FColCount, FColSize, FRowCount, FRowSize);
                // ------------------------------------------------------------------<HIS-015>---
                Redraw();
                // 再描画
                // ---<HIS-015> Redraw で先頭ﾍﾟｰｼﾞに戻るため再設定-------------------------------
                //@ Undeclared identifier(3): 'scPosition'
                Scroll(scPosition, iPos);
            // ------------------------------------------------------------------<HIS-015>---
            }
        }

        // ******************************************************************************
        // Proccess	: ｽｸﾛｰﾙﾊﾞｰを操作する
        // Name		: Y.Sato
        // Date		: 2000/08/22
        // Parameter	: ScrollCode	TScrollCode
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void Scroll(TScrollCode ScrollCode, int ScrollPos)
        {
            TScrollInfo ScrollInfo;
            //@ Unsupported property or method(C): 'cbSize'
            ScrollInfo.cbSize = sizeof(ScrollInfo);
            //@ Unsupported property or method(C): 'SIF_ALL'
            //@ Unsupported property or method(C): 'fMask'
            ScrollInfo.fMask = ScrollInfo.SIF_ALL;
            //@ Unsupported property or method(C): 'SB_VERT'
            //@ Unsupported function or procedure: 'GetScrollInfo'
            GetScrollInfo(WndBase.Handle, ScrollInfo.SB_VERT, ScrollInfo);
            //@ Unsupported property or method(C): 'scPosition'
            if (ScrollCode != ScrollInfo.scPosition)
            {
                switch(ScrollCode)
                {
                    //@ Unsupported property or method(C): 'scLineUp'
                    case ScrollInfo.scLineUp:
                        //@ Unsupported property or method(C): 'nPos'
                        ScrollPos = ScrollInfo.nPos - 1;
                        break;
                    //@ Unsupported property or method(C): 'scPageUp'
                    case ScrollInfo.scPageUp:
                        //@ Unsupported property or method(C): 'nPos'
                        ScrollPos = ScrollInfo.nPos - 1;
                        break;
                    //@ Unsupported property or method(C): 'scLineDown'
                    case ScrollInfo.scLineDown:
                        //@ Unsupported property or method(C): 'nPos'
                        ScrollPos = ScrollInfo.nPos + 1;
                        break;
                    //@ Unsupported property or method(C): 'scPageDown'
                    case ScrollInfo.scPageDown:
                        //@ Unsupported property or method(C): 'nPos'
                        ScrollPos = ScrollInfo.nPos + 1;
                        break;
                    //@ Unsupported property or method(C): 'scTrack'
                    case ScrollInfo.scTrack:
                        //@ Unsupported property or method(C): 'nTrackPos'
                        ScrollPos = ScrollInfo.nTrackPos;
                        break;
                    //@ Unsupported property or method(C): 'scTop'
                    case ScrollInfo.scTop:
                        //@ Unsupported property or method(C): 'nMin'
                        ScrollPos = ScrollInfo.nMin;
                        break;
                    //@ Unsupported property or method(C): 'scBottom'
                    case ScrollInfo.scBottom:
                        //@ Unsupported property or method(C): 'nMax'
                        ScrollPos = ScrollInfo.nMax;
                        break;
                    default:
                        //@ Unsupported property or method(C): 'nPos'
                        ScrollPos = ScrollInfo.nPos;
                        break;
                }
            }
            //@ Unsupported property or method(C): 'nMin'
            if (ScrollPos < ScrollInfo.nMin)
            {
                //@ Unsupported property or method(C): 'nMin'
                ScrollPos = ScrollInfo.nMin;
            }
            //@ Unsupported property or method(C): 'nMax'
            else if (ScrollPos > ScrollInfo.nMax)
            {
                //@ Unsupported property or method(C): 'nMax'
                ScrollPos = ScrollInfo.nMax;
            }
            //@ Unsupported property or method(C): 'nPos'
            if (ScrollPos != ScrollInfo.nPos)
            {
                //@ Unsupported property or method(C): 'SB_VERT'
                //@ Unsupported function or procedure: 'SetScrollPos'
                SetScrollPos(WndBase.Handle, ScrollInfo.SB_VERT, ScrollPos, true);
            }
            PageDsp(ScrollPos);
            // 表示

        }

        // (*H0001	20020219 khattori ＣＲ！！！*)
        // (*H0006	20020219 khattori ＣＲ！！！*)
        // ******************************************************************************
        // Proccess	: ウィンドウ内部コード入力を認めるかのフラグ
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetInnerCode(bool Value)
        {
            if (Value != FInnerCode)
            {
                FInnerCode = Value;
            }
        }

        // ******************************************************************************
        // Proccess	: ｳｨﾝﾄﾞｳｻｲｽﾞに合わせて子ﾊﾟﾈﾙの設定を変えるかどうかの切り換え
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetAutoSize(bool Value)
        {
            if (Value != FAutoSize)
            {
                FAutoSize = Value;
                if (FAutoSize)
                {
                    DspInit(FAutoSize, FColCount, FColSize, FRowCount, FRowSize);
                    Redraw();
                // 再描画
                }
            }
        }

        // ******************************************************************************
        // Proccess	: ｺｰﾄﾞ部のAlignmentを変更
        // Name		: Y.Sato
        // Date		: 2000/08/28
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetCodeAlignment(ContentAlignment Value)
        {
            int iIndex;
            if (Value != FCodeAlignment)
            {
                FCodeAlignment = Value;
                for (iIndex = 0; iIndex <= WndPnl.GetUpperBound(0); iIndex ++ )
                {
                    WndPnl[iIndex].WndLblCode.TextAlign = FCodeAlignment;
                }
            }
        }

        // ******************************************************************************
        // Proccess	: ｺｰﾄﾞ部の幅をｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/08/23
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetCodeWidth(int Value)
        {
            int iIndex;
            bool bVisible;
            if ((Value > 0) && (Value != FCodeWidth))
            {
                FCodeWidth = Value;
                bVisible = WndBase.Visible;
                if (bVisible)
                {
                    WndBase.Visible = false;
                }
                // ﾊﾟﾈﾙを非表示にして高速化
                for (iIndex = 0; iIndex <= WndPnl.GetUpperBound(0); iIndex ++ )
                {
                    WndPnl[iIndex].CodeWidth = FCodeWidth;
                }
                // ｺｰﾄﾞ部の幅をｾｯﾄ
                if (bVisible)
                {
                    WndBase.Visible = true;
                }
            // ﾊﾟﾈﾙを表示する
            }
        }

        // ******************************************************************************
        // Proccess	: ｶﾗﾑ数をｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetColCount(int Value)
        {
            if ((Value > 0) && (Value != FColCount))
            {
                FColCount = Value;
                DspInit(FAutoSize, FColCount, 0, 0, 0);
                Redraw();
            // 再描画
            }
        }

        // ******************************************************************************
        // Proccess	: ｶﾗﾑｻｲｽﾞをｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/08/25
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetColSize(int Value)
        {
            if ((Value > 0) && (Value != FColSize))
            {
                FColSize = Value;
                DspInit(FAutoSize, 0, FColSize, 0, 0);
                Redraw();
            // 再描画
            }
        }

        // ******************************************************************************
        // Proccess	: 行数をｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/08/25
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetRowCount(int Value)
        {
            if ((Value > 0) && (Value != FRowCount))
            {
                FRowCount = Value;
                DspInit(FAutoSize, 0, 0, FRowCount, 0);
                Redraw();
            // 再描画
            }
        }

        // ******************************************************************************
        // Proccess	: 行ｻｲｽﾞをｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/08/25
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetRowSize(int Value)
        {
            if ((Value > 0) && (Value != FRowSize))
            {
                FRowSize = Value;
                DspInit(FAutoSize, 0, 0, 0, FRowSize);
                Redraw();
            // 再描画
            }
        }

        // ******************************************************************************
        // Proccess	: ｳｨﾝﾄﾞｳ表示の初期処理
        // Name		: Y.Sato
        // Date		: 2000/08/08
        // Parameter	: AutoSize
        // : ColCount
        // : ColSize
        // : RowCount
        // : RowSize
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void DspInit(bool AutoSize, int ColCount, int ColSize, int RowCount, int RowSize)
        {
            int iIndex;
            int iColIndex;
            int iRowIndex;
            bool bVisible;
            iColIndex = 0;
            iRowIndex = 0;
            // 行と桁の設定を自動
            if (AutoSize)
            {
                // 桁ｻｲｽﾞ設定
                if (ColSize > 0)
                {
                    FColSize = ColSize;
                    if (DspWidth / ColSize > 0)
                    {
                        FColCount = DspWidth / ColSize;
                    }
                    else
                    {
                        FColCount = 1;
                    }
                    // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
                    FColSize = DspWidth(1) / FColCount;
                // FColSize	:= DspWidth div FColCount;
                // 桁数設定
                }
                else if (ColCount > 0)
                {
                    FColCount = ColCount;
                    // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
                    FColSize = DspWidth(1) / ColCount;
                // FColSize	:= DspWidth div ColCount;
                }
                // 行ｻｲｽﾞ設定
                if (RowSize > 0)
                {
                    FRowSize = RowSize;
                    //@ Unsupported property or method(C): 'ClientHeight'
                    if (this.ClientHeight / RowSize > 0)
                    {
                        //@ Unsupported property or method(C): 'ClientHeight'
                        FRowCount = this.ClientHeight / RowSize;
                    }
                    else
                    {
                        FRowCount = 1;
                    }
                // 行数設定
                }
                else if (RowCount > 0)
                {
                    FRowCount = RowCount;
                    //@ Unsupported property or method(C): 'ClientHeight'
                    FRowSize = this.ClientHeight / RowCount;
                }
            }
            else
            {
                // 桁ｻｲｽﾞ設定
                if (ColSize > 0)
                {
                    FColSize = ColSize;
                }
                // 桁数設定
                if (ColCount > 0)
                {
                    FColCount = ColCount;
                }
                // 行ｻｲｽﾞ設定
                if (RowSize > 0)
                {
                    FRowSize = RowSize;
                }
                // 行数設定
                if (RowCount > 0)
                {
                    FRowCount = RowCount;
                }
            }
            bVisible = WndBase.Visible;
            if (bVisible)
            {
                WndBase.Visible = false;
            }
            // ﾊﾟﾈﾙを非表示にして高速化
            // ﾊﾟﾈﾙ数が増える
            if (FRowCount * FColCount > WndPnl.GetUpperBound(0) + 1)
            {
                iIndex = WndPnl.GetUpperBound(0) + 1;
                WndPnl = new TSelWndPanel[FRowCount * FColCount];
                for (iIndex = iIndex; iIndex <= WndPnl.GetUpperBound(0); iIndex ++ )
                {
                    // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
                    WndPnl[iIndex] = new TSelWndPanel(WndBase, m_pRec);
                    // WndPnl[iIndex]						:= TSelWndPanel.Create(WndBase);
                    WndPnl[iIndex].Parent = WndBase;
                    WndPnl[iIndex].WndLblCode.TextAlign = FCodeAlignment;
                    WndPnl[iIndex].CodeWidth = FCodeWidth;
                // ﾗﾍﾞﾙの幅をｾｯﾄ
                }
            }
            // 範囲外のﾊﾟﾈﾙは非表示
            for (iIndex = FRowCount * FColCount; iIndex <= WndPnl.GetUpperBound(0); iIndex ++ )
            {
                WndPnl[iIndex].Visible = false;
            }
            // ﾊﾟﾈﾙの位置をｾｯﾄ
            for (iIndex = 0; iIndex < FRowCount * FColCount; iIndex ++ )
            {
                //@ Unsupported property or method(C): 'BevelWidth'
                WndPnl[iIndex].Left = this.BevelWidth + FColSize * iColIndex;
                //@ Unsupported property or method(C): 'BevelWidth'
                WndPnl[iIndex].Top = this.BevelWidth + FRowSize * iRowIndex;
                WndPnl[iIndex].Height = FRowSize;
                //@ Undeclared identifier(3): 'SM_CXVSCROLL'
                WndPnl[iIndex].Width = FColSize + SystemInformation.VerticalScrollBarWidth;
                WndPnl[iIndex].Visible = true;
                iRowIndex ++;
                // 行が最大
                if (iRowIndex == FRowCount)
                {
                    iColIndex ++;
                    iRowIndex = 0;
                }
            }
            if (bVisible)
            {
                //@ Unsupported property or method(D): 'Visible'
                WndBase.Visible = true;
            }
            // ﾊﾟﾈﾙを表示する

        }

        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        // ******************************************************************************
        // Proccess	: 表示幅を取得
        // Name		: Y.Sato
        // Date		: 2000/08/31
        // Parameter	: なし
        // Return		: 表示部の幅
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        private int DspWidth(int iZoom)
        {
            int result;
            // ---<HIS-015>------------------------------------------------------------------
            if (iZoom == 1)
            {
                //@ Unsupported property or method(C): 'ClientWidth'
                //@ Undeclared identifier(3): 'SM_CXVSCROLL'
                result = this.ClientWidth - SystemInformation.VerticalScrollBarWidth;
            }
            else
            {
                //@ Unsupported property or method(C): 'ClientWidth'
                //@ Undeclared identifier(3): 'GetZoomRatio'
                //@ Undeclared identifier(3): 'SM_CXVSCROLL'
                result = this.ClientWidth * 100 / GetZoomRatio((m_pRec as object)) -  -SystemInformation.VerticalScrollBarWidth;
            }
            // Result := 914;
            // if	iZoom=1	then
            // Result := Result	*	GetZoomRatio(Pointer(m_pRec))	div	100;
            // //	Result := ClientWidth - GetSystemMetrics(SM_CXVSCROLL);
            // ------------------------------------------------------------------<HIS-015>---

            return result;
        }

        // function DspWidth: Integer;													// 表示幅を取得
        // ******************************************************************************
        // Proccess	: ﾍﾟｰｼﾞ数を取得
        // Name		: Y.Sato
        // Date		: 2000/09/05
        // Parameter	: なし
        // Return		: ﾍﾟｰｼﾞ数
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private int PageCnt()
        {
            int result;
            result = 0;
            if (FRowCount * FColCount > 0)
            {
                result = RecListDsp.Length / (FRowCount * FColCount);
                if (RecListDsp.Length % (FRowCount * FColCount) > 0)
                {
                    result ++;
                }
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: 表示処理
        // Name		: Y.Sato
        // Date		: 2000/08/09
        // Parameter	: Page
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void PageDsp(int Page)
        {
            int iIndex;
            int iIndexD;
            // 指定したﾍﾟｰｼﾞが範囲外
            if ((Page < 1) || (Page > PageCnt()))
            {
                Page = 1;
            }
            for (iIndex = 0; iIndex <= WndPnl.GetUpperBound(0); iIndex ++ )
            {
                iIndexD = FRowCount * FColCount * (Page - 1) + iIndex;
                if ((iIndex < FRowCount * FColCount) && (iIndexD < RecListDsp.Length))
                {
                    // (*H0006	20020219 khattori ＣＲ！！！*)
                    if (FInnerCode && (RecListDsp[iIndexD].Code != ""))
                    {
                        WndPnl[iIndex].WndLblCode.Text = ((iIndex % (FRowCount * FColCount)) + 1).ToString();
                    }
                    else
                    {
                        WndPnl[iIndex].WndLblCode.Text = RecListDsp[iIndexD].Code;
                    }
                    WndPnl[iIndex].WndLblName.Text = RecListDsp[iIndexD].Name;
                    //@ Unsupported property or method(C): 'Color'
                    WndPnl[iIndex].WndLblCode.Font.Color = RecListDsp[iIndexD].Color;
                    //@ Unsupported property or method(C): 'Color'
                    WndPnl[iIndex].WndLblName.Font.Color = RecListDsp[iIndexD].Color;
                }
                else
                {
                    WndPnl[iIndex].WndLblCode.Text = "";
                    WndPnl[iIndex].WndLblName.Text = "";
                }
            }
            DspPage = Page;
        }

        // ******************************************************************************
        // Proccess	: 再描画
        // Name		: Y.Sato
        // Date		: 2000/08/28
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void Redraw()
        {
            ScrollInfoSet;
            // ｽｸﾛｰﾙﾊﾞｰの情報をｾｯﾄ
            PageDsp(1);
            // 表示

        }

        // ******************************************************************************
        // Proccess	: ｽｸﾛｰﾙﾊﾞｰをｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/08/24
        // Parameter	: ScrollMax
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void ScrollInfoSet(int ScrollPos, int ScrollMax)
        {
            TScrollInfo ScrollInfo;
            if (ScrollMax <= 0)
            {
                ScrollMax = PageCnt();
                if (ScrollMax <= 0)
                {
                    ScrollMax = 1;
                }
            }
            if ((ScrollPos < 1) || (ScrollPos > ScrollMax))
            {
                ScrollPos = 1;
            }
            //@ Unsupported property or method(C): 'cbSize'
            ScrollInfo.cbSize = sizeof(ScrollInfo);
            //@ Unsupported property or method(C): 'SIF_ALL'
            //@ Unsupported property or method(C): 'fMask'
            ScrollInfo.fMask = ScrollInfo.SIF_ALL;
            //@ Unsupported property or method(C): 'nMin'
            ScrollInfo.nMin = 1;
            //@ Unsupported property or method(C): 'nMax'
            ScrollInfo.nMax = ScrollMax;
            //@ Unsupported property or method(C): 'nPage'
            ScrollInfo.nPage = 1;
            //@ Unsupported property or method(C): 'nPos'
            ScrollInfo.nPos = ScrollPos;
            //@ Unsupported property or method(D): 'Handle'
            //@ Unsupported property or method(C): 'SB_VERT'
            //@ Unsupported function or procedure: 'SetScrollInfo'
            SetScrollInfo(WndBase.Handle, ScrollInfo.SB_VERT, ScrollInfo, true);
        }

        // ******************************************************************************
        // Proccess	: WMCreate
        // Name		: Y.Sato
        // Date		: 2000/08/23
        // Parameter	: var Message	TWMCreate
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void WMCreate(ref TWMCreate Message)
        {
            base.WMCreate();
            //@ Unsupported property or method(C): 'ClientHeight'
            //@ Unsupported property or method(D): 'Height'
            WndBase.Height = this.ClientHeight;
            //@ Unsupported property or method(C): 'ClientWidth'
            //@ Unsupported property or method(D): 'Width'
            WndBase.Width = this.ClientWidth;
            WndPnl = new TSelWndPanel[0];
            DspInit(FAutoSize, FColCount, 0, FRowCount, 0);
            ScrollInfoSet(1, 1);
            // ｽｸﾛｰﾙﾊﾞｰの情報をｾｯﾄ

        }

        // ******************************************************************************
        // Proccess	: WMVScroll
        // Name		: Y.Sato
        // Date		: 2000/08/22
        // Parameter	: var Message	TWMVScroll
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void WMVScroll(ref TWMVScroll Message)
        {
            base.WMVScroll();
            //@ Unsupported property or method(C): 'ScrollCode'
            //@ Undeclared identifier(3): 'TScrollCode'
            //@ Unsupported property or method(C): 'Pos'
            Scroll(TScrollCode(Message.ScrollCode), Message.Pos);
        }

    } // end TSelWnd

    // ******************************************************************************
    // TMAS310SelWnd
    // ******************************************************************************
    public class TMAS310SelWnd: TSelWnd
    {
        // Private 宣言
        private int StartDate = 0;
        // 適用開始年月日
        private int EndDate = 0;
        // Public 宣言
        // ******************************************************************************
        // TMAS310SelWnd
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2000/11/24
        // Parameter	: AOwner	TComponent
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create( AOwner)
        public TMAS310SelWnd(object AOwner) : base(AOwner)
        {
            StartDate = 0;
            // 適用開始年月日
            EndDate = 0;
            // 適用終了年月日

        }
        // ******************************************************************************
        // Proccess	: 表示処理
        // Name		: Y.Sato
        // Date		: 2000/09/29
        // Parameter	: RecList
        // : var DspParam
        // : DspParamEtc
        // Return		: なし
        // History		: 2000/11/20	Y.Sato		・ｳｨﾝﾄﾞｳ表示桁数自動ｾｯﾄ対応
        // : 2000/11/22	Y.Sato		・固定摘要表示列切り換え対応
        // : 2001/02/05	Y.Sato		・固定摘要表示で仕訳辞書摘要も表示
        // : 2001/02/08	Y.Sato		・表示用と検索用で配列を別に持つ
        // : 2001/02/09	Y.Sato		・表示パラメータに固定摘要ウィンドウ表示パターンを追加
        // : 2001/04/27	Y.Sato		・表示処理で表示件数を返せるようにする
        // ******************************************************************************
        public void Dsp(TWTblData[] TblList, ref TWDspParamTbl DspParam, TWDspParamEtc DspParamEtc)
        {
            TWRecData[] RecList;
            bool bVisible;
            int Index;
            SortData(ref RecList, TblList, DspParam, DspParamEtc);
            // 表示件数をセット 2001/04/27 追加
            DspParam.DspCount = 0;
            // フィルタがON
            if (DspParam.DspParam.Filt)
            {
                for (Index = 0; Index <= RecList[1].GetUpperBound(0); Index ++ )
                {
                    //@ Unsupported property or method(D): 'Code'
                    //@ Unsupported property or method(D): 'Name'
                    if ((RecList[1][Index].Code != "") && (RecList[1][Index].Name != ""))
                    {
                        DspParam.DspCount ++;
                    }
                }
            }
            else
            {
                for (Index = 0; Index <= RecList[1].GetUpperBound(0); Index ++ )
                {
                    //@ Unsupported property or method(D): 'Code'
                    if (RecList[1][Index].Code != "")
                    {
                        DspParam.DspCount ++;
                    }
                }
            }
            // 件数取得（表示はしない）
            if (DspParam.DspMode == 1)
            {
                return;
            }
            //@ Unsupported property or method(D): 'Visible'
            bVisible = this.WndBase.Visible;
            if (bVisible)
            {
                //@ Unsupported property or method(D): 'Visible'
                this.WndBase.Visible = false;
            }
            // ﾊﾟﾈﾙを非表示にして高速化
            // 数値属性のとき
            if ((DspParamEtc.MasterInfo.CodeAttr == 0) || (DspParamEtc.MasterInfo.CodeAttr == 1))
            {
                this.CodeAlignment = System.Drawing.ContentAlignment.TopCenter;
                if (new ArrayList(new object[] {VKZ310Cmnu.TWTableID.wtiKanjoKmk, VKZ310Cmnu.TWTableID.wtiSaimkKmk, VKZ310Cmnu.TWTableID.wtiCash, VKZ310Cmnu.TWTableID.wtiTeki, VKZ310Cmnu.TWTableID.wtiTax}).Contains(DspParam.TableID))
                {
                    // SetCodeWidth(DspParamEtc.MasterInfo.CodeDigit * 7)					//<H0045> コメントアウト。
                    //@ Undeclared identifier(3): 'GetZoomRatio'
                    // <H0045>
                    this.CodeWidth = Convert.ToInt64(DspParamEtc.MasterInfo.CodeDigit * 7 * GetZoomRatio((this.m_pRec as object)) / 100);
                }
                else
                {
                    // SetPanelSize(DspParamEtc.MasterInfo.CodeDigit * 7, 102);			//<H0045> コメントアウト。
                    //@ Undeclared identifier(3): 'GetZoomRatio'
                    this.SetPanelSize(Convert.ToInt64(DspParamEtc.MasterInfo.CodeDigit * 7 * GetZoomRatio((this.m_pRec as object)) / 100), 102);
                }
            // <H0045>
            // 文字属性のとき
            }
            else
            {
                this.CodeAlignment = System.Drawing.ContentAlignment.TopLeft;
                this.SetPanelSize(DspParamEtc.MasterInfo.CodeDigit * 11, 102);
            }
            switch(DspParam.TableID)
            {
                case VKZ310Cmnu.TWTableID.wtiKanjoKmk:
                case VKZ310Cmnu.TWTableID.wtiSaimkKmk:
                case VKZ310Cmnu.TWTableID.wtiCash:
                    // 勘定科目,細目科目,資金繰科目
                    if (this.FColCount != 6)
                    {
                        this.DspInit(this.FAutoSize, 6, 0, 5, 0);
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiTeki:
                    // 固定摘要
                    if ((DspParam.TekiDspPtn == 0) && (this.FColCount != 4))
                    {
                        // ４列表示
                        this.DspInit(this.FAutoSize, 4, 0, 5, 0);
                    }
                    else if ((DspParam.TekiDspPtn == 1) && (this.FColCount != 3))
                    {
                        this.DspInit(this.FAutoSize, 3, 0, 5, 0);
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiTax:
                    // ３列表示
                    // 消費税
                    if (this.FColCount != 4)
                    {
                        this.DspInit(this.FAutoSize, 4, 0, 5, 0);
                    }
                    DspParam.DspParam.Filt = false;
                    break;
            // ﾌｨﾙﾀOFF
            }
            // (*H0006	20020219 khattori ＣＲ！！！*)
            // (DspParam.TableID=wtiKanjoKmk) or
            // FileExists('c:\temp\MjsLog\TestMode.txt')
            if (((DspParam.TableID == VKZ310Cmnu.TWTableID.wtiTeki)) && (this.FCRMode == 1))
            {
                this.FInnerCode = true;
            }
            else
            {
                this.FInnerCode = false;
            }
            this.SetRecListSrc(RecList[0], DspParam.DspParam);
            // 検索用レコードリストをセット
            // (*H0001	20020219 khattori ＣＲ！！！*)
            base.Dsp(RecList[1], ref DspParam.DspParam, true);
            // 表示用レコードリストをセット
            // inherited Dsp(RecList[1], DspParam.DspParam);								// 表示用レコードリストをセット
            if (bVisible)
            {
                //@ Unsupported property or method(D): 'Visible'
                this.WndBase.Visible = true;
            }
            // ﾊﾟﾈﾙを表示する

        }

        // procedure Dsp(TblList: TWTblList; DspParam: TWDspParamTbl; DspParamEtc: TWDspParamEtc); overload; 2001/04/27 削除
        // ******************************************************************************
        // Proccess	: 固定摘要をチェック
        // Name		: Y.Sato
        // Date		: 2001/01/09
        // Parameter	: TblList		固定摘要レコード
        // : CTParam		固定摘要チェックパラメータ
        // Return		: Boolean		True:	OK
        // False:	NG
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public bool CheckTeki(TWTblData[] TblList, TWCTParam CTParam)
        {
            bool result;
            int Index1;
            int Index2;
            string sTekiCd1;
            string sTekiCd2;
            string sTekiCd3;
            string sTekiCd4;
            string sTekiCd5;
            result = false;
            sTekiCd1 = (CTParam.TekiCd1).ToString();
            sTekiCd2 = (CTParam.TekiCd2).ToString();
            sTekiCd3 = (CTParam.TekiCd3).ToString();
            sTekiCd4 = (CTParam.TekiCd4).ToString();
            sTekiCd5 = (CTParam.TekiCd5).ToString();
            for (Index1 = 0; Index1 <= TblList.GetUpperBound(0); Index1 ++ )
            {
                if ((CTParam.TekiCd1 > 0) && (TblList[Index1].RecData.Code == sTekiCd1) || (CTParam.TekiCd2 > 0) && (TblList[Index1].RecData.Code == sTekiCd2) || (CTParam.TekiCd3 > 0) && (TblList[Index1].RecData.Code == sTekiCd3) || (CTParam.TekiCd4 > 0) && (TblList[Index1].RecData.Code == sTekiCd4) || (CTParam.TekiCd5 > 0) && (TblList[Index1].RecData.Code == sTekiCd5))
                {
                    // (*Ver1.01*)
                    // (*20020225 khattori	件数が多い時、表示が遅くなる*)
                    if (CheckTeki2(TblList[Index1], CTParam))
                    {
                        result = true;
                        break;
                    }
                // for Index2 := 0 to High(TblList[Index1].TekiData.TekiTreeData) do
                // begin
                // // 通常摘要(摘要分類)
                // if TblList[Index1].TekiData.TekiTreeData[Index2].TekiKbn = 1 then
                // begin
                // if (CTParam.TKClassCode > 0) and (TblList[Index1].TekiData.TekiTreeData[Index2].SumCode = CTParam.TKClassCode) then
                // begin
                // Result	:= True;
                // Break;
                // end;
                // end
                // // 科目連想
                // else if TblList[Index1].TekiData.TekiTreeData[Index2].TekiKbn = 2 then
                // begin
                // if (CTParam.TKClassCode = 0) and (CTParam.KmkCode > 0) and (TblList[Index1].TekiData.TekiTreeData[Index2].SumCode = CTParam.KmkCode) then
                // begin
                // Result	:= True;
                // Break;
                // end;
                // end;
                // end;
                }
            }
            return result;
        }

        // 固定摘要をチェック
        // (*20020225 khattori	件数が多い時、表示が遅くなる*)
        // (*Ver1.01*)
        // (*20020225 khattori	件数が多い時、表示が遅くなる*)
        // ******************************************************************************
        // Proccess	: 固定摘要をチェック
        // Name		: Y.Sato
        // Date		: 2001/01/09
        // Parameter	: TblList		固定摘要レコード
        // : CTParam		固定摘要チェックパラメータ
        // Return		: Boolean		True:	OK
        // False:	NG
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public bool CheckTeki2(TWTblData TblData, TWCTParam CTParam)
        {
            bool result;
            int Index1;
            result = false;
            for (Index1 = 0; Index1 <= TblData.TekiData.TekiTreeData.GetUpperBound(0); Index1 ++ )
            {
                // 通常摘要(摘要分類)
                if (TblData.TekiData.TekiTreeData[Index1].TekiKbn == 1)
                {
                    if ((CTParam.TkClassCode > 0) && (TblData.TekiData.TekiTreeData[Index1].SumCode == CTParam.TkClassCode))
                    {
                        result = true;
                        break;
                    }
                // 科目連想
                }
                else if (TblData.TekiData.TekiTreeData[Index1].TekiKbn == 2)
                {
                    if ((CTParam.TkClassCode == 0) && (CTParam.KmkCode > 0) && (TblData.TekiData.TekiTreeData[Index1].SumCode == CTParam.KmkCode))
                    {
                        result = true;
                        break;
                    }
                }
            }
            return result;
        }

        // **************************************************************************
        // Proccess	: 科目の性格を取得 消費税
        // Name		: Y.Sato
        // Date		: 2000/10/12
        // Parameter	: KmkParam		科目ﾊﾟﾗﾒｰﾀ
        // : KmkCode		科目ｺｰﾄﾞ
        // Return		: Integer		0:非消費税
        // 1:売上
        // 2:仕入
        // 3:売上調整勘定
        // 4:仕入調整勘定
        // 5:仮受消費税
        // 6:仮払消費税
        // 7:貸倒償却
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // **************************************************************************
        public int GetWndPattern_GetKmkType(TWKmkParam KmkParam, int[] KmkCode)
        {
            int result;
            result = 0;
            if (KmkParam.GCode != 0)
            {
                if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiUrityo])
                {
                    // 売上調整勘定
                    result = 3;
                }
                else if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiSirtyo])
                {
                    // 仕入調整勘定
                    result = 4;
                }
                else if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKruke])
                {
                    // 仮受消費税
                    result = 5;
                }
                else if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKrbar])
                {
                    // 仮払消費税
                    result = 6;
                }
                else if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor1])
                {
                    // 貸倒償却
                    result = 7;
                }
                else if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor2])
                {
                    // 貸倒償却
                    result = 7;
                }
                else if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor3])
                {
                    // 貸倒償却
                    result = 7;
                }
                else if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor4])
                {
                    // 貸倒償却
                    result = 7;
                }
                else if (KmkParam.GCode == KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor5])
                {
                    // 貸倒償却
                    result = 7;
                }
                else if (KmkParam.TaxKbn == 0)
                {
                    // 対象外
                    result = 0;
                }
                else if (KmkParam.TaxKbn == 1)
                {
                    // 売上科目
                    result = 1;
                }
                else if (KmkParam.TaxKbn == 2)
                {
                    result = 2;
                }
            // 仕入科目
            }
            return result;
        }

        // **************************************************************************
        // Proccess  :	部門の種類を取得(共通仕入部門)
        // Parameter : iMode			Integer
        // 0:	借方のみで判断
        // 1:	貸方のみで判断
        // 2:	貸借両方で判断
        // Return    : Integer			部門種類
        // 0:	通常部門
        // 1:	課税・非課税売上共通課税仕入部門
        // 2:	非課税売上対応課税仕入部門
        // 3:	(iMode=2 限定)
        // 貸借で「1」「2」が混在
        // Comment	  :	仕入属性のときのみ適用される。それ以外は「0:通常部門」
        // History	  :	<HIS-075>
        // **************************************************************************
        public int GetWndPattern_GetBmnType(int iMode)
        {
            int result;
            int iDBunCd;
            int iCBunCd;
            iDBunCd = 0;
            iCBunCd = 0;
            if ((new ArrayList(new int[] {0, 2}).Contains(iMode)) && (DspParam.KmkParamD.TaxKbn == 2))
            {
                iDBunCd = DspParam.HojyoParamD.BunCode;
            }
            if ((new ArrayList(new int[] {1, 2}).Contains(iMode)) && (DspParam.KmkParamC.TaxKbn == 2))
            {
                iCBunCd = DspParam.HojyoParamC.BunCode;
            }
            result = iDBunCd | iCBunCd;
            return result;
        }

        public int GetWndPattern_GetBmnType()
        {
            return GetWndPattern_GetBmnType(2);
        }

        // **************************************************************************
        // Proccess	: ｳｨﾝﾄﾞｳﾊﾟﾀｰﾝ(売上1･2)を取得 消費税
        // Name		: Y.Sato
        // Date		: 2000/10/12
        // Parameter	: ComKbn4		公益法人区分
        // Return		: TWTaxWnd
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // **************************************************************************
        public TWTaxWnd GetWndPattern_Uri1_2()
        {
            TWTaxWnd result;
            if (DspParamEtc.ComKbn4 == 0)
            {
                result = VKZ310Cmnu.TWTaxWnd.wtwUri1;
            }
            else
            {
                result = VKZ310Cmnu.TWTaxWnd.wtwUri2;
            }
            return result;
        }

        // **************************************************************************
        // Proccess  :	ウィンドウパターン(仕入1〜9、11〜14)を取得
        // Parameter : None
        // Return    : TWWndPattern
        // History	  :	<HIS-075>
        // **************************************************************************
        public TWWndPattern GetWndPattern_Sir1_9()
        {
            TWWndPattern result;
            int iBmn;
            TWDspParamTax _wvar1 = DspParam.DspParamTax;
            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
            result.KanShoKbn = false;
            iBmn = GetWndPattern_GetBmnType();
            switch(iBmn)
            {
                case 1:
                    // 課税・非課税売上共通仕入部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                            // 輸入取引区分
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir7;
                            break;
                        case 1:
                        case 2:
                            // 輸入取引なし
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir8;
                            break;
                        case 3:
                            // 税抜処理(消費税一括処理) or 税抜処理(国税/地方税分割)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir9;
                            break;
                    // 税込処理(消費税一括処理)
                    }
                    break;
                case 2:
                    // 非課税売上対応部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                            // 輸入取引区分
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir11;
                            break;
                        case 1:
                        case 2:
                            // 輸入取引なし
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir12;
                            break;
                        case 3:
                            // 税抜処理(消費税一括処理) or 税抜処理(国税/地方税分割)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir13;
                            break;
                    // 税込処理(消費税一括処理)
                    }
                    break;
                case 3:
                    // 課税・非課税売上共通仕入部門 と 非課税売上対応部門 が混在
                    result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir14;
                    break;
                default:
                    // 消「30」「40」限定
                    // 通常部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                            // 輸入取引区分
                            // 輸入取引なし
                            if (_wvar1.KanKbn)
                            {
                                // 簡易
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir1;
                            }
                            else
                            {
                                // 詳細
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir2;
                            }
                            break;
                        case 1:
                        case 2:
                            // 税抜処理(消費税一括処理)
                            // 税抜処理(国税/地方税分割)
                            if (_wvar1.KanKbn)
                            {
                                // 簡易
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir3;
                            }
                            else
                            {
                                // 詳細
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir4;
                            }
                            break;
                        case 3:
                            // 税込処理(消費税一括処理)
                            if (_wvar1.KanKbn)
                            {
                                // 簡易
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir5;
                            }
                            else
                            {
                                // 詳細
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir6;
                            }
                            break;
                    }
                    result.KanShoKbn = true;
                    break;
            }
            return result;
        }

        // //**************************************************************************
        // //		Proccess	: ｳｨﾝﾄﾞｳﾊﾟﾀｰﾝ(仕入1〜9)を取得 消費税
        // //		Name		: Y.Sato
        // //		Date		: 2000/10/12
        // //		Parameter	: BunCodeD		(借方)共通部門仕入区分
        // //					: BunCodeC		(貸方)共通部門仕入区分
        // //					: ImportKbn		輸入取引区分
        // //					: KanKbn		消費税簡易表示区分
        // //		Return		: TWWndPattern
        // //		History		: 9999/99/99	X.Xxxx
        // //									XXXXXXXXXXXXXXXXXX
        // //**************************************************************************
        // function Sir1_9: TWWndPattern;
        // //	function Sir1_9(BunCodeD, BunCodeC, ImportKbn: Integer; KanKbn: Boolean): TWWndPattern;
        // begin
        // with DspParam,DspParamTax,DspParamEtc	do
        // begin
        // Result.TaxWnd		:= wtwError;
        // Result.KanShoKbn	:= False;
        // // 共通仕入部門対象外
        // if (HojyoParamD.BunCode = 0) and (HojyoParamC.BunCode = 0) then
        // begin
        // // 輸入取引なし
        // if ImportKbn = 0 then
        // begin
        // if KanKbn then	Result.TaxWnd	:= wtwSir1
        // else			Result.TaxWnd	:= wtwSir2;
        // end
        // // 税抜処理(消費税一括処理) or 税抜処理(国税/地方税分割)
        // else if (ImportKbn = 1) or (ImportKbn = 2) then
        // begin
        // if KanKbn then	Result.TaxWnd	:= wtwSir3
        // else	 		Result.TaxWnd	:= wtwSir4;
        // end
        // // 税込処理(消費税一括処理)
        // else if ImportKbn = 3 then
        // begin
        // if KanKbn then	Result.TaxWnd	:= wtwSir5
        // else			Result.TaxWnd	:= wtwSir6;
        // end;
        // Result.KanShoKbn	:= True;
        // end
        // // 共通仕入部門
        // else
        // begin
        // if		ImportKbn = 0						then	Result.TaxWnd	:= wtwSir7	// 輸入取引なし
        // else if (ImportKbn = 1) or (ImportKbn = 2)	then	Result.TaxWnd	:= wtwSir8	// 税抜処理(消費税一括処理) or 税抜処理(国税/地方税分割)
        // else if ImportKbn = 3						then	Result.TaxWnd	:= wtwSir9;	// 税込処理(消費税一括処理)
        // end;
        // end;
        // end;
        // **************************************************************************
        // Proccess  :	ウィンドウパターン(仮払1〜6、11〜21)を取得
        // Parameter : None
        // Return    : TWWndPattern
        // History	  :	<HIS-075>
        // **************************************************************************
        public TWWndPattern GetWndPattern_Kbr1_6()
        {
            TWWndPattern result;
            int iBmn;
            TWDspParamTax _wvar1 = DspParam.DspParamTax;
            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
            result.KanShoKbn = false;
            iBmn = GetWndPattern_GetBmnType();
            switch(iBmn)
            {
                case 1:
                    // 課税・非課税売上共通仕入部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                        case 3:
                            // 輸入取引区分
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri11;
                            break;
                        case 1:
                            // 輸入取引なし or 税込処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri12;
                            break;
                        case 2:
                            // 税抜処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri13;
                            break;
                    // 税抜処理(国税/地方税分割)
                    }
                    break;
                case 2:
                    // 非課税売上対応部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                        case 3:
                            // 輸入取引区分
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri16;
                            break;
                        case 1:
                            // 輸入取引なし or 税込処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri17;
                            break;
                        case 2:
                            // 税抜処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri18;
                            break;
                    // 税抜処理(国税/地方税分割)
                    }
                    break;
                case 3:
                    // 課税・非課税売上共通仕入部門 と 非課税売上対応部門 が混在
                    result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri21;
                    break;
                default:
                    // 消「40」限定
                    // 通常部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                        case 3:
                            // 輸入取引区分
                            // 輸入取引なし
                            // 税込処理(消費税一括処理)
                            if (_wvar1.KanKbn)
                            {
                                // 簡易
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri1;
                            }
                            else
                            {
                                // 詳細
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri2;
                            }
                            break;
                        case 1:
                            // 税抜処理(消費税一括処理)
                            if (_wvar1.KanKbn)
                            {
                                // 簡易
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri3;
                            }
                            else
                            {
                                // 詳細
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri4;
                            }
                            break;
                        case 2:
                            // 税抜処理(国税/地方税分割)
                            if (_wvar1.KanKbn)
                            {
                                // 簡易
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri5;
                            }
                            else
                            {
                                // 詳細
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri6;
                            }
                            break;
                    }
                    result.KanShoKbn = true;
                    break;
            }
            return result;
        }

        // //**************************************************************************
        // //		Proccess	: ｳｨﾝﾄﾞｳﾊﾟﾀｰﾝ(仮払1〜6)を取得 消費税
        // //		Name		: Y.Sato
        // //		Date		: 2000/10/12
        // //		Parameter	: ImportKbn		輸入取引区分
        // //					: KanKbn		消費税簡易表示区分
        // //		Return		: TWWndPattern
        // //		History		: 9999/99/99	X.Xxxx
        // //									XXXXXXXXXXXXXXXXXX
        // //**************************************************************************
        // function Kbr1_6: TWWndPattern;
        // begin
        // with DspParam, DspParamTax,DspParamEtc	do
        // begin
        // Result.TaxWnd		:= wtwError;
        // Result.KanShoKbn	:= True;
        // case ImportKbn of
        // 0,3:if KanKbn then	Result.TaxWnd	:= wtwKrbri1	else	Result.TaxWnd	:= wtwKrbri2;	// 輸入取引なし, 税込処理
        // 1:	if KanKbn then	Result.TaxWnd	:= wtwKrbri3	else	Result.TaxWnd	:= wtwKrbri4;	// 税抜処理(消費税一括処理)
        // 2:	if KanKbn then	Result.TaxWnd	:= wtwKrbri5	else	Result.TaxWnd	:= wtwKrbri6;	// 税抜処理(国税/地方税分割)
        // end;
        // end;
        // end;
        // **************************************************************************
        // Proccess  :	ウィンドウパターン(仮払7〜9、11〜21)を取得
        // Parameter : None
        // Return    : TWWndPattern
        // Comment	  :	相手科目が仕入のケースなので
        // 「税抜処理(国税/地方税分割)」で	地方消費税 を表示しない
        // History	  :	<HIS-075>
        // **************************************************************************
        public TWWndPattern GetWndPattern_Kbr7_9()
        {
            TWWndPattern result;
            int iBmn;
            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
            result.KanShoKbn = false;
            iBmn = GetWndPattern_GetBmnType();
            switch(iBmn)
            {
                case 1:
                    // 課税・非課税売上共通仕入部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                        case 3:
                            // 輸入取引区分
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri14;
                            break;
                        case 1:
                            // 輸入取引なし or 税込処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri15;
                            break;
                        case 2:
                            // 税抜処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri15;
                            break;
                    // 税抜処理(国税/地方税分割)
                    }
                    break;
                case 2:
                    // 非課税売上対応部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                        case 3:
                            // 輸入取引区分
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri19;
                            break;
                        case 1:
                            // 輸入取引なし or 税込処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri20;
                            break;
                        case 2:
                            // 税抜処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri20;
                            break;
                    // 税抜処理(国税/地方税分割)
                    }
                    break;
                case 3:
                    // 課税・非課税売上共通仕入部門 と 非課税売上対応部門 が混在
                    result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri21;
                    break;
                default:
                    // 消「40」限定
                    // 通常部門
                    switch(DspParamEtc.ImportKbn)
                    {
                        case 0:
                        case 3:
                            // 輸入取引区分
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri7;
                            break;
                        case 1:
                            // 輸入取引なし or 税込処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri8;
                            break;
                        case 2:
                            // 税抜処理(消費税一括処理)
                            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri9;
                            break;
                    // 税抜処理(国税/地方税分割)
                    }
                    break;
            }
            return result;
        }

        // 固定摘要をチェック
        // ******************************************************************************
        // Proccess	: 消費税ｳｨﾝﾄﾞｳ表示ﾊﾟﾀｰﾝを取得
        // Name		: Y.Sato
        // Date		: 2000/10/16
        // Parameter	: DspParam
        // : DspParamEtc
        // Return		: TWWndPattern
        // History		: 2000/10/31	Y.Sato		･非消費税仕訳対応
        // ******************************************************************************
        public TWWndPattern GetWndPattern(TWDspParamTbl DspParam, TWDspParamEtc DspParamEtc)
        {
            TWWndPattern result;
            // //**************************************************************************
            // //		Proccess	: ｳｨﾝﾄﾞｳﾊﾟﾀｰﾝ(仮払7〜9)を取得 消費税
            // //		Name		: Y.Sato
            // //		Date		: 2000/10/12
            // //		Parameter	: ImportKbn		輸入取引区分
            // //		Return		: TWTaxWnd
            // //		History		: 9999/99/99	X.Xxxx
            // //									XXXXXXXXXXXXXXXXXX
            // //**************************************************************************
            // function Kbr7_9: TWTaxWnd;
            // begin
            // Result	:= wtwError;
            // case DspParamEtc.ImportKbn of
            // 0, 3:	Result	:= wtwKrbri7;			// 輸入取引なし, 税込処理
            // 1:		Result	:= wtwKrbri8;			// 税抜処理(消費税一括処理)
            // 2:		Result	:= wtwKrbri9;			// 税抜処理(国税/地方税分割)
            // end;
            // end;
            result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwNone;
            result.KanShoKbn = false;
            TWDspParamTax _wvar1 = DspParam.DspParamTax;
            // 表示条件(売上)
            if (_wvar1.TaxDsp == VKZ310Cmnu.TWTaxDsp.wtdJknUri)
            {
                if (DspParamEtc.ComKbn4 == 0)
                {
                    // 公益法人外
                    result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwJknUri1;
                }
                else
                {
                    result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwJknUri2;
                }
            // 公益法人
            // 表示条件(仕入)
            }
            else if (_wvar1.TaxDsp == VKZ310Cmnu.TWTaxDsp.wtdJknSir)
            {
                switch(DspParamEtc.ImportKbn)
                {
                    case 0:
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwJknSir1;
                        break;
                    case 1:
                    case 2:
                        // 輸入取引なし
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwJknSir2;
                        break;
                    case 3:
                        // 税抜処理
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwJknSir3;
                        break;
                // 税込処理
                }
            // 表示条件(区別なし)
            }
            else if (_wvar1.TaxDsp == VKZ310Cmnu.TWTaxDsp.wtdJkn)
            {
                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwUri3;
            // その他
            }
            else if (_wvar1.TaxDsp == VKZ310Cmnu.TWTaxDsp.wtdEtc)
            {
                switch(GetWndPattern_GetKmkType(DspParam.KmkParamD, DspParamEtc.KmkCode) * 10 + GetWndPattern_GetKmkType(DspParam.KmkParamC, DspParamEtc.KmkCode))
                {
                    case 10:
                        // (借方)科目性格*10+(貸方)科目性格
                        result.TaxWnd = GetWndPattern_Uri1_2();
                        break;
                    case 11:
                        // 売上			/	非消費税科目
                        result.TaxWnd = GetWndPattern_Uri1_2();
                        break;
                    case 12:
                        // 売上			/	売上
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwUri3;
                        break;
                    case 13:
                        // 売上			/	仕入
                        result.TaxWnd = GetWndPattern_Uri1_2();
                        break;
                    case 14:
                        // 売上			/	売上調整
                        result.TaxWnd = GetWndPattern_Uri1_2();
                        break;
                    case 15:
                        // 売上			/	仕入調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke2;
                        break;
                    case 16:
                        // 売上			/	仮受消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri10;
                        break;
                    case 17:
                        // 売上			/	仮払消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 01:
                        // 売上			/	貸倒償却
                        result.TaxWnd = GetWndPattern_Uri1_2();
                        break;
                    case 21:
                        // 非消費税科目	/	売上
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir10;
                        break;
                    case 31:
                        // 仕入			/	売上
                        result.TaxWnd = GetWndPattern_Uri1_2();
                        break;
                    case 41:
                        // 売上調整		/	売上
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir10;
                        break;
                    case 51:
                        // 仕入調整		/	売上
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke2;
                        break;
                    case 61:
                        // 仮受消費税		/	売上
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri10;
                        break;
                    case 71:
                        // 仮払消費税		/	売上
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 20:
                        // 貸倒償却		/	売上
                        result = GetWndPattern_Sir1_9();
                        break;
                    case 22:
                        // 仕入			/	非消費税科目
                        result = GetWndPattern_Sir1_9();
                        break;
                    case 23:
                        // 仕入			/	仕入
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir10;
                        break;
                    case 24:
                        // 仕入			/	売上調整
                        result = GetWndPattern_Sir1_9();
                        break;
                    case 25:
                        // 仕入			/	仕入調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke3;
                        break;
                    case 26:
                        // 仕入			/	仮受消費税
                        result = GetWndPattern_Kbr7_9();
                        break;
                    case 27:
                        // 仕入			/	仮払消費税		<HIS-075>
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 02:
                        // 仕入			/	貸倒償却
                        result = GetWndPattern_Sir1_9();
                        break;
                    case 32:
                        // 非消費税科目	/	仕入
                        result = GetWndPattern_Sir1_9();
                        break;
                    case 42:
                        // 売上調整		/	仕入
                        result = GetWndPattern_Sir1_9();
                        break;
                    case 52:
                        // 仕入調整		/	仕入
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke3;
                        break;
                    case 62:
                        // 仮受消費税		/	仕入
                        result = GetWndPattern_Kbr7_9();
                        break;
                    case 72:
                        // 仮払消費税		/	仕入			<HIS-075>
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 30:
                        // 貸倒償却		/	仕入
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwNone;
                        break;
                    case 33:
                        // 売上調整		/	非消費税科目
                        result.TaxWnd = GetWndPattern_Uri1_2();
                        break;
                    case 34:
                        // 売上調整		/	売上調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwNone;
                        break;
                    case 35:
                        // 売上調整		/	仕入調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke1;
                        break;
                    case 36:
                        // 売上調整		/	仮受消費税
                        result = GetWndPattern_Kbr1_6();
                        break;
                    case 37:
                        // 売上調整		/	仮払消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKsdor1;
                        break;
                    case 03:
                        // 売上調整		/	貸倒償却
                        result.TaxWnd = GetWndPattern_Uri1_2();
                        break;
                    case 43:
                        // 非消費税科目	/	売上調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir10;
                        break;
                    case 53:
                        // 仕入調整		/	売上調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke2;
                        break;
                    case 63:
                        // 仮受消費税		/	売上調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri10;
                        break;
                    case 73:
                        // 仮払消費税		/	売上調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 40:
                        // 貸倒償却		/	売上調整
                        result = GetWndPattern_Sir1_9();
                        break;
                    case 44:
                        // 仕入調整		/	非消費税科目
                        result = GetWndPattern_Sir1_9();
                        break;
                    case 45:
                        // 仕入調整		/	仕入調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke3;
                        break;
                    case 46:
                        // 仕入調整		/	仮受消費税
                        result = GetWndPattern_Kbr7_9();
                        break;
                    case 47:
                        // 仕入調整		/	仮払消費税		<HIS-075>
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 04:
                        // 仕入調整		/	貸倒償却
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwNone;
                        break;
                    case 54:
                        // 非消費税科目	/	仕入調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke1;
                        break;
                    case 64:
                        // 仮受消費税		/	仕入調整
                        result = GetWndPattern_Kbr1_6();
                        break;
                    case 74:
                        // 仮払消費税		/	仕入調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKsdor1;
                        break;
                    case 50:
                        // 貸倒償却		/	仕入調整
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke1;
                        break;
                    case 55:
                        // 仮受消費税		/	非消費税科目
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke1;
                        break;
                    case 56:
                        // 仮受消費税		/	仮受消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke3;
                        break;
                    case 57:
                        // 仮受消費税		/	仮払消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 05:
                        // 仮受消費税		/	貸倒償却
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKruke1;
                        break;
                    case 65:
                        // 非消費税科目	/	仮受消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri10;
                        break;
                    case 75:
                        // 仮払消費税		/	仮受消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 60:
                        // 貸倒償却		/	仮受消費税
                        result = GetWndPattern_Kbr1_6();
                        break;
                    case 66:
                        // 仮払消費税		/	非消費税科目
                        result = GetWndPattern_Kbr1_6();
                        break;
                    case 67:
                        // 仮払消費税		/	仮払消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 06:
                        // 仮払消費税		/	貸倒償却
                        result = GetWndPattern_Kbr1_6();
                        break;
                    case 76:
                        // 非消費税科目	/	仮払消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwError;
                        break;
                    case 70:
                        // 貸倒償却		/	仮払消費税
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKsdor1;
                        break;
                    case 77:
                        // 貸倒償却		/	非消費税科目
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKsdor1;
                        break;
                    case 07:
                        // 貸倒償却		/	貸倒償却
                        result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKsdor1;
                        break;
                // 非消費税科目	/	貸倒償却
                }
                // ---<HIS-075>------------------------------------------------------------------
                // 部門種類の考慮
                // 以下のウィンドウパターンは考慮済みなので除外する
                // 仕入１〜９
                // 仕入11〜14
                // 仮払１〜９
                // 仮払11〜21
                // なし、エラー
                if (!(new ArrayList(new TWTaxWnd[] {VKZ310Cmnu.TWTaxWnd.wtwSir1, VKZ310Cmnu.TWTaxWnd.wtwSir11, VKZ310Cmnu.TWTaxWnd.wtwKrbri1, VKZ310Cmnu.TWTaxWnd.wtwKrbri11, VKZ310Cmnu.TWTaxWnd.wtwNone, VKZ310Cmnu.TWTaxWnd.wtwError}).Contains(result.TaxWnd)))
                {
                    if (GetWndPattern_GetBmnType() > 0)
                    {
                        result.KanShoKbn = false;
                        switch(result.TaxWnd)
                        {
                            case VKZ310Cmnu.TWTaxWnd.wtwKrbri10:
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwKrbri21;
                                break;
                            default:
                                result.TaxWnd = VKZ310Cmnu.TWTaxWnd.wtwSir14;
                                break;
                        }
                    }
                }
            // ------------------------------------------------------------------<HIS-075>---
            }
        }
    }
}
            return result;
        }

        // 消費税ｳｨﾝﾄﾞｳ表示ﾊﾟﾀｰﾝを取得
        // ******************************************************************************
        // Proccess	: ﾃﾞｰﾀを検索
        // Name		: Y.Sato
        // Date		: 2000/09/29
        // Parameter	: SearchCode
        // : TblList
        // : DspParam
        // : DspParamEtc
        // Return		: Boolean
        // History		: 2000/11/08	Y.Sato		･消費税はｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択なし
        // : 2000/11/29	Y.Sato		･ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択不可
        // : 2001/02/08	Y.Sato		・表示用と検索用で配列を別に持つ
        // ******************************************************************************
        public bool SearchData(string SearchCode, TWTblData[] TblList, TWDspParamTbl DspParam, TWDspParamEtc DspParamEtc)
        {
            bool result;
            TWRecData[] RecList;
            // 消費税
            if (DspParam.TableID == VKZ310Cmnu.TWTableID.wtiTax)
            {
                DspParam.DspParamTax.KanKbn = false;
            }
            // 詳細表示
            SortData(ref RecList, TblList, DspParam, DspParamEtc);
            this.SetRecListSrc(RecList[0], DspParam.DspParam);
            // 検索用レコードリストをセット
            result = base.SearchData(SearchCode, false);
            return result;
        }

        // ******************************************************************************
        // Proccess	: 適用開始年月日と適用終了年月日をｾｯﾄ
        // Name		: Y.Sato
        // Date		: 2000/11/24
        // Parameter	: StartDate		適用開始年月日
        // : EndDate		適用終了年月日
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetDate(int StartDate, int EndDate)
        {
            this.StartDate = StartDate;
            this.EndDate = EndDate;
        }

        // 消費税ウィンドウパターン
        // **************************************************************************
        // Proccess	: 勘定科目チェック
        // Name		: Y.Sato
        // Date		: 2001/02/07
        // Parameter	: TblList
        // : DspParam
        // : DspParamEtc
        // Return		: TWTblList
        // History		: 2001/04/26	Y.Sato		・仕訳入力区分が入力不可でも表示する
        // **************************************************************************
        public TWTblData[] SortData_CheckKanjoKmk(TWTblData[] TblList, TWDspParamTbl DspParam, TWDspParamEtc DspParamEtc)
        {
            TWTblData[] result;
            int Index;
            int RecCnt;
            RecCnt = 0;
            result = new TWTblData[TblList.Length];
            for (Index = 0; Index <= TblList.GetUpperBound(0); Index ++ )
            {
                // 複合表示 or 複合科目でない and 資金複合科目でない
                // 会計科目,非会計科目の両方表示
                // 会計科目表示 and 会計科目
                // 非会計科目表示 and 非会計科目
                // 入力不可でも表示 2001/04/26 追加
                // 借方
                // 貸方
                // 借方+貸方
                // 貸借入力のみ
                if ((DspParam.FukugoDsp || (TblList[Index].RecData.Code != (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiFukugo]).ToString()) && (TblList[Index].RecData.Code != (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiSknfkg]).ToString())) && ((DspParam.KaikeDsp == VKZ310Cmnu.TWKaikeDsp.wkdBoth) || (DspParam.KaikeDsp == VKZ310Cmnu.TWKaikeDsp.wkdKaike) && ((TblList[Index].KmkData.AnalyzeCode != 0) || (TblList[Index].RecData.Code == (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiFukugo]).ToString()) || (TblList[Index].RecData.Code == (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiSknfkg]).ToString())) || (DspParam.KaikeDsp == VKZ310Cmnu.TWKaikeDsp.wkdHikaike) && (TblList[Index].KmkData.AnalyzeCode == 0) && (TblList[Index].RecData.Code != (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiFukugo]).ToString()) && (TblList[Index].RecData.Code != (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiSknfkg]).ToString())) && ((DspParam.InputKbn == 1) || (DspParam.DCDsp == 0) && ((TblList[Index].KmkData.InputKbn == 0) || (TblList[Index].KmkData.InputKbn == 1) && (TblList[Index].KmkData.DCKbn == 0) || (TblList[Index].KmkData.InputKbn == 2) && (TblList[Index].KmkData.DCKbn == 1)) || (DspParam.DCDsp == 1) && ((TblList[Index].KmkData.InputKbn == 0) || (TblList[Index].KmkData.InputKbn == 1) && (TblList[Index].KmkData.DCKbn == 1) || (TblList[Index].KmkData.InputKbn == 2) && (TblList[Index].KmkData.DCKbn == 0)) || (DspParam.DCDsp == 2) && (TblList[Index].KmkData.InputKbn < 9) || (DspParam.DCDsp == 3) && (TblList[Index].KmkData.InputKbn == 0)))
                {
                    result[RecCnt] = TblList[Index];
                    // 製造科目
                    if (TblList[Index].KmkData.SumAnaCode == 13)
                    {
                        result[RecCnt].RecData.Color = System.Drawing.Color.Blue;
                    }
                    RecCnt ++;
                // 入力不可
                }
                else
                {
                    // if	(TblList[Index].KmkData.InputKbn = 9)	then
                    // else if	(TblList[Index].KmkData.InputKbn = 9)	then
                    result[RecCnt].RecData.Code = TblList[Index].RecData.Code;
                    result[RecCnt].RecData.Name = "＝入力不可科目＝";
                    RecCnt ++;
                }
            }
            result = new TWTblData[RecCnt];
            return result;
        }

        // **************************************************************************
        // Proccess	: 分析コードチェック（勘定科目）
        // Name		: Y.Sato
        // Date		: 2001/02/06
        // Parameter	: TblList
        // : KmkParam
        // Return		: TWTblList
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // **************************************************************************
        public TWTblData[] SortData_CheckAnalyzeCode(TWTblData[] TblList, TWKmkParam KmkParam)
        {
            TWTblData[] result;
            int Index1;
            int Index2;
            int RecCnt;
            if (KmkParam.AnalyzeCode.Length == 0)
            {
                result = TblList;
                return result;
            }
            RecCnt = 0;
            result = new TWTblData[TblList.Length];
            for (Index1 = 0; Index1 <= TblList.GetUpperBound(0); Index1 ++ )
            {
                for (Index2 = 0; Index2 <= KmkParam.AnalyzeCode.GetUpperBound(0); Index2 ++ )
                {
                    // (*Ver A123 M103*)
                    // (*H0030 20020501 khattori	手形入力対応（以外検索）*)
                    if (((KmkParam.AnalyzeCode[Index2] > 0) && (TblList[Index1].KmkData.AnalyzeCode == KmkParam.AnalyzeCode[Index2])) || ((KmkParam.AnalyzeCode[Index2] < 0) && (TblList[Index1].KmkData.AnalyzeCode !=  -(KmkParam.AnalyzeCode[Index2]))))
                    {
                        // if TblList[Index1].KmkData.AnalyzeCode = KmkParam.AnalyzeCode[Index2] then
                        result[RecCnt] = TblList[Index1];
                        RecCnt ++;
                        break;
                    }
                }
            }
            result = new TWTblData[RecCnt];
            return result;
        }

        // **************************************************************************
        // Proccess	: ウィンドウ表示順序チェック（勘定科目）
        // Name		: Y.Sato
        // Date		: 2001/02/07
        // Parameter	: TblList
        // : DspParamEtc
        // Return		: TWTblList
        // History		: 2001/05/16	Y.Sato		・ウィンドウ表示順序のとき、空白は非表示
        // **************************************************************************
        public TWTblData[] SortData_CheckWinDspInfo(TWTblData[] TblList, TWDspParamTbl DspParam, TWDspParamEtc DspParamEtc)
        {
            TWTblData[] result;
            int Index1;
            int Index2;
            string sCode;
            int RecCnt;
            // 2001/05/16
            result = new TWTblData[DspParamEtc.WinDspInfo.Length];
            RecCnt = 0;
            // (*H0001	20010529 khattori ウィンドウ表示順序のとき、空白は非表示ー＞出納帳の当該だけ*)
            for (Index1 = 0; Index1 <= DspParamEtc.WinDspInfo.GetUpperBound(0); Index1 ++ )
            {
                if (DspParamEtc.WinDspInfo[Index1].KmkCode > 0)
                {
                    sCode = (DspParamEtc.WinDspInfo[Index1].KmkCode).ToString();
                    for (Index2 = 0; Index2 <= TblList.GetUpperBound(0); Index2 ++ )
                    {
                        if (sCode == TblList[Index2].RecData.Code)
                        {
                            result[RecCnt] = TblList[Index2];
                            // 出納帳の時
                            if (DspParam.Suitoutyou == 1)
                            {
                                RecCnt ++;
                            }
                            break;
                        }
                    }
                }
                // 出納帳以外の時
                if (DspParam.Suitoutyou != 1)
                {
                    RecCnt ++;
                }
            }
            result = new TWTblData[RecCnt];
            return result;
        }

        // (*H0003 20010620 khattori syuusei 入力不可科目、非会計科目の表示*)
        // **************************************************************************
        // Proccess	: ウィンドウ入力不可科目チェック
        // **************************************************************************
        public TWTblData[] SortData_CheckInVisible(TWTblData[] TblList)
        {
            TWTblData[] result;
            int Index1;
            int RecCnt;
            // 2001/05/16
            result = new TWTblData[TblList.Length];
            RecCnt = 0;
            for (Index1 = 0; Index1 <= TblList.GetUpperBound(0); Index1 ++ )
            {
                if ("＝入力不可科目＝" != TblList[Index1].RecData.Name)
                {
                    result[RecCnt] = TblList[Index1];
                    RecCnt ++;
                }
            }
            result = new TWTblData[RecCnt];
            return result;
        }

        // (*H0003 20010620 khattori syuusei 入力不可科目、非会計科目の表示*)
        // **************************************************************************
        // Proccess	: 会計科目ー非会計科目順序調整
        // **************************************************************************
        public TWTblData[] SortData_SortKaikeiKbn(TWTblData[] TblList, TWDspParamEtc DspParamEtc)
        {
            TWTblData[] result;
            int Index;
            int RecCnt;
            // 2001/05/16
            result = new TWTblData[TblList.Length];
            RecCnt = 0;
            for (Index = 0; Index <= TblList.GetUpperBound(0); Index ++ )
            {
                if ((TblList[Index].KmkData.AnalyzeCode != 0) || (TblList[Index].RecData.Code == (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiFukugo]).ToString()) || (TblList[Index].RecData.Code == (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiSknfkg]).ToString()))
                {
                    result[RecCnt] = TblList[Index];
                    RecCnt ++;
                }
            }
            for (Index = 0; Index <= TblList.GetUpperBound(0); Index ++ )
            {
                if ((TblList[Index].KmkData.AnalyzeCode == 0) && (TblList[Index].RecData.Code != (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiFukugo]).ToString()) && (TblList[Index].RecData.Code != (DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiSknfkg]).ToString()))
                {
                    result[RecCnt] = TblList[Index];
                    RecCnt ++;
                }
            }
            result = new TWTblData[RecCnt];
            return result;
        }

        // **************************************************************************
        // Proccess	: 細目科目チェック
        // Name		: Y.Sato
        // Date		: 2001/02/08
        // Parameter	: TblList
        // : DspParam
        // Return		: TWTblList
        // History		: 2001/05/14	Y.Sato		・細目科目表示の不具合を修正
        // **************************************************************************
        public TWTblData[] SortData_CheckSaimkKmk(TWTblData[] TblList, TWDspParamTbl DspParam)
        {
            TWTblData[] result;
            int Index;
            int RecCnt;
            RecCnt = 0;
            result = new TWTblData[TblList.Length];
            for (Index = 0; Index <= TblList.GetUpperBound(0); Index ++ )
            {
                if (TblList[Index].RecData.Code == (DspParam.KmkParamD.GCode).ToString())
                {
                    result[RecCnt].RecData.Code = (TblList[Index].KmkData.SubCode).ToString();
                    result[RecCnt].RecData.Name = TblList[Index].RecData.Name;
                    result[RecCnt].RecData.Ren = TblList[Index].RecData.Ren;
                    result[RecCnt].RecData.Color = TblList[Index].RecData.Color;
                    RecCnt ++;
                }
                // 文字列で判断すると'10004' < '127' になるので、数値で判断する
                if (Convert.ToInt32(TblList[Index].RecData.Code) > DspParam.KmkParamD.GCode)
                {
                    // if TblList[Index].RecData.Code > IntToStr(DspParam.KmkParamD.GCode) then	2001/05/14
                    break;
                }
            }
            result = new TWTblData[RecCnt];
            return result;
        }

        // **************************************************************************
        // Proccess	: データを整列 固定摘要(科目連想、摘要残優先)
        // Name		: Y.Sato
        // Date		: 2000/10/05
        // Parameter	: var TblList1	取得データ
        // : TblList2		元データ
        // : TekiDsp		固定摘要表示区分
        // Return		: なし
        // History		: 2001/01/09	Y.Sato		・固定摘要チェック関数対応
        // : 2001/05/07	Y.Sato		・摘要残優先表示のとき、科目で絞り込む
        // : 2001/05/08	Y.Sato		・摘要残優先表示の変更
        // : 2001/05/11	Y.Sato		・固定摘要科目連想表示の色を緑から黒に変更
        // **************************************************************************
        public void SortData_TekiSort(ref TWTblData[] TblList1, TWTblData[] TblList2, TWTekiDsp TekiDsp)
        {
            int Index1;
            int Index2;
            int RecCnt;
            int RecCnt1;
            // 科目連想の中で摘要残管理ありのもの 2001/05/08
            int RecCnt2;
            // 科目連想の中で摘要残管理なしのもの 2001/05/08
            TWCTParam CTParamD;
            TWCTParam CTParamC;
            TWTblData[] TblList3;
            // 科目連想表示用リスト 2001/05/08
            TWTblData[] TblList4;
            // 科目連想の中で摘要残管理なしのもの 2001/05/08
            int[] TekiCode = new int[1 + 1];
            // 固定摘要コード 2001/05/08
            bool[] bValue = new bool[1 + 1];
            // 2001/05/08
            // SetLength(TblList1, Length(TblList2));									// 2001/05/08 削除
            TblList3 = new TWTblData[TblList2.Length];
            // 2001/05/08
            RecCnt = 0;
            // 固定摘要チェックパラメータ(借方)
            CTParamD.KmkCode = DspParam.KmkParamD.GCode;
            CTParamD.TkClassCode = DspParam.KmkParamD.TkClassCode;
            CTParamD.TekiCd1 = 0;
            CTParamD.TekiCd2 = 0;
            CTParamD.TekiCd3 = 0;
            CTParamD.TekiCd4 = 0;
            CTParamD.TekiCd5 = 0;
            // 固定摘要チェックパラメータ(貸方)
            CTParamC.KmkCode = DspParam.KmkParamC.GCode;
            CTParamC.TkClassCode = DspParam.KmkParamC.TkClassCode;
            CTParamC.TekiCd1 = 0;
            CTParamC.TekiCd2 = 0;
            CTParamC.TekiCd3 = 0;
            CTParamC.TekiCd4 = 0;
            CTParamC.TekiCd5 = 0;
            // 2001/05/08
            for (Index1 = 0; Index1 <= TblList2.GetUpperBound(0); Index1 ++ )
            {
                CTParamD.TekiCd1 = Convert.ToInt32(TblList2[Index1].RecData.Code);
                // 借方固定摘要コード１
                CTParamC.TekiCd1 = Convert.ToInt32(TblList2[Index1].RecData.Code);
                // 貸方固定摘要コード１
                // 固定摘要チェック
                // (*Ver1.01*)
                // (*20020225 khattori	件数が多い時、表示が遅くなる*)
                if (CheckTeki2(TblList2[Index1], CTParamD) || CheckTeki2(TblList2[Index1], CTParamC))
                {
                    // if CheckTeki(TblList2, CTParamD) or CheckTeki(TblList2, CTParamC) then
                    TblList3[RecCnt] = TblList2[Index1];
                    // TblList3[RecCnt].RecData.Color	:= clGreen;	2001/05/11
                    RecCnt ++;
                }
            }
            TblList3 = new TWTblData[RecCnt];
            // 摘要残優先表示
            if (TekiDsp == VKZ310Cmnu.TWTekiDsp.wtdZan)
            {
                TblList1 = new TWTblData[RecCnt];
                TblList4 = new TWTblData[RecCnt];
                //@ Unsupported function or procedure: 'SetLength'
                TekiCode[0].Length = 0;
                //@ Unsupported function or procedure: 'SetLength'
                TekiCode[1].Length = 0;
                RecCnt1 = 0;
                RecCnt2 = 0;
                bValue[0] = false;
                bValue[1] = false;
                if (DspParam.KmkParamD.GCode == 0)
                {
                    bValue[0] = true;
                }
                if ((DspParam.KmkParamC.GCode == 0) || (DspParam.KmkParamD.GCode == DspParam.KmkParamC.GCode))
                {
                    bValue[1] = true;
                }
                for (Index1 = 0; Index1 <= DspParamEtc.ZanRecord.GetUpperBound(0); Index1 ++ )
                {
                    if (bValue[0] && bValue[1])
                    {
                        break;
                    }
                    if (!bValue[0] && (DspParamEtc.ZanRecord[Index1].KmkCode == DspParam.KmkParamD.GCode))
                    {
                        //@ Unsupported function or procedure: 'SetLength'
                        TekiCode[0].Length = DspParamEtc.ZanRecord[Index1].TekiCode.Length;
                        for (Index2 = 0; Index2 <= DspParamEtc.ZanRecord[Index1].TekiCode.GetUpperBound(0); Index2 ++ )
                        {
                            TekiCode[0][Index2] = DspParamEtc.ZanRecord[Index1].TekiCode[Index2];
                        }
                        bValue[0] = true;
                    }
                    if (!bValue[1] && (DspParamEtc.ZanRecord[Index1].KmkCode == DspParam.KmkParamC.GCode))
                    {
                        //@ Unsupported function or procedure: 'SetLength'
                        TekiCode[1].Length = DspParamEtc.ZanRecord[Index1].TekiCode.Length;
                        for (Index2 = 0; Index2 <= DspParamEtc.ZanRecord[Index1].TekiCode.GetUpperBound(0); Index2 ++ )
                        {
                            TekiCode[1][Index2] = DspParamEtc.ZanRecord[Index1].TekiCode[Index2];
                        }
                        bValue[1] = true;
                    }
                }
                for (Index1 = 0; Index1 <= TblList3.GetUpperBound(0); Index1 ++ )
                {
                    bValue[0] = false;
                    // 借方残高管理チェック
                    if (!bValue[0])
                    {
                        for (Index2 = 0; Index2 <= Int32.MaxValue; Index2 ++ )
                        {
                            if ((TekiCode[0][Index2]).ToString() == TblList3[Index1].RecData.Code)
                            {
                                TblList1[RecCnt1] = TblList3[Index1];
                                TblList1[RecCnt1].RecData.Color = System.Drawing.Color.Blue;
                                RecCnt1 ++;
                                bValue[0] = true;
                                break;
                            }
                        }
                    }
                    // 貸方残高管理チェック
                    if (!bValue[0])
                    {
                        for (Index2 = 0; Index2 <= Int32.MaxValue; Index2 ++ )
                        {
                            if ((TekiCode[1][Index2]).ToString() == TblList3[Index1].RecData.Code)
                            {
                                TblList1[RecCnt1] = TblList3[Index1];
                                TblList1[RecCnt1].RecData.Color = System.Drawing.Color.Blue;
                                RecCnt1 ++;
                                bValue[0] = true;
                                break;
                            }
                        }
                    }
                    // 残高管理なし
                    if (!bValue[0])
                    {
                        TblList4[RecCnt2] = TblList3[Index1];
                        RecCnt2 ++;
                    }
                }
                // 残高管理なしをセット
                for (Index1 = 0; Index1 < RecCnt2; Index1 ++ )
                {
                    TblList1[RecCnt1 + Index1] = TblList4[Index1];
                }
            // 科目連想表示
            }
            else if (TekiDsp == VKZ310Cmnu.TWTekiDsp.wtdKmk)
            {
                TblList1 = TblList3;
            }
            // 摘要残優先表示
            // if TekiDsp = wtdZan then
            // begin
            // for Index1 := 0 to High(TblList2) do
            // begin
            // CTParamD.TekiCd1	:= StrToInt(TblList2[Index1].RecData.Code);	// 借方固定摘要コード１ 2001/05/07
            // CTParamC.TekiCd1	:= StrToInt(TblList2[Index1].RecData.Code);	// 貸方固定摘要コード１ 2001/05/07
            // 
            // // 固定摘要チェック
            // if (TblList2[Index1].TekiData.ZanKbn = 1) and (CheckTeki(TblList2, CTParamD) or CheckTeki(TblList2, CTParamC)) then
            // // 摘要残管理あり
            // //				if TblList2[Index1].TekiData.ZanKbn = 1 then	2001/05/07 削除
            // begin
            // TblList1[RecCnt]				:= TblList2[Index1];
            // TblList1[RecCnt].RecData.Color	:= clBlue;
            // Inc(RecCnt);
            // end;
            // end;
            // end;
            // 
            // for Index1 := 0 to High(TblList2) do
            // begin
            // CTParamD.TekiCd1	:= StrToInt(TblList2[Index1].RecData.Code);		// 借方固定摘要コード１
            // CTParamC.TekiCd1	:= StrToInt(TblList2[Index1].RecData.Code);		// 貸方固定摘要コード１
            // 
            // // 固定摘要チェック
            // if ((TekiDsp = wtdKmk) or (TblList2[Index1].TekiData.ZanKbn = 0)) and (CheckTeki(TblList2, CTParamD) or CheckTeki(TblList2, CTParamC)) then
            // begin
            // TblList1[RecCnt]				:= TblList2[Index1];
            // TblList1[RecCnt].RecData.Color	:= clGreen;
            // Inc(RecCnt);
            // end;
            // end;
            // SetLength(TblList1, RecCnt);
            // 2001/05/08 削除

        }

        // 負残側セット用リスト 2001/05/10
        // **********************************************************************
        // Proccess	: 仕訳辞書摘要をチェック
        // Name		: Y.Sato
        // Date		: 2001/05/10
        // Parameter	: DCKbn			0:借方 1:貸方
        // : TekiData
        // Return		: Boolean
        // History		: 2001/05/10	Y.Sato		・仕訳辞書摘要表示対応
        // **********************************************************************
        public bool SortData_GetSwDicTeki_CheckSwDicTeki(int DCKbn, TWTekiData TekiData)
        {
            bool result;
            string[] Code = new string[2 + 1];
            result = false;
            // 借方
            if (DCKbn == 0)
            {
                // マスタ区分１
                if (DspParam.HojyoParam[0].MasterKbn == 2)
                {
                    Code[0] = TekiData.DSubCode;
                }
                else if (DspParam.HojyoParam[0].MasterKbn == 41)
                {
                    Code[0] = TekiData.DBmnCode;
                }
                else if (DspParam.HojyoParam[0].MasterKbn == 42)
                {
                    Code[0] = TekiData.DSeg1Code;
                }
                else if (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[0].MasterKbn))
                {
                    Code[0] = TekiData.DHojyo1Code;
                }
                else if (DspParam.HojyoParam[0].MasterKbn == 51)
                {
                    Code[0] = TekiData.DKojCode;
                }
                else if (DspParam.HojyoParam[0].MasterKbn == 52)
                {
                    Code[0] = TekiData.DKsyCode;
                }
                else
                {
                    Code[0] = "";
                }
                // マスタ区分２
                if (DspParam.HojyoParam[1].MasterKbn == 2)
                {
                    Code[1] = TekiData.DSubCode;
                }
                else if (DspParam.HojyoParam[1].MasterKbn == 41)
                {
                    Code[1] = TekiData.DBmnCode;
                }
                else if (DspParam.HojyoParam[1].MasterKbn == 42)
                {
                    Code[1] = TekiData.DSeg1Code;
                }
                else if (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[1].MasterKbn))
                {
                    if (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[0].MasterKbn))
                    {
                        Code[1] = TekiData.DHojyo2Code;
                    }
                    else
                    {
                        Code[1] = TekiData.DHojyo1Code;
                    }
                }
                else if (DspParam.HojyoParam[1].MasterKbn == 51)
                {
                    Code[1] = TekiData.DKojCode;
                }
                else if (DspParam.HojyoParam[1].MasterKbn == 52)
                {
                    Code[1] = TekiData.DKsyCode;
                }
                else
                {
                    Code[1] = "";
                }
                // マスタ区分３
                if (DspParam.HojyoParam[2].MasterKbn == 2)
                {
                    Code[2] = TekiData.DSubCode;
                }
                else if (DspParam.HojyoParam[2].MasterKbn == 41)
                {
                    Code[2] = TekiData.DBmnCode;
                }
                else if (DspParam.HojyoParam[2].MasterKbn == 42)
                {
                    Code[2] = TekiData.DSeg1Code;
                }
                else if (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[2].MasterKbn))
                {
                    if ((new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[0].MasterKbn)) || (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[1].MasterKbn)))
                    {
                        Code[2] = TekiData.DHojyo2Code;
                    }
                    else
                    {
                        Code[2] = TekiData.DHojyo1Code;
                    }
                }
                else if (DspParam.HojyoParam[2].MasterKbn == 51)
                {
                    Code[2] = TekiData.DKojCode;
                }
                else if (DspParam.HojyoParam[2].MasterKbn == 52)
                {
                    Code[2] = TekiData.DKsyCode;
                }
                else
                {
                    Code[2] = "";
                }
            // 貸方
            }
            else if (DCKbn == 1)
            {
                // マスタ区分１
                if (DspParam.HojyoParam[0].MasterKbn == 2)
                {
                    Code[0] = TekiData.CSubCode;
                }
                else if (DspParam.HojyoParam[0].MasterKbn == 41)
                {
                    Code[0] = TekiData.CBmnCode;
                }
                else if (DspParam.HojyoParam[0].MasterKbn == 42)
                {
                    Code[0] = TekiData.CSeg1Code;
                }
                else if (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[0].MasterKbn))
                {
                    Code[0] = TekiData.CHojyo1Code;
                }
                else if (DspParam.HojyoParam[0].MasterKbn == 51)
                {
                    Code[0] = TekiData.CKojCode;
                }
                else if (DspParam.HojyoParam[0].MasterKbn == 52)
                {
                    Code[0] = TekiData.CKsyCode;
                }
                else
                {
                    Code[0] = "";
                }
                // マスタ区分２
                if (DspParam.HojyoParam[1].MasterKbn == 2)
                {
                    Code[1] = TekiData.CSubCode;
                }
                else if (DspParam.HojyoParam[1].MasterKbn == 41)
                {
                    Code[1] = TekiData.CBmnCode;
                }
                else if (DspParam.HojyoParam[1].MasterKbn == 42)
                {
                    Code[1] = TekiData.CSeg1Code;
                }
                else if (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[1].MasterKbn))
                {
                    if (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[0].MasterKbn))
                    {
                        Code[1] = TekiData.CHojyo2Code;
                    }
                    else
                    {
                        Code[1] = TekiData.CHojyo1Code;
                    }
                }
                else if (DspParam.HojyoParam[1].MasterKbn == 51)
                {
                    Code[1] = TekiData.CKojCode;
                }
                else if (DspParam.HojyoParam[1].MasterKbn == 52)
                {
                    Code[1] = TekiData.CKsyCode;
                }
                else
                {
                    Code[1] = "";
                }
                // マスタ区分３
                if (DspParam.HojyoParam[2].MasterKbn == 2)
                {
                    Code[2] = TekiData.CSubCode;
                }
                else if (DspParam.HojyoParam[2].MasterKbn == 41)
                {
                    Code[2] = TekiData.CBmnCode;
                }
                else if (DspParam.HojyoParam[2].MasterKbn == 42)
                {
                    Code[2] = TekiData.CSeg1Code;
                }
                else if (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[2].MasterKbn))
                {
                    if ((new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[0].MasterKbn)) || (new ArrayList(new int[] {21, 22, 25, 31}).Contains(DspParam.HojyoParam[1].MasterKbn)))
                    {
                        Code[2] = TekiData.CHojyo2Code;
                    }
                    else
                    {
                        Code[2] = TekiData.CHojyo1Code;
                    }
                }
                else if (DspParam.HojyoParam[2].MasterKbn == 51)
                {
                    Code[2] = TekiData.CKojCode;
                }
                else if (DspParam.HojyoParam[2].MasterKbn == 52)
                {
                    Code[2] = TekiData.CKsyCode;
                }
                else
                {
                    Code[2] = "";
                }
            }
            if (((Code[0] == "") || (Code[0] == DspParam.HojyoParam[0].GCode)) && ((Code[1] == "") || (Code[1] == DspParam.HojyoParam[1].GCode)) && ((Code[2] == "") || (Code[2] == DspParam.HojyoParam[2].GCode)))
            {
                result = true;
            }
            return result;
        }

        // **************************************************************************
        // Proccess	: 仕訳辞書摘要取得（固定摘要）
        // Name		: Y.Sato
        // Date		: 2000/02/06
        // Parameter	: var TblList1	取得データ
        // : TblList2		元データ
        // Return		: なし
        // History		: 2001/05/10	Y.Sato		・仕訳辞書摘要表示対応
        // **************************************************************************
        public void SortData_GetSwDicTeki(ref TWTblData[] TblList1, TWTblData[] TblList2)
        {
            int Index1;
            int[] RecCnt = new int[1 + 1];
            // RecCnt		: Integer;	2001/05/10
            TWTblData[] TblList3;
            TblList1 = new TWTblData[TblList2.Length];
            TblList3 = new TWTblData[TblList2.Length];
            RecCnt[0] = 0;
            RecCnt[1] = 0;
            // RecCnt	:= 0;	2001/05/10
            for (Index1 = 0; Index1 <= TblList2.GetUpperBound(0); Index1 ++ )
            {
                // 仕訳辞書摘要 and 科目コードがセットされている
                if ((TblList2[Index1].TekiData.SwDicKbn == 1) && ((DspParam.KmkParamD.GCode > 0)))
                {
                    // 科目の正残区分が借方
                    if (DspParam.KmkParamD.DCKbn == 0)
                    {
                        // 正残側（借方）をチェック
                        if ((TblList2[Index1].TekiData.DKmkCode == DspParam.KmkParamD.GCode) && SortData_GetSwDicTeki_CheckSwDicTeki(0, TblList2[Index1].TekiData))
                        {
                            TblList1[RecCnt[0]] = TblList2[Index1];
                            RecCnt[0] ++;
                        // 負残側（貸方）をチェック
                        }
                        else if ((TblList2[Index1].TekiData.CKmkCode == DspParam.KmkParamD.GCode) && SortData_GetSwDicTeki_CheckSwDicTeki(1, TblList2[Index1].TekiData))
                        {
                            TblList3[RecCnt[1]] = TblList2[Index1];
                            RecCnt[1] ++;
                        }
                    // 科目の正残区分が貸方
                    }
                    else if (DspParam.KmkParamD.DCKbn == 1)
                    {
                        // 正残側（貸方）をチェック
                        if ((TblList2[Index1].TekiData.CKmkCode == DspParam.KmkParamD.GCode) && SortData_GetSwDicTeki_CheckSwDicTeki(1, TblList2[Index1].TekiData))
                        {
                            TblList1[RecCnt[0]] = TblList2[Index1];
                            RecCnt[0] ++;
                        // 負残側（借方）をチェック
                        }
                        else if ((TblList2[Index1].TekiData.DKmkCode == DspParam.KmkParamD.GCode) && SortData_GetSwDicTeki_CheckSwDicTeki(0, TblList2[Index1].TekiData))
                        {
                            TblList3[RecCnt[1]] = TblList2[Index1];
                            RecCnt[1] ++;
                        }
                    }
                }
            // 仕訳辞書摘要
            // if TblList2[Index1].TekiData.SwDicKbn = 1 then
            // begin
            // TblList1[RecCnt]	:= TblList2[Index1];
            // Inc(RecCnt);
            // end;
            // 2001/05/10 古いやり方
            }
            for (Index1 = 0; Index1 < RecCnt[1]; Index1 ++ )
            {
                TblList1[RecCnt[0] + Index1] = TblList3[Index1];
            }
            TblList1 = new TWTblData[RecCnt[0] + RecCnt[1]];
            // SetLength(TblList1, RecCnt);	2001/05/10

        }

        // **************************************************************************
        // Proccess	: 部署絞り込み処理 固定摘要
        // Name		: Y.Sato
        // Date		: 2000/10/05
        // Parameter	: var TblList1	取得ﾃﾞｰﾀ
        // : TblList2		元ﾃﾞｰﾀ
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // **************************************************************************
        public void SortData_TekiBusho(ref TWTblData[] TblList1, TWTblData[] TblList2)
        {
            int Index1;
            int RecCnt;
            // 部署指定なし
            if ((DspParam.KmkParamD.SectionCode == "") && (DspParam.KmkParamC.SectionCode == ""))
            {
                RecCnt = 0;
                TblList1 = new TWTblData[TblList2.GetUpperBound(0) + 1];
                for (Index1 = 0; Index1 <= TblList2.GetUpperBound(0); Index1 ++ )
                {
                    TblList1[RecCnt] = TblList2[Index1];
                    RecCnt ++;
                }
            }
            else
            {
                RecCnt = 0;
                TblList1 = new TWTblData[TblList2.GetUpperBound(0) + 1];
                for (Index1 = 0; Index1 <= TblList2.GetUpperBound(0); Index1 ++ )
                {
                    if ((DspParam.KmkParamD.SectionCode != "") && (TblList2[Index1].TekiData.SectionCode == DspParam.KmkParamD.SectionCode) || (DspParam.KmkParamC.SectionCode != "") && (TblList2[Index1].TekiData.SectionCode == DspParam.KmkParamC.SectionCode))
                    {
                        TblList1[RecCnt] = TblList2[Index1];
                        RecCnt ++;
                    }
                }
                // 特定部署ｺｰﾄﾞ空も表示
                if (!DspParam.BushoDsp)
                {
                    for (Index1 = 0; Index1 <= TblList2.GetUpperBound(0); Index1 ++ )
                    {
                        if (TblList2[Index1].TekiData.SectionCode == "")
                        {
                            TblList1[RecCnt] = TblList2[Index1];
                            RecCnt ++;
                        }
                    }
                }
                TblList1 = new TWTblData[RecCnt];
            }
        }

        // **************************************************************************
        // Proccess	: 適用開始年月日と適用終了年月日をﾁｪｯｸ
        // Name		: Y.Sato
        // Date		: 2000/11/24
        // Parameter	: TblList
        // : StartDate		適用開始年月日
        // : EndDate		適用終了年月日
        // Return		: TWTblList
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // **************************************************************************
        public TWTblData[] SortData_CheckDate(TWTblData[] TblList, int StartDate, int EndDate)
        {
            TWTblData[] result;
            int iIndex;
            int RecCnt;
            if ((StartDate == 0) && (EndDate == 0))
            {
                result = TblList;
            }
            else
            {
                RecCnt = 0;
                result = new TWTblData[TblList.Length];
                if (StartDate == 0)
                {
                    for (iIndex = 0; iIndex <= TblList.GetUpperBound(0); iIndex ++ )
                    {
                        if ((TblList[iIndex].StartDate == 0) || (TblList[iIndex].StartDate <= EndDate))
                        {
                            result[RecCnt] = TblList[iIndex];
                            RecCnt ++;
                        }
                    }
                }
                else if (EndDate == 0)
                {
                    for (iIndex = 0; iIndex <= TblList.GetUpperBound(0); iIndex ++ )
                    {
                        if ((TblList[iIndex].EndDate == 0) || (StartDate <= TblList[iIndex].EndDate))
                        {
                            result[RecCnt] = TblList[iIndex];
                            RecCnt ++;
                        }
                    }
                }
                else
                {
                    for (iIndex = 0; iIndex <= TblList.GetUpperBound(0); iIndex ++ )
                    {
                        // if ((TblList[iIndex].StartDate = 0) or (TblList[iIndex].StartDate <= EndDate))
                        // and ((TblList[iIndex].EndDate = 0) or (StartDate <= TblList[iIndex].EndDate))	then
                        if ((TblList[iIndex].StartDate == 0) && (TblList[iIndex].EndDate == 0) || (TblList[iIndex].StartDate == 0) && (StartDate <= TblList[iIndex].EndDate) || (TblList[iIndex].EndDate == 0) && (TblList[iIndex].StartDate <= EndDate) || (TblList[iIndex].StartDate <= EndDate) && (StartDate <= TblList[iIndex].EndDate))
                        {
                            result[RecCnt] = TblList[iIndex];
                            RecCnt ++;
                        }
                    }
                }
                // for iIndex := 0 to High(TblList) do
                // begin
                // if ((TblList[iIndex].StartDate = 0) or (EndDate = 0) or (TblList[iIndex].StartDate <= EndDate))
                // and ((TblList[iIndex].EndDate = 0) or (StartDate = 0) or (StartDate <= TblList[iIndex].EndDate))	then
                // begin
                // Result[RecCnt]	:= TblList[iIndex];
                // Inc(RecCnt);
                // end;
                // end;
                result = new TWTblData[RecCnt];
            }
            return result;
        }

        // Protected 宣言
        // ******************************************************************************
        // Proccess	: データを整列
        // Name		: Y.Sato
        // Date		: 2000/10/11
        // Parameter	: var RecList
        // : TblList
        // : DspParam
        // : DspParamEtc
        // Return		: なし
        // History		: 2000/11/06	Y.Sato		・借方/貸方表示区分に2:借方+貸方を追加
        // : 2000/12/07	Y.Sato		・勘定科目表示に貸借入力のみを考慮
        // : 2000/12/18	Y.Sato		・勘定科目表示の不具合を修正
        // : 2000/12/20	Y.Sato		・部門がP/Lのみ採用のときP/L部門+諸口を表示するように修正
        // : 2000/12/21	Y.Sato		・細目科目表示の不具合修正
        // : 2000/12/25	Y.Sato		・セグメント表示対応
        // : 2001/01/22	Y.Sato		・摘要残優先表示を変更
        // : 2001/02/05	Y.Sato		・固定摘要表示で仕訳辞書摘要も表示
        // ・工事表示を修正（入力区分を参照する）
        // : 2001/02/06	Y.Sato		・科目表示のとき要約分析コードを複数参照する
        // : 2001/02/07	Y.Sato		・科目表示でウィンドウ表示順序を考慮
        // : 2001/02/08	Y.Sato		・表示用と検索用で配列を別に持つ
        // : 2001/04/26	Y.Sato		・仕訳入力区分が入力不可でも表示する
        // : 2001/05/07	Y.Sato		・摘要残優先表示のとき、科目で絞り込む
        // : 2001/05/08	Y.Sato		・摘要残優先表示の変更
        // : 2001/05/10	Y.Sato		・仕訳辞書摘要表示対応
        // : 2001/05/11	Y.Sato		・固定摘要科目連想表示の色を緑から黒に変更
        // : 2001/05/14	Y.Sato		・細目科目表示の不具合を修正
        // : 2001/05/16	Y.Sato		・ウィンドウ表示順序のとき、空白は非表示
        // ******************************************************************************
        protected void SortData(ref TWRecData[] RecList, TWTblData[] TblList, TWDspParamTbl DspParam, TWDspParamEtc DspParamEtc)
        {
            int iIndex1;
            int iRecCnt;
            TWWndPattern WndPattern;
            iRecCnt = 0;
            RecList[0] = new TWRecData[0];
            RecList[1] = new TWRecData[0];
            switch(DspParam.TableID)
            {
                case VKZ310Cmnu.TWTableID.wtiKanjoKmk:
                    // 勘定科目
                    TblList = SortData_CheckDate(TblList, StartDate, EndDate);
                    // 適用開始年月日と適用終了年月日をﾁｪｯｸ
                    TblList = SortData_CheckAnalyzeCode(TblList, DspParam.KmkParamD);
                    // 分析コードチェック
                    TblList = SortData_CheckKanjoKmk(TblList, DspParam, DspParamEtc);
                    // 勘定科目チェック
                    RecList[0] = new TWRecData[TblList.Length];
                    for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                    {
                        RecList[0][iIndex1] = TblList[iIndex1].RecData;
                    }
                    // ウィンドウ表示順序チェック（勘定科目）
                    // (*H0003 20010620 khattori syuusei 入力不可科目、非会計科目の表示*)
                    if (DspParam.WinDspInfo && (DspParamEtc.WinDspInfo.Length > 0))
                    {
                        TblList = SortData_CheckWinDspInfo(TblList, DspParam, DspParamEtc);
                    }
                    // (*H0003 20010620 khattori syuusei 入力不可科目、非会計科目の表示*)
                    // 入力不可科目チェック
                    TblList = SortData_CheckInVisible(TblList);
                    // (*H0003 20010620 khattori syuusei 入力不可科目、非会計科目の表示*)
                    // 会計科目ー非会計科目順序調整
                    if ((DspParam.WinDspInfo == false) || (DspParamEtc.WinDspInfo.Length == 0))
                    {
                        TblList = SortData_SortKaikeiKbn(TblList, DspParamEtc);
                    }
                    RecList[1] = new TWRecData[TblList.Length];
                    for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                    {
                        RecList[1][iIndex1] = TblList[iIndex1].RecData;
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiSaimkKmk:
                    // 細目科目
                    TblList = SortData_CheckDate(TblList, StartDate, EndDate);
                    // 適用開始年月日と適用終了年月日をﾁｪｯｸ
                    TblList = SortData_CheckSaimkKmk(TblList, DspParam);
                    // 細目科目チェック
                    RecList[0] = new TWRecData[TblList.Length];
                    RecList[1] = new TWRecData[TblList.Length];
                    for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                    {
                        RecList[0][iIndex1] = TblList[iIndex1].RecData;
                        RecList[1][iIndex1] = TblList[iIndex1].RecData;
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiCash:
                    // 資金繰科目
                    RecList[0] = new TWRecData[TblList.Length];
                    RecList[1] = new TWRecData[TblList.Length];
                    for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                    {
                        RecList[0][iIndex1] = TblList[iIndex1].RecData;
                        RecList[1][iIndex1] = TblList[iIndex1].RecData;
                    }
                    break;
                // 補助
                // Modify the A .. B: VKZ310Cmnu.TWTableID.wtiGinko .. VKZ310Cmnu.TWTableID.wtiHanyo5
                case VKZ310Cmnu.TWTableID.wtiGinko:
                    TblList = SortData_CheckDate(TblList, StartDate, EndDate);
                    // 適用開始年月日と適用終了年月日をﾁｪｯｸ
                    RecList[0] = new TWRecData[TblList.Length];
                    RecList[1] = new TWRecData[TblList.Length];
                    for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                    {
                        RecList[0][iIndex1] = TblList[iIndex1].RecData;
                        RecList[1][iIndex1] = TblList[iIndex1].RecData;
                    }
                    break;
                // 部門、セグメント
                // Modify the A .. B: VKZ310Cmnu.TWTableID.wtiBumon .. VKZ310Cmnu.TWTableID.wtiSeg4
                case VKZ310Cmnu.TWTableID.wtiBumon:
                    TblList = SortData_CheckDate(TblList, StartDate, EndDate);
                    // 適用開始年月日と適用終了年月日をﾁｪｯｸ
                    // 科目に従う
                    if (DspParam.DspParamBum.BumDsp == VKZ310Cmnu.TWBumDsp.wbdKmk)
                    {
                        TWDspParamBum _wvar1 = DspParam.DspParamBum;
                        // P/L
                        if (DspParam.KmkParamD.BPKbn == 1)
                        {
                            _wvar1.BumDsp = VKZ310Cmnu.TWBumDsp.wbdPL1;
                            // (*Ver A??? M108*)
                            // (*H0030 20021017 khattori	非会計科目の部門ウィンドウが諸口だけでは不満らしい*)
                            _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcTujo] = true;
                            // 通常部門
                            // DspChar[wbcTujo]	:= False;
                            _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcEgyo] = false;
                            // 営業部門
                            _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcSezo] = false;
                            // 製造部門
                            _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcKnri] = false;
                            // 管理部門
                            _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcEgKn] = false;
                            // 営業+管理部門
                            _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcSeKn] = false;
                            switch(DspParam.KmkParamD.SumAnaCode)
                            {
                                case 11:
                                case 12:
                                    // 製造+管理部門
                                    // DspChar[wbcTujo]	:= True;					// 通常部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcEgyo] = true;
                                    // 営業部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcEgKn] = true;
                                    break;
                                case 13:
                                    // 営業+管理部門
                                    // DspChar[wbcTujo]	:= True;					// 通常部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcSezo] = true;
                                    // 製造部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcSeKn] = true;
                                    break;
                                case 14:
                                    // 製造+管理部門
                                    // DspChar[wbcTujo]	:= True;					// 通常部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcEgyo] = true;
                                    // 営業部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcKnri] = true;
                                    // 管理部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcEgKn] = true;
                                    // 営業+管理部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcSeKn] = true;
                                    break;
                                // 製造+管理部門
                                // Modify the A .. B: 15 .. 19, 21 .. 25
                                case 15:
                                case 21:
                                    // DspChar[wbcTujo]	:= True;					// 通常部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcKnri] = true;
                                    // 管理部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcEgKn] = true;
                                    // 営業+管理部門
                                    _wvar1.DspChar[VKZ310Cmnu.TWBumChar.wbcSeKn] = true;
                                    break;
                            // 製造+管理部門
                            }
                        }
                    }
                    // 全て
                    if (DspParam.DspParamBum.BumDsp == VKZ310Cmnu.TWBumDsp.wbdAll)
                    {
                        RecList[0] = new TWRecData[TblList.Length];
                        RecList[1] = new TWRecData[TblList.Length];
                        for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                        {
                            RecList[0][iIndex1] = TblList[iIndex1].RecData;
                            RecList[1][iIndex1] = TblList[iIndex1].RecData;
                        }
                    // 科目に従う
                    }
                    else if (DspParam.DspParamBum.BumDsp == VKZ310Cmnu.TWBumDsp.wbdKmk)
                    {
                        RecList[0] = new TWRecData[TblList.Length];
                        RecList[1] = new TWRecData[TblList.Length];
                        for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                        {
                            // 共通部門(B/S+P/L) or B/S部門
                            if ((TblList[iIndex1].HojyoData.HojyoKbn2 == 1) || (TblList[iIndex1].HojyoData.HojyoKbn2 == 2))
                            {
                                RecList[0][iRecCnt] = TblList[iIndex1].RecData;
                                RecList[1][iRecCnt] = TblList[iIndex1].RecData;
                                iRecCnt ++;
                            }
                        }
                        RecList[0] = new TWRecData[iRecCnt];
                        RecList[1] = new TWRecData[iRecCnt];
                    // P/LとB/S+P/L
                    }
                    else if (DspParam.DspParamBum.BumDsp == VKZ310Cmnu.TWBumDsp.wbdPL1)
                    {
                        RecList[0] = new TWRecData[TblList.Length];
                        RecList[1] = new TWRecData[TblList.Length];
                        for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                        {
                            // P/L部門 or 共通部門(B/S+P/L)
                            if ((TblList[iIndex1].HojyoData.HojyoKbn2 == 0) || (TblList[iIndex1].HojyoData.HojyoKbn2 == 1))
                            {
                                if (DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcTujo] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 0) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcEgyo] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 1) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcSezo] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 2) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcKnri] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 3) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcEgKn] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 4) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcSeKn] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 5) || (TblList[iIndex1].HojyoData.NCode == 0))
                                {
                                    RecList[0][iRecCnt] = TblList[iIndex1].RecData;
                                    RecList[1][iRecCnt] = TblList[iIndex1].RecData;
                                    iRecCnt ++;
                                }
                            }
                        }
                        RecList[0] = new TWRecData[iRecCnt];
                        RecList[1] = new TWRecData[iRecCnt];
                    // P/Lのみ
                    }
                    else if (DspParam.DspParamBum.BumDsp == VKZ310Cmnu.TWBumDsp.wbdPL2)
                    {
                        RecList[0] = new TWRecData[TblList.Length];
                        RecList[1] = new TWRecData[TblList.Length];
                        for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                        {
                            // P/L部門
                            if (TblList[iIndex1].HojyoData.HojyoKbn2 == 0)
                            {
                                if (DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcTujo] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 0) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcEgyo] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 1) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcSezo] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 2) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcKnri] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 3) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcEgKn] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 4) || DspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcSeKn] && (TblList[iIndex1].HojyoData.HojyoKbn1 == 5) || (TblList[iIndex1].HojyoData.NCode == 0))
                                {
                                    RecList[0][iRecCnt] = TblList[iIndex1].RecData;
                                    RecList[1][iRecCnt] = TblList[iIndex1].RecData;
                                    iRecCnt ++;
                                }
                            }
                        }
                        RecList[0] = new TWRecData[iRecCnt];
                        RecList[1] = new TWRecData[iRecCnt];
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiKoji:
                    // 工事
                    switch(DspParam.KojiDsp)
                    {
                        case VKZ310Cmnu.TWKojiDsp.wkdAll:
                            // 全件表示
                            RecList[0] = new TWRecData[TblList.Length];
                            RecList[1] = new TWRecData[TblList.Length];
                            for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                            {
                                RecList[0][iIndex1] = TblList[iIndex1].RecData;
                                RecList[1][iIndex1] = TblList[iIndex1].RecData;
                                // 原価科目は不可 or 入力不可 or 完成年月登録済み
                                if ((TblList[iIndex1].HojyoData.BunCode == 1) || (TblList[iIndex1].HojyoData.BunCode == 9) || (TblList[iIndex1].HojyoData.FinishDate != 0))
                                {
                                    //@ Unsupported property or method(D): 'Color'
                                    RecList[0][iIndex1].Color = System.Drawing.Color.Blue;
                                    //@ Unsupported property or method(D): 'Color'
                                    RecList[1][iIndex1].Color = System.Drawing.Color.Blue;
                                }
                            }
                            break;
                        case VKZ310Cmnu.TWKojiDsp.wkdBun:
                            // 入力可のみ
                            RecList[0] = new TWRecData[TblList.Length];
                            RecList[1] = new TWRecData[TblList.Length];
                            for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                            {
                                // 入力可
                                if (TblList[iIndex1].HojyoData.BunCode == 0)
                                {
                                    RecList[0][iRecCnt] = TblList[iIndex1].RecData;
                                    RecList[1][iRecCnt] = TblList[iIndex1].RecData;
                                    // 完成年月登録済み
                                    if (TblList[iIndex1].HojyoData.FinishDate != 0)
                                    {
                                        //@ Unsupported property or method(D): 'Color'
                                        RecList[0][iRecCnt].Color = System.Drawing.Color.Blue;
                                        //@ Unsupported property or method(D): 'Color'
                                        RecList[1][iRecCnt].Color = System.Drawing.Color.Blue;
                                    }
                                    iRecCnt ++;
                                }
                            }
                            RecList[0] = new TWRecData[iRecCnt];
                            RecList[1] = new TWRecData[iRecCnt];
                            break;
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiKosh:
                    // 工種
                    RecList[0] = new TWRecData[TblList.Length];
                    RecList[1] = new TWRecData[TblList.Length];
                    for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                    {
                        RecList[0][iIndex1] = TblList[iIndex1].RecData;
                        RecList[1][iIndex1] = TblList[iIndex1].RecData;
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiTeki:
                    // 固定摘要
                    if (DspParam.TekiDsp == VKZ310Cmnu.TWTekiDsp.wtdNone)
                    {
                        return;
                    }
                    // 非表示は終了 2001/05/07
                    SortData_TekiBusho(ref TblList, TblList);
                    // 部署絞り込み
                    RecList[0] = new TWRecData[TblList.Length];
                    for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                    {
                        RecList[0][iIndex1] = TblList[iIndex1].RecData;
                    }
                    switch(DspParam.TekiDsp)
                    {
                        case VKZ310Cmnu.TWTekiDsp.wtdKmk:
                        case VKZ310Cmnu.TWTekiDsp.wtdZan:
                            // 科目連想表示、摘要残優先表示
                            SortData_TekiSort(ref TblList, TblList, DspParam.TekiDsp);
                            break;
                        case VKZ310Cmnu.TWTekiDsp.wtdSwDic:
                            // データを整列 固定摘要(科目連想、摘要残優先)
                            // 仕訳辞書摘要のみ表示
                            SortData_GetSwDicTeki(ref TblList, TblList);
                            break;
                    // 仕訳辞書摘要取得
                    }
                    RecList[1] = new TWRecData[TblList.Length];
                    for (iIndex1 = 0; iIndex1 <= TblList.GetUpperBound(0); iIndex1 ++ )
                    {
                        RecList[1][iIndex1] = TblList[iIndex1].RecData;
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiTax:
                    // 消費税
                    WndPattern = GetWndPattern(DspParam, DspParamEtc);
                    RecList[1] = GetRecListTax(WndPattern.TaxWnd);
                    // 簡易詳細区分あり and 簡易表示
                    if (WndPattern.KanShoKbn && DspParam.DspParamTax.KanKbn)
                    {
                        RecList[0] = GetRecListTax(WndPattern.TaxWnd + 1);
                    }
                    else
                    {
                        RecList[0] = GetRecListTax(WndPattern.TaxWnd);
                    }
                    break;
            }
        }

        // **************************************************************************
        // Proccess  :	文字列を コード、名称 に分割する
        // Parameter : sTax		String			「コード|名称」 形式の文字列
        // Return    : TWRecData
        // **************************************************************************
        public TWRecData GetRecListTax_GetTax(string sTax)
        {
            TWRecData result;
            result.Code = GetShortHint(sTax);
            result.Name = GetLongHint(sTax);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	result(TWRecList) の領域確保
        // Parameter : iPage		Integer			ページ数
        // Return    : None
        // ******************************************************************************
        public void GetRecListTax_SetWRecList(int iPage)
        {
            int idx;
            result = null;
            result = new TWRecData[5 * 4 * iPage];
            // ５行×４列×ページ数
            for (idx = result.GetLowerBound(0); idx <= result.GetUpperBound(0); idx ++ )
            {
                result[idx].Code = "";
                result[idx].Name = "";
                result[idx].Ren = "";
                result[idx].Color = System.Drawing.Color.Black;
            }
        }

        // 適用終了年月日
        // ******************************************************************************
        // Proccess  :	消費税レコード取得
        // Parameter : TaxWnd			TWTaxWnd
        // Return    : TWRecList
        // History	  :	<HIS-078>
        // ******************************************************************************
        private TWRecData[] GetRecListTax(TWTaxWnd TaxWnd)
        {
            TWRecData[] result;
            const string TaxNm10 = "10|課税取引(内税)";
            const string TaxNm20 = "20|課税取引(外税)";
            const string TaxNm30 = "30|非課税取引";
            const string TaxNm40 = "40|不課税取引(精算取引)";
            const string TaxNm99 = "99|消費税不明取引";
            const string TaxNm10_U = "10|課税売上(内税)";
            const string TaxNm12_U = "12|課税売上控除(内税)";
            const string TaxNm13_U = "13|課税貸倒償却(内税)";
            const string TaxNm15_U = "15|課税貸倒回収(内税)";
            const string TaxNm20_U = "20|課税売上(外税)";
            const string TaxNm22_U = "22|課税売上控除(外税)";
            const string TaxNm23_U = "23|課税貸倒償却(外税)";
            const string TaxNm25_U = "25|課税貸倒回収(外税)";
            const string TaxNm30_U = "30|非課税売上";
            const string TaxNm34_U = "34|有価証券売上等(非課税)";
            // <HIS-084>
            const string TaxNm40_U = "40|不課税売上(精算取引)";
            const string TaxNm60_U = "60|輸出売上";
            const string TaxNm64_U = "64|非課税輸出売上";
            const string TaxNm80_U = "80|課税仕入対応特定収入";
            const string TaxNm81_U = "81|共通仕入対応特定収入";
            const string TaxNm84_U = "84|非課税仕入対応特定収入";
            const string TaxNm89_U = "89|使途不特定の特定収入";
            const string TaxNm10_S = "10|課税仕入(内税)";
            const string TaxNm11_S = "11|共通仕入(内税)";
            const string TaxNm12_S = "12|課税仕入控除(内税)";
            const string TaxNm14_S = "14|非課税売上対応仕入(内税)";
            const string TaxNm15_S = "15|共通仕入控除(内税)";
            const string TaxNm16_S = "16|非課税売上対応仕入控除(内税)";
            const string TaxNm20_S = "20|課税仕入(外税)";
            const string TaxNm21_S = "21|共通仕入(外税)";
            const string TaxNm22_S = "22|課税仕入控除(外税)";
            const string TaxNm24_S = "24|非課税売上対応仕入(外税)";
            const string TaxNm25_S = "25|共通仕入控除(外税)";
            const string TaxNm26_S = "26|非課税売上対応仕入控除(外税)";
            const string TaxNm30_S = "30|非課税仕入";
            const string TaxNm40_S = "40|不課税仕入(精算取引)";
            const string TaxNm50_S = "50|棚卸調整消費税(課税)";
            const string TaxNm51_S = "51|棚卸調整消費税(共通)";
            const string TaxNm54_S = "54|棚卸調整消費税(非課税)";
            const string TaxNm60_S = "60|輸入仕入(外税)";
            const string TaxNm61_S = "61|輸入共通仕入(外税)";
            const string TaxNm64_S = "64|非課税売上対応輸入(外税)";
            const string TaxNm65_S = "65|輸入仕入(地方消費税)";
            const string TaxNm66_S = "66|輸入共通仕入(地方消費税)";
            const string TaxNm69_S = "69|非課税売上対応輸入(地方)";
            const string TaxNm70_S = "70|輸入仕入(内税)";
            const string TaxNm71_S = "71|輸入共通仕入(内税)";
            const string TaxNm74_S = "74|非課税売上対応輸入(内税)";
            result = null;
            switch(TaxWnd)
            {
                case VKZ310Cmnu.TWTaxWnd.wtwUri1:
                    // 売上１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_U);
                    result[1] = GetRecListTax_GetTax(TaxNm20_U);
                    result[2] = GetRecListTax_GetTax(TaxNm30_U);
                    result[3] = GetRecListTax_GetTax(TaxNm40_U);
                    result[4] = GetRecListTax_GetTax(TaxNm60_U);
                    result[5] = GetRecListTax_GetTax(TaxNm15_U);
                    result[6] = GetRecListTax_GetTax(TaxNm25_U);
                    result[7] = GetRecListTax_GetTax(TaxNm34_U);
                    result[9] = GetRecListTax_GetTax(TaxNm64_U);
                    result[10] = GetRecListTax_GetTax(TaxNm12_U);
                    result[11] = GetRecListTax_GetTax(TaxNm22_U);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwUri2:
                    // 売上２
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_U);
                    result[1] = GetRecListTax_GetTax(TaxNm20_U);
                    result[2] = GetRecListTax_GetTax(TaxNm30_U);
                    result[3] = GetRecListTax_GetTax(TaxNm40_U);
                    result[4] = GetRecListTax_GetTax(TaxNm60_U);
                    result[5] = GetRecListTax_GetTax(TaxNm15_U);
                    result[6] = GetRecListTax_GetTax(TaxNm25_U);
                    result[7] = GetRecListTax_GetTax(TaxNm34_U);
                    result[9] = GetRecListTax_GetTax(TaxNm64_U);
                    result[10] = GetRecListTax_GetTax(TaxNm12_U);
                    result[11] = GetRecListTax_GetTax(TaxNm22_U);
                    result[12] = GetRecListTax_GetTax(TaxNm80_U);
                    result[13] = GetRecListTax_GetTax(TaxNm81_U);
                    result[17] = GetRecListTax_GetTax(TaxNm84_U);
                    result[18] = GetRecListTax_GetTax(TaxNm89_U);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwUri3:
                    // 売上３
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10);
                    result[1] = GetRecListTax_GetTax(TaxNm20);
                    result[2] = GetRecListTax_GetTax(TaxNm30);
                    result[3] = GetRecListTax_GetTax(TaxNm40);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKruke1:
                    // 仮受１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_U);
                    result[1] = GetRecListTax_GetTax(TaxNm40_U);
                    result[5] = GetRecListTax_GetTax(TaxNm23_U);
                    result[6] = GetRecListTax_GetTax(TaxNm25_U);
                    result[10] = GetRecListTax_GetTax(TaxNm22_U);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKruke2:
                    // 仮受２
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_U);
                    result[1] = GetRecListTax_GetTax(TaxNm40_U);
                    result[6] = GetRecListTax_GetTax(TaxNm25_U);
                    result[10] = GetRecListTax_GetTax(TaxNm22_U);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKruke3:
                    // 仮受３
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_U);
                    result[1] = GetRecListTax_GetTax(TaxNm40_U);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKsdor1:
                    // 貸倒
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm13_U);
                    result[1] = GetRecListTax_GetTax(TaxNm23_U);
                    result[2] = GetRecListTax_GetTax(TaxNm40_U);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwJknUri1:
                    // 表示条件１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_U);
                    result[1] = GetRecListTax_GetTax(TaxNm20_U);
                    result[2] = GetRecListTax_GetTax(TaxNm30_U);
                    result[3] = GetRecListTax_GetTax(TaxNm40_U);
                    result[4] = GetRecListTax_GetTax(TaxNm60_U);
                    result[5] = GetRecListTax_GetTax(TaxNm15_U);
                    result[6] = GetRecListTax_GetTax(TaxNm25_U);
                    result[7] = GetRecListTax_GetTax(TaxNm34_U);
                    result[9] = GetRecListTax_GetTax(TaxNm64_U);
                    result[10] = GetRecListTax_GetTax(TaxNm12_U);
                    result[11] = GetRecListTax_GetTax(TaxNm22_U);
                    result[15] = GetRecListTax_GetTax(TaxNm13_U);
                    result[16] = GetRecListTax_GetTax(TaxNm23_U);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwJknUri2:
                    // 表示条件２
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_U);
                    result[1] = GetRecListTax_GetTax(TaxNm20_U);
                    result[2] = GetRecListTax_GetTax(TaxNm30_U);
                    result[3] = GetRecListTax_GetTax(TaxNm40_U);
                    result[4] = GetRecListTax_GetTax(TaxNm60_U);
                    result[5] = GetRecListTax_GetTax(TaxNm15_U);
                    result[6] = GetRecListTax_GetTax(TaxNm25_U);
                    result[7] = GetRecListTax_GetTax(TaxNm34_U);
                    result[9] = GetRecListTax_GetTax(TaxNm64_U);
                    result[10] = GetRecListTax_GetTax(TaxNm12_U);
                    result[11] = GetRecListTax_GetTax(TaxNm22_U);
                    result[15] = GetRecListTax_GetTax(TaxNm13_U);
                    result[16] = GetRecListTax_GetTax(TaxNm23_U);
                    result[12] = GetRecListTax_GetTax(TaxNm80_U);
                    result[13] = GetRecListTax_GetTax(TaxNm81_U);
                    result[17] = GetRecListTax_GetTax(TaxNm84_U);
                    result[18] = GetRecListTax_GetTax(TaxNm89_U);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir1:
                    // 仕入１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir2:
                    // 仕入２
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[10] = GetRecListTax_GetTax(TaxNm11_S);
                    result[11] = GetRecListTax_GetTax(TaxNm15_S);
                    result[12] = GetRecListTax_GetTax(TaxNm21_S);
                    result[13] = GetRecListTax_GetTax(TaxNm25_S);
                    result[15] = GetRecListTax_GetTax(TaxNm14_S);
                    result[16] = GetRecListTax_GetTax(TaxNm16_S);
                    result[17] = GetRecListTax_GetTax(TaxNm24_S);
                    result[18] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir3:
                    // 仕入３
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm60_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir4:
                    // 仕入４
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm60_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[9] = GetRecListTax_GetTax(TaxNm61_S);
                    result[10] = GetRecListTax_GetTax(TaxNm11_S);
                    result[11] = GetRecListTax_GetTax(TaxNm15_S);
                    result[12] = GetRecListTax_GetTax(TaxNm21_S);
                    result[13] = GetRecListTax_GetTax(TaxNm25_S);
                    result[14] = GetRecListTax_GetTax(TaxNm64_S);
                    result[15] = GetRecListTax_GetTax(TaxNm14_S);
                    result[16] = GetRecListTax_GetTax(TaxNm16_S);
                    result[17] = GetRecListTax_GetTax(TaxNm24_S);
                    result[18] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir5:
                    // 仕入５
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm70_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir6:
                    // 仕入６
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm70_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[9] = GetRecListTax_GetTax(TaxNm71_S);
                    result[10] = GetRecListTax_GetTax(TaxNm11_S);
                    result[11] = GetRecListTax_GetTax(TaxNm15_S);
                    result[12] = GetRecListTax_GetTax(TaxNm21_S);
                    result[13] = GetRecListTax_GetTax(TaxNm25_S);
                    result[14] = GetRecListTax_GetTax(TaxNm74_S);
                    result[15] = GetRecListTax_GetTax(TaxNm14_S);
                    result[16] = GetRecListTax_GetTax(TaxNm16_S);
                    result[17] = GetRecListTax_GetTax(TaxNm24_S);
                    result[18] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir7:
                    // 仕入７
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm11_S);
                    result[1] = GetRecListTax_GetTax(TaxNm21_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm15_S);
                    result[6] = GetRecListTax_GetTax(TaxNm25_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir8:
                    // 仕入８
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm11_S);
                    result[1] = GetRecListTax_GetTax(TaxNm21_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm61_S);
                    result[5] = GetRecListTax_GetTax(TaxNm15_S);
                    result[6] = GetRecListTax_GetTax(TaxNm25_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir9:
                    // 仕入９
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm11_S);
                    result[1] = GetRecListTax_GetTax(TaxNm21_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm71_S);
                    result[5] = GetRecListTax_GetTax(TaxNm15_S);
                    result[6] = GetRecListTax_GetTax(TaxNm25_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir10:
                    // 仕入１０
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir11:
                    // 仕入１１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm14_S);
                    result[1] = GetRecListTax_GetTax(TaxNm24_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm16_S);
                    result[6] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir12:
                    // 仕入１２
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm14_S);
                    result[1] = GetRecListTax_GetTax(TaxNm24_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm64_S);
                    result[5] = GetRecListTax_GetTax(TaxNm16_S);
                    result[6] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir13:
                    // 仕入１３
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm14_S);
                    result[1] = GetRecListTax_GetTax(TaxNm24_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm74_S);
                    result[5] = GetRecListTax_GetTax(TaxNm16_S);
                    result[6] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwSir14:
                    // 仕入１４
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm30_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri1:
                    // 仮払１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[3] = GetRecListTax_GetTax(TaxNm50_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri2:
                    // 仮払２
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[3] = GetRecListTax_GetTax(TaxNm50_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[8] = GetRecListTax_GetTax(TaxNm51_S);
                    result[10] = GetRecListTax_GetTax(TaxNm21_S);
                    result[11] = GetRecListTax_GetTax(TaxNm25_S);
                    result[13] = GetRecListTax_GetTax(TaxNm54_S);
                    result[15] = GetRecListTax_GetTax(TaxNm24_S);
                    result[16] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri3:
                    // 仮払３
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm60_S);
                    result[3] = GetRecListTax_GetTax(TaxNm50_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri4:
                    // 仮払４
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm60_S);
                    result[3] = GetRecListTax_GetTax(TaxNm50_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[7] = GetRecListTax_GetTax(TaxNm61_S);
                    result[8] = GetRecListTax_GetTax(TaxNm51_S);
                    result[10] = GetRecListTax_GetTax(TaxNm21_S);
                    result[11] = GetRecListTax_GetTax(TaxNm25_S);
                    result[12] = GetRecListTax_GetTax(TaxNm64_S);
                    result[13] = GetRecListTax_GetTax(TaxNm54_S);
                    result[15] = GetRecListTax_GetTax(TaxNm24_S);
                    result[16] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri5:
                    // 仮払５
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm60_S);
                    result[3] = GetRecListTax_GetTax(TaxNm50_S);
                    result[4] = GetRecListTax_GetTax(TaxNm65_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri6:
                    // 仮払６
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm60_S);
                    result[3] = GetRecListTax_GetTax(TaxNm50_S);
                    result[4] = GetRecListTax_GetTax(TaxNm65_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[7] = GetRecListTax_GetTax(TaxNm61_S);
                    result[8] = GetRecListTax_GetTax(TaxNm51_S);
                    result[9] = GetRecListTax_GetTax(TaxNm66_S);
                    result[10] = GetRecListTax_GetTax(TaxNm21_S);
                    result[11] = GetRecListTax_GetTax(TaxNm25_S);
                    result[12] = GetRecListTax_GetTax(TaxNm64_S);
                    result[13] = GetRecListTax_GetTax(TaxNm54_S);
                    result[14] = GetRecListTax_GetTax(TaxNm69_S);
                    result[15] = GetRecListTax_GetTax(TaxNm24_S);
                    result[16] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri7:
                    // 仮払７
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[10] = GetRecListTax_GetTax(TaxNm21_S);
                    result[11] = GetRecListTax_GetTax(TaxNm25_S);
                    result[15] = GetRecListTax_GetTax(TaxNm24_S);
                    result[16] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri8:
                    // 仮払８
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm60_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[7] = GetRecListTax_GetTax(TaxNm61_S);
                    result[10] = GetRecListTax_GetTax(TaxNm21_S);
                    result[11] = GetRecListTax_GetTax(TaxNm25_S);
                    result[12] = GetRecListTax_GetTax(TaxNm64_S);
                    result[15] = GetRecListTax_GetTax(TaxNm24_S);
                    result[16] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri9:
                    // 仮払９
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm60_S);
                    result[5] = GetRecListTax_GetTax(TaxNm22_S);
                    result[7] = GetRecListTax_GetTax(TaxNm61_S);
                    result[10] = GetRecListTax_GetTax(TaxNm21_S);
                    result[11] = GetRecListTax_GetTax(TaxNm25_S);
                    result[12] = GetRecListTax_GetTax(TaxNm64_S);
                    result[15] = GetRecListTax_GetTax(TaxNm24_S);
                    result[16] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri10:
                    // 仮払１０
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm20_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri11:
                    // 仮払１１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm21_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[3] = GetRecListTax_GetTax(TaxNm51_S);
                    result[5] = GetRecListTax_GetTax(TaxNm25_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri12:
                    // 仮払１２
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm21_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm61_S);
                    result[3] = GetRecListTax_GetTax(TaxNm51_S);
                    result[5] = GetRecListTax_GetTax(TaxNm25_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri13:
                    // 仮払１３
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm21_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm61_S);
                    result[3] = GetRecListTax_GetTax(TaxNm51_S);
                    result[4] = GetRecListTax_GetTax(TaxNm66_S);
                    result[5] = GetRecListTax_GetTax(TaxNm25_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri14:
                    // 仮払１４
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm21_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm25_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri15:
                    // 仮払１５
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm21_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm61_S);
                    result[5] = GetRecListTax_GetTax(TaxNm25_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri16:
                    // 仮払１６
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm24_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[3] = GetRecListTax_GetTax(TaxNm54_S);
                    result[5] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri17:
                    // 仮払１７
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm24_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm64_S);
                    result[3] = GetRecListTax_GetTax(TaxNm54_S);
                    result[5] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri18:
                    // 仮払１８
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm24_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm64_S);
                    result[3] = GetRecListTax_GetTax(TaxNm54_S);
                    result[4] = GetRecListTax_GetTax(TaxNm69_S);
                    result[5] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri19:
                    // 仮払１９
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm24_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri20:
                    // 仮払２０
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm24_S);
                    result[1] = GetRecListTax_GetTax(TaxNm40_S);
                    result[2] = GetRecListTax_GetTax(TaxNm64_S);
                    result[5] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwKrbri21:
                    // 仮払２１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm40_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwJknSir1:
                    // 表示条件１
                    GetRecListTax_SetWRecList(1);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[4] = GetRecListTax_GetTax(TaxNm50_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[9] = GetRecListTax_GetTax(TaxNm51_S);
                    result[10] = GetRecListTax_GetTax(TaxNm11_S);
                    result[11] = GetRecListTax_GetTax(TaxNm15_S);
                    result[12] = GetRecListTax_GetTax(TaxNm21_S);
                    result[13] = GetRecListTax_GetTax(TaxNm25_S);
                    result[14] = GetRecListTax_GetTax(TaxNm54_S);
                    result[15] = GetRecListTax_GetTax(TaxNm14_S);
                    result[16] = GetRecListTax_GetTax(TaxNm16_S);
                    result[17] = GetRecListTax_GetTax(TaxNm24_S);
                    result[18] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwJknSir2:
                    // 表示条件２
                    GetRecListTax_SetWRecList(2);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[10] = GetRecListTax_GetTax(TaxNm11_S);
                    result[11] = GetRecListTax_GetTax(TaxNm15_S);
                    result[12] = GetRecListTax_GetTax(TaxNm21_S);
                    result[13] = GetRecListTax_GetTax(TaxNm25_S);
                    result[15] = GetRecListTax_GetTax(TaxNm14_S);
                    result[16] = GetRecListTax_GetTax(TaxNm16_S);
                    result[17] = GetRecListTax_GetTax(TaxNm24_S);
                    result[18] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    result[20] = GetRecListTax_GetTax(TaxNm60_S);
                    result[21] = GetRecListTax_GetTax(TaxNm50_S);
                    result[22] = GetRecListTax_GetTax(TaxNm65_S);
                    result[30] = GetRecListTax_GetTax(TaxNm61_S);
                    result[31] = GetRecListTax_GetTax(TaxNm51_S);
                    result[32] = GetRecListTax_GetTax(TaxNm66_S);
                    result[35] = GetRecListTax_GetTax(TaxNm64_S);
                    result[36] = GetRecListTax_GetTax(TaxNm54_S);
                    result[37] = GetRecListTax_GetTax(TaxNm69_S);
                    break;
                case VKZ310Cmnu.TWTaxWnd.wtwJknSir3:
                    // 表示条件３
                    GetRecListTax_SetWRecList(2);
                    result[0] = GetRecListTax_GetTax(TaxNm10_S);
                    result[1] = GetRecListTax_GetTax(TaxNm20_S);
                    result[2] = GetRecListTax_GetTax(TaxNm30_S);
                    result[3] = GetRecListTax_GetTax(TaxNm40_S);
                    result[5] = GetRecListTax_GetTax(TaxNm12_S);
                    result[6] = GetRecListTax_GetTax(TaxNm22_S);
                    result[10] = GetRecListTax_GetTax(TaxNm11_S);
                    result[11] = GetRecListTax_GetTax(TaxNm15_S);
                    result[12] = GetRecListTax_GetTax(TaxNm21_S);
                    result[13] = GetRecListTax_GetTax(TaxNm25_S);
                    result[15] = GetRecListTax_GetTax(TaxNm14_S);
                    result[16] = GetRecListTax_GetTax(TaxNm16_S);
                    result[17] = GetRecListTax_GetTax(TaxNm24_S);
                    result[18] = GetRecListTax_GetTax(TaxNm26_S);
                    result[19] = GetRecListTax_GetTax(TaxNm99);
                    result[20] = GetRecListTax_GetTax(TaxNm50_S);
                    result[21] = GetRecListTax_GetTax(TaxNm70_S);
                    result[30] = GetRecListTax_GetTax(TaxNm51_S);
                    result[31] = GetRecListTax_GetTax(TaxNm71_S);
                    result[35] = GetRecListTax_GetTax(TaxNm54_S);
                    result[36] = GetRecListTax_GetTax(TaxNm74_S);
                    break;
            }
            return result;
        }

    } // end TMAS310SelWnd

    // ｳｨﾝﾄﾞｳ表示区分
    public class TMAS310SelWndDB: TMAS310SelWnd
    {
        // Private 宣言
        protected TMDataModulef m_cMDModule = null;
        // (*H0044 20041213 khattori	ＦｏｎｔＲｅｓｉｚｅ*)
        // m_pRec: ^TMjsAppRecord;
        protected TMASCom m_cSysCom = null;
        protected object dbCop = null;
        protected object mqCop = null;
        protected int[] DspKbn;
        // ｳｨﾝﾄﾞｳ表示区分
        protected TWDspParamEtc DspParamEtc = null;
        // 表示ﾊﾟﾗﾒｰﾀ
        protected object MasterInfo;
        // ﾏｽﾀ基本情報
        protected bool[] ReadFlg;
        // True:ﾃﾞｰﾀ読込済
        protected TWTableID[] TableSet;
        // ｽﾚｯﾄﾞﾃｰﾌﾞﾙ
        protected TWTblData[] TblList;
        // ﾃﾞｰﾀ
        protected TMAS310SelWndThreads[] Threads;
        // Public 宣言
        // //******************************************************************************
        // //		Proccess	: 消費税レコード取得
        // //		Name		: Y.Sato
        // //		Date		: 2001/02/08
        // //		Parameter	: TaxWnd
        // //		Return		: TWRecList
        // //		History		: 2001/04/26	Y.Sato		・消費税の仮払９を変更
        // //******************************************************************************
        // function TMAS310SelWnd.GetRecListTax(TaxWnd: TWTaxWnd): TWRecList;
        // var
        // Index	: Integer;
        // function GetTax(sTax:String): TWRecData;
        // begin
        // Result.Code	:= Copy(sTax,1,2);Result.Name	:= Copy(sTax,4,length(sTax)-3);
        // end;
        // begin
        // SetLength(Result, 20);
        // for Index := 0 to 19 do
        // begin
        // Result[Index].Code	:= '';
        // Result[Index].Name	:= '';
        // Result[Index].Ren	:= '';
        // Result[Index].Color	:= clBlack;
        // end;
        // case TaxWnd of
        // // 売上１
        // wtwUri1:
        // begin
        // Result[0]	:= GetTax('10-課税売上(内税)');
        // Result[1]	:= GetTax('20-課税売上(外税)');
        // Result[2]	:= GetTax('30-非課税売上');
        // Result[3]	:= GetTax('40-不課税売上(精算取引)');
        // Result[4]	:= GetTax('60-輸出売上');
        // Result[5]	:= GetTax('15-課税貸倒回収(内税)');
        // Result[6]	:= GetTax('25-課税貸倒回収(外税)');
        // Result[7]	:= GetTax('34-有価証券売上(非課税)');
        // Result[9]	:= GetTax('64-非課税輸出売上');
        // Result[10]	:= GetTax('12-課税売上控除(内税)');
        // Result[11]	:= GetTax('22-課税売上控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 売上２
        // wtwUri2:
        // begin
        // Result[0]	:= GetTax('10-課税売上(内税)');
        // Result[1]	:= GetTax('20-課税売上(外税)');
        // Result[2]	:= GetTax('30-非課税売上');
        // Result[3]	:= GetTax('40-不課税売上(精算取引)');
        // Result[4]	:= GetTax('60-輸出売上');
        // Result[5]	:= GetTax('15-課税貸倒回収(内税)');
        // Result[6]	:= GetTax('25-課税貸倒回収(外税)');
        // Result[7]	:= GetTax('34-有価証券売上(非課税)');
        // Result[9]	:= GetTax('64-非課税輸出売上');
        // Result[10]	:= GetTax('12-課税売上控除(内税)');
        // Result[11]	:= GetTax('22-課税売上控除(外税)');
        // Result[12]	:= GetTax('80-課税仕入対応特定収入');
        // Result[13]	:= GetTax('81-共通仕入対応特定収入');
        // Result[17]	:= GetTax('84-非課税仕入対応特定収入');
        // Result[18]	:= GetTax('89-使途不特定の特定収入');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 売上３
        // wtwUri3:
        // begin
        // (*H0002 20010614 khattori syuusei 消費税文言変更*)
        // Result[0]	:= GetTax('10-課税取引(内税)');
        // Result[1]	:= GetTax('20-課税取引(外税)');
        // Result[2]	:= GetTax('30-非課税取引');
        // Result[3]	:= GetTax('40-不課税取引(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // //			Result[0]	:= GetTax('10-課税売上(内税)');
        // //			Result[1]	:= GetTax('20-課税売上(外税)');
        // //			Result[2]	:= GetTax('30-非課税売上');
        // //			Result[3]	:= GetTax('40-不課税売上(精算取引)');
        // //			Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮受１
        // wtwKruke1:
        // begin
        // Result[0]	:= GetTax('20-課税売上(外税)');
        // Result[1]	:= GetTax('40-不課税売上(精算取引)');
        // Result[5]	:= GetTax('23-課税貸倒償却(外税)');
        // Result[6]	:= GetTax('25-課税貸倒回収(外税)');
        // Result[10]	:= GetTax('22-課税売上控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮受２
        // wtwKruke2:
        // begin
        // Result[0]	:= GetTax('20-課税売上(外税)');
        // Result[1]	:= GetTax('40-不課税売上(精算取引)');
        // Result[6]	:= GetTax('25-課税貸倒回収(外税)');
        // Result[10]	:= GetTax('22-課税売上控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮受３
        // wtwKruke3:
        // begin
        // Result[0]	:= GetTax('20-課税売上(外税)');
        // Result[1]	:= GetTax('40-不課税売上(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 貸倒
        // wtwKsdor1:
        // begin
        // Result[0]	:= GetTax('13-課税貸倒償却(内税)');
        // Result[1]	:= GetTax('23-課税貸倒償却(外税)');
        // Result[2]	:= GetTax('40-不課税売上(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 表示条件１
        // wtwJknUri1:
        // begin
        // Result[0]	:= GetTax('10-課税売上(内税)');
        // Result[1]	:= GetTax('20-課税売上(外税)');
        // Result[2]	:= GetTax('30-非課税売上');
        // Result[3]	:= GetTax('40-不課税売上(精算取引)');
        // Result[4]	:= GetTax('60-輸出売上');
        // Result[5]	:= GetTax('15-課税貸倒回収(内税)');
        // Result[6]	:= GetTax('25-課税貸倒回収(外税)');
        // Result[7]	:= GetTax('34-有価証券売上(非課税)');
        // Result[9]	:= GetTax('64-非課税輸出売上');
        // Result[10]	:= GetTax('12-課税売上控除(内税)');
        // Result[11]	:= GetTax('22-課税売上控除(外税)');
        // Result[15]	:= GetTax('13-課税貸倒償却(内税)');
        // Result[16]	:= GetTax('23-課税貸倒償却(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 表示条件２
        // wtwJknUri2:
        // begin
        // Result[0]	:= GetTax('10-課税売上(内税)');
        // Result[1]	:= GetTax('20-課税売上(外税)');
        // Result[2]	:= GetTax('30-非課税売上');
        // Result[3]	:= GetTax('40-不課税売上(精算取引)');
        // Result[4]	:= GetTax('60-輸出売上');
        // Result[5]	:= GetTax('15-課税貸倒回収(内税)');
        // Result[6]	:= GetTax('25-課税貸倒回収(外税)');
        // Result[7]	:= GetTax('34-有価証券売上(非課税)');
        // Result[9]	:= GetTax('64-非課税輸出売上');
        // Result[10]	:= GetTax('12-課税売上控除(内税)');
        // Result[11]	:= GetTax('22-課税売上控除(外税)');
        // Result[15]	:= GetTax('13-課税貸倒償却(内税)');
        // Result[16]	:= GetTax('23-課税貸倒償却(外税)');
        // Result[12]	:= GetTax('80-課税仕入対応特定収入');
        // Result[13]	:= GetTax('81-共通仕入対応特定収入');
        // Result[17]	:= GetTax('84-非課税仕入対応特定収入');
        // Result[18]	:= GetTax('89-使途不特定の特定収入');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入１
        // wtwSir1:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[15]	:= GetTax('12-課税仕入控除(内税)');
        // Result[16]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入２
        // wtwSir2:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[5]	:= GetTax('11-共通仕入(内税)');
        // Result[6]	:= GetTax('21-共通仕入(外税)');
        // Result[10]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[11]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[15]	:= GetTax('12-課税仕入控除(内税)');
        // Result[16]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入３
        // wtwSir3:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('60-輸入仕入(外税)');
        // Result[15]	:= GetTax('12-課税仕入控除(内税)');
        // Result[16]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入４
        // wtwSir4:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('60-輸入仕入(外税)');
        // Result[5]	:= GetTax('11-共通仕入(内税)');
        // Result[6]	:= GetTax('21-共通仕入(外税)');
        // Result[9]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[10]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[11]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[14]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[15]	:= GetTax('12-課税仕入控除(内税)');
        // Result[16]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入５
        // wtwSir5:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('70-輸入仕入(内税)');
        // Result[15]	:= GetTax('12-課税仕入控除(内税)');
        // Result[16]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入６
        // wtwSir6:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('70-輸入仕入(内税)');
        // Result[5]	:= GetTax('11-共通仕入(内税)');
        // Result[6]	:= GetTax('21-共通仕入(外税)');
        // Result[9]	:= GetTax('71-輸入共通仕入(内税)');
        // Result[10]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[11]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[14]	:= GetTax('74-非課税売上対応輸入(内税)');
        // Result[15]	:= GetTax('12-課税仕入控除(内税)');
        // Result[16]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入７
        // wtwSir7:
        // begin
        // Result[0]	:= GetTax('11-共通仕入(内税)');
        // Result[1]	:= GetTax('21-共通仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入８
        // wtwSir8:
        // begin
        // Result[0]	:= GetTax('11-共通仕入(内税)');
        // Result[1]	:= GetTax('21-共通仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入９
        // wtwSir9:
        // begin
        // Result[0]	:= GetTax('11-共通仕入(内税)');
        // Result[1]	:= GetTax('21-共通仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('71-輸入共通仕入(内税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入１０
        // wtwSir10:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // //---<HIS-075>------------------------------------------------------------------
        // // 仕入１１
        // wtwSir11:
        // begin
        // Result[0]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[1]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入１２
        // wtwSir12:
        // begin
        // Result[0]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[1]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入１３
        // wtwSir13:
        // begin
        // Result[0]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[1]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('74-非課税売上対応輸入(内税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仕入１４
        // wtwSir14:
        // begin
        // Result[0]	:= GetTax('30-非課税仕入');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // //------------------------------------------------------------------<HIS-075>---
        // // 仮払１
        // wtwKrbri1:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[3]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払２
        // wtwKrbri2:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[3]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[5]	:= GetTax('21-共通仕入(外税)');
        // Result[8]	:= GetTax('51-棚卸調整消費税(共通)');
        // Result[10]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[13]	:= GetTax('54-棚卸調整消費税(非課税)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払３
        // wtwKrbri3:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('60-輸入仕入(外税)');
        // Result[3]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払４
        // wtwKrbri4:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('60-輸入仕入(外税)');
        // Result[3]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[5]	:= GetTax('21-共通仕入(外税)');
        // Result[7]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[8]	:= GetTax('51-棚卸調整消費税(共通)');
        // Result[10]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[13]	:= GetTax('54-棚卸調整消費税(非課税)');
        // Result[12]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払５
        // wtwKrbri5:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('60-輸入仕入(外税)');
        // Result[3]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[4]	:= GetTax('65-輸入仕入(地方消費税)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払６
        // wtwKrbri6:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('60-輸入仕入(外税)');
        // Result[3]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[4]	:= GetTax('65-輸入仕入(地方消費税)');
        // Result[5]	:= GetTax('21-共通仕入(外税)');
        // Result[7]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[8]	:= GetTax('51-棚卸調整消費税(共通)');
        // Result[9]	:= GetTax('66-輸入共通仕入(地方消費税)');
        // Result[10]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[12]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[13]	:= GetTax('54-棚卸調整消費税(非課税)');
        // Result[14]	:= GetTax('69-非課税売上対応輸入(地方)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払７
        // wtwKrbri7:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[5]	:= GetTax('21-共通仕入(外税)');
        // Result[10]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払８
        // wtwKrbri8:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('60-輸入仕入(外税)');
        // Result[5]	:= GetTax('21-共通仕入(外税)');
        // Result[7]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[10]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[12]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払９
        // wtwKrbri9:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('60-輸入仕入(外税)');
        // Result[5]	:= GetTax('21-共通仕入(外税)');
        // Result[7]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[10]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[12]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[15]	:= GetTax('22-課税仕入控除(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１０
        // wtwKrbri10:
        // begin
        // Result[0]	:= GetTax('20-課税仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // //---<HIS-075>------------------------------------------------------------------
        // // 仮払１１
        // wtwKrbri11:
        // begin
        // Result[0]	:= GetTax('21-共通仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[3]	:= GetTax('51-棚卸調整消費税(共通)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１２
        // wtwKrbri12:
        // begin
        // Result[0]	:= GetTax('21-共通仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[3]	:= GetTax('51-棚卸調整消費税(共通)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１３
        // wtwKrbri13:
        // begin
        // Result[0]	:= GetTax('21-共通仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[3]	:= GetTax('51-棚卸調整消費税(共通)');
        // Result[4]	:= GetTax('66-輸入共通仕入(地方消費税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１４
        // wtwKrbri14:
        // begin
        // Result[0]	:= GetTax('21-共通仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１５
        // wtwKrbri15:
        // begin
        // Result[0]	:= GetTax('21-共通仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１６
        // wtwKrbri16:
        // begin
        // Result[0]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[3]	:= GetTax('54-棚卸調整消費税(非課税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１７
        // wtwKrbri17:
        // begin
        // Result[0]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[3]	:= GetTax('54-棚卸調整消費税(非課税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１８
        // wtwKrbri18:
        // begin
        // Result[0]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[3]	:= GetTax('54-棚卸調整消費税(非課税)');
        // Result[4]	:= GetTax('69-非課税売上対応輸入(地方)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払１９
        // wtwKrbri19:
        // begin
        // Result[0]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払２０
        // wtwKrbri20:
        // begin
        // Result[0]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[1]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[2]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 仮払２１
        // wtwKrbri21:
        // begin
        // Result[0]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // //------------------------------------------------------------------<HIS-075>---
        // // 表示条件１
        // wtwJknSir1:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[5]	:= GetTax('12-課税仕入控除(内税)');
        // Result[6]	:= GetTax('22-課税仕入控除(外税)');
        // Result[7]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[10]	:= GetTax('11-共通仕入(内税)');
        // Result[11]	:= GetTax('21-共通仕入(外税)');
        // //---<HIS-058>------------------------------------------------------------------
        // Result[12]	:= GetTax('51-棚卸調整消費税(共通)');
        // //------------------------------------------------------------------<HIS-058>---
        // Result[15]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[16]	:= GetTax('24-非課税売上対応仕入(外税)');
        // //---<HIS-058>------------------------------------------------------------------
        // Result[17]	:= GetTax('54-棚卸調整消費税(非課税)');
        // //------------------------------------------------------------------<HIS-058>---
        // Result[19]	:= GetTax('99-消費税不明取引');
        // end;
        // // 表示条件２
        // wtwJknSir2:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('99-消費税不明取引');
        // Result[5]	:= GetTax('12-課税仕入控除(内税)');
        // Result[6]	:= GetTax('22-課税仕入控除(外税)');
        // Result[7]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[8]	:= GetTax('60-輸入仕入(外税)');
        // Result[9]	:= GetTax('65-輸入仕入(地方消費税)');
        // Result[10]	:= GetTax('11-共通仕入(内税)');
        // Result[11]	:= GetTax('21-共通仕入(外税)');
        // Result[12]	:= GetTax('51-棚卸調整消費税(共通)');
        // Result[13]	:= GetTax('61-輸入共通仕入(外税)');
        // Result[14]	:= GetTax('66-輸入共通仕入(地方消費税)');
        // Result[15]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[16]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[17]	:= GetTax('54-棚卸調整消費税(非課税)');
        // Result[18]	:= GetTax('64-非課税売上対応輸入(外税)');
        // Result[19]	:= GetTax('69-非課税売上対応輸入(地方)');
        // end;
        // // 表示条件３
        // wtwJknSir3:
        // begin
        // Result[0]	:= GetTax('10-課税仕入(内税)');
        // Result[1]	:= GetTax('20-課税仕入(外税)');
        // Result[2]	:= GetTax('30-非課税仕入');
        // Result[3]	:= GetTax('40-不課税仕入(精算取引)');
        // Result[4]	:= GetTax('99-消費税不明取引');
        // Result[5]	:= GetTax('12-課税仕入控除(内税)');
        // Result[6]	:= GetTax('22-課税仕入控除(外税)');
        // Result[7]	:= GetTax('50-棚卸調整消費税(課税)');
        // Result[9]	:= GetTax('70-輸入仕入(内税)');
        // Result[10]	:= GetTax('11-共通仕入(内税)');
        // Result[11]	:= GetTax('21-共通仕入(外税)');
        // Result[12]	:= GetTax('51-棚卸調整消費税(共通)');
        // Result[14]	:= GetTax('71-輸入共通仕入(内税)');
        // Result[15]	:= GetTax('14-非課税売上対応仕入(内税)');
        // Result[16]	:= GetTax('24-非課税売上対応仕入(外税)');
        // Result[17]	:= GetTax('54-棚卸調整消費税(非課税)');
        // Result[19]	:= GetTax('74-非課税売上対応輸入(内税)');
        // end;
        // end;
        // end;
        // ******************************************************************************
        // TMAS310SelWndDB
        // ******************************************************************************
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2000/08/24
        // Parameter	: AOwner	TComponent
        // Return		: なし
        // History		: 2000/11/22	Y.Sato		･固定摘要表示列切り換え対応
        // ******************************************************************************
        //Constructor  Create( AOwner)
        public TMAS310SelWndDB(object AOwner) : base(AOwner)
        {
            int iIndex;
            TWKmkInfoID KmkInfoID;
            TWTableID TableID;
            dbCop = null;
            mqCop = new TMQuery(this);
            //@ Unsupported function: 'Low'
            //@ Unsupported function: 'High'
            for (TableID = Low(TableID); TableID <= High(TableID); TableID ++ )
            {
                DspKbn[TableID] = 0;
                // ｳｨﾝﾄﾞｳ表示区分
                // ﾏｽﾀ基本情報
                MasterInfo[TableID].CodeAttr = 0;
                // ｺｰﾄﾞ属性
                MasterInfo[TableID].CodeDigit = 6;
                // ｺｰﾄﾞ桁数
                MasterInfo[TableID].UseKbn = 0;
                // 採用区分
                ReadFlg[TableID] = false;
            // 読込済みﾌﾗｸﾞをOFF
            }
            DspParamEtc.ComKbn4 = 0;
            // 公益法人区分
            DspParamEtc.ImportKbn = 0;
            // 輸入取引区分
            //@ Unsupported function: 'Low'
            //@ Unsupported function: 'High'
            for (KmkInfoID = Low(KmkInfoID); KmkInfoID <= High(KmkInfoID); KmkInfoID ++ )
            {
                DspParamEtc.KmkCode[KmkInfoID] = 0;
            // 特定科目情報
            }
            for (iIndex = 1; iIndex <= Units.MAS310000u.MAS310SELWND_THREAD_COUNT; iIndex ++ )
            {
                switch(iIndex)
                {
                    case 1:
                        TableSet[iIndex] = Units.MAS310000u.MAS310SELWND_THREAD_TABLE1;
                        break;
                    case 2:
                        TableSet[iIndex] = Units.MAS310000u.MAS310SELWND_THREAD_TABLE2;
                        break;
                    case 3:
                        TableSet[iIndex] = Units.MAS310000u.MAS310SELWND_THREAD_TABLE3;
                        break;
                    case 4:
                        TableSet[iIndex] = Units.MAS310000u.MAS310SELWND_THREAD_TABLE4;
                        break;
                    case 5:
                        TableSet[iIndex] = Units.MAS310000u.MAS310SELWND_THREAD_TABLE5;
                        break;
                }
            }
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2000/08/24
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TMAS310SelWndDB()
        {
            if (dbCop != null)
            {
                Term();
            }
            //@ Unsupported property or method(C): 'Free'
            mqCop.Free;
            base.Destroy();
        }
        // 消費税ｳｨﾝﾄﾞｳ表示ﾊﾟﾀｰﾝを取得
        // ******************************************************************************
        // Proccess	: 初期処理
        // Name		: Y.Sato
        // Date		: 2000/08/24
        // Parameter	: pRec			Pointer
        // Return		: Boolean		True	: OK
        // :				False	: NG
        // History		: 2000/11/07	Y.Sato		・複数会社DB対応
        // : 2001/05/08	Y.Sato		・摘要残優先表示の変更
        // ******************************************************************************
        public bool Init(object pRec, int iSyoriKubun, int iCRMode)
        {
            bool result;
            // function TMAS310SelWndDB.Init(pRec: Pointer; iSyoriKubun:Integer): Boolean;
            int iIndex;
            result = false;
            this.m_pRec = pRec;
            //@ Unsupported property or method(D): 'm_pDBModule'
            //@ Undeclared identifier(3): 'TMDataModulef'
            m_cMDModule = TMDataModulef(this.m_pRec.m_pDBModule);
            //@ Unsupported property or method(D): 'm_pSystemArea'
            //@ Undeclared identifier(3): 'TMASCom'
            m_cSysCom = TMASCom(this.m_pRec.m_pSystemArea);
            this.FCRMode = iCRMode;
            //@ Unsupported property or method(D): 'm_iCorpID'
            //@ Unsupported property or method(A): 'COPDBOpen'
            dbCop = m_cMDModule.COPDBOpen(0, this.m_pRec.m_iCorpID);
            if (dbCop != null)
            {
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                m_cMDModule.SetDBInfoToQuery(dbCop, mqCop);
                GetDspParam(ref DspKbn, ref DspParamEtc, ref MasterInfo);
                for (iIndex = 1; iIndex <= Units.MAS310000u.MAS310SELWND_THREAD_COUNT; iIndex ++ )
                {
                    Threads[iIndex] = new TMAS310SelWndThreads(this.m_pRec, TableSet[iIndex], MasterInfo, iSyoriKubun);
                }
                result = true;
            }
            DspParamEtc.ZanRecord = new TWZanRecord[0];
            // 残高管理区分をクリア 2001/05/08

            return result;
        }

        public bool Init(object pRec, int iSyoriKubun)
        {
            return Init(pRec, iSyoriKubun, 0);
        }

        // ******************************************************************************
        // Proccess	: 残高管理区分セット
        // Name		: Y.Sato
        // Date		: 2001/05/08
        // Parameter	: KmkCode		科目コード
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Dsp_SetZanRecord(int KmkCode)
        {
            string sSql;
            int Index1;
            bool bExist;
            if (KmkCode > 0)
            {
                bExist = false;
                for (Index1 = 0; Index1 <= DspParamEtc.ZanRecord.GetUpperBound(0); Index1 ++ )
                {
                    if (DspParamEtc.ZanRecord[Index1].KmkCode == KmkCode)
                    {
                        bExist = true;
                        break;
                    }
                }
                if (!bExist)
                {
                    DspParamEtc.ZanRecord = new TWZanRecord[DspParamEtc.ZanRecord.Length + 1];
                    DspParamEtc.ZanRecord[DspParamEtc.ZanRecord.GetUpperBound(0)].KmkCode = KmkCode;
                    sSql = " NMonth = 0" + " AND MasterKbn = 0" + " AND BmnCode = \'\'" + " AND KmkCode = " + (KmkCode).ToString() + " AND HojyoKbn = 61" + " AND HojyoCode = \'\'" + " AND SumKbn = 1";
                    //@ Unsupported property or method(D): 'Close'
                    mqCop.Close;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    mqCop.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    mqCop.SQL.Add("SELECT COUNT(TekiCode) AS RecCnt FROM SumSM WHERE" + sSql);
                    //@ Unsupported property or method(D): 'Open'
                    mqCop.Open;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    DspParamEtc.ZanRecord[DspParamEtc.ZanRecord.GetUpperBound(0)].TekiCode = new int[mqCop.GetFld("RecCnt").AsInteger];
                    //@ Unsupported property or method(D): 'Close'
                    mqCop.Close;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    mqCop.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    mqCop.SQL.Add("SELECT TekiCode FROM SumSM WHERE" + sSql);
                    //@ Unsupported property or method(D): 'Open'
                    mqCop.Open;
                    for (Index1 = 0; Index1 <= DspParamEtc.ZanRecord[DspParamEtc.ZanRecord.GetUpperBound(0)].TekiCode.GetUpperBound(0); Index1 ++ )
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.ZanRecord[DspParamEtc.ZanRecord.GetUpperBound(0)].TekiCode[Index1] = mqCop.GetFld("TekiCode").AsInteger;
                        //@ Unsupported property or method(D): 'Next'
                        mqCop.Next;
                    }
                }
            }
        }

        // ******************************************************************************
        // Proccess	: 表示処理
        // Name		: Y.Sato
        // Date		: 2000/09/22
        // Parameter	: var DspParam	TWDspParamTbl
        // Return		: なし
        // History		: 2000/11/29	Y.Sato		・ｳｨﾝﾄﾞｳ非表示のときﾃﾞｰﾀ選択できるように修正
        // : 2001/02/08	Y.Sato		・表示用と検索用で配列を別に持つ
        // : 2001/04/27	Y.Sato		・表示処理で表示件数を返せるようにする
        // : 2001/05/08	Y.Sato		・摘要残優先表示の変更
        // ******************************************************************************
        public void Dsp(ref TWDspParamTbl DspParam)
        {
            TWRecData[] RecList;
            TWTblData[] TblList2;
            // 未読込時
            if (!ReadFlg[DspParam.TableID])
            {
                TblList[DspParam.TableID] = GetRecList(DspParam.TableID);
            }
            // ﾚｺｰﾄﾞを取得
            // 固定摘要表示 and ｳｨﾝﾄﾞｳ表示区分に従う
            if ((DspParam.TableID == VKZ310Cmnu.TWTableID.wtiTeki) && (DspParam.TekiDsp == VKZ310Cmnu.TWTekiDsp.wtdDspKbn))
            {
                switch(DspKbn[DspParam.TableID])
                {
                    case 0:
                        DspParam.TekiDsp = VKZ310Cmnu.TWTekiDsp.wtdAll;
                        break;
                    case 1:
                        DspParam.TekiDsp = VKZ310Cmnu.TWTekiDsp.wtdKmk;
                        break;
                    case 2:
                        DspParam.TekiDsp = VKZ310Cmnu.TWTekiDsp.wtdZan;
                        break;
                    case 9:
                        DspParam.TekiDsp = VKZ310Cmnu.TWTekiDsp.wtdNone;
                        break;
                }
            }
            DspParamEtc.MasterInfo = MasterInfo[DspParam.TableID];
            // ﾏｽﾀ基本情報
            if ((DspParam.TableID != VKZ310Cmnu.TWTableID.wtiTeki) && (DspKbn[DspParam.TableID] == 0) || (DspParam.TableID == VKZ310Cmnu.TWTableID.wtiTeki) && (DspParam.TekiDsp != VKZ310Cmnu.TWTekiDsp.wtdNone) || (DspParam.DspMode == 1))
            {
                // if (DspParam.TableID <> wtiTeki) and (DspKbn[DspParam.TableID] = 0)
                // or (DspParam.TableID = wtiTeki) and (DspParam.TekiDsp <> wtdNone) then 2001/04/27 削除
                // 固定摘要表示 and 摘要残優先表示 2001/05/08
                if ((DspParam.TableID == VKZ310Cmnu.TWTableID.wtiTeki) && (DspParam.TekiDsp == VKZ310Cmnu.TWTekiDsp.wtdZan))
                {
                    Dsp_SetZanRecord(DspParam.KmkParamD.GCode);
                    // 借方残高管理区分セット
                    Dsp_SetZanRecord(DspParam.KmkParamC.GCode);
                // 貸方残高管理区分セット
                }
                // 社員マスタで、部署指定有り
                if (((DspParam.TableID == VKZ310Cmnu.TWTableID.wtiShain) || (DspParam.TableID == VKZ310Cmnu.TWTableID.wtiBumon)) && (DspParam.KmkParamD.SectionCode != ""))
                {
                    // if (DspParam.TableID = wtiShain) and (DspParam.KmkParamD.SectionCode<>'') then
                    base.Dsp(ref CheckBusyoSection(TblList[DspParam.TableID], DspParam), DspParam, DspParamEtc);
                }
                else
                {
                    base.Dsp(ref TblList[DspParam.TableID], DspParam, DspParamEtc);
                }
            }
            else
            {
                this.Clear();
                // 社員マスタで、部署指定有り
                if (((DspParam.TableID == VKZ310Cmnu.TWTableID.wtiShain) || (DspParam.TableID == VKZ310Cmnu.TWTableID.wtiBumon)) && (DspParam.KmkParamD.SectionCode != ""))
                {
                    // if (DspParam.TableID = wtiShain) and (DspParam.KmkParamD.SectionCode<>'') then
                    this.SortData(ref RecList, CheckBusyoSection(TblList[DspParam.TableID], DspParam), DspParam, DspParamEtc);
                }
                else
                {
                    this.SortData(ref RecList, TblList[DspParam.TableID], DspParam, DspParamEtc);
                }
                this.SetRecListSrc(RecList[0], DspParam.DspParam);
            // 検索用レコードリストをセット
            }
        }

        // 表示処理
        // procedure Dsp(DspParam: TWDspParamTbl); overload;							// 表示処理 2001/04/27 削除
        // ******************************************************************************
        // Proccess	: 固定摘要をチェック
        // Name		: Y.Sato
        // Date		: 2001/01/09
        // Parameter	: CTParam		固定摘要チェックパラメータ
        // Return		: Boolean		True:	OK
        // False:	NG
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public bool CheckTeki(TWCTParam CTParam)
        {
            bool result;
            // 未読込時
            if (!ReadFlg[VKZ310Cmnu.TWTableID.wtiTeki])
            {
                TblList[VKZ310Cmnu.TWTableID.wtiTeki] = GetRecList(VKZ310Cmnu.TWTableID.wtiTeki);
            }
            // ﾚｺｰﾄﾞを取得
            result = CheckTeki(TblList[VKZ310Cmnu.TWTableID.wtiTeki], CTParam);
            return result;
        }

        // 固定摘要をチェック
        // ******************************************************************************
        // Proccess	: 消費税ｳｨﾝﾄﾞｳ表示ﾊﾟﾀｰﾝを取得
        // Name		: Y.Sato
        // Date		: 2000/10/16
        // Parameter	: DspParam
        // Return		: TWWndPattern
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public TWWndPattern GetWndPattern(TWDspParamTbl DspParam)
        {
            TWWndPattern result;
            result = GetWndPattern(DspParam, DspParamEtc);
            return result;
        }

        // 初期処理
        // function Init(pRec: Pointer; iSyoriKubun:Integer): Boolean;					// 初期処理
        // ******************************************************************************
        // Proccess	: ﾃﾞｰﾀを検索
        // Name		: Y.Sato
        // Date		: 2000/09/29
        // Parameter	: SearchCode
        // : DspParam
        // Return		: Boolean
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public bool SearchData(string SearchCode, TWDspParamTbl DspParam)
        {
            bool result;
            // 未読込時
            if (!ReadFlg[DspParam.TableID])
            {
                TblList[DspParam.TableID] = GetRecList(DspParam.TableID);
            }
            // ﾚｺｰﾄﾞを取得
            // 固定摘要表示 and ｳｨﾝﾄﾞｳ表示区分に従う
            if ((DspParam.TableID == VKZ310Cmnu.TWTableID.wtiTeki) && (DspParam.TekiDsp == VKZ310Cmnu.TWTekiDsp.wtdDspKbn))
            {
                switch(DspKbn[DspParam.TableID])
                {
                    case 0:
                        DspParam.TekiDsp = VKZ310Cmnu.TWTekiDsp.wtdAll;
                        break;
                    case 1:
                        DspParam.TekiDsp = VKZ310Cmnu.TWTekiDsp.wtdKmk;
                        break;
                    case 2:
                        DspParam.TekiDsp = VKZ310Cmnu.TWTekiDsp.wtdZan;
                        break;
                    case 9:
                        DspParam.TekiDsp = VKZ310Cmnu.TWTekiDsp.wtdNone;
                        break;
                }
            }
            // 社員マスタで、部署指定有り
            if (((DspParam.TableID == VKZ310Cmnu.TWTableID.wtiShain) || (DspParam.TableID == VKZ310Cmnu.TWTableID.wtiBumon)) && (DspParam.KmkParamD.SectionCode != ""))
            {
                // if (DspParam.TableID = wtiShain) and (DspParam.KmkParamD.SectionCode<>'') then
                result = SearchData(SearchCode, CheckBusyoSection(TblList[DspParam.TableID], DspParam), DspParam, DspParamEtc);
            }
            else
            {
                result = SearchData(SearchCode, TblList[DspParam.TableID], DspParam, DspParamEtc);
            }
            return result;
        }

        // ﾃﾞｰﾀを検索
        // ******************************************************************************
        // Proccess	: 終了処理
        // Name		: Y.Sato
        // Date		: 2000/08/24
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx
        // XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Term()
        {
            int iIndex;
            for (iIndex = 1; iIndex <= Units.MAS310000u.MAS310SELWND_THREAD_COUNT; iIndex ++ )
            {
                if (Threads[iIndex] != null)
                {
                    //@ Unsupported property or method(C): 'Free'
                    Threads[iIndex].Free;
                }
            }
            if (dbCop != null)
            {
                //@ Unsupported property or method(A): 'COPDBClose'
                m_cMDModule.COPDBClose(dbCop);
                dbCop = null;
            }
        }

        // 終了処理
        // ******************************************************************************
        // Proccess	: 更新処理
        // Name		: Y.Sato
        // Date		: 2000/10/03
        // Parameter	: TableID
        // Return		: なし
        // History		: 2001/05/08	Y.Sato		・摘要残優先表示の変更
        // ******************************************************************************
        public void WndUpdate(TWTableID TableID)
        {
            int iIndex;
            ReadFlg[TableID] = false;
            // 読込ﾁｪｯｸをはずす
            if (TableID >= VKZ310Cmnu.TWTableID.wtiTrhksaki && TableID<= VKZ310Cmnu.TWTableID.wtiSirsaki)
            {
                ReadFlg[VKZ310Cmnu.TWTableID.wtiTrhksaki] = false;
                // 読込ﾁｪｯｸをはずす
                ReadFlg[VKZ310Cmnu.TWTableID.wtiTkisaki] = false;
                // 読込ﾁｪｯｸをはずす
                ReadFlg[VKZ310Cmnu.TWTableID.wtiSirsaki] = false;
            // 読込ﾁｪｯｸをはずす
            }
            if (TableID == VKZ310Cmnu.TWTableID.wtiEtc)
            {
                GetDspParam(ref DspKbn, ref DspParamEtc, ref MasterInfo);
            }
            else
            {
                for (iIndex = 1; iIndex <= Units.MAS310000u.MAS310SELWND_THREAD_COUNT; iIndex ++ )
                {
                    if ((Threads[iIndex] != null) && (new ArrayList(TableSet[iIndex]).Contains(TableID)))
                    {
                        Threads[iIndex].ReadRec(TableID, MasterInfo[TableID]);
                    }
                }
            }
            if (TableID == VKZ310Cmnu.TWTableID.wtiTeki)
            {
                DspParamEtc.ZanRecord = new TWZanRecord[0];
            }
            // 残高管理区分をクリア 2001/05/08

        }

        // **************************************************************************
        // Proccess	: ﾏｽﾀ区分からﾃｰﾌﾞﾙIDを取得
        // Name		: Y.Sato
        // Date		: 2000/11/27
        // Parameter	: MasterKbn
        // Return		: TWTableID
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // **************************************************************************
        public TWTableID GetDspParam_GetTableID(int MasterKbn)
        {
            TWTableID result;
            result = VKZ310Cmnu.TWTableID.wtiEtc;
            switch(MasterKbn)
            {
                case 1:
                    // その他
                    result = VKZ310Cmnu.TWTableID.wtiKanjoKmk;
                    break;
                case 2:
                    // 勘定科目
                    result = VKZ310Cmnu.TWTableID.wtiSaimkKmk;
                    break;
                case 3:
                    // 細目科目
                    result = VKZ310Cmnu.TWTableID.wtiCash;
                    break;
                case 21:
                    // 資金繰科目
                    result = VKZ310Cmnu.TWTableID.wtiGinko;
                    break;
                case 22:
                    // 銀行
                    result = VKZ310Cmnu.TWTableID.wtiTrhksaki;
                    break;
                case 25:
                    // 取引先
                    result = VKZ310Cmnu.TWTableID.wtiShain;
                    break;
                case 31:
                    // 社員
                    result = VKZ310Cmnu.TWTableID.wtiHanyo1;
                    break;
                case 32:
                    // 汎用補助1
                    result = VKZ310Cmnu.TWTableID.wtiHanyo2;
                    break;
                case 33:
                    // 汎用補助2
                    result = VKZ310Cmnu.TWTableID.wtiHanyo3;
                    break;
                case 34:
                    // 汎用補助3
                    result = VKZ310Cmnu.TWTableID.wtiHanyo4;
                    break;
                case 35:
                    // 汎用補助4
                    result = VKZ310Cmnu.TWTableID.wtiHanyo5;
                    break;
                case 41:
                    // 汎用補助5
                    result = VKZ310Cmnu.TWTableID.wtiBumon;
                    break;
                case 42:
                    // 部門
                    result = VKZ310Cmnu.TWTableID.wtiSeg1;
                    break;
                case 43:
                    // セグメント１
                    result = VKZ310Cmnu.TWTableID.wtiSeg2;
                    break;
                case 44:
                    // セグメント２
                    result = VKZ310Cmnu.TWTableID.wtiSeg3;
                    break;
                case 45:
                    // セグメント３
                    result = VKZ310Cmnu.TWTableID.wtiSeg4;
                    break;
                case 51:
                    // セグメント４
                    result = VKZ310Cmnu.TWTableID.wtiKoji;
                    break;
                case 52:
                    // 工事
                    result = VKZ310Cmnu.TWTableID.wtiKosh;
                    break;
                case 61:
                    // 工種
                    result = VKZ310Cmnu.TWTableID.wtiTeki;
                    break;
            // 固定摘要
            }
            return result;
        }

        // ｽﾚｯﾄﾞ
        // ******************************************************************************
        // Proccess	: 表示ﾊﾟﾗﾒｰﾀを取得
        // Name		: Y.Sato
        // Date		: 2000/11/27
        // Parameter	: var DspKbn
        // : var DspParamEtc
        // : var MasterInfo
        // Return		: なし
        // History		: 2001/02/05	Y.Sato		・固定摘要表示で仕訳辞書摘要も表示
        // : 2001/02/07	Y.Sato		・科目表示でウィンドウ表示順序を考慮
        // ******************************************************************************
        public virtual void GetDspParam(ref int[] DspKbn, ref TWDspParamEtc DspParamEtc, ref TWMasterInfo[] MasterInfo)
        {
            int DataKbn;
            // データ区分
            int Index;
            DataKbn = 0;
            // データ区分
            // 会社基本情報
            //@ Unsupported property or method(C): 'Close'
            this.Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            mqCop.SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("SELECT");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("DataKbn,");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("ComKbn4");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("FROM DTMAIN");
            //@ Unsupported property or method(D): 'Open'
            mqCop.Open;
            //@ Unsupported function or procedure: 'Eof'
            if (!Eof)
            {
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                DataKbn = mqCop.GetFld("DataKbn").AsInteger;
                // データ区分
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                DspParamEtc.ComKbn4 = mqCop.GetFld("ComKbn4").AsInteger;
            // 公益法人区分
            }
            // 特定科目情報取得
            //@ Unsupported property or method(C): 'Close'
            this.Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            mqCop.SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("SELECT");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("SpeCode,");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("KmkCode");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("FROM KmkInfo WHERE");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("SpeCode > 010300");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            mqCop.SQL.Add("AND SpeCode < 030110");
            //@ Unsupported property or method(D): 'Open'
            mqCop.Open;
            //@ Unsupported property or method(D): 'First'
            mqCop.First;
            //@ Unsupported function or procedure: 'Eof'
            while (!Eof)
            {
                //@ Unsupported property or method(A): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                switch(DspParamEtc.GetFld("SpeCode").AsInteger)
                {
                    case 010301:
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiFukugo] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 010302:
                        // 複合科目
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiSknfkg] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030101:
                        // 資金複合科目
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKruke] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030102:
                        // 仮受消費税
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKrbar] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030103:
                        // 仮払消費税
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiUrityo] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030104:
                        // 売上調整勘定
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiSirtyo] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030105:
                        // 仕入調整勘定
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor1] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030106:
                        // 貸倒償却1
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor2] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030107:
                        // 貸倒償却2
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor3] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030108:
                        // 貸倒償却3
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor4] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                    case 030109:
                        // 貸倒償却4
                        //@ Unsupported property or method(A): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        DspParamEtc.KmkCode[VKZ310Cmnu.TWKmkInfoID.wkiKsdor5] = DspParamEtc.GetFld("KmkCode").AsInteger;
                        break;
                // 貸倒償却5
                }
                //@ Unsupported property or method(D): 'Next'
                .Next;
            }
            // 仕訳ｳｨﾝﾄﾞｳ表示区分取得
            //@ Unsupported property or method(C): 'Close'
            this.Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            .SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("SELECT");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("MasterKbn,");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("DspKbn");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("FROM KmkWinDsp");
            //@ Unsupported property or method(D): 'Open'
            .Open;
            //@ Unsupported property or method(D): 'First'
            .First;
            //@ Unsupported function or procedure: 'Eof'
            while (!Eof)
            {
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                DspKbn[GetDspParam_GetTableID(.GetFld("MasterKbn").AsInteger)] = .GetFld("DspKbn").AsInteger;
                //@ Unsupported property or method(D): 'Next'
                .Next;
            }
            DspKbn[VKZ310Cmnu.TWTableID.wtiTkisaki] = DspKbn[VKZ310Cmnu.TWTableID.wtiTrhksaki];
            DspKbn[VKZ310Cmnu.TWTableID.wtiSirsaki] = DspKbn[VKZ310Cmnu.TWTableID.wtiTrhksaki];
            // ﾏｽﾀ基本情報
            //@ Unsupported property or method(C): 'Close'
            this.Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            .SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("SELECT");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("MasterKbn,");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("CodeAttr,");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("CodeDigit,");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("UseKbn");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            .SQL.Add("FROM MasterInfo");
            //@ Unsupported property or method(D): 'Open'
            .Open;
            //@ Unsupported property or method(D): 'First'
            .First;
            //@ Unsupported function or procedure: 'Eof'
            while (!Eof)
            {
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                TWMasterInfo _wvar1 = MasterInfo[GetDspParam_GetTableID(.GetFld("MasterKbn").AsInteger)];
                //@ Unsupported property or method(A): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                _wvar1.CodeAttr = _wvar1.GetFld("CodeAttr").AsInteger;
                // ｺｰﾄﾞ属性
                //@ Unsupported property or method(A): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                _wvar1.CodeDigit = _wvar1.GetFld("CodeDigit").AsInteger;
                // ｺｰﾄﾞ桁数
                //@ Unsupported property or method(A): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                _wvar1.UseKbn = _wvar1.GetFld("UseKbn").AsInteger;
                // 採用区分
                //@ Unsupported property or method(D): 'Next'
                WM_TERM.Next;
            }
            // 資金繰科目
            TWMasterInfo _wvar2 = MasterInfo[VKZ310Cmnu.TWTableID.wtiCash];
            _wvar2.CodeAttr = 0;
            // ｺｰﾄﾞ属性
            _wvar2.CodeDigit = 2;
            // ｺｰﾄﾞ桁数
            _wvar2.UseKbn = 1;
            // 採用区分
            // 得意先
            TWMasterInfo _wvar3 = MasterInfo[VKZ310Cmnu.TWTableID.wtiTkisaki];
            _wvar3.CodeAttr = MasterInfo[VKZ310Cmnu.TWTableID.wtiTrhksaki].CodeAttr;
            // ｺｰﾄﾞ属性
            _wvar3.CodeDigit = MasterInfo[VKZ310Cmnu.TWTableID.wtiTrhksaki].CodeDigit;
            // ｺｰﾄﾞ桁数
            _wvar3.UseKbn = MasterInfo[VKZ310Cmnu.TWTableID.wtiTrhksaki].UseKbn;
            // 採用区分
            // 仕入先
            TWMasterInfo _wvar4 = MasterInfo[VKZ310Cmnu.TWTableID.wtiSirsaki];
            _wvar4.CodeAttr = MasterInfo[VKZ310Cmnu.TWTableID.wtiTrhksaki].CodeAttr;
            // ｺｰﾄﾞ属性
            _wvar4.CodeDigit = MasterInfo[VKZ310Cmnu.TWTableID.wtiTrhksaki].CodeDigit;
            // ｺｰﾄﾞ桁数
            _wvar4.UseKbn = MasterInfo[VKZ310Cmnu.TWTableID.wtiTrhksaki].UseKbn;
            // 採用区分
            // 固定摘要
            TWMasterInfo _wvar5 = MasterInfo[VKZ310Cmnu.TWTableID.wtiTeki];
            _wvar5.CodeAttr = 0;
            // ｺｰﾄﾞ属性
            _wvar5.CodeDigit = 6;
            // ｺｰﾄﾞ桁数
            _wvar5.UseKbn = 1;
            // 採用区分
            // 消費税
            TWMasterInfo _wvar6 = MasterInfo[VKZ310Cmnu.TWTableID.wtiTax];
            _wvar6.CodeAttr = 0;
            // ｺｰﾄﾞ属性
            _wvar6.CodeDigit = 2;
            // ｺｰﾄﾞ桁数
            _wvar6.UseKbn = 1;
            // 採用区分
            // 消費税基本情報
            //@ Unsupported property or method(C): 'Close'
            this.Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            WM_TERM.SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            WM_TERM.SQL.Add("SELECT");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            WM_TERM.SQL.Add("ImportKbn");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            WM_TERM.SQL.Add("FROM TaxInfo");
            //@ Unsupported property or method(D): 'Open'
            WM_TERM.Open;
            //@ Unsupported function or procedure: 'Eof'
            if (!Eof)
            {
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                DspParamEtc.ImportKbn = WM_TERM.GetFld("ImportKbn").AsInteger;
            }
            // 輸入取引区分
            // ウィンドウ表示順序取得
            //@ Unsupported property or method(C): 'Close'
            this.Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            WM_TERM.SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            WM_TERM.SQL.Add("SELECT");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            WM_TERM.SQL.Add("COUNT(KmkCode) AS RecCnt");
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            WM_TERM.SQL.Add("FROM WinDspInfo");
            // (*Ver.6*)
            // (*H0005 20011206 khattori 顧問先でウィンドウ表示順序を見る時、事務所のところを見る*)
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            WM_TERM.SQL.Add("WHERE (AppKbn = 1)");
            // if DataKbn = 0 then			SQL.Add('WHERE (AppKbn = 1)')
            // else if DataKbn = 1 then	SQL.Add('WHERE (AppKbn = 11)');
            // if DataKbn = 0 then			SQL.Add('WHERE (AppKbn = 1 OR AppKbn = 2 AND StaffCode = ' + IntToStr(rcCOMMONAREA(m_pRec^.m_pCommonArea^).TantoNCD) + ')')
            // else if DataKbn = 1 then	SQL.Add('WHERE (AppKbn = 11 OR AppKbn = 12 AND StaffCode = ' + IntToStr(rcCOMMONAREA(m_pRec^.m_pCommonArea^).TantoNCD) + ')');
            //@ Unsupported property or method(D): 'Open'
            WM_TERM.Open;
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsInteger'
            DspParamEtc.WinDspInfo = new TWWinDspInfo[WM_TERM.GetFld("RecCnt").AsInteger];
            //@ Unsupported property or method(C): 'Close'
            this.Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Strings'
            WM_TERM.SQL.Strings[1] = "KmkCode";
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            WM_TERM.SQL.Add("ORDER BY AppKbn DESC, DspNo");
            //@ Unsupported property or method(D): 'Open'
            WM_TERM.Open;
            //@ Unsupported property or method(D): 'First'
            WM_TERM.First;
            for (Index = 0; Index <= DspParamEtc.WinDspInfo.GetUpperBound(0); Index ++ )
            {
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                DspParamEtc.WinDspInfo[Index].KmkCode = WM_TERM.GetFld("KmkCode").AsInteger;
                //@ Unsupported property or method(D): 'Next'
                WM_TERM.Next;
            }
        }

        // **********************************************************************
        // Proccess	: ｽﾚｯﾄﾞの優先度を変える
        // Name		: Y.Sato
        // Date		: 2000/11/21
        // Parameter	: Threads
        // : Priority		指定ｽﾚｯﾄﾞの優先度
        // : PriorityEtc	他ｽﾚｯﾄﾞの優先度
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // **********************************************************************
        public void GetRecList_GetRecList_SetPriority(TMAS310SelWndThreads Threads, TThreadPriority Priority, TThreadPriority PriorityEtc)
        {
            int iIndex;
            Threads.SetPriority(Priority);
            for (iIndex = 1; iIndex <= Units.MAS310000u.MAS310SELWND_THREAD_COUNT; iIndex ++ )
            {
                if ((this.Threads[iIndex] != Threads) && (this.Threads[iIndex] != null))
                {
                    this.Threads[iIndex].SetPriority(PriorityEtc);
                }
            }
        }

        // **********************************************************************
        // Proccess	: ｽﾚｯﾄﾞの実行を停止再開する
        // Name		: Y.Sato
        // Date		: 2000/11/21
        // Parameter	: Threads
        // : Suspended		True:停止
        // :				False:実行
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // **********************************************************************
        public void GetRecList_GetRecList_SetSuspended(TMAS310SelWndThreads Threads, bool Suspended)
        {
            int iIndex;
            for (iIndex = 1; iIndex <= Units.MAS310000u.MAS310SELWND_THREAD_COUNT; iIndex ++ )
            {
                if ((this.Threads[iIndex] != Threads) && (this.Threads[iIndex] != null))
                {
                    this.Threads[iIndex].SetSuspended(Suspended);
                }
            }
        }

        // **************************************************************************
        // Proccess	: ﾚｺｰﾄﾞを取得
        // Name		: Y.Sato
        // Date		: 2000/11/21
        // Parameter	: Threads
        // Return		: TWTblList		取得ﾃﾞｰﾀ
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // **************************************************************************
        public TWTblData[] GetRecList_GetRecList(TMAS310SelWndThreads Threads)
        {
            TWTblData[] result;
            result = null;
            if (Threads != null)
            {
                // SetPriority(Threads, tpTimeCritical, tpIdle);
                GetRecList_GetRecList_SetSuspended(Threads, true);
                result = Threads.GetRecList(TableID);
                // ﾚｺｰﾄﾞを取得
                // SetPriority(Threads, tpLower, tpLower);
                GetRecList_GetRecList_SetSuspended(Threads, false);
            }
            return result;
        }

        // 表示ﾊﾟﾗﾒｰﾀを取得
        // ******************************************************************************
        // Proccess	: ﾚｺｰﾄﾞを取得
        // Name		: Y.Sato
        // Date		: 2000/11/21
        // Parameter	: TableID		ﾃｰﾌﾞﾙID
        // Return		: TWTblList		取得ﾃﾞｰﾀ
        // History		: 9999/99/99	X.Xxxx		･XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        protected TWTblData[] GetRecList(TWTableID TableID)
        {
            TWTblData[] result;
            int iIndex;
            result = null;
            for (iIndex = 1; iIndex <= Units.MAS310000u.MAS310SELWND_THREAD_COUNT; iIndex ++ )
            {
                if (new ArrayList(TableSet[iIndex]).Contains(TableID))
                {
                    result = GetRecList_GetRecList(Threads[iIndex]);
                    // ﾚｺｰﾄﾞを取得
                    ReadFlg[TableID] = true;
                // 読込済みﾌﾗｸﾞをON
                }
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: 部署入力で担当者の絞込の為に部門条件を作成する
        // ******************************************************************************
        protected TWTblData[] CheckBusyoSection(TWTblData[] TblList, TWDspParamTbl DspParam)
        {
            TWTblData[] result;
            int Index;
            int Index2;
            bool bMatch;
            int RecCnt;
            string[] rSBumon;
            rSBumon = new string[0];
            // ＝１の時、部門ｺｰﾄﾞなので直接比較
            if (DspParam.KmkParamD.TkClassCode == 1)
            {
                rSBumon = new string[rSBumon.Length + 1];
                rSBumon[rSBumon.Length - 1] = DspParam.KmkParamD.SectionCode;
            // ＝２の時、部署ｺｰﾄﾞなので部門をリストして比較
            }
            else
            {
                //@ Unsupported property or method(D): 'Close'
                mqCop.Close;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(D): 'Clear'
                mqCop.SQL.Clear;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                mqCop.SQL.Add("SELECT BasedCode FROM HojyoTree WHERE");
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                mqCop.SQL.Add("MasterKbn = 47");
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                mqCop.SQL.Add("AND PatternNo = 1");
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                mqCop.SQL.Add("AND sumcode = " + DspParam.KmkParamD.SectionCode);
                //@ Unsupported property or method(D): 'Open'
                mqCop.Open;
                //@ Unsupported property or method(D): 'Eof'
                while (!mqCop.Eof)
                {
                    rSBumon = new string[rSBumon.Length + 1];
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    rSBumon[rSBumon.Length - 1] = mqCop.GetFld("BasedCode").AsString;
                    // ＝３の時、部門ｺｰﾄﾞ表示
                    if (DspParam.KmkParamD.TkClassCode == 3)
                    {
                        //@ Unsupported property or method(D): 'CodeDigit'
                        //@ Unsupported property or method(D): 'CodeAttr'
                        //@ Unsupported property or method(A): 'SetDspCodeAttr'
                        rSBumon[rSBumon.Length - 1] = m_cSysCom.SetDspCodeAttr(rSBumon[rSBumon.Length - 1], MasterInfo[VKZ310Cmnu.TWTableID.wtiBumon].CodeDigit, MasterInfo[VKZ310Cmnu.TWTableID.wtiBumon].CodeAttr);
                    }
                    //@ Unsupported property or method(D): 'next'
                    mqCop.next;
                }
                //@ Unsupported property or method(D): 'Close'
                mqCop.Close;
            }
            RecCnt = 0;
            result = new TWTblData[TblList.Length];
            for (Index = 0; Index <= TblList.GetUpperBound(0); Index ++ )
            {
                // ＝３の時、部門ｺｰﾄﾞ表示
                if (DspParam.KmkParamD.TkClassCode == 3)
                {
                    if ((TblList[Index].RecData.Code != ""))
                    {
                        bMatch = false;
                        for (Index2 = 0; Index2 < rSBumon.Length; Index2 ++ )
                        {
                            if (rSBumon[Index2] == TblList[Index].RecData.Code)
                            {
                                bMatch = true;
                                break;
                            }
                        }
                        if (!bMatch)
                        {
                            continue;
                        }
                    }
                }
                else
                {
                    if ((TblList[Index].TekiData.SectionCode != ""))
                    {
                        bMatch = false;
                        for (Index2 = 0; Index2 < rSBumon.Length; Index2 ++ )
                        {
                            if (rSBumon[Index2] == TblList[Index].TekiData.SectionCode)
                            {
                                bMatch = true;
                                break;
                            }
                        }
                        if (!bMatch)
                        {
                            continue;
                        }
                    }
                }
                result[RecCnt] = TblList[Index];
                RecCnt ++;
            }
            result = new TWTblData[RecCnt];
            return result;
        }

#endif
    } // end TMAS310SelWndDB

    // ******************************************************************************
    // Proccess	:	TMASL310Item
    // Name		:	K.Hattori(MJS)
    // Date		:	2000/12/08
    // Parameter	:
    // Return		:
    // ******************************************************************************
    // (*H0017 20010925 khattori	定型仕訳対応*)
    // <HIS-014> 2007/05/08 T.Yamaguchi	コクヨ伝票、部署伝票 対応
    public class TMASL310Item: ArrayList
    {
        protected string m_sBplPath = String.Empty;
        protected int m_iSyoriKbn = 0;
        // m_iItemMode			:	Integer;	//	=0の時、Iniファイル。=1の時、constant。
        // m_iProcId			:	Integer;	//	指示の処理コード
        // IniFile				:	TIniFile;
        protected object m_pRoot = null;
        protected TMjsAppRecord m_pRec = null;
        // Bpl管理構造体
        // ///////////////////////////////
        protected TMDataModulef m_cMDModule = null;
        // (*db*)
        protected object m_FCtlDB = null;
        // (*db*)
        protected object m_FCopDB = null;
        // (*db*)
        protected object m_FdqCtlInfo = null;
        // (*db*)
        protected object m_FdqCopInfo = null;
        // (*db*)
        protected TMASCom m_ComArea = null;
        // (*db*)
        // ///////////////////////////////
        // (*H0017 20010925 khattori	定型仕訳対応*)
        protected int m_FixKbn20 = 0;
        // 定型仕訳採用区分（仕訳）
        protected int m_FixKbn21 = 0;
        // 定型仕訳採用区分（出納）
        protected int m_FixKbn29 = 0;
        // 定型仕訳採用区分（伝票）
        protected int m_iZaimu = 0;
        // Public 宣言
        public int m_iDefaultFunc = 0;
        // ******************************************************************************
        // Proccess	:	TMASL310Item
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // (*H0001	20010522 khattori 初期処理失敗時のメッセージに出す処理名*)
        // (*H0002	20010523 khattori メニュー制御情報による排他*)
        // (*H0003	20010601 khattori 大改造　きれいにした*)
        // (*H0017 20010925 khattori	定型仕訳対応*)
        // (*H0018 20011024 khattori	初期値変更*)
        // (*Ver.x*)
        // (*H0024	20011217 khattori	手形入力*)
        // (*H0025	20011217 khattori	伝票入力*)
        // (*Ver A123 M102*)
        // (*H0030 20020415 khattori	メール会計本支店対応*)
        // (*Ver Axxx Mxxx*)
        // (*H0031 20020522 khattori 伝票入力*)
        // (*H0032 20030130 khattori 部署入力でFunction制御が動作しない*)
        // (*H0038 20030904 khattori	分散入力<単一入力>*)
        // <HIS-001> 2006/02/15 T.Yamaguchi	サブプログラムボタン ＆ Excel取込 対応
        // <HIS-004> 2006/10/17 T.Yamaguchi	サブプログラム メニュー追加(他社データ取込 他)
        // <HIS-006> 2006/12/27 T.Yamaguchi	サブプログラム メニュー追加
        // <HIS-011> 2007/03/06 T.Yamaguchi	サブプログラム メニュー追加
        // <HIS-012> 2007/03/14 T.Yamaguchi	サブプログラム メニュータイトル変更「IBEX出納帳X」
        // <HIS-014> 2007/05/08 T.Yamaguchi	伝票 対応
        // <HIS-016> 2007/08/24 T.Yamaguchi	サブプログラム メニュー追加(記帳くん07)
        // <HIS-026> 2008/01/11 T.Yamaguchi	サブプログラム メニュータイトル変更「弥生会計05-08」「IBEX出納帳」
        // <HIS-053> 2009/01/16 T.Yamaguchi	取込処理 メニュータイトル変更「弥生会計05-09」
        // <HIS-054> 2009/02/25 T.Yamaguchi	取込処理 メニュータイトル変更「ミロクのかんたん！法人会計」
        // <HIS-059> 2009/08/19 T.Yamaguchi	取込処理 ＰＣＡ会計９対応
        // <HIS-064> 2010/04/01 T.Yamaguchi	取込処理 会計王11、勘定奉行i 対応
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create()
        public TMASL310Item() : base()
        {
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 終了処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //@ Destructor  Destroy()
        ~TMASL310Item()
        {
            int idx;
            TMASL310IItem prItem;
            // 自分の管理している指示項目リストを削除＆クリア
            for (idx = 0; idx < this.Count; idx ++ )
            {
                prItem = this[idx];
                if (prItem != null)
                {
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(prItem);
                }
            }
            this.Clear();
            base.Destroy();
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual int SetRootAddress(object[] arPrm01)
        {
            int result;
            int iCount;
            int iPCode;
            iCount = 0;
            m_pRoot = arPrm01[0];
            m_pRec = arPrm01[1];
            // (*H0017 20010925 khattori	定型仕訳対応*)
            m_FixKbn20 = ((int)arPrm01[2]);
            // 定型仕訳採用区分（仕訳）
            m_FixKbn21 = ((int)arPrm01[3]);
            // 定型仕訳採用区分（出納）
            m_FixKbn29 = ((int)arPrm01[4]);
            // 定型仕訳採用区分（伝票）
            m_iZaimu = ((int)arPrm01[5]);
            // １＝財務基本
            //@ Undeclared identifier(3): 'TMASCom'
            m_ComArea = TMASCom(m_pRec.m_pSystemArea);
            //@ Unsupported property or method(C): 'SystemArea'
            //@ Unsupported property or method(D): 'SysPrefix'
            m_sBplPath = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).SysRoot + '\\' + m_ComArea.SystemArea.SysPrefix + "\\prg\\";
            // DBModule
            if (m_pRec.m_pDBModule != null)
            {
                //@ Undeclared identifier(3): 'TMDataModulef'
                m_cMDModule = TMDataModulef(m_pRec.m_pDBModule);
                // MJSCommon
                //@ Unsupported property or method(C): 'CTLDBOpen'
                m_FCtlDB = m_cMDModule.CTLDBOpen;
                if ((m_FCtlDB != null))
                {
                    m_FdqCtlInfo = new TMQuery(m_pRec.m_pChildForm);
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FCtlDB, m_FdqCtlInfo);
                    // 担当者管理無し
                    m_iSyoriKbn =  -1;
                    // 担当者管理あり？
                    if (((m_pRec.m_pCommonArea) as rcCOMMONAREA).TantoNCD !=  -1)
                    {
                        //@ Unsupported function or procedure: 'Close'
                        Close;
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(D): 'Clear'
                        m_FdqCtlInfo.SQL.Clear;
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqCtlInfo.SQL.Add("select SyoriKbn from MOS_OFFICE_STAFF where TantoNCD=");
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqCtlInfo.SQL.Add((((m_pRec.m_pCommonArea) as rcCOMMONAREA).TantoNCD).ToString());
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqCtlInfo.SQL.Add(" AND TsyokKbn=0;");
                        //@ Unsupported property or method(D): 'Open'
                        m_FdqCtlInfo.Open;
                        // レコード無しなら、動作不能とみなす。
                        //@ Unsupported function or procedure: 'eof'
                        if (eof)
                        {
                            m_iSyoriKbn =  -2;
                        }
                        else
                        {
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            m_iSyoriKbn = m_FdqCtlInfo.GetFld("SyoriKbn").AsInteger;
                        }
                        //@ Unsupported function or procedure: 'Close'
                        Close;
                    }
                    // MASCommon
                    //@ Unsupported property or method(C): 'm_iMasCommonNo'
                    //@ Unsupported property or method(A): 'COPDBOpen'
                    m_FCopDB = m_cMDModule.COPDBOpen(0, m_ComArea.m_iMasCommonNo);
                    if ((m_FCopDB != null))
                    {
                        m_FdqCopInfo = new TMQuery(m_pRec.m_pChildForm);
                        //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                        m_cMDModule.SetDBInfoToQuery(m_FCopDB, m_FdqCopInfo);
                        if ((m_pRec.m_iProgramCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU) && (((m_pRoot) as TMASL310Root).LogWrite("CheckIsDnpModeK")))
                        {
                            iPCode = m_pRec.m_iProgramCode;
                            m_pRec.m_iProgramCode = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO;
                            // m_pRec^.m_iProgramCode:=MASL_PROC_CODE_KARISSN;
                            // 指示項目リスト作成
                            iCount = CreateItemList();
                            m_pRec.m_iProgramCode = iPCode;
                        }
                        else
                        {
                            // 指示項目リスト作成
                            iCount = CreateItemList();
                        }
                        //@ Unsupported property or method(D): 'Free'
                        m_FdqCopInfo.Free;
                        //@ Unsupported property or method(A): 'COPDBClose'
                        m_cMDModule.COPDBClose(m_FCopDB);
                    }
                    //@ Unsupported property or method(D): 'Free'
                    m_FdqCtlInfo.Free;
                    //@ Unsupported property or method(A): 'CTLDBClose'
                    m_cMDModule.CTLDBClose(m_FCtlDB);
                }
            }
            result = iCount;
            return result;
        }

        // ＩＮＩファイル読み込み	数値型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ＩＮＩファイル読み込み	数値型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public int ReadIniInt(int iCode, string sString, int iIndex)
        {
            int result;
            TMASL310IFunc rMASL310IFunc;
            result = 0;
            rMASL310IFunc = ReadIniRec(iCode, iIndex);
            if (sString == "Type")
            {
                result = rMASL310IFunc.iType;
            }
            if (sString == "Code")
            {
                result = rMASL310IFunc.iOpCode;
            }
            if (sString == "Brth")
            {
                result = rMASL310IFunc.iBrotherCode;
            }
            if (sString == "Levl")
            {
                result = rMASL310IFunc.iLevl;
            }
            if (sString == "Mama")
            {
                result = rMASL310IFunc.iMamaOpCode;
            }
            if (sString == "Numb")
            {
                result = rMASL310IFunc.iNumb;
            }
            return result;
        }

        // ＩＮＩファイル読み込み	レコード型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ＩＮＩファイル読み込み	レコード型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public TMASL310IFunc ReadIniRec(int iCode, int iIndex)
        {
            TMASL310IFunc result;
            TMASL310IFunc rMASL310IFunc;
            int iCldCnt;
            int iTempCode;
            int idx;
            rMASL310IFunc.iOpCode = 0;
            // iIndexが負の時、親の検索
            if (iIndex < 0)
            {
                iTempCode = iCode;
                iCode = 0;
                for (idx = 0; idx < this.Count; idx ++ )
                {
                    if (this[idx] == null)
                    {
                        continue;
                    }
                    if (((TMASL310IItem)(this[idx])).iOwn != iTempCode)
                    {
                        continue;
                    }
                    iCode = ((TMASL310IItem)(this[idx])).iMama;
                    break;
                }
            }
            // iIndexが正の時、子供の検索
            if (iIndex > 0)
            {
                iTempCode = iCode;
                iCode = 0;
                iCldCnt = 0;
                for (idx = 0; idx < this.Count; idx ++ )
                {
                    if (this[idx] == null)
                    {
                        continue;
                    }
                    if (((TMASL310IItem)(this[idx])).iMama != iTempCode)
                    {
                        continue;
                    }
                    iCldCnt = iCldCnt + 1;
                    if (iCldCnt != iIndex)
                    {
                        continue;
                    }
                    iCode = ((TMASL310IItem)(this[idx])).iOwn;
                    break;
                }
            }
            if (iCode != 0)
            {
                for (idx = 0; idx < this.Count; idx ++ )
                {
                    if (this[idx] == null)
                    {
                        continue;
                    }
                    if (((TMASL310IItem)(this[idx])).iOwn != iCode)
                    {
                        continue;
                    }
                    rMASL310IFunc.iOpCode = iCode;
                    rMASL310IFunc.iMamaOpCode = ((TMASL310IItem)(this[idx])).iMama;
                    rMASL310IFunc.iLevl = ((TMASL310IItem)(this[idx])).iLevel;
                    rMASL310IFunc.sCaption = ((TMASL310IItem)(this[idx])).sName;
                    rMASL310IFunc.sProg = ((TMASL310IItem)(this[idx])).sBpl;
                    if ((rMASL310IFunc.sProg != 'x') && (rMASL310IFunc.sProg != "ac-change") && (rMASL310IFunc.sProg != 'y') && (rMASL310IFunc.sProg != 'z'))
                    {
                        rMASL310IFunc.sProg = m_sBplPath + ((TMASL310IItem)(this[idx])).sBpl;
                    }
                    rMASL310IFunc.iBrotherCode = ((TMASL310IItem)(this[idx])).iBrother;
                    rMASL310IFunc.iMode = ((TMASL310IItem)(this[idx])).iMode;
                    rMASL310IFunc.iStyl = ((TMASL310IItem)(this[idx])).iStyle;
                    rMASL310IFunc.bEnabled = true;
                    rMASL310IFunc.bWndUV = false;
                    if (((TMASL310IItem)(this[idx])).iWindow == 1)
                    {
                        rMASL310IFunc.bWndUV = true;
                    }
                    rMASL310IFunc.iType = ((TMASL310IItem)(this[idx])).iType;
                    if (rMASL310IFunc.iType == 0)
                    {
                        rMASL310IFunc.iType = ((m_pRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_TYPE);
                    }
                    rMASL310IFunc.iNumb = ((TMASL310IItem)(this[idx])).iNumb;
                    break;
                }
            }
            result = rMASL310IFunc;
            return result;
        }

        public int CreateItemList_GetSlipKind()
        {
            int result;
            object pQuery;
            enTblList tlTblList;
            int index;
            int[] irSlipKind;
            string[] arSlipTitle;
            int iSlipId;
            int iSlipMd;
            string sSwkForm;
            string sSlipBplName;
            switch(m_pRec.m_iProgramCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU:
                    sSwkForm = '3';
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO:
                    // ﾐﾛｸ型振替伝票
                    sSwkForm = '4';
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN:
                    // ｺｸﾖ型振替伝票
                    sSwkForm = '5';
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN:
                    // 入金伝票
                    sSwkForm = '6';
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN:
                    // 出金伝票
                    sSwkForm = "34";
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO:
                    // 仮払精算伝票
                    sSwkForm = "31";
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                    // 部署伝票指示
                    sSwkForm = '3';
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                    // ﾐﾛｸ型振替伝票
                    sSwkForm = '4';
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                    // ｺｸﾖ型振替伝票
                    sSwkForm = '5';
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                    // 入金伝票
                    sSwkForm = '6';
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                    // 出金伝票
                    sSwkForm = "34";
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO_BUN:
                    // 仮払精算伝票
                    sSwkForm = "31";
                    break;
            // 部署伝票指示
            }
            sSlipBplName = "MAS312101.bpl";
            switch(m_pRec.m_iProgramCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                    sSlipBplName = "MAS312102.bpl";
                    break;
            // ｺｸﾖ型振替伝票
            }
            m_iDefaultFunc =  -1;
            iDspWork1 = 0;
            irSlipKind = new int[0];
            arSlipTitle = new string[0];
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_DenInfo;
            sSwkForm = " where SwkForm=" + sSwkForm + " order by DenClass";
            pQuery = ((m_pRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList, sSwkForm);
            if (pQuery != null)
            {
                //@ Undeclared identifier(3): 'TMQuery'
                 _wvar1 = TMQuery(pQuery);
                //@ Unsupported function or procedure: 'eof'
                while (!eof)
                {
                    iCount ++;
                    irSlipKind = new int[irSlipKind.Length + 1];
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    irSlipKind[irSlipKind.Length - 1] = _wvar1.GetFld("DenClass").AsInteger;
                    arSlipTitle = new string[arSlipTitle.Length + 1];
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    arSlipTitle[arSlipTitle.Length - 1] = _wvar1.GetFld("DDspName").AsString;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    if (_wvar1.GetFld("DenClass").AsInteger == 0)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        iDspWork1 = _wvar1.GetFld("DspWork1").AsInteger;
                    }
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    if (iDspWork1 == _wvar1.GetFld("DenClass").AsInteger)
                    {
                        m_iDefaultFunc = iCount;
                    }
                    //@ Unsupported property or method(D): 'NEXT'
                    _wvar1.NEXT;
                }
            }
            switch(m_pRec.m_iProgramCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU:
                    // 指示自体
                    // own	 mama	level	 name			  bpl					 brotehr Mode	 style	 window  type	 numb
                    SetRecSet(310000, 300000, 100, "ミロク型指示　", 'x', 0, 0, 0, 0, 3);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO:
                    SetRecSet(310000, 300000, 100, "コクヨ型指示　", 'x', 0, 0, 0, 0, 4);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN:
                    SetRecSet(310000, 300000, 100, "入金伝票指示　", 'x', 0, 0, 0, 0, 5);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN:
                    SetRecSet(310000, 300000, 100, "出金伝票指示　", 'x', 0, 0, 0, 0, 6);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN:
                    SetRecSet(310000, 300000, 100, "仮払精算指示　", 'x', 0, 0, 0, 0, 34);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO:
                    SetRecSet(310000, 300000, 100, "部署伝票指示　", 'x', 0, 0, 0, 0, 31);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                    SetRecSet(310000, 300000, 100, "ミロク型指示　", 'x', 0, 0, 0, 0, 3);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                    SetRecSet(310000, 300000, 100, "コクヨ型指示　", 'x', 0, 0, 0, 0, 4);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                    SetRecSet(310000, 300000, 100, "入金伝票指示　", 'x', 0, 0, 0, 0, 5);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                    SetRecSet(310000, 300000, 100, "出金伝票指示　", 'x', 0, 0, 0, 0, 6);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                    SetRecSet(310000, 300000, 100, "仮払精算指示　", 'x', 0, 0, 0, 0, 34);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO_BUN:
                    SetRecSet(310000, 300000, 100, "部署伝票指示　", 'x', 0, 0, 0, 0, 31);
                    break;
            }
            switch(m_pRec.m_iProgramCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO:
                    iSlipId = 1;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU:
                    // コクヨ
                    iSlipId = 2;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN:
                    // ミロク
                    iSlipId = 3;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN:
                    // 入金
                    iSlipId = 4;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN:
                    // 出金
                    iSlipId = 5;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO:
                    // 仮払精算
                    iSlipId = 6;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                    // 部署伝票
                    iSlipId = 1;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                    // コクヨ
                    iSlipId = 2;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                    // ミロク
                    iSlipId = 3;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                    // 入金
                    iSlipId = 4;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                    // 出金
                    iSlipId = 5;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO_BUN:
                    // 仮払精算
                    iSlipId = 6;
                    break;
            // 部署伝票
            }
            switch(m_pRec.m_iProgramCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO:
                    // コクヨ
                    // ミロク
                    // 入金
                    // 出金
                    // 仮払精算
                    iSlipMd = 0;
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO_BUN:
                    // 部署伝票
                    // コクヨ
                    // ミロク
                    // 入金
                    // 出金
                    // 仮払精算
                    iSlipMd = 1000;
                    break;
            // 部署伝票
            }
            if (iSlipMd == 1000)
            {
                m_FixKbn29 = 0;
            }
            // カスタマイズ情報２つ以上有り？
            if (iCount > 1)
            {
                // 第１指示
                SetRecSet(312100 + iSlipMd, 310000, 200, "入力			", 'x');
                SetRecSet(312500 + iSlipMd, 310000, 200, "表示・修正	", 'x');
                if (m_FixKbn29 == 1)
                {
                    SetRecSet(312800, 310000, 200, "定型登録		", 'x');
                }
                // 担当者別制御
                // own			 		mama	level	 name			  bpl				 brotehr Mode	 style	 window  type	 numb
                SetRecSet(312100 + iSlipMd + iSlipId, 310000, 400, "入力", sSlipBplName, 312199, 1);
                SetRecSet(312500 + iSlipMd + iSlipId, 310000, 400, "表示・修正", sSlipBplName, 312199, 5);
                if (m_FixKbn29 == 1)
                {
                    SetRecSet(312800 + iSlipMd + iSlipId, 310000, 400, "定型登録", sSlipBplName, 312199, 7);
                }
                SetRecSet(312200 + iSlipMd + iSlipId, 310000, 400, "修正・削除", sSlipBplName, 312199, 2);
                iSlipId = (iSlipMd + iSlipId) * 100;
                for (index = 0; index < iCount; index ++ )
                {
                    // own								 mama			level	 name				  bpl				 brotehr			 Mode	 style	 window  type	 numb
                    SetRecSet(31210000 + iSlipId + irSlipKind[index], 312100 + iSlipMd, 300, arSlipTitle[index], sSlipBplName, 31210000 + iSlipId, 1, 0, 0, 0, irSlipKind[index]);
                    SetRecSet(31250000 + iSlipId + irSlipKind[index], 312500 + iSlipMd, 300, arSlipTitle[index], sSlipBplName, 31210000 + iSlipId, 5, 0, 0, 0, irSlipKind[index]);
                    if (m_FixKbn29 == 1)
                    {
                        SetRecSet(31280000 + iSlipId + irSlipKind[index], 312800 + iSlipMd, 300, arSlipTitle[index], sSlipBplName, 31210000 + iSlipId, 7, 0, 0, 0, irSlipKind[index]);
                    }
                }
            // １つ
            }
            else if (iCount > 0)
            {
                iSlipId = (iSlipMd + iSlipId) * 100;
                // iSlipId:=iSlipId*100;
                // own							 mama	level	 name			  bpl			 brotehr			 Mode	 style	 window  type	 numb
                SetRecSet(31210000 + iSlipId + irSlipKind[0], 310000, 200, "入力", sSlipBplName, 31210000 + iSlipId, 1, 0, 0, 0, irSlipKind[0]);
                SetRecSet(31250000 + iSlipId + irSlipKind[0], 310000, 200, "表示・修正", sSlipBplName, 31210000 + iSlipId, 5, 0, 0, 0, irSlipKind[0]);
                if (m_FixKbn29 == 1)
                {
                    SetRecSet(31280000 + iSlipId + irSlipKind[0], 310000, 200, "定型登録", sSlipBplName, 31210000 + iSlipId, 7, 0, 0, 0, irSlipKind[0]);
                }
                // 担当者別制御
                iSlipId = (iSlipId / 100) - iSlipMd;
                // own			 		mama	level	 name			  bpl				 brotehr Mode	 style	 window  type	 numb
                SetRecSet(312100 + iSlipMd + iSlipId, 310000, 400, "入力", sSlipBplName, 312199, 1);
                SetRecSet(312500 + iSlipMd + iSlipId, 310000, 400, "表示・修正", sSlipBplName, 312199, 5);
                if (m_FixKbn29 == 1)
                {
                    SetRecSet(312800 + iSlipMd + iSlipId, 310000, 400, "定型登録", sSlipBplName, 312199, 7);
                }
                SetRecSet(312200 + iSlipMd + iSlipId, 310000, 400, "修正・削除", sSlipBplName, 312199, 2);
            // 基本のみ
            }
            else
            {
                // own			 		mama	level	 name			  bpl				 brotehr		 Mode	 style	 window  type	 numb
                SetRecSet(312100 + iSlipMd + iSlipId, 310000, 200, "入力", sSlipBplName, 312100 + iSlipMd + iSlipId, 1);
                SetRecSet(312500 + iSlipMd + iSlipId, 310000, 200, "表示・修正", sSlipBplName, 312100 + iSlipMd + iSlipId, 5);
                if (m_FixKbn29 == 1)
                {
                    SetRecSet(312800 + iSlipMd + iSlipId, 310000, 200, "定型登録", sSlipBplName, 312100 + iSlipMd + iSlipId, 7);
                }
                // 担当者別制御
                SetRecSet(312200 + iSlipMd + iSlipId, 310000, 400, "修正・削除", sSlipBplName, 312100 + iSlipMd + iSlipId, 2);
            }
            return result;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ＩＮＩファイル作成
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public int CreateItemList()
        {
            int result;
            int iCount;
            int iDspWork1;
            iCount = 0;
            // (*H0037 20030827 khattori	ＡＣＥＬＩＮＫ＜−＞ＭＪＳＬＩＮＫ統合*)
            // if	(m_iZaimu=1)	and
            // (m_pRec^.m_iOptionCode=MASL_PROC_OPT_ZTEGATA)	then
            if ((m_pRec.m_iOptionCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
            {
                SetRecSet(310000, 300000, 100, "手形入力　　　", 'x', 0, 0, 0, 0, 1);
                SetRecSet(310100, 310000, 200, "受取手形　　　", 'x', 0, 0, 0, 0, 1);
                SetRecSet(310101, 310100, 300, "入力　　　　　", "BIL310101.bpl", 310101, 1);
                SetRecSet(310102, 310100, 300, "修正・削除　　", "BIL310101.bpl", 310101, 2);
                SetRecSet(310103, 310100, 300, "表示　　　　　", "BIL310101.bpl", 310101, 11);
                SetRecSet(310200, 310000, 200, "支払手形　　　", 'x', 0, 0, 0, 0, 1);
                SetRecSet(310201, 310200, 300, "入力　　　　　", "BIL310101.bpl", 310201, 1);
                SetRecSet(310202, 310200, 300, "修正・削除　　", "BIL310101.bpl", 310201, 2);
                SetRecSet(310203, 310200, 300, "表示　　　　　", "BIL310101.bpl", 310201, 11);
                SetRecSet(310300, 310000, 200, "顛末入力　　　", "BIL310300.bpl", 0, 0, 0, 1);
            }
            else
            {
                switch(m_pRec.m_iProgramCode)
                {
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MONTHR:
                        // ///////////////////////////////////////////////////////
                        // 単一仕訳指示
                        // ///////////////////////////////////////////////////////
                        // own	 mama	level	 name			  bpl					 brotehr Mode	 style	 window  type	 numb
                        SetRecSet(310000, 300000, 100, "単一仕訳指示　", 'x', 0, 0, 0, 0, 1);
                        SetRecSet(310101, 310000, 200, "入力　　　　　", "MAS310101.bpl", 310101, 1);
                        SetRecSet(310201, 310000, 200, "修正・削除　　", "MAS310101.bpl", 310101, 2);
                        SetRecSet(310301, 310000, 200, "一括削除　　　", "MAS310101.bpl", 310101, 4);
                        SetRecSet(310500, 310000, 200, "仕訳帳　　　　", 'x');
                        SetRecSet(310502, 310500, 300, "入力順　　　　", "MAS310101.bpl", 310101, 11, 2);
                        SetRecSet(310501, 310500, 300, "日付順　　　　", "MAS310101.bpl", 310101, 11, 1);
                        SetRecSet(310503, 310500, 300, "非会計表示　　", "MAS310101.bpl", 310101, 11, 3);
                        SetRecSet(310601, 310000, 200, "元帳　　　　　", "MAS310101.bpl", 310101, 12);
                        SetRecSet(310700, 310000, 200, "検証　　　　　", 'x', 0, 13);
                        // (*20010214 0gatuha nasi*)
                        SetRecSet(310701, 310700, 300, "日別残　　　　", "MAS310701.bpl", 0, 0, 0, 1);
                        SetRecSet(310702, 310700, 300, "日計表　　　　", "MAS310702.bpl", 0, 0, 0, 1);
                        SetRecSet(310703, 310700, 300, "当年推移　　　", "MAS310703.bpl", 0, 0, 0, 1);
                        SetRecSet(310704, 310700, 300, "科目別集計　　", "MAS310704.bpl", 0, 0, 0, 1);
                        SetRecSet(310705, 310700, 300, "残高試算表　　", "MAS310702.bpl", 0, 0, 0, 1);
                        // (*20010124 bpl 310702->310705*)
                        SetRecSet(310706, 310700, 300, "要約財務　　　", "MAS310706.bpl", 0, 0, 0, 1);
                        // ＡＬUのみ動作
#if _WANTYPE_NEW_
                        // showmessage(inttostr(fn_GetSeriesFlag(m_pRec)));
                        // if	fn_GetSeriesFlag(m_pRec)>0	then
                        // begin
                        SetRecSet(310707, 310700, 300, "比較損益　　　", "MAS310707.bpl", 0, 0, 0, 1);
                        SetRecSet(370010, 310700, 300, "消費税　　　　", "MAS370010.bpl", 0, 0, 0, 1);
                        // end;
#endif
                        if (m_FixKbn20 == 1)
                        {
                            SetRecSet(310801, 310000, 200, "定型仕訳登録　", "MAS310101.bpl", 310101, 7);
                        }
                        break;
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU_BUN:
                        // (*H0038 20030904 khattori	分散入力<単一入力>*)
                        // ///////////////////////////////////////////////////////
                        // 単一仕訳分散入力指示
                        // ///////////////////////////////////////////////////////
                        // own	 mama	level	 name			  bpl					 brotehr Mode	 style	 window  type	 numb
                        SetRecSet(310000, 300000, 100, "単一分散指示　", 'x', 0, 0, 0, 0, 1);
                        SetRecSet(314101, 310000, 200, "入力　　　　　", "MAS310101.bpl", 314101, 1);
                        SetRecSet(314201, 310000, 200, "修正・削除　　", "MAS310101.bpl", 314101, 2);
                        SetRecSet(314301, 310000, 200, "一括削除　　　", "MAS310101.bpl", 314101, 4);
                        SetRecSet(314500, 310000, 200, "仕訳帳　　　　", 'x');
                        SetRecSet(314502, 314500, 300, "入力順　　　　", "MAS310101.bpl", 314101, 11, 2);
                        SetRecSet(314501, 314500, 300, "日付順　　　　", "MAS310101.bpl", 314101, 11, 1);
                        SetRecSet(314503, 314500, 300, "非会計表示　　", "MAS310101.bpl", 314101, 11, 3);
                        break;
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO_BUN:
                        // ///////////////////////////////////////////////////////
                        // 伝票入力指示
                        // ///////////////////////////////////////////////////////
                        // コクヨ
                        // ミロク
                        // 入金
                        // 出金
                        // 仮払精算
                        // 部署伝票
                        // コクヨ
                        // ミロク
                        // 入金
                        // 出金
                        // 仮払精算
                        // 部署伝票
                        // 伝票情報作成
                        CreateItemList_GetSlipKind();
                        break;
                    default:
                        // ///////////////////////////////////////////////////////
                        // 出納帳指示
                        // ///////////////////////////////////////////////////////
                        // own	 mama	level	 name			  bpl					 brotehr Mode	 style	 window  type	 numb
                        SetRecSet(311000, 300000, 100, "出納帳指示　　", 'x', 0, 0, 0, 0, 2);
                        SetRecSet(311101, 311000, 200, "入力　　　　　", "MAS310101.bpl", 310101, 1);
                        SetRecSet(311201, 311000, 200, "修正・削除　　", "MAS310101.bpl", 310101, 2);
                        SetRecSet(310401, 311000, 800, "科目変更　　　", "ac-change");
                        SetRecSet(311601, 311000, 200, "帳面表示　　　", "MAS310101.bpl", 310101, 12);
                        SetRecSet(310701, 311000, 200, "日別残　　　　", "MAS310701.bpl", 0, 0, 0, 1);
                        SetRecSet(310702, 311000, 200, "日計表　　　　", "MAS310702.bpl", 0, 0, 0, 1);
                        if (m_FixKbn21 == 1)
                        {
                            SetRecSet(311801, 311000, 200, "定型仕訳登録　", "MAS310101.bpl", 310101, 7);
                        }
                        break;
                // SetRecSet(311000,300000,100		,'出納帳指示　　','x'					,0		,0		,0		,0		,2			);	//
                // SetRecSet(310101,311000,200		,'入力　　　　　','MAS310101.bpl'		,310101	,1									);	//
                // SetRecSet(310201,311000,200		,'修正・削除　　','MAS310101.bpl'		,310101	,2									);	//
                // SetRecSet(310401,311000,800		,'科目変更　　　','ac-change'														);	//
                // SetRecSet(310601,311000,200		,'帳面表示　　　','MAS310101.bpl'		,310101	,12									);	//
                // SetRecSet(310701,311000,200		,'日別残　　　　','MAS310701.bpl'		,0		,0		,0		,1					);	//
                // SetRecSet(310702,311000,200		,'日計表　　　　','MAS310702.bpl'		,0		,0		,0		,1					);	//
                // if	m_FixKbn21=1	then
                // SetRecSet(310801,311000,200		,'定型仕訳登録　','MAS310101.bpl'		,310101	,7									);	//
                }
            // case
            }
            switch(m_pRec.m_iProgramCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU_BUN:
                    // if
                    // ドリルダウン用
                    SetRecSet(313101, 313500, 400, "コクヨ型", "MAS312102.bpl", 313101, 1);
                    SetRecSet(313102, 313500, 400, "振替伝票", "MAS312101.bpl", 313102, 1);
                    SetRecSet(313103, 313500, 400, "入金伝票", "MAS312101.bpl", 313103, 1);
                    SetRecSet(313104, 313500, 400, "出金伝票", "MAS312101.bpl", 313104, 1);
                    SetRecSet(313105, 313500, 400, "仮払精算", "MAS312101.bpl", 313105, 1);
                    SetRecSet(313201, 313500, 400, "コクヨ型", "MAS312102.bpl", 313101, 2);
                    SetRecSet(313202, 313500, 400, "振替伝票", "MAS312101.bpl", 313102, 2);
                    SetRecSet(313203, 313500, 400, "入金伝票", "MAS312101.bpl", 313103, 2);
                    SetRecSet(313204, 313500, 400, "出金伝票", "MAS312101.bpl", 313104, 2);
                    SetRecSet(313205, 313500, 400, "仮払精算", "MAS312101.bpl", 313105, 2);
                    SetRecSet(313501, 313500, 400, "コクヨ型", "MAS312102.bpl", 313101, 5);
                    SetRecSet(313502, 313500, 400, "振替伝票", "MAS312101.bpl", 313101, 5);
                    SetRecSet(313503, 313500, 400, "入金伝票", "MAS312101.bpl", 313101, 5);
                    SetRecSet(313504, 313500, 400, "出金伝票", "MAS312101.bpl", 313101, 5);
                    SetRecSet(313505, 313500, 400, "仮払精算", "MAS312101.bpl", 313101, 5);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BUSYO_BUN:
                    break;
                default:
                    // ///////////////////////////////////////////////////////
                    // 単一仕訳指示
                    // ///////////////////////////////////////////////////////
                    // コクヨ
                    // ミロク
                    // 入金
                    // 出金
                    // 仮払精算
                    // 部署伝票
                    // コクヨ
                    // ミロク
                    // 入金
                    // 出金
                    // 仮払精算
                    // 部署伝票
                    SetRecSet(312500, 300000, 100, "", 'x');
                    SetRecSet(312101, 312500, 400, "コクヨ型", "MAS312102.bpl", 312101, 1);
                    SetRecSet(312102, 312500, 400, "振替伝票", "MAS312101.bpl", 312102, 1);
                    SetRecSet(312103, 312500, 400, "入金伝票", "MAS312101.bpl", 312103, 1);
                    SetRecSet(312104, 312500, 400, "出金伝票", "MAS312101.bpl", 312104, 1);
                    SetRecSet(312105, 312500, 400, "仮払精算", "MAS312101.bpl", 312105, 1);
                    SetRecSet(312201, 312500, 400, "コクヨ型", "MAS312102.bpl", 312101, 2);
                    SetRecSet(312202, 312500, 400, "振替伝票", "MAS312101.bpl", 312102, 2);
                    SetRecSet(312203, 312500, 400, "入金伝票", "MAS312101.bpl", 312103, 2);
                    SetRecSet(312204, 312500, 400, "出金伝票", "MAS312101.bpl", 312104, 2);
                    SetRecSet(312205, 312500, 400, "仮払精算", "MAS312101.bpl", 312105, 2);
                    SetRecSet(312501, 312500, 400, "コクヨ型", "MAS312102.bpl", 312101, 5);
                    SetRecSet(312502, 312500, 400, "振替伝票", "MAS312101.bpl", 312101, 5);
                    SetRecSet(312503, 312500, 400, "入金伝票", "MAS312101.bpl", 312101, 5);
                    SetRecSet(312504, 312500, 400, "出金伝票", "MAS312101.bpl", 312101, 5);
                    SetRecSet(312505, 312500, 400, "仮払精算", "MAS312101.bpl", 312101, 5);
                    break;
            }
            // ///////////////////////////////////////////////////////
            // 集計
            // ///////////////////////////////////////////////////////
            if ((m_pRec.m_iOptionCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_OPT_ZTEGATA))
            {
                // 手形集計
                SetRecSet(320100, 0, 800, "仕訳集計　　　", "BIL310000Calc.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Siw));
            }
            else
            {
                SetRecSet(320100, 0, 800, "仕訳集計　　　", "MAS320100Calc.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Siw));
            }
            // 仕訳集計
            SetRecSet(340100, 0, 800, "仕訳集計　　　", "MAS320200Calc.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Mot));
            // 元帳集計
            SetRecSet(300000, 0, 800, "仕訳集計　　　", "BIL310000Calc.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Teg));
            // 手形集計
            SetRecSet(320300, 0, 800, "仕訳集計　　　", "MAS312100Calc.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Sli));
            // 伝票集計
            SetRecSet(320400, 0, 800, "仕訳集計　　　", "MAS320400Prn.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Slp));
            // 伝票集計
            // ///////////////////////////////////////////////////////
            // ダイアログ
            // ///////////////////////////////////////////////////////
            SetRecSet(390101, 0, 900, "バランス表示　", "MAS31_Balance.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bal));
            SetRecSet(390201, 0, 900, "その他条件　　", "MAS31_OtherCond.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Otc));
            SetRecSet(390301, 0, 900, "科目登録　　　", "MAS390300.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Kmk));
            SetRecSet(390302, 0, 900, "細目科目登録　", "MAS390300.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Kmk));
            SetRecSet(390321, 0, 900, "銀行登録　　　", "MAS390320.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Hjo));
            SetRecSet(390322, 0, 900, "取引先登録　　", "MAS390320.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Hjo));
            SetRecSet(390325, 0, 900, "担当者登録　　", "MAS390320.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Hjo));
            SetRecSet(390331, 0, 900, "汎用補助１登録", "MAS390320.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Hjo));
            SetRecSet(390332, 0, 900, "汎用補助２登録", "MAS390320.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Hjo));
            SetRecSet(390333, 0, 900, "汎用補助３登録", "MAS390320.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Hjo));
            SetRecSet(390334, 0, 900, "汎用補助４登録", "MAS390320.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Hjo));
            SetRecSet(390335, 0, 900, "汎用補助５登録", "MAS390320.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Hjo));
            SetRecSet(390341, 0, 900, "部門登録　　　", "MAS390340.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bmn));
            SetRecSet(390342, 0, 900, "ｾｸﾞﾒﾝﾄ１登録　", "MAS390340.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bmn));
            SetRecSet(390343, 0, 900, "ｾｸﾞﾒﾝﾄ２登録　", "MAS390340.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bmn));
            SetRecSet(390344, 0, 900, "ｾｸﾞﾒﾝﾄ３登録　", "MAS390340.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bmn));
            SetRecSet(390345, 0, 900, "ｾｸﾞﾒﾝﾄ４登録　", "MAS390340.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bmn));
            SetRecSet(390351, 0, 900, "工事登録　　　", "MAS390350.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Kji));
            SetRecSet(390352, 0, 900, "工種登録　　　", "MAS390350.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Kji));
            SetRecSet(390361, 0, 900, "固定摘要登録　", "MAS390360.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Tek));
            // 仮払精算金額取得ダイアログ
            SetRecSet(390900, 0, 900, "仮払参照　　　", "MAS390900.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Kar));
            // ↓↓↓<HIS-001><HIS-004><HIS-006><HIS-011><HIS-016><HIS-026>
            // ↓↓↓<HIS-053><HIS-054><HIS-059><HIS-064>
            // own	 mama	level	 name			  			   	   		　bpl					 brotehr Mode	 style	 window  type	 numb
            SetRecSet(391001, 0, 900, "Excel 取込", "MAS31_Excel.bpl", 0, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Exc));
            SetRecSet(391002, 0, 900, "他社データ取込　弥生会計02-04", "MAS505200.bpl", 391000, 9, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391003, 0, 900, "他社データ取込　弥生会計05-09", "MAS505200.bpl", 391000, 13, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391004, 0, 900, "他社データ取込　勘定奉行2000/２１", "MAS505200.bpl", 391000, 10, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391018, 0, 900, "他社データ取込　勘定奉行i", "MAS505200.bpl", 391000, 87, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391005, 0, 900, "他社データ取込　ＰＣＡ会計", "MAS505200.bpl", 391000, 12, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391017, 0, 900, "他社データ取込　ＰＣＡ会計９ Ｖ２", "MAS505200.bpl", 391000, 85, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391006, 0, 900, "他社データ取込　会計王７-１０", "MAS505200.bpl", 391000, 55, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391019, 0, 900, "他社データ取込　会計王１１", "MAS505200.bpl", 391000, 86, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391007, 0, 900, "他社データ取込　IBEX出納帳", "MAS505200.bpl", 391000, 65, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391008, 0, 900, "ミロクのかんたん！会計", "MAS505200.bpl", 391000, 17, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391009, 0, 900, "ミロクのかんたん！法人会計　データ抽出処理", "MAS511201.bpl", 391000, 2, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391010, 0, 900, "ミロクのかんたん！法人会計　データ受入処理", "MAS511301.bpl", 391000, 2, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391011, 0, 900, "iCompass会計/会計太郎　差分データ送信", "MASMailExpDlg.bpl", 391000, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391012, 0, 900, "iCompass会計/会計太郎　差分データ受信", "MASMailImpDlg.bpl", 391000, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391013, 0, 900, "ＣＥ会計　差分データ送信", "MASMailExpDlg.bpl", 391000, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391014, 0, 900, "ＣＥ会計　差分データ受信", "MASMailImpDlg.bpl", 391000, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391015, 0, 900, "記帳くん　差分データ送信", "MASVKZExpDlg.bpl", 391000, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            SetRecSet(391016, 0, 900, "記帳くん　差分データ受信", "MASVKZImpDlg.bpl", 391000, 0, 0, 0, 0, (int)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld));
            // ↑↑↑<HIS-001><HIS-004><HIS-006><HIS-011><HIS-016><HIS-026>
            // ↑↑↑<HIS-053><HIS-054><HIS-059><HIS-064>
            result = iCount;
            return result;
        }

        // ///////////////////////////////////////////////////////
        // ///////////////////////////////////////////////////////
        public void SetRecSet(int iOwn, int iMama, int iLevel, string sName, string sBpl, int iBrother, int iMode, int iStyle, int iWindow, int iType, int iNumb)
        {
            TMASL310IItem prItem;
            prItem = new TMASL310IItem();
            prItem.iOwn = iOwn;
            prItem.iMama = iMama;
            prItem.iLevel = iLevel;
            prItem.sName = sName;
            if (iLevel == 800)
            {
                // 集計＆科目変更はノーチェック
                prItem.sBpl = sBpl;
            }
            else
            {
                prItem.sBpl = RankCheck(iOwn, sBpl);
            }
            // 使用不能のプログラムは、'y'が帰る
            // ---<HIS-014>------------------------------------------------------------------
            // 担当者別制御
            if (prItem.sBpl == 'z')
            {
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(prItem);
                return;
            }
            // ------------------------------------------------------------------<HIS-014>---
            prItem.iBrother = iBrother;
            prItem.iMode = iMode;
            prItem.iStyle = iStyle;
            prItem.iWindow = iWindow;
            prItem.iType = iType;
            prItem.iNumb = iNumb;
            this.Add(prItem);
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ランクチェック　＆　担当者区分毎メニュー制御
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public string RankCheck(int iOwn, string sBpl)
        {
            string result;
            // (*H0032 20030130 khattori 部署入力でFunction制御が動作しない*)
            object pQuery;
            enTblList tlTblList;
            int iHassei;
            result = sBpl;
            // with	m_FdqCtlInfo	do
            // begin
            // ランク＝０は、ノーチェック
            // if	m_pRec^.m_iRank <> 0 then
            // begin
            // Close;
            // SQL.Clear;
            // //	当該プログラムコードのランクＩＤと一致するセキュリティランクテーブルに、
            // //	現在のランクでの動作可能状態を見に行く。
            // SQL.Add('SELECT RANK'+Format('%0.2d',[m_pRec^.m_iRank])+' as RankOk');
            // SQL.Add(' FROM MENU_PRGINFO,SYS_SEC');
            // SQL.Add(' WHERE SECRANKID=RANKID');
            // SQL.Add(' AND PRGCD='+IntToStr(iOwn));
            // SQL.Add(' AND OPTCD='+IntToStr(m_pRec^.m_iOptionCode));
            // SQL.Add(' AND SYSCD='+IntToStr(m_pRec^.m_iSystemCode));
            // SQL.Add(' AND RankOk=0');
            // SQL.Add(';');
            // Open;
            // //	レコード有りなら、動作不能とみなす。
            // if	not eof	then	result:='y';
            // end;
            // end;
            if (m_iSyoriKbn <  -1)
            {
                result = 'y';
            }
            if (m_iSyoriKbn >  -1)
            {
                // 仕訳発生区分
                // (*H0002	20010523 khattori メニュー制御情報による排他*)
                // (*H0032 20030130 khattori 部署入力でFunction制御が動作しない*)
                tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_DTMAIN;
                pQuery = ((m_pRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                iHassei = 0;
                if (pQuery != null)
                {
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iHassei = TMQuery(pQuery).GetFld("DataKbn").AsInteger;
                    if (iHassei != 3)
                    {
                        iHassei = 0;
                    }
                }
                // tlTblList:=MASL_TLST_DTMAIN;
                // pQuery:=TMASL310Root(m_pRoot^).Pfnc(MASL_PGET_TBL_LIST,@tlTblList);
                // iHassei		:=	0;
                // if	pQuery<>nil	then
                // begin
                // iHassei		:=	TMQuery(pQuery^).GetFld('DataKbn').AsInteger;
                // end;
                //@ Unsupported function or procedure: 'Close'
                Close;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(D): 'Clear'
                m_FdqCopInfo.SQL.Clear;
                // (*H0032 20030130 khattori 部署入力でFunction制御が動作しない*)
                // ' AND DataKbn=0'+
                // (*H0002	20010523 khattori メニュー制御情報による排他*)
                // ' AND DataKbn='		+IntToStr(iHassei)+
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                m_FdqCopInfo.SQL.Add("select ExecKbn from MasMenuInfo" + " where SysCode=" + (m_pRec.m_iSystemCode * 100 + m_pRec.m_iOptionCode).ToString() + " AND DataKbn=" + (iHassei).ToString() + " AND ((UserKbn=" + (m_iSyoriKbn).ToString() + ") or(UserKbn=99))" + " AND ExecID=" + (iOwn).ToString() + " AND ExecKbn=1;");
                //@ Unsupported property or method(D): 'Open'
                m_FdqCopInfo.Open;
                // レコード有りなら、動作不能とみなす。
                //@ Unsupported function or procedure: 'eof'
                if (!eof)
                {
                    result = 'y';
                }
                //@ Unsupported function or procedure: 'Close'
                Close;
            // ---<HIS-014> 保留-------------------------------------------------------------
            // //	担当者別制御
            // if	(m_pRec^.m_iSystemCode div 1000)=3	then
            // begin
            // //	１回だけ
            // if	Length(m_irPrgId)=0	then
            // begin
            // SetLength(m_irPrgId,1);
            // SQL.Clear;
            // SQL.Add('select GrpNO from SwkTantoGrp'+
            // ' where SysCode='	+IntToStr(m_pRec^.m_iSystemCode));
            // SQL.Add('AND TantoNCD=');
            // SQL.Add(IntToStr(rcCOMMONAREA(m_pRec^.m_pCommonArea^).TantoNCD));
            // SQL.Add(';');
            // Open;
            // if	not eof then
            // begin
            // iGroup	:=GetFld('GrpNO').AsInteger;
            // Close;
            // SQL.Clear;
            // SQL.Add('select SyrCode1,SyrCode2 from GrpSwkCtl'+
            // ' where SysCode='	+IntToStr(m_pRec^.m_iSystemCode)+
            // ' AND GrpNO='		+IntToStr(iGroup)+';');
            // Open;
            // while not eof do
            // begin
            // SetLength(m_irPrgId,Length(m_irPrgId)+1);
            // m_irPrgId[Length(m_irPrgId)-1][0]	:=GetFld('SyrCode1').AsInteger;
            // m_irPrgId[Length(m_irPrgId)-1][1]	:=GetFld('SyrCode2').AsInteger;
            // next;
            // end;
            // end;
            // Close;
            // end;
            // for idx := 1 to Length(m_irPrgId)-1	do
            // begin
            // if	(m_irPrgId[idx][0]=310000)or
            // (m_irPrgId[idx][0]=311200)or
            // (m_irPrgId[idx][0]=311300)or
            // (m_irPrgId[idx][0]=311400)or
            // (m_irPrgId[idx][0]=311500)	then
            // if	m_irPrgId[idx][0]<>m_pRec^.m_iProgramCode	then	continue;
            // if	((m_irPrgId[idx][0]			div 10)=31200)	and
            // ((m_pRec^.m_iProgramCode	div 10)=31200)		then
            // begin
            // if	m_irPrgId[idx][0]<>m_pRec^.m_iProgramCode	then	continue;
            // //	レコード有りなら、動作不能とみなす。
            // if	(m_irPrgId[idx][1] div 10)=(GetPrgId(iOwn) div 10)	then
            // begin
            // result:='z';
            // break;
            // end;
            // end;
            // //	レコード有りなら、動作不能とみなす。
            // if	m_irPrgId[idx][1]=GetPrgId(iOwn)	then
            // begin
            // result:='z';
            // break;
            // end;
            // end;
            // end;
            // ------------------------------------------------------------------<HIS-014>---
            }
            return result;
        }

#endif
    } // end TMASL310Item

    // __MASL310ITEMH_INC__
    // ******************************************************************************
    // Proccess	:	MASL310StatusBar
    // Name		:	K.Hattori(MJS)
    // Date		:	2000/12/08
    // Parameter	:
    // Return		:
    // ******************************************************************************
    public class TMASL310StatusBar
    {
        // Private 宣言
        private StatusBar MStatusBar = null;
        // Public 宣言
        // __MASL310ITEMB_INC__
        // ******************************************************************************
        // Proccess	:	MASL310StatusBar
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create( prm01)
        public TMASL310StatusBar(StatusBar prm01) : base()
        {
            MStatusBar = prm01;
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 文字セット
        // Parameter	:	pString	:	String
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetStatusBarText(string pString)
        {
            MStatusBar.Text = pString;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 文字ゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public string GetStatusBarText()
        {
            string result;
            result = MStatusBar.Text;
            return result;
        }

#endif
    } // end TMASL310StatusBar

    // __MASL310STATUSBARH_INC__
    // ******************************************************************************
    // Proccess	:	MASL310Func
    // Name		:	K.Hattori(MJS)
    // Date		:	2000/12/08
    // Parameter	:
    // Return		:
    // ******************************************************************************
    // <HIS-003> 2006/05/23 T.Yamaguchi	裏ファンクションクリック対応
    public class TMASL310Func: ArrayList
    {
        // Private 宣言
        private TMSPFunctionBar MSPFunctionBar = null;
        private int giCurPage = 0;
        // Public 宣言
        public int m_iOwner = 0;
        // 指示からセットされたら＝１
        // __MASL310STATUSBARB_INC__
        // ******************************************************************************
        // Proccess	:	MASL310Func
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // <HIS-003> 2006/05/23 T.Yamaguchi	裏ファンクションクリック対応
        // <HIS-031> 2008/02/21 T.Yamaguchi	ファンクションマウスクリックでエラーが発生することがある(M2で発生)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create( prm01)
        public TMASL310Func(TMSPFunctionBar prm01) : base()
        {
            MSPFunctionBar = prm01;
            // ---<HIS-003>------------------------------------------------------------------
            //@ Unsupported property or method(C): 'OnFunctionClick'
            MSPFunctionBar.OnFunctionClick = MFuncClick;
            // ------------------------------------------------------------------<HIS-003>---

        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 終了処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //@ Destructor  Destroy()
        ~TMASL310Func()
        {
            DeleteItem();
            base.Destroy();
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 削除処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void DeleteItem()
        {
            int idx;
            TMASL310IFunc pTMASL310IFunc;
            for (idx = 0; idx < this.Count; idx ++ )
            {
                if (this[idx] != null)
                {
                    pTMASL310IFunc = this[idx];
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pTMASL310IFunc);
                }
            }
            this.Clear();
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ファンクション一括セット
        // Parameter	:	pFunc	:	Pointer（ファンクションリスト）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetFuncItems(object pFunc, int iOwner)
        {
            int idx;
            m_iOwner = iOwner;
            DeleteItem();
            for (idx = 0; idx <= (((pFunc) as ArrayList).Count - 1); idx ++ )
            {
                // if	Sm.CurMonth.iFixMonth=1	then	TMASL310IFunc(TList(pFunc^).Items[idx]^).bEnabled:=1;
                this.Add(((pFunc) as ArrayList)[idx]);
            }
        }

        public void SetFuncItems(object pFunc)
        {
            SetFuncItems(pFunc, 0);
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ファンクション一件セット
        // Parameter	:	pFunc	:	Pointer（ファンクションリスト）
        // iFuncId	:	Integer（ファンクションＮＯ）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetFuncItem(object pFunc, int iFuncId)
        {
            int idx;
            TMASL310IFunc pTMASL310IFunc;
            m_iOwner = 0;
            for (idx = this.Count; idx <= (iFuncId - 1); idx ++ )
            {
                this.Add(null);
            }
            // 空きを埋める
            if (this[iFuncId - 1] != null)
            {
                pTMASL310IFunc = this[iFuncId - 1];
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pTMASL310IFunc);
            }
            this[iFuncId - 1] = pFunc;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ファンクションEnable一件セット
        // Parameter	:	pFunc	:	Pointer（ファンクションリスト）
        // iFuncId	:	Integer（ファンクションＮＯ）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetFuncEnable(bool bFunc, int iFuncId)
        {
            int idx;
            for (idx = this.Count; idx <= (iFuncId - 1); idx ++ )
            {
                this.Add(null);
            }
            // 空きを埋める
            if (this[iFuncId - 1] != null)
            {
                ((TMASL310IFunc)(this[iFuncId - 1])).bEnabled = bFunc;
            }
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 指定のファンクションのEnableを変更
        // Parameter	:	pFunc	:	Pointer（ファンクションリスト）
        // iFuncId	:	Integer（ファンクションＮＯ）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void ChgFuncEnable(bool bFunc, int iFuncId)
        {
            //@ Unsupported property or method(A): 'GetFuncCaption'
            if (MSPFunctionBar.GetFuncCaption(iFuncId) != "")
            {
                ((TMASL310IFunc)(this[iFuncId - 1])).bEnabled = bFunc;
                if ((iFuncId >= (giCurPage * 8)) && (iFuncId < ((giCurPage + 1) * 8)))
                {
                    //@ Unsupported property or method(A): 'SetFuncEnabled'
                    MSPFunctionBar.SetFuncEnabled(iFuncId, bFunc);
                }
            }
        }

        // function	GetFuncItems	():Pointer;
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ファンクション一件ゲット
        // Parameter	:	iFuncId	:	Integer（ファンクションＮＯ）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public object GetFuncItem(int iFuncId)
        {
            object result;
            int iCalc;
            iCalc = iFuncId;
            if (iCalc < 0)
            {
                iCalc = 0 - iCalc;
            }
            if ((iCalc > this.Count) || (iCalc == 0))
            {
                // if	(iFuncId>count)	or	(iFuncId=0)	then	result:=nil
                result = null;
            }
            else
            {
                if (iFuncId < 0)
                {
                    // マイナスの時、絶対位置
                    iFuncId = 0 - iFuncId;
                }
                else
                {
                    iFuncId = iFuncId + (giCurPage * 8);
                }
                // プラスの時、現在頁上の相対位置
                if (this[iFuncId - 1] != null)
                {
                    ((TMASL310IFunc)(this[iFuncId - 1])).iNumb = iFuncId;
                }
                result = this[iFuncId - 1];
            }
            return result;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ファンクション頁セット（次頁）
        // Parameter	:	なし
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void IncPage()
        {
            SetFuncPage(giCurPage + 1, true);
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ファンクション頁セット
        // Parameter	:	iPage	:	Integer（表示ページ 0,1,2..）
        // bForce	:	Boolean（強制区分　trueの時、同一頁指定でも更新）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetFuncPage(int iPage, bool bForce)
        {
            int idx;
            int iStridx;
            int iEndidx;
            int iEnable;
            string[] arStr;
            TMessage Msg;
            // 省略なら現在頁
            if ((iPage < 0))
            {
                iPage = giCurPage;
                bForce = true;
            }
            if ((iPage > ((this.Count - 1) / 8)))
            {
                iPage = 0;
            }
            // 最大頁数範囲外なら０
            if ((iPage != giCurPage) || (bForce == true))
            {
                iStridx = iPage * 8;
                iEndidx = iPage * 8 + 7;
                if (iEndidx > (this.Count - 1))
                {
                    iEndidx = this.Count - 1;
                }
                arStr = new string[iEndidx - iStridx + 1];
                for (idx = iStridx; idx <= iEndidx; idx ++ )
                {
                    if (this[idx] != null)
                    {
                        if (((TMASL310IFunc)(this[idx])).iOpCode != 0)
                        {
                            iEnable = 1;
                            if (((TMASL310IFunc)(this[idx])).bEnabled == false)
                            {
                                iEnable = 0;
                            }
                            arStr[idx - (iPage * 8)] = " F" + (idx + 1 - (iPage * 8)).ToString() + ' ' + ((TMASL310IFunc)(this[idx])).sCaption + ',' + (iEnable).ToString();
                        }
                    }
                }
                giCurPage = iPage;
            }
            //@ Unsupported property or method(A): 'CopyFuncData'
            MSPFunctionBar.CopyFuncData(arStr);
            //@ Unsupported function or procedure: 'FillChar'
            FillChar(Msg, sizeof(Msg), 0);
            //@ Unsupported property or method(C): 'Msg'
            Msg.Msg = 1001;
            //@ Unsupported property or method(A): 'MjsMessage'
            //@ Unsupported property or method(D): 'LParam'
            Msg.LParam = 1 - MSPFunctionBar.MjsMessage(Msg);
            //@ Unsupported property or method(D): 'LParam'
            //@ Unsupported property or method(D): 'LParam'
            if (((this.Count <= 8) && (Msg.LParam == 0)) || ((this.Count > 8) && (Msg.LParam == 1)))
            {
                //@ Unsupported property or method(D): 'Msg'
                Msg.Msg = 1000;
                //@ Unsupported property or method(A): 'MjsMessage'
                MSPFunctionBar.MjsMessage(Msg);
            }
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ファンクション頁ゲット
        // Parameter	:	なし
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public int GetFuncPage()
        {
            int result;
            result = giCurPage;
            return result;
        }

        public TMSPFunctionBar GetFuncControl()
        {
            TMSPFunctionBar result;
            result = MSPFunctionBar;
            return result;
        }

        // ---<HIS-003>------------------------------------------------------------------
        // ---<HIS-003>------------------------------------------------------------------
        // ******************************************************************************
        // Component : MSPFunctionBar ( TMSPFunctionBar )
        // Event     : OnFunctionClick
        // Comment	  :	FuncNo=1000 は 裏ファンクションクリック として F9 押下として動作する
        // ******************************************************************************
        public void MFuncClick(Object Sender, int FuncNo)
        {
            // ---<HIS-031> SetComponentInfo は使用しない------------------------------------
            ushort Key;
            switch(FuncNo)
            {
                // Modify the A .. B: 1 .. 8
                case 1:
                    // F1〜F8
                    //@ Undeclared identifier(3): 'VK_F1'
                    Key = VK_F1 + FuncNo - 1;
                    break;
                case 1000:
                    // 裏ﾌｧﾝｸｼｮﾝ(F9)
                    //@ Undeclared identifier(3): 'VK_F9'
                    Key = VK_F9;
                    break;
                default:
                    return;
                    break;
            }
            //@ Unsupported property or method(C): 'ActiveControl'
            //@ Unsupported property or method(D): 'Handle'
            //@ Undeclared identifier(3): 'WM_KEYDOWN'
            //@ Unsupported function or procedure: 'PostMessage'
            PostMessage(Screen.PrimaryScreen.ActiveControl.Handle, WM_KEYDOWN, Key, 0);
        }

        // begin
        // //	裏ファンクション
        // if FuncNo = 1000 then
        // PostMessage(Screen.ActiveControl.Handle, WM_KEYDOWN, VK_F9, 0);
        // end;
        // ------------------------------------------------------------------<HIS-031>---
        // ------------------------------------------------------------------<HIS-003>---
#endif
    } // end TMASL310Func

    // __MASL310FUNCH_INC__
    // <HIS-060> 2009/09/07 T.Yamaguchi	ウィンドウ コードによる絞り込み機能を追加
    public class TMASL310Head: TMPanel
    {
        // Private 宣言
        // LMLabel			:	TMLabel;	//	連想対応　HIS-IWA-0001
        private TMNumEdit EMNumEditCode = null;
        private TMTxtEdit EMTxtEditName = null;
        private TWTableID sPKind;
        private int iPType = 0;
        private int iPKind = 0;
        private int m_iIndex = 0;
        private int iRight = 0;
        private TMASL310Head[] PMSiwakexx;
        private int m_iCount = 0;
        private int m_iKGCode = 0;
        // 科目外部コード
        private int m_iSACode = 0;
        // 要約分析
        private int m_iBPKbn = 0;
        // ＢＳ／ＰＬ
        private int m_iDCKbn = 0;
        // 正残区分	HIS-IWA-0001
        private int m_iUseKbn = 0;
        // 採用区分	HIS-IWA-0001
        private int m_iCodeDigit = 0;
        // コード桁数	HIS-IWA-0006
        // m_sGCode		:	String;		//	外部コード
        private int[] m_iAnalyzeCode;
        private TMASL310IDrParam m_DrParam = null;
        // Public 宣言
        public object cRoot = null;
        public Control cFirstComp = null;
        // 2001/09/21 Ins
        public Control cPrevComp = null;
        public object cNextComp = null;
        public Control cEditComp = null;
        // __MASL310FUNCB_INC__
        // ******************************************************************************
        // Proccess	:	TMASL310Head	（基底クラス）
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // (*H0001	20010529 khattori ウィンドウ表示順序のとき、空白は非表示ー＞出納帳の当該だけ*)
        // (*H0002	20010710 khattori 最後が共通部門等のときエラー*)
        // (*H0003	20010718 khattori 出納帳の当該でＢＳ部門が表示されない*)
        // (*H0004	20010821 tyamaguchi クリックできないように修正*)
        // (*H0005 20010921 tyamaguchi 定型仕訳対応*)
        // (*H0006 20020329 khattori 新規連想パーツ対応*)
        // <HIS-060> 2009/09/07 T.Yamaguchi	ウィンドウ コードによる絞り込み機能を追加
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create( AOwner,  iNo,  iLeft,  iWidth,  iCapLength)
        public TMASL310Head(object AOwner, int iNo, int iLeft, int iWidth, int iCapLength) : base(AOwner)
        {
            object vTab;
            //@ Undeclared identifier(3): 'Parent'
            Parent = ((AOwner) as Control);
            //@ Undeclared identifier(3): 'Left'
            Left = iLeft;
            //@ Undeclared identifier(3): 'Width'
            Width = iWidth;
            //@ Undeclared identifier(3): 'Height'
            Height = ((AOwner) as Control).Height;
            //@ Undeclared identifier(3): 'ParentColor'
            ParentColor = true;
            //@ Undeclared identifier(3): 'bvNone'
            //@ Undeclared identifier(3): 'BevelOuter'
            BevelOuter = bvNone;
            //@ Undeclared identifier(3): 'Visible'
            Visible = false;
            vTab = Units.MAS310000u.HDRD0X_WIDTH + iCapLength;
            // HIS-IWA-0001　[+ iCapLength]追加
            //@ Undeclared identifier(3): 'Name'
            Name = "PMASLHdRd0" + (iNo).ToString();
            // HIS-IWA-0001　[(iLeft/vTab)+1]→[iNo]
            // 連想対応　HIS-IWA-0001
            // LMLabel				:=	TMLabel.Create(Self);
            // with LMLabel do
            // begin
            // Parent			:=	Self;
            // Width			:=	iCapLength;
            // Height			:=	Self.Height;
            // end;
            EMTxtEditName = new TMTxtEdit(this);
            //@ Unsupported property or method(C): 'Parent'
            EMTxtEditName.Parent = this;
            //@ Unsupported property or method(C): 'Left'
            EMTxtEditName.Left = iCapLength;
            //@ Unsupported property or method(C): 'Width'
            EMTxtEditName.Width = iWidth - iCapLength;
            //@ Unsupported property or method(C): 'Height'
            //@ Unsupported property or method(C): 'Height'
            EMTxtEditName.Height = this.Height;
            //@ Unsupported property or method(C): 'OnEnter'
            EMTxtEditName.OnEnter = TxtNameEnter;
            //@ Unsupported property or method(C): 'Name'
            //@ Unsupported property or method(C): 'Name'
            EMTxtEditName.Name = this.Name + "TxNm";
            EMNumEditCode = new TMNumEdit(this);
            //@ Unsupported property or method(C): 'Parent'
            EMNumEditCode.Parent = this;
            //@ Unsupported property or method(C): 'Left'
            EMNumEditCode.Left = iCapLength;
            //@ Unsupported property or method(C): 'Width'
            EMNumEditCode.Width = iWidth - iCapLength;
            //@ Unsupported property or method(C): 'Height'
            //@ Unsupported property or method(C): 'Height'
            EMNumEditCode.Height = this.Height;
            //@ Unsupported property or method(C): 'OnEnter'
            EMNumEditCode.OnEnter = xxxCodeEnter;
            //@ Unsupported property or method(C): 'OnExit'
            EMNumEditCode.OnExit = xxxCodeExit;
            //@ Unsupported property or method(C): 'OnKeyDown'
            EMNumEditCode.OnKeyDown = xxxCodeKeyDown;
            // ---<HIS-060>------------------------------------------------------------------
            //@ Unsupported property or method(C): 'OnChange'
            EMNumEditCode.OnChange = xxxCodeChange;
            // ------------------------------------------------------------------<HIS-060>---
            //@ Unsupported property or method(C): 'TabStop'
            EMNumEditCode.TabStop = false;
            //@ Unsupported property or method(C): 'imDisable'
            //@ Unsupported property or method(C): 'ImeMode'
            EMNumEditCode.ImeMode = EMNumEditCode.imDisable;
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'InputFlag'
            EMNumEditCode.InputFlag = false;
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Zero'
            EMNumEditCode.Zero = true;
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'InputFlagEnabled'
            EMNumEditCode.InputFlagEnabled = true;
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Negative'
            EMNumEditCode.Negative = false;
            // HIS-IWA-0001　追加
            m_iIndex = iNo;
            // HIS-IWA-0001　[(iLeft/vTab)+1]→[iNo]

        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 終了処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //@ Destructor  Destroy()
        ~TMASL310Head()
        {
            //@ Unsupported property or method(C): 'Free'
            EMTxtEditName.Free;
            //@ Unsupported property or method(C): 'Free'
            EMNumEditCode.Free;
            // LMLabel.Free;												//	連想対応　HIS-IWA-0001
            base.Destroy();
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // SetCaption
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // HIS-IWA-0001
        // procedure	TMASL310Head.SetCaption	(sName : String);
        // begin
        // LMLabel.Caption:=sName;
        // end;
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // SetNumCode
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetNumCode(long iCode, bool bClear)
        {
            //@ Unsupported property or method(C): 'Value'
            EMNumEditCode.Value = iCode;
            // HIS-IWA-0001　Zeroを考慮
            if (iCode == 0)
            {
                if (bClear == true)
                {
                    //@ Unsupported property or method(A): 'Clear'
                    EMNumEditCode.Clear();
                    //@ Unsupported property or method(C): 'InputFlag'
                    EMNumEditCode.InputFlag = true;
                }
                else
                {
                    //@ Unsupported property or method(C): 'InputFlag'
                    EMNumEditCode.InputFlag = false;
                }
            }
        }

        // procedure	SetCaption	(sName : String);							//	HIS-IWA-0001
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // SetTxtName
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetTxtName(string sName)
        {
            //@ Unsupported property or method(C): 'Text'
            EMTxtEditName.Text = sName;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // SetWndParam
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public TWDspParamTbl SetWndParam(TWTableID wtPKind, bool bRen)
        {
            TWDspParamTbl result;
            int iIndex;
            TWDspParamTbl rDspParam;
            rDspParam.TableID = wtPKind;
            // ﾃｰﾌﾞﾙID
            rDspParam.DspParam.Filt = false;
            // ﾌｨﾙﾀ区分
            rDspParam.DspParam.Page = 0;
            switch(wtPKind)
            {
                case VKZ310Cmnu.TWTableID.wtiKanjoKmk:
                    // 表示ﾍﾟｰｼﾞ
                    // 科目
                    rDspParam.DCDsp = 3;
                    // 貸借区分			（貸借入力のみ表示）
                    rDspParam.FukugoDsp = false;
                    // 複合表示区分		（表示無し）
                    rDspParam.KaikeDsp = VKZ310Cmnu.TWKaikeDsp.wkdBoth;
                    // 会計/非会計表示区分	（両方あり）
                    rDspParam.WinDspInfo = !bRen;
                    // ｳｨﾝﾄﾞｳ表示順序
                    // (*H0001	20010529 khattori ウィンドウ表示順序のとき、空白は非表示ー＞出納帳の当該だけ*)
                    rDspParam.Suitoutyou = 1;
                    // 1=出納帳 2001/05/29
                    // 分析ｺｰﾄﾞ
                    rDspParam.KmkParamD.AnalyzeCode = new int[m_iAnalyzeCode.Length];
                    // 配列の長さを合わせる
                    for (iIndex = 0; iIndex < m_iAnalyzeCode.Length; iIndex ++ )
                    {
                        rDspParam.KmkParamD.AnalyzeCode[iIndex] = m_iAnalyzeCode[iIndex];
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiSaimkKmk:
                    // 細目科目
                    rDspParam.KmkParamD.GCode = m_iKGCode;
                    break;
                case VKZ310Cmnu.TWTableID.wtiBumon:
                case VKZ310Cmnu.TWTableID.wtiSeg1:
                case VKZ310Cmnu.TWTableID.wtiSeg2:
                case VKZ310Cmnu.TWTableID.wtiSeg3:
                case VKZ310Cmnu.TWTableID.wtiSeg4:
                    // 科目外部ｺｰﾄﾞ
                    // 部門
                    // ｾｸﾞﾒﾝﾄ	1
                    // 2
                    // 3
                    // 4
                    rDspParam.DCDsp = m_iDCKbn;
                    // 科目正残区分
                    // (*H0003	20010718 khattori 出納帳の当該でＢＳ部門が表示されない*)
                    rDspParam.KmkParamD.SumAnaCode = m_iSACode;
                    // 要約分析ｺｰﾄﾞ
                    rDspParam.KmkParamD.BPKbn = m_iBPKbn;
                    // BS/PL区分
                    if (m_iBPKbn == 0)
                    {
                        // 部門表示区分
                        // BSは科目に従う
                        rDspParam.DspParamBum.BumDsp = VKZ310Cmnu.TWBumDsp.wbdKmk;
                    }
                    else
                    {
                        rDspParam.DspParamBum.BumDsp = VKZ310Cmnu.TWBumDsp.wbdPL1;
                        // PLは[PL]+[BS+PL]
                        rDspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcTujo] = true;
                        // 部門性格区分は全てTrue
                        rDspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcEgyo] = true;
                        rDspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcSezo] = true;
                        rDspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcKnri] = true;
                        rDspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcEgKn] = true;
                        rDspParam.DspParamBum.DspChar[VKZ310Cmnu.TWBumChar.wbcSeKn] = true;
                    }
                    break;
                case VKZ310Cmnu.TWTableID.wtiKoji:
                    // 工事
                    rDspParam.KojiDsp = VKZ310Cmnu.TWKojiDsp.wkdAll;
                    break;
            // 全件表示（完成工事込み）
            // wtiKosh:		//	工種
            // wtiGinko:		//	銀行
            // wtiTrhksaki:	//	取引先
            // wtiTkisaki:		//	得意先
            // wtiSirsaki:		//	仕入先
            // wtiShain:		//	社員
            // wtiHanyo1:		//	汎用補助1
            // wtiHanyo2:		//			2
            // wtiHanyo3:		//			3
            // wtiHanyo4:		//			4
            // wtiHanyo5:		//			5
            }
            result = rDspParam;
            return result;
        }

        // HIS-IWA-0001　Integer→Int64、bClear追加
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxCodeEnter
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void xxxCodeEnter(Object Sender)
        {
            int iPar;
            int iPage;
            int iIndex;
            TWDspParamTbl rDspParam;
            bool bVal;
            int iStDate;
            // HIS-IWA-0001
            int iEdDate;
            ((TWParam)((((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM)))).Sender = ((Sender) as Control);
            ((cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_ParamSet, ((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM));
            // rDspParam.DspParam.Filt			:=	true;		//	フィルタ区分
            // rDspParam.DspParam.Page			:=	0;			//	表示ページ
            // rDspParam.TableID				:=	sPKind;		//	テーブルＩＤ
            // rDspParam.DCDsp					:=	3;			//	借方／貸方表示区分
            // rDspParam.DspParamBum.BumDsp	:=	wbdKmk;		//	部門表示区分　−＞　科目に従う
            // rDspParam.FukugoDsp				:=	false;		//	複合表示区分
            // rDspParam.KaikeDsp				:=	wkdBoth;	//	会計/非会計表示区分
            // if	sPKind=wtiSaimkKmk
            // then	rDspParam.KmkParamD.Gcode		:=	m_iKGCode	//	外部ｺｰﾄﾞ
            // else	rDspParam.KmkParamD.Gcode		:=	0;			//	外部ｺｰﾄﾞ
            // rDspParam.KmkParamD.SumAnaCode	:=	m_iSACode;	//	要約分析ｺｰﾄﾞ
            // rDspParam.KmkParamD.BPKbn		:=	m_iBPKbn;	//	BS/PL区分
            // HIS-IWA-0001　↑ｺﾒﾝﾄ、↓新規
            // 仕訳入力のとき
            if ((((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE) == 310101))
            {
                iPar = 10;
                // 定型仕訳入力のとき
                if (((int)((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar)) == 0)
                {
                    // 入力された伝票日付
                    iPar = 4;
                    iStDate = ((int)((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                    iEdDate = ((int)((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                // 仕訳入力のとき
                }
                else
                {
                    iStDate = ((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_STR_DATE);
                    // 当該月の開始
                    iEdDate = ((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_END_DATE);
                // 当該月の終了
                }
            // 定型仕訳登録のとき
            }
            else
            {
                // 適用期間無視
                iStDate = 0;
                iEdDate = 0;
            }
            // HIS-IWA-0001　適用期間指定（指示月の範囲を指定）
            // iStDate := TMASL310Root(cRoot).Ifnc( MASL_IGET_STR_DATE );
            // iEdDate := TMASL310Root(cRoot).Ifnc( MASL_IGET_END_DATE );
            ((cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_SetDate, iStDate, iEdDate);
            //@ Unsupported property or method(C): 'Tag'
            if (((PMSiwakexx[0]) as TMASL310HeadAc).EMTxtRenso.Tag == 0)
            {
                // ---<HIS-060>------------------------------------------------------------------
                ((PMSiwakexx[0]) as TMASL310HeadAc).m_sRen = "";
                // ------------------------------------------------------------------<HIS-060>---
                rDspParam = SetWndParam(sPKind, false);
                // ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ設定
                ((cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_Dsp, rDspParam);
            }
            else
            {
                //@ Unsupported property or method(C): 'Tag'
                ((PMSiwakexx[0]) as TMASL310HeadAc).EMTxtRenso.Tag = 0;
            }
            // 連想ﾌﾗｸﾞをOffに
            bVal = true;
            ((cRoot) as TMASL310Root).Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_WND_VSBLE, bVal);
            ((cRoot) as TMASL310Root).Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_ACTV_CTRL, Sender);
            ((cRoot) as TMASL310Root).Vfnc(VKZ310Cmnu.enVfunc.MASL_VINI_FNC_ITEM);
            iPage = 0;
            ((cRoot) as TMASL310Root).Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_PAGE, iPage);
            ((Sender) as Control).BringToFront();
            for (iIndex = m_iIndex; iIndex <= m_iCount; iIndex ++ )
            {
                //@ Unsupported property or method(C): 'Enabled'
                PMSiwakexx[iIndex].Enabled = false;
            }
            if (iPType == 0)
            {
                //@ Undeclared identifier(3): 'TMNumEdit'
                //@ Unsupported property or method(D): 'SelectAll'
                TMNumEdit(cEditComp).SelectAll;
            }
            else
            {
                //@ Undeclared identifier(3): 'TMTxtEdit'
                //@ Unsupported property or method(D): 'SelectAll'
                TMTxtEdit(cEditComp).SelectAll;
            }
            // PMSiwakexx[m_iCount].cNextComp.Enabled	:=	false;
            ((PMSiwakexx[0]) as TMASL310HeadAc).m_iRenLength = 0;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxCodeExit
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void xxxCodeExit(Object Sender)
        {
            //@ Unsupported property or method(C): 'BringToFront'
            EMTxtEditName.BringToFront;
            //@ Unsupported property or method(A): 'Refresh'
            EMTxtEditName.Refresh();
            // 即時更新対応　HIS-IWA-0002
            ((cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_Clear);
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // KamokuCodeChange
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual void KamokuCodeChange()
        {

        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxCodeKeyDown
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual void xxxCodeKeyDown(Object Sender, ref ushort Key, Keys Shift)
        {
            TWParam WndParam;
            string sInpCode;
            bool bWndSelMode;
            TWDspParamTbl rDspParam;
            // (*♪♪♪*)
            TMASL310IFunc rFunc;
            int iPar;
            int iAct;
            TWMKey Msg;
            int iLoop;
            ((cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_KeyDown, Key, Shift);
            // if (Key=VK_RETURN) or ( Key = VK_TAB )
            //@ Undeclared identifier(3): 'VK_RETURN'
            //@ Undeclared identifier(3): 'VK_TAB'
            if (((Key == VK_RETURN) || (Key == VK_TAB)) && (Shift == new object[] {}))
            {
                WndParam = ((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM);
                if ((WndParam.Code == ""))
                {
                    switch(iPType)
                    {
                        case 0:
                            // HIS-IWA-0001　Zero対応
                            //@ Undeclared identifier(3): 'TMNumEdit'
                            //@ Unsupported property or method(D): 'Text'
                            if (TMNumEdit(Sender).Text == "")
                            {
                                // (*♪♪♪*)
                                // 定型登録で科目以外は省略可
                                if ((((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE) == 311801) && (sPKind != VKZ310Cmnu.TWTableID.wtiKanjoKmk))
                                {
                                    sInpCode = "";
                                }
                                else
                                {
                                    Console.Beep();
                                    return;
                                }
                            }
                            // 前Zero考慮　HIS-IWA-0003
                            // sInpCode:= IntToStr(Trunc(TMNumEdit(Sender).Value));
                            //@ Undeclared identifier(3): 'TMNumEdit'
                            //@ Unsupported property or method(D): 'Text'
                            sInpCode = TMNumEdit(Sender).Text;
                            break;
                        case 1:
                            //@ Undeclared identifier(3): 'TMTxtEdit'
                            //@ Unsupported property or method(D): 'Text'
                            sInpCode = TMTxtEdit(Sender).Text;
                            break;
                    }
                    bWndSelMode = ((cRoot) as TMASL310Root).Bfnc(VKZ310Cmnu.enBfunc.MASL_BGET_WND_SELMODE);
                    ((cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_SearchDataB, sInpCode, bWndSelMode);
                    // HIS-IWA-0004　ｳｨﾝﾄﾞｳ選択ﾌﾗｸﾞを参照する様に変更
                    bWndSelMode = false;
                    ((cRoot) as TMASL310Root).Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_WND_SELMODE, bWndSelMode);
                }
                if (WndParam.Code != "")
                {
                    switch(iPType)
                    {
                        case 0:
                            SetNumCode(Convert.ToInt64(WndParam.Code));
                            break;
                        case 1:
                            // HIS-IWA-0001　[StrToInt]→[StrToInt64]
                            //@ Undeclared identifier(3): 'TMTxtEdit'
                            //@ Unsupported property or method(D): 'Text'
                            TMTxtEdit(Sender).Text = WndParam.Code;
                            break;
                    }
                    SetTxtName(WndParam.Name);
                    WndParam.Code = "";
                    WndParam.Name = "";
                    // 科目か？
                    if (sPKind == VKZ310Cmnu.TWTableID.wtiKanjoKmk)
                    {
                        KamokuCodeChange();
                    }
                }
                else
                {
                    // (*♪♪♪*)
                    // 定型登録で科目以外は省略可
                    if ((((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE) == 311801) && (sInpCode == "") && (sPKind != VKZ310Cmnu.TWTableID.wtiKanjoKmk))
                    {
                        SetTxtName("");
                    // sInpCode:= '';
                    }
                    else
                    {
                        if (iPType == 0)
                        {
                            //@ Undeclared identifier(3): 'TMNumEdit'
                            //@ Unsupported property or method(D): 'SelectAll'
                            TMNumEdit(cEditComp).SelectAll;
                        }
                        else
                        {
                            //@ Undeclared identifier(3): 'TMTxtEdit'
                            //@ Unsupported property or method(D): 'SelectAll'
                            TMTxtEdit(cEditComp).SelectAll;
                        }
                        Console.Beep();
                        new Exception("Abort");
                    }
                }
            }
            //@ Undeclared identifier(3): 'VK_RETURN'
            //@ Undeclared identifier(3): 'VK_LEFT'
            //@ Undeclared identifier(3): 'VK_TAB'
            if ((Key == VK_RETURN) || (Key == VK_LEFT) || (Key == VK_TAB))
            {
                //@ Undeclared identifier(3): 'VK_LEFT'
                if ((Shift == new System.Windows.Forms.Keys[] {System.Windows.Forms.Keys.Shift}) || (Key == VK_LEFT))
                {
                    // (*H0005 20010921 tyamaguchi 定型仕訳対応*)
                    if (cPrevComp.CanFocus)
                    {
                        cPrevComp.Focus();
                    }
                    else
                    {
                        cFirstComp.Focus();
                    }
                // if (Shift=[ssShift]) or (Key=VK_LEFT) then	cPrevComp.SetFocus
                }
                else
                {
                    // 自分の子供か？
                    //@ Undeclared identifier(3): 'Parent'
                    //@ Unsupported property or method(B): 'ContainsControl'
                    if (Parent.ContainsControl(cNextComp) == false)
                    {
                        ((PMSiwakexx[0]) as TMASL310HeadAc).m_bEnable = true;
                        SetDrillPar();
                        // (*♪♪♪*)
                        rFunc = ((TMASL310IFunc)(((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DEF_FUNC)));
                        if (rFunc.iOpCode != 0)
                        {
                            iPar = 10;
                            iAct = ((int)((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD, iPar));
                            // ---<HIS-010>------------------------------------------------------------------
                            if (((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE) == 311101)
                            {
                                // if	TMASL310Root(cRoot).Ifnc(MASL_IGET_FST_CODE)=310101	then
                                // ------------------------------------------------------------------<HIS-010>---
                                if (iAct == 0)
                                {
                                    rFunc.iMode = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEINYUURYOKU;
                                }
                                else
                                {
                                    rFunc.iMode = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU;
                                }
                            }
                            else if ((((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE) == 311801))
                            {
                                if (iAct == 0)
                                {
                                    rFunc.iMode = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEISYUUSEI;
                                }
                                else
                                {
                                    rFunc.iMode = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU;
                                }
                            }
                            if (rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEISYUUSEI)
                            {
                                ((cRoot) as TMASL310Root).FxHeadChange(0, 0, "", "");
                            }
                            ((cRoot) as TMASL310Root).DoAction(rFunc);
                            //@ Unsupported property or method(C): 'Parent'
                            //@ Undeclared identifier(3): 'TMPanel'
                            //@ Unsupported property or method(D): 'Enabled'
                            TMPanel(((PMSiwakexx[0]) as TMASL310HeadAc).Parent).Enabled = false;
                        // (*H0004	20010821 tyamaguchi クリックできないように修正*)
                        }
                        else
                        {
                            //@ Unsupported property or method(D): 'Parent'
                            //@ Unsupported property or method(D): 'Enabled'
                            cNextComp.Parent.Enabled = true;
                            //@ Unsupported property or method(D): 'Enabled'
                            cNextComp.Enabled = true;
                            //@ Unsupported property or method(D): 'SetFocus'
                            cNextComp.SetFocus;
                        }
                    }
                    else
                    {
                        //@ Unsupported property or method(D): 'Parent'
                        //@ Unsupported property or method(D): 'Enabled'
                        cNextComp.Parent.Enabled = true;
                        //@ Unsupported property or method(D): 'Enabled'
                        cNextComp.Enabled = true;
                        //@ Unsupported property or method(D): 'SetFocus'
                        cNextComp.SetFocus;
                    }
                }
            }
            // 連想対応
            //@ Undeclared identifier(3): 'VK_HOME'
            if ((Key == VK_HOME) && (Shift == new object[] {}))
            {
                Key = 0;
                TMASL310HeadAc _wvar1 = ((PMSiwakexx[0]) as TMASL310HeadAc);
                //@ Unsupported property or method(C): 'VK_DELETE'
                //@ Unsupported property or method(C): 'CharCode'
                Msg.CharCode = _wvar1.VK_DELETE;
                //@ Unsupported property or method(C): 'Text'
                for (iLoop = 1; iLoop <= _wvar1.EMTxtRenso.Text.Length; iLoop ++ )
                {
                    //@ Unsupported property or method(C): 'Handle'
                    //@ Unsupported property or method(C): 'WM_KEYDOWN'
                    //@ Unsupported property or method(C): 'CharCode'
                    //@ Unsupported function or procedure: 'PostMessage'
                    PostMessage(_wvar1.EMTxtRenso.Handle, _wvar1.WM_KEYDOWN, Msg.CharCode, 0);
                }
                //@ Unsupported property or method(C): 'Text'
                _wvar1.EMTxtRenso.Text = "";
                _wvar1.oRenMoto = ((Sender) as Control);
                //@ Unsupported property or method(C): 'Parent'
                //@ Unsupported property or method(D): 'Left'
                _wvar1.EMTxtRenso.Parent.Left = ((Sender) as Control).Left + ((Sender) as Control).Parent.Left;
                //@ Unsupported property or method(C): 'Parent'
                //@ Unsupported property or method(D): 'Visible'
                _wvar1.EMTxtRenso.Parent.Visible = true;
                //@ Unsupported property or method(C): 'Tag'
                _wvar1.EMTxtRenso.Tag = 0;
                // 確定ﾌﾗｸﾞをOffに
                //@ Unsupported property or method(A): 'SetFocus'
                _wvar1.EMTxtRenso.SetFocus();
                rDspParam = _wvar1.SetWndParam(this.sPKind, true);
                // ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ設定
                ((_wvar1.cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_Dsp, rDspParam);
                //@ Unsupported property or method(C): 'Parent'
                //@ Unsupported property or method(D): 'BringToFront'
                _wvar1.EMTxtRenso.Parent.BringToFront;
            }
            //@ Undeclared identifier(3): 'VK_HOME'
            //@ Undeclared identifier(3): 'VK_END'
            //@ Undeclared identifier(3): 'VK_ESCAPE'
            if (((Key == VK_HOME) || (Key == VK_END) || (Key == VK_ESCAPE)) && (Shift == new object[] {}))
            {
                // 第1指示へ移動
                Key = 0;
                // (*H0005 20010921 tyamaguchi 定型仕訳対応*)
                cFirstComp.Focus();
            // TMASL310HeadAc(PMSiwakexx[0]).cPrevComp.SetFocus();
            }
        }

        // ---<HIS-060>------------------------------------------------------------------
        // ******************************************************************************
        // Component : TMNumEdit, TMTxtEdit
        // Event     : OnChange
        // History	  :	<HIS-060>
        // ******************************************************************************
        public void xxxCodeChange(Object Sender)
        {
            int iFld;
            string sRen;
            if ((PMSiwakexx[0] != null))
            {
                TMASL310HeadAc _wvar1 = ((PMSiwakexx[0]) as TMASL310HeadAc);
                if (_wvar1.m_pCodeAssoc == 1)
                {
                    iFld = 1;
                    sRen = _wvar1.m_sRen;
                    ((_wvar1.cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_RenChange, Sender, iFld, sRen);
                }
            }
        }

        // (*♪♪♪♪♪*)
        // <カード型>
        // 以前の規約では、「←」「→」のキーは、無条件にフィールド移動となっています。
        // これを、次のように場合分けします。
        // @　文字列フィールド（文字列あり）にフォーカスが来たときに、　「←」「→」を押す。
        // （処理）全反転を消し、文字列の右端にアイビームを点滅させる。
        // A　文字列フィールド内の動作は、以下の表を参照
        // 位置
        // 左端			その他			右端
        // キー	←		前パーツ等		文字一つ分左へ	文字一つ分左へ
        // →		文字一つ分右へ	文字一つ分右へ	次パーツ等
        // ↑、↓	前後のパーツ等	前後のパーツ等	前後のパーツ等
        // B	文字列フィールド以外は、従来の動きでOKです。
        // ※ 参考ですが、@Aの実現のために、2000/10/26の環境で追加された次の関数を使用します。
        // その関数の概略を記します。環境（AP関数\DOC）にもドキュメントがあります。
        // 【 AP関数 】
        // ○カーソル位置チェック関数の追加　（　MjsCommon　）
        // ・テキスト系コンポーネントのカーソル位置が先頭・末尾か？先頭行、最終行か？を検証します。
        // function	MjsChkCurTop( SrcCompo: TComponent ):boolean;
        // function	MjsChkCurEnd( SrcCompo: TComponent ):boolean;
        // function 	MjsChkLineTop( SrcCompo: TComponent ):boolean;
        // function 	MjsChkLineEnd( SrcCompo: TComponent ):boolean;
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // SetDrillPar
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public bool SetDrillPar()
        {
            bool result;
            TMASL310IDrParam pParam;
            // (*♪♪♪♪♪*)
            TMASL310IDrParam cParam;
            int iIndex;
            TWTableID sKind;
            int iLength;
            string sGCode;
            bool bAttr;
            // (*♪♪♪♪♪*)
            result = false;
            cParam = ((TMASL310IDrill)(((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DRL_PARM))).ToCld;
            pParam = (((TMASL310IDrill)(((cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DRL_PARM))).ToCld);
            pParam = m_DrParam;
            // ドリルダウンパラメーター（初期化用）
            pParam.Efct = true;
            // 有効にする（デフォルト＝false）
            pParam.Kamk[0] = PMSiwakexx[0].m_iKGCode;
            for (iIndex = 1; iIndex <= m_iCount; iIndex ++ )
            {
                sKind = PMSiwakexx[iIndex].sPKind;
                // 科目、細目科目は数値のみ
                if (sKind == VKZ310Cmnu.TWTableID.wtiSaimkKmk)
                {
                    // (*♪♪♪*)
                    // 定型登録で科目以外は省略可
                    //@ Unsupported property or method(C): 'InputFlag'
                    //@ Unsupported property or method(C): 'Value'
                    if ((((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE) == 311801) && (PMSiwakexx[iIndex].EMNumEditCode.InputFlag == true) && ((PMSiwakexx[iIndex].EMNumEditCode.Value as object) == 0))
                    {
                        // 細目科目
                        pParam.Saik[0] =  -1;
                    }
                    else
                    {
                        //@ Unsupported property or method(C): 'Value'
                        pParam.Saik[0] = (PMSiwakexx[iIndex].EMNumEditCode.Value as object);
                    }
                    // 細目科目
                    pParam.Saiu[0] = 1;
                // 追加　HIS-IWA-0001
                }
                else
                {
                    // ＝０のとき数値
                    if (PMSiwakexx[iIndex].iPType == 0)
                    {
                        bAttr = false;
                        // (**)
                        //@ Unsupported property or method(C): 'Value'
                        sGCode = (Convert.ToInt64(PMSiwakexx[iIndex].EMNumEditCode.Value)).ToString();
                    // sGCode	:=	IntToStr(Variant(PMSiwakexx[iIndex].EMNumEditCode.Value));
                    }
                    else
                    {
                        bAttr = true;
                        //@ Unsupported property or method(C): 'Text'
                        sGCode = ((PMSiwakexx[iIndex]) as TMASL310HeadOt).EMTxtEditCode.Text;
                    }
                    // 固定
                    iLength = 10;
                    //@ Undeclared identifier(3): 'TMASCom'
                    //@ Unsupported property or method(B): 'SetCodeAttr'
                    sGCode = TMASCom(((cRoot) as TMASL310Root).m_pRec.m_pSystemArea).SetCodeAttr(sGCode, iLength, bAttr);
                    // (*♪♪♪*)
                    // 定型登録で科目以外は省略可
                    //@ Unsupported property or method(C): 'InputFlag'
                    //@ Unsupported property or method(C): 'Value'
                    if ((PMSiwakexx[iIndex].iPType == 0) && (((cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE) == 311801) && (PMSiwakexx[iIndex].EMNumEditCode.InputFlag == true) && ((PMSiwakexx[iIndex].EMNumEditCode.Value as object) == 0))
                    {
                        sGCode = "";
                    }
                    switch(sKind)
                    {
                        case VKZ310Cmnu.TWTableID.wtiBumon:
                            pParam.Bmon[0] = sGCode;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg1:
                            // 部門
                            pParam.Seg1[0] = sGCode;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg2:
                            // ｾｸﾞﾒﾝﾄ1
                            pParam.Seg2[0] = sGCode;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg3:
                            // ｾｸﾞﾒﾝﾄ2
                            pParam.Seg3[0] = sGCode;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg4:
                            // ｾｸﾞﾒﾝﾄ3
                            pParam.Seg4[0] = sGCode;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiKoji:
                            // ｾｸﾞﾒﾝﾄ4
                            pParam.Koji[0] = sGCode;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiKosh:
                            // 工事
                            pParam.Kshu[0] = sGCode;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiGinko:
                        case VKZ310Cmnu.TWTableID.wtiTrhksaki:
                        case VKZ310Cmnu.TWTableID.wtiTkisaki:
                        case VKZ310Cmnu.TWTableID.wtiSirsaki:
                        case VKZ310Cmnu.TWTableID.wtiShain:
                        case VKZ310Cmnu.TWTableID.wtiHanyo1:
                        case VKZ310Cmnu.TWTableID.wtiHanyo2:
                        case VKZ310Cmnu.TWTableID.wtiHanyo3:
                        case VKZ310Cmnu.TWTableID.wtiHanyo4:
                        case VKZ310Cmnu.TWTableID.wtiHanyo5:
                            // 工種
                            // 銀行	取引先	得意先	仕入先	社員
                            // 汎用補助1〜5
                            // 第１補助未セット？
                            if (pParam.Hjk1[0] == 0)
                            {
                                pParam.Hjk1[0] = PMSiwakexx[iIndex].iPKind;
                                // 第1補助	区分
                                pParam.Hjc1[0] = sGCode;
                            // ｺｰﾄﾞ
                            // 第２補助へ
                            }
                            else
                            {
                                pParam.Hjk2[0] = PMSiwakexx[iIndex].iPKind;
                                // 第2補助	区分
                                pParam.Hjc2[0] = sGCode;
                            // ｺｰﾄﾞ
                            }
                            break;
                    }
                }
            }
            // (*♪♪♪♪♪*)
            // 借貸	科目ｺｰﾄﾞ
            // 細目科目ｺｰﾄﾞ
            // 細目科目ｺｰﾄﾞ使用／非使用（０＝非使用、１＝使用）	(*H0002*)
            // 部門ｺｰﾄﾞ
            // ｾｸﾞﾒﾝﾄｺｰﾄﾞ	1
            // 2
            // 3
            // 4
            // 第1補助	区分
            // ｺｰﾄﾞ
            // 第2補助	区分
            // ｺｰﾄﾞ
            // 工事ｺｰﾄﾞ
            if ((cParam.Kamk[0] != pParam.Kamk[0]) || (cParam.Saik[0] != pParam.Saik[0]) || (cParam.Saiu[0] != pParam.Saiu[0]) || (cParam.Bmon[0] != pParam.Bmon[0]) || (cParam.Seg1[0] != pParam.Seg1[0]) || (cParam.Seg2[0] != pParam.Seg2[0]) || (cParam.Seg3[0] != pParam.Seg3[0]) || (cParam.Seg4[0] != pParam.Seg4[0]) || (cParam.Hjk1[0] != pParam.Hjk1[0]) || (cParam.Hjc1[0] != pParam.Hjc1[0]) || (cParam.Hjk2[0] != pParam.Hjk2[0]) || (cParam.Hjc2[0] != pParam.Hjc2[0]) || (cParam.Koji[0] != pParam.Koji[0]) || (cParam.Kshu[0] != pParam.Kshu[0]))
            {
                // 工種ｺｰﾄﾞ
                result = true;
            }
            return result;
        }

        // procedure	SetDrillPar;//virtual;
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // TxtNameEnter
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void TxtNameEnter(Object Sender)
        {
            cEditComp.Focus();
        }

    } // end TMASL310Head

    public class TMASL310HeadOt: TMASL310Head
    {
        // Private 宣言
        private TMTxtEdit EMTxtEditCode = null;
        // Public 宣言
        // ******************************************************************************
        // Proccess	:	TMASL310HeadOt	（科目以外）
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create( AOwner,  iNo,  iLeft,  iWidth,  iCapLength)
        public TMASL310HeadOt(object AOwner, int iNo, int iLeft, int iWidth, int iCapLength) : base(AOwner, iNo, iLeft, iWidth, iCapLength)
        {
            EMTxtEditCode = new TMTxtEdit(this);
            //@ Unsupported property or method(C): 'Parent'
            EMTxtEditCode.Parent = this;
            //@ Unsupported property or method(C): 'Left'
            EMTxtEditCode.Left = iCapLength;
            //@ Unsupported property or method(C): 'Width'
            EMTxtEditCode.Width = iWidth - iCapLength;
            //@ Unsupported property or method(C): 'Height'
            //@ Unsupported property or method(C): 'Height'
            EMTxtEditCode.Height = this.Height;
            //@ Unsupported property or method(C): 'OnEnter'
            EMTxtEditCode.OnEnter = this.xxxCodeEnter();
            //@ Unsupported property or method(C): 'OnExit'
            EMTxtEditCode.OnExit = this.xxxCodeExit();
            //@ Unsupported property or method(C): 'OnKeyDown'
            EMTxtEditCode.OnKeyDown = this.xxxCodeKeyDown();
            // ---<HIS-060>------------------------------------------------------------------
            //@ Unsupported property or method(C): 'OnChange'
            EMTxtEditCode.OnChange = this.xxxCodeChange();
            // ------------------------------------------------------------------<HIS-060>---
            //@ Unsupported property or method(C): 'TabStop'
            EMTxtEditCode.TabStop = false;
            //@ Unsupported property or method(C): 'imClose'
            //@ Unsupported property or method(C): 'ImeMode'
            EMTxtEditCode.ImeMode = EMTxtEditCode.imClose;
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Hankaku'
            EMTxtEditCode.Hankaku = true;
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'SendToBack'
            EMTxtEditCode.SendToBack;
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 終了処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //@ Destructor  Destroy()
        ~TMASL310HeadOt()
        {
            //@ Unsupported property or method(C): 'Free'
            EMTxtEditCode.Free;
            base.Destroy();
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // SetPattern
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetPattern(TWTableID sKind, int iType, int iDigt, string sName)
        {
            this.sPKind = sKind;
            this.iPType = 0;
            if (iType == 2)
            {
                this.iPType = 1;
            }
            switch(this.iPType)
            {
                case 0:
                    // 0:数字,1:数字(前ｾﾞﾛあり),2:ﾌﾘｰ
                    // <>0 → =2 HIS-IWA-0003
                    // HIS-IWA-0001
                    // case	sPKind	of
                    // wtiSaimkKmk	:	SetCaption	(' 細目　');	//	細目科目
                    // //	wtiCash		:								//	資金繰
                    // wtiBumon	:	SetCaption	(' 部門　');	//	部門
                    // wtiSeg1		:	SetCaption	(' ｾｸﾞﾒﾝﾄ');	//	ｾｸﾞﾒﾝﾄ1
                    // wtiSeg2		:	SetCaption	(' ｾｸﾞﾒﾝﾄ2');	//	ｾｸﾞﾒﾝﾄ2
                    // wtiSeg3		:	SetCaption	(' ｾｸﾞﾒﾝﾄ3');	//	ｾｸﾞﾒﾝﾄ3
                    // wtiSeg4		:	SetCaption	(' ｾｸﾞﾒﾝﾄ4');	//	ｾｸﾞﾒﾝﾄ4
                    // wtiGinko	:	SetCaption	(' 銀行　');	//	銀行
                    // wtiTrhksaki	:	SetCaption	(' 取引先');	//	取引先
                    // wtiTkisaki	:	SetCaption	(' 得意先');	//	得意先
                    // wtiSirsaki	:	SetCaption	(' 仕入先');	//	仕入先
                    // wtiShain	:	SetCaption	(' 担当者');	//	社員
                    // wtiHanyo1	:	SetCaption	(' 汎用１');	//	汎用補助1
                    // wtiHanyo2	:	SetCaption	(' 汎用２');	//	汎用補助2
                    // wtiHanyo3	:	SetCaption	(' 汎用３');	//	汎用補助3
                    // wtiHanyo4	:	SetCaption	(' 汎用４');	//	汎用補助4
                    // wtiHanyo5	:	SetCaption	(' 汎用５');	//	汎用補助5
                    // wtiKoji		:	SetCaption	(' 工事　');	//	工事
                    // wtiKosh		:	SetCaption	(' 工種　');	//	工種
                    // end;
                    this.cEditComp = this.EMNumEditCode;
                    //@ Unsupported property or method(C): 'Digits'
                    this.EMNumEditCode.Digits = iDigt;
                    if (iType == 1)
                    {
                        // 前Zeroを考慮　HIS-IWA-0003
                        //@ Unsupported property or method(C): 'FormatStr'
                        this.EMNumEditCode.FormatStr = new String('0', iDigt);
                    }
                    else
                    {
                        //@ Unsupported property or method(C): 'FormatStr'
                        this.EMNumEditCode.FormatStr = "";
                    }
                    break;
                case 1:
                    this.cEditComp = EMTxtEditCode;
                    //@ Unsupported property or method(C): 'MaxLength'
                    EMTxtEditCode.MaxLength = iDigt;
                    break;
            }
            this.SetNumCode(0, true);
            // HIS-IWA-0001　引数追加対応
            //@ Unsupported property or method(C): 'Text'
            EMTxtEditCode.Text = "";
            this.SetTxtName("");
        }

    } // end TMASL310HeadOt

    public class TMASL310HeadAc: TMASL310Head
    {
        // Private 宣言
        private TMQuery m_pFdqKmk = null;
        private TMASL310HeadOt PMSiwake02 = null;
        private TMASL310HeadOt PMSiwake03 = null;
        private TMASL310HeadOt PMSiwake04 = null;
        private TMLabel LMLabel = null;
        // 連想対応　HIS-IWA-0001
        private TMPanel PMRenPnl = null;
        // 連想対応　HIS-IWA-0001
        private TMPanel PMRenTitle = null;
        // 連想対応　HIS-IWA-0001
        // (*H0006 20020329 khattori 新規連想パーツ対応*)
        private TMAssocEdit EMTxtRenso = null;
        // EMTxtRenso		:	TMTxtEdit;	//	連想対応　HIS-IWA-0001
        private object oRenMoto = null;
        // 連想対応　HIS-IWA-0001
        private int m_iRenLength = 0;
        // ---<HIS-060>------------------------------------------------------------------
        private string m_sRen = String.Empty;
        // Public 宣言
        public Control cLastComp = null;
        public bool m_bEnable = false;
        // ---<HIS-060>------------------------------------------------------------------
        public int m_pCodeAssoc = 0;
        // コードによる連想絞込	(0:絞込なし 1:絞込あり)
        // ------------------------------------------------------------------<HIS-060>---
        // ******************************************************************************
        // Proccess	:	TMASL310HeadAc	（科目）
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create( AOwner, ref  Brt02, ref  Brt03, ref  Brt04,  iLeft,  iWidth,  iCapLength,  iSysFocusColor,  iSysColorD)
        public TMASL310HeadAc(object AOwner, ref TMASL310HeadOt Brt02, ref TMASL310HeadOt Brt03, ref TMASL310HeadOt Brt04, int iLeft, int iWidth, int iCapLength, int iSysFocusColor, int iSysColorD) : base(AOwner, 1, iLeft, iWidth, iCapLength)
        {
            int iIndex1;
            int iIndex2;
            int iSetWidth;
            LMLabel = new TMLabel(this);
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Parent'
            LMLabel.Parent = this;
            //@ Unsupported property or method(C): 'Width'
            LMLabel.Width = iCapLength;
            //@ Unsupported property or method(C): 'Height'
            //@ Unsupported property or method(C): 'Height'
            LMLabel.Height = this.Height;
            PMRenPnl = new TMPanel(this);
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Parent'
            PMRenPnl.Parent = ((AOwner) as Control);
            //@ Unsupported property or method(C): 'Left'
            PMRenPnl.Left = 0;
            //@ Unsupported property or method(C): 'Width'
            PMRenPnl.Width = iWidth - iCapLength + 30;
            //@ Unsupported property or method(C): 'Height'
            //@ Unsupported property or method(C): 'Height'
            PMRenPnl.Height = this.Height;
            //@ Unsupported property or method(C): 'ParentColor'
            PMRenPnl.ParentColor = true;
            //@ Unsupported property or method(C): 'bvNone'
            //@ Unsupported property or method(C): 'BevelOuter'
            PMRenPnl.BevelOuter = PMRenPnl.bvNone;
            //@ Unsupported property or method(C): 'TabStop'
            PMRenPnl.TabStop = false;
            //@ Unsupported property or method(C): 'Caption'
            PMRenPnl.Caption = "";
            //@ Unsupported property or method(C): 'Tag'
            PMRenPnl.Tag = 0;
            //@ Unsupported property or method(C): 'Visible'
            PMRenPnl.Visible = false;
            PMRenTitle = new TMPanel(this);
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Parent'
            PMRenTitle.Parent = PMRenPnl;
            //@ Unsupported property or method(C): 'Left'
            PMRenTitle.Left = 0;
            //@ Unsupported property or method(C): 'Width'
            PMRenTitle.Width = 44;
            //@ Unsupported property or method(C): 'Height'
            //@ Unsupported property or method(C): 'Height'
            PMRenTitle.Height = this.Height;
            //@ Unsupported property or method(C): 'TabStop'
            PMRenTitle.TabStop = false;
            //@ Unsupported property or method(C): 'Color'
            PMRenTitle.Color = iSysColorD;
            //@ Unsupported property or method(C): 'Caption'
            PMRenTitle.Caption = "";
            // (*H0006 20020329 khattori 新規連想パーツ対応*)
            EMTxtRenso = new TMAssocEdit(this);
            // HIS-IWA-0001　追加
            // EMTxtRenso			:=	TMTxtEdit.Create(Self);				//	HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Parent'
            EMTxtRenso.Parent = PMRenPnl;
            //@ Unsupported property or method(C): 'Left'
            EMTxtRenso.Left = 44;
            //@ Unsupported property or method(C): 'Width'
            EMTxtRenso.Width = iWidth - iCapLength - 14;
            //@ Unsupported property or method(C): 'Height'
            //@ Unsupported property or method(C): 'Height'
            EMTxtRenso.Height = this.Height;
            //@ Unsupported property or method(C): 'Name'
            //@ Unsupported property or method(C): 'Name'
            EMTxtRenso.Name = this.Name + "TxRen";
            //@ Unsupported property or method(C): 'TabStop'
            EMTxtRenso.TabStop = false;
            //@ Unsupported property or method(C): 'MaxLength'
            EMTxtRenso.MaxLength = 10;
            //@ Unsupported property or method(C): 'imDisable'
            //@ Unsupported property or method(C): 'ImeMode'
            EMTxtRenso.ImeMode = EMTxtRenso.imDisable;
            // ImeMode			:=	imSKata;
            // (*H0006 20020329 khattori 新規連想パーツ対応*)
            //@ Unsupported property or method(C): 'ImRoma'
            //@ Unsupported property or method(C): 'InputMode'
            EMTxtRenso.InputMode = EMTxtRenso.ImRoma;
            //@ Unsupported property or method(C): 'CmToKana'
            //@ Unsupported property or method(C): 'ConvertMode'
            EMTxtRenso.ConvertMode = EMTxtRenso.CmToKana;
            // Hankaku			:=	True;
            //@ Unsupported property or method(C): 'Tag'
            EMTxtRenso.Tag = 0;
            System.IO.Stream = "";
            //@ Unsupported property or method(C): 'OnEnter'
            EMTxtRenso.OnEnter = xxxRenEnter;
            //@ Unsupported property or method(C): 'OnExit'
            EMTxtRenso.OnExit = xxxRenExit;
            //@ Unsupported property or method(C): 'OnChange'
            EMTxtRenso.OnChange = xxxRenChange;
            //@ Unsupported property or method(C): 'OnKeyDown'
            EMTxtRenso.OnKeyDown = xxxRenKeyDown;
            // (*H0006 20020329 khattori 新規連想パーツ対応*)
            //@ Unsupported property or method(C): 'OnAssocEvent'
            EMTxtRenso.OnAssocEvent = xxxRenAssocEvent;
            SetPattern(VKZ310Cmnu.TWTableID.wtiKanjoKmk, 0);
            //@ Undeclared identifier(3): 'Visible'
            Visible = true;
            //@ Unsupported property or method(C): 'FocusedColor'
            this.EMNumEditCode.FocusedColor = iSysFocusColor;
            //@ Unsupported property or method(C): 'Digits'
            this.EMNumEditCode.Digits = 6;
            // (*H0006 20020329 khattori 新規連想パーツ対応*)
            // EMTxtRenso.FocusedColor		:=	iSysFocusColor;	//	連想対応　HIS-IWA-0001
            m_bEnable = false;
            iSetWidth = iWidth - iCapLength + 10;
            // HIS-IWA-0001
            PMSiwake02 = new TMASL310HeadOt(AOwner, 2, iLeft + iWidth, iSetWidth, 10);
            // HIS-IWA-0001　CaptionLengthを10に
            PMSiwake03 = new TMASL310HeadOt(AOwner, 3, iLeft + iWidth + iSetWidth, iSetWidth, 10);
            PMSiwake04 = new TMASL310HeadOt(AOwner, 4, iLeft + iWidth + iSetWidth * 2, iSetWidth, 10);
            Brt02 = PMSiwake02;
            Brt03 = PMSiwake03;
            Brt04 = PMSiwake04;
            this.PMSiwakexx[0] = this;
            this.PMSiwakexx[1] = PMSiwake02;
            this.PMSiwakexx[2] = PMSiwake03;
            this.PMSiwakexx[3] = PMSiwake04;
            for (iIndex1 = 1; iIndex1 <= 3; iIndex1 ++ )
            {
                for (iIndex2 = 0; iIndex2 <= 3; iIndex2 ++ )
                {
                    this.PMSiwakexx[iIndex1].PMSiwakexx[iIndex2] = this.PMSiwakexx[iIndex2];
                }
                //@ Unsupported property or method(C): 'FocusedColor'
                this.PMSiwakexx[iIndex1].EMNumEditCode.FocusedColor = iSysFocusColor;
                //@ Unsupported property or method(C): 'FocusedColor'
                ((this.PMSiwakexx[iIndex1]) as TMASL310HeadOt).EMTxtEditCode.FocusedColor = iSysFocusColor;
            }
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 終了処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //@ Destructor  Destroy()
        ~TMASL310HeadAc()
        {
            if (m_pFdqKmk != null)
            {
                //@ Unsupported property or method(D): 'Close'
                m_pFdqKmk.Close;
                //@ Unsupported property or method(D): 'Free'
                m_pFdqKmk.Free;
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(m_pFdqKmk);
            }
            //@ Unsupported property or method(C): 'Free'
            PMSiwake02.Free;
            //@ Unsupported property or method(C): 'Free'
            PMSiwake03.Free;
            //@ Unsupported property or method(C): 'Free'
            PMSiwake04.Free;
            //@ Unsupported property or method(C): 'Free'
            LMLabel.Free;
            // 連想対応　HIS-IWA-0001
            //@ Unsupported property or method(C): 'Free'
            EMTxtRenso.Free;
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Free'
            PMRenTitle.Free;
            // HIS-IWA-0001　追加
            //@ Unsupported property or method(C): 'Free'
            PMRenPnl.Free;
            // HIS-IWA-0001　追加
            base.Destroy();
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 部門、補助の入力コンポーネントの情報をセット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetBrother(object pint, Control cFirst, Control cPrev, Control cNext, int[] iAnalyzeCode)
        {
            // (*H0005 20010921 tyamaguchi 定型仕訳対応*)
            // procedure	TMASL310HeadAc.SetBrother	(pint:Pointer;cPrev,cNext:TWinControl;iAnalyzeCode:array of Integer);
            int iIndex1;
            this.cRoot = pint;
            this.cFirstComp = cFirst;
            // (*H0005 20010921 tyamaguchi 定型仕訳対応*)
            this.cPrevComp = cPrev;
            this.cNextComp = cNext;
            cLastComp = cNext;
            PMSiwake02.cRoot = pint;
            PMSiwake03.cRoot = pint;
            PMSiwake04.cRoot = pint;
            PMSiwake02.cFirstComp = cFirst;
            // (*H0005 20010921 tyamaguchi 定型仕訳対応*)
            PMSiwake03.cFirstComp = cFirst;
            // (*H0005 20010921 tyamaguchi 定型仕訳対応*)
            PMSiwake04.cFirstComp = cFirst;
            // (*H0005 20010921 tyamaguchi 定型仕訳対応*)
            // 配列の長さを合わせる
            this.m_iAnalyzeCode = new int[iAnalyzeCode.Length];
            for (iIndex1 = 0; iIndex1 < iAnalyzeCode.Length; iIndex1 ++ )
            {
                this.m_iAnalyzeCode[iIndex1] = iAnalyzeCode[iIndex1];
            }
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 部門、補助の入力コンポーネントの情報をセット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public override void KamokuCodeChange()
        {
            int iIndex;
            enTblList tlTblList;
            // 追加　HIS-IWA-0001
            TWDspParamTbl rDspParam;
            TMQuery pQue;
            string sCode;
            string sSql;
            int iLoop;
            int iLoop2;
            TWParam WndParam;
            int[] iAutoSet = new int[3 + 1];
            //@ Unsupported property or method(C): 'Value'
            if (this.m_iKGCode == (this.EMNumEditCode.Value as object))
            {
                return;
            }
            m_bEnable = false;
            this.cNextComp = cLastComp;
            this.m_iCount = 0;
            //@ Unsupported property or method(C): 'Value'
            this.m_iKGCode = (this.EMNumEditCode.Value as object);
            // 科目１件ゲット
            if (m_pFdqKmk == null)
            {
                m_pFdqKmk = new TMQuery();
            }
            else
            {
                //@ Unsupported property or method(D): 'Close'
                m_pFdqKmk.Close;
                //@ Unsupported property or method(D): 'Free'
                m_pFdqKmk.Free;
            }
            ((this.cRoot) as TMASL310Root).GetKamokuMaster(this.m_iKGCode, m_pFdqKmk);
            //@ Unsupported property or method(D): 'eof'
            if (!m_pFdqKmk.eof)
            {
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                this.m_iSACode = m_pFdqKmk.GetFld("SumAnaCode").AsInteger;
                // 要約分析
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                this.m_iBPKbn = m_pFdqKmk.GetFld("BPKbn").AsInteger;
                // ＢＳ／ＰＬ
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                this.m_iDCKbn = m_pFdqKmk.GetFld("DCKbn").AsInteger;
                // 正残区分	HIS-IWA-0001
                SetAttr("SubKmkUse", 2, VKZ310Cmnu.TWTableID.wtiSaimkKmk);
                // 細目科目
                SetAttr("BmnUse", 41, VKZ310Cmnu.TWTableID.wtiBumon);
                // 部門
                SetAttr("SegUse1", 42, VKZ310Cmnu.TWTableID.wtiSeg1);
                // ｾｸﾞﾒﾝﾄ1
                SetAttr("SegUse2", 43, VKZ310Cmnu.TWTableID.wtiSeg2);
                // ｾｸﾞﾒﾝﾄ2
                SetAttr("SegUse3", 44, VKZ310Cmnu.TWTableID.wtiSeg3);
                // ｾｸﾞﾒﾝﾄ3
                SetAttr("SegUse4", 45, VKZ310Cmnu.TWTableID.wtiSeg4);
                // ｾｸﾞﾒﾝﾄ4
                SetAttr("HojyoUse1");
                // 第１補助
                SetAttr("HojyoUse2");
                // 第２補助
                SetAttr("KoujiUse", 51, VKZ310Cmnu.TWTableID.wtiKoji);
            // 工事
            }
            for (iIndex = 1; iIndex <= 3; iIndex ++ )
            {
                this.PMSiwakexx[iIndex].m_iCount = this.m_iCount;
            }
            if (this.m_iCount <= 0)
            {
                //@ Unsupported property or method(C): 'Visible'
                this.PMSiwakexx[1].Visible = false;
            }
            if (this.m_iCount <= 1)
            {
                //@ Unsupported property or method(C): 'Visible'
                this.PMSiwakexx[2].Visible = false;
            }
            if (this.m_iCount <= 2)
            {
                //@ Unsupported property or method(C): 'Visible'
                this.PMSiwakexx[3].Visible = false;
            }
            //@ Unsupported property or method(C): 'Enabled'
            this.PMSiwakexx[1].Enabled = false;
            //@ Unsupported property or method(C): 'Enabled'
            this.PMSiwakexx[2].Enabled = false;
            //@ Unsupported property or method(C): 'Enabled'
            this.PMSiwakexx[3].Enabled = false;
            // 製造科目色対応　HIS-IWA-0002
            if (this.m_iSACode == 13)
            {
                //@ Unsupported property or method(C): 'Font'
                //@ Unsupported property or method(D): 'Color'
                this.EMTxtEditName.Font.Color = System.Drawing.Color.Blue;
            }
            else
            {
                //@ Unsupported property or method(C): 'Font'
                //@ Unsupported property or method(D): 'Color'
                this.EMTxtEditName.Font.Color = System.Drawing.Color.Black;
            }
            // 共通部門/ｾｸﾞﾒﾝﾄ1〜4対応　HIS-IWA-0001
            iAutoSet[0] = 0;
            iAutoSet[1] = 0;
            iAutoSet[2] = 0;
            iAutoSet[3] = 0;
            WndParam = ((this.cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM);
            for (iLoop = 1; iLoop <= this.m_iCount; iLoop ++ )
            {
                TMASL310HeadOt _wvar1 = ((this.PMSiwakexx[iLoop]) as TMASL310HeadOt);
                if ((_wvar1.m_iUseKbn == 2) && ((_wvar1.sPKind == VKZ310Cmnu.TWTableID.wtiBumon) || (_wvar1.sPKind == VKZ310Cmnu.TWTableID.wtiSeg1) || (_wvar1.sPKind == VKZ310Cmnu.TWTableID.wtiSeg2) || (_wvar1.sPKind == VKZ310Cmnu.TWTableID.wtiSeg3) || (_wvar1.sPKind == VKZ310Cmnu.TWTableID.wtiSeg4)))
                {
                    sCode = "";
                    switch(_wvar1.sPKind)
                    {
                        case VKZ310Cmnu.TWTableID.wtiBumon:
                            iIndex = 41;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg1:
                            // 部門
                            iIndex = 42;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg2:
                            // ｾｸﾞﾒﾝﾄ	1
                            iIndex = 43;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg3:
                            // 2
                            iIndex = 44;
                            break;
                        case VKZ310Cmnu.TWTableID.wtiSeg4:
                            // 3
                            iIndex = 45;
                            break;
                        default:
                            // 4
                            break;
                            break;
                    }
                    // ﾏｽﾀ基本情報の読込み
                    tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_MasterInfo;
                    pQue = ((_wvar1.cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                    if (pQue != null)
                    {
                        //@ Unsupported property or method(B): 'Locate'
                        if (pQue.Locate("MasterKbn", iIndex, new object[] {}) == true)
                        {
                            // ﾚｺｰﾄﾞ検索
                            if (_wvar1.m_iBPKbn == 0)
                            {
                                //@ Unsupported property or method(B): 'GetFld'
                                // BS共通部門ｺｰﾄﾞ（部門･ｾｸﾞﾒﾝﾄのみ）
                                //@ Unsupported property or method(D): 'AsString'
                                sCode = pQue.GetFld("SpHojyoCd1").AsString;
                            }
                            else
                            {
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsString'
                                sCode = pQue.GetFld("SpHojyoCd2").AsString;
                            }
                        // PL共通部門ｺｰﾄﾞ（部門･ｾｸﾞﾒﾝﾄのみ）
                        }
                    }
                    if (sCode == "")
                    {
                        // 共通が登録されていない場合は諸口をｾｯﾄ
                        tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_HojyoMa;
                        sSql = "where MasterKbn=" + (iIndex).ToString() + " And SumKbn=0 And RecordKbn=0 And NCode=0";
                        pQue = ((_wvar1.cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList, sSql);
                        if (pQue != null)
                        {
                            //@ Unsupported property or method(B): 'GetFld'
                            // 外部ｺｰﾄﾞ
                            //@ Unsupported property or method(D): 'AsString'
                            sCode = pQue.GetFld("GCode").AsString;
                        }
                    }
                    if (sCode != "")
                    {
                        // 数値属性は変換が必要
                        if (_wvar1.iPType == 0)
                        {
                            // (*H0002	20010710 khattori 最後が共通部門等のときエラー*)
                            //@ Unsupported property or method(C): 'FormatStr'
                            if (_wvar1.EMNumEditCode.FormatStr == "")
                            {
                                sCode = (Convert.ToInt64(sCode)).ToString();
                            }
                            else
                            {
                                //@ Unsupported property or method(A): 'TMASCom'
                                //@ Unsupported property or method(B): 'SetCodeAttr'
                                sCode = _wvar1.TMASCom(((_wvar1.cRoot) as TMASL310Root).m_pRec.m_pSystemArea).SetCodeAttr(sCode, _wvar1.m_iCodeDigit, false);
                            }
                        }
                        // HIS-IWA-0006　ｺｰﾄﾞ属性と桁数を参照する様に変更
                        rDspParam = _wvar1.SetWndParam(_wvar1.sPKind, false);
                        // ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ設定
                        ((_wvar1.cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_SearchData, sCode, rDspParam);
                        if (WndParam.Code != "")
                        {
                            iAutoSet[iLoop] = 1;
                            switch(_wvar1.iPType)
                            {
                                case 0:
                                    _wvar1.SetNumCode(Convert.ToInt64(WndParam.Code));
                                    break;
                                case 1:
                                    //@ Unsupported property or method(C): 'Text'
                                    _wvar1.EMTxtEditCode.Text = WndParam.Code;
                                    break;
                            }
                            _wvar1.SetTxtName(WndParam.Name);
                            WndParam.Code = "";
                            WndParam.Name = "";
                            //@ Unsupported property or method(C): 'BringToFront'
                            _wvar1.PMSiwakexx[iLoop].EMTxtEditName.BringToFront;
                            _wvar1.SetDrillPar();
                        }
                    }
                }
            }
            // 移動先の付け替え
            for (iLoop = 1; iLoop <= this.m_iCount; iLoop ++ )
            {
                if (iAutoSet[iLoop] == 1)
                {
                    for (iLoop2 = 1; iLoop2 <= iLoop; iLoop2 ++ )
                    {
                        if (iLoop - iLoop2 + 1 > 3)
                        {
                            break;
                        }
                        if (iAutoSet[iLoop - iLoop2] == 0)
                        {
                            // (*H0002	20010710 khattori 最後が共通部門等のときエラー*)
                            if (iLoop < 3)
                            {
                                // PMSiwakexx[iLoop+1].cPrevComp := PMSiwakexx[iLoop-iLoop2];
                                this.PMSiwakexx[iLoop + 1].cPrevComp = this.PMSiwakexx[iLoop - iLoop2 + 1].cPrevComp;
                            }
                            this.PMSiwakexx[iLoop - iLoop2].cNextComp = this.PMSiwakexx[iLoop].cNextComp;
                            break;
                        }
                    }
                // (*H0002	20010710 khattori 最後が共通部門等のときエラー*)
                // for iLoop2 := 1 to m_iCount do
                // begin
                // if iLoop+iLoop2 > 3 then	break;
                // 
                // if iAutoSet[iLoop+iLoop2] = 0 then
                // begin
                // PMSiwakexx[iLoop-1].cNextComp := PMSiwakexx[iLoop+iLoop2-1].cNextComp;
                // break;
                // end;
                // end;
                }
            }
        }

        // procedure	SetDrillPar;override;
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // SetAttr
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetAttr(string sFld, int iKind, TWTableID sKind)
        {
            int iSaiyou;
            enTblList tlTblList;
            TMQuery pQuery;
            int iUseKbn;
            string sJHojyoName;
            int iCodeDigit;
            int iCodeAttr;
            int iKind2;
            if (this.m_iCount >= 3)
            {
                return;
            }
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsInteger'
            iSaiyou = m_pFdqKmk.GetFld(sFld).AsInteger;
            if (iSaiyou == 0)
            {
                return;
            }
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_MasterInfo;
            pQuery = ((this.cRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
            if (pQuery == null)
            {
                return;
            }
            if ((sFld == "HojyoUse1") || (sFld == "HojyoUse2"))
            {
                iKind = iSaiyou;
                // HIS-IWA-0001　23:得意先,24:仕入先は22:取引先を参照する
                if (new ArrayList(new int[] {23, 24}).Contains(iSaiyou))
                {
                    iKind2 = 22;
                }
                else
                {
                    iKind2 = iKind;
                }
                switch(iKind)
                {
                    case 21:
                        // 補助採	0:なし 21:銀行 22:取引先 23:得意先 24:仕入先 25:社員 31〜35:汎用1〜5
                        sKind = VKZ310Cmnu.TWTableID.wtiGinko;
                        break;
                    case 22:
                        // 銀行
                        sKind = VKZ310Cmnu.TWTableID.wtiTrhksaki;
                        break;
                    case 23:
                        // 取引先
                        sKind = VKZ310Cmnu.TWTableID.wtiTkisaki;
                        break;
                    case 24:
                        // 得意先
                        sKind = VKZ310Cmnu.TWTableID.wtiSirsaki;
                        break;
                    case 25:
                        // 仕入先
                        sKind = VKZ310Cmnu.TWTableID.wtiShain;
                        break;
                    case 31:
                        // 社員
                        sKind = VKZ310Cmnu.TWTableID.wtiHanyo1;
                        break;
                    case 32:
                        // 汎用補助1
                        sKind = VKZ310Cmnu.TWTableID.wtiHanyo2;
                        break;
                    case 33:
                        // 汎用補助2
                        sKind = VKZ310Cmnu.TWTableID.wtiHanyo3;
                        break;
                    case 34:
                        // 汎用補助3
                        sKind = VKZ310Cmnu.TWTableID.wtiHanyo4;
                        break;
                    case 35:
                        // 汎用補助4
                        sKind = VKZ310Cmnu.TWTableID.wtiHanyo5;
                        break;
                // 汎用補助5
                }
            }
            else
            {
                iKind2 = iKind;
            }
            //@ Unsupported property or method(B): 'Locate'
            if (pQuery.Locate("MasterKbn", iKind2, new object[] {}) == false)
            {
                return;
            }
            // マスタ区分	HIS-IWA-0001　iKind→iSaiyou
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsInteger'
            iUseKbn = TMQuery(pQuery).GetFld("UseKbn").AsInteger;
            // 採用区分
            if (iUseKbn == 0)
            {
                return;
            }
            // HIS-IWA-0001　部門/ｾｸﾞﾒﾝﾄ1〜4はBS/PLで採用区分を判定
            if ((iKind2 >= 41) && (iKind2 <= 45))
            {
                if ((iUseKbn == 1) && (this.m_iBPKbn == 0))
                {
                    return;
                }
            }
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsString'
            sJHojyoName = TMQuery(pQuery).GetFld("JHojyoName").AsString;
            // 補助名称（実在）
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsInteger'
            iCodeDigit = TMQuery(pQuery).GetFld("CodeDigit").AsInteger;
            // コード桁数
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsInteger'
            iCodeAttr = TMQuery(pQuery).GetFld("CodeAttr").AsInteger;
            // コード属性
            this.m_iCount = this.m_iCount + 1;
            ((this.PMSiwakexx[this.m_iCount]) as TMASL310HeadOt).SetPattern(sKind, iCodeAttr, iCodeDigit, sJHojyoName);
            this.PMSiwakexx[this.m_iCount].iPKind = iKind;
            this.PMSiwakexx[this.m_iCount - 1].cNextComp = this.PMSiwakexx[this.m_iCount].EMTxtEditName;
            this.PMSiwakexx[this.m_iCount].cPrevComp = this.PMSiwakexx[this.m_iCount - 1].EMTxtEditName;
            this.PMSiwakexx[this.m_iCount].cNextComp = cLastComp;
            //@ Unsupported property or method(C): 'Visible'
            this.PMSiwakexx[this.m_iCount].Visible = true;
            this.PMSiwakexx[this.m_iCount].m_iKGCode = this.m_iKGCode;
            this.PMSiwakexx[this.m_iCount].m_iSACode = this.m_iSACode;
            // 要約分析
            this.PMSiwakexx[this.m_iCount].m_iBPKbn = this.m_iBPKbn;
            // ＢＳ／ＰＬ
            this.PMSiwakexx[this.m_iCount].m_iDCKbn = this.m_iDCKbn;
            // 正残区分	HIS-IWA-0001
            this.PMSiwakexx[this.m_iCount].m_iUseKbn = iSaiyou;
            // 採用区分	HIS-IWA-0001
            this.PMSiwakexx[this.m_iCount].m_iCodeDigit = iCodeDigit;
            // コード桁数	HIS-IWA-0006

        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // SetPattern
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetPattern(TWTableID sKind, int iType)
        {
            this.sPKind = sKind;
            this.iPType = iType;
            // HIS-IWA-0001
            // SetCaption	('　科目');
            //@ Unsupported property or method(C): 'Caption'
            LMLabel.Caption = "　科目";
            this.cEditComp = this.EMNumEditCode;
            this.SetNumCode(0, true);
            // HIS-IWA-0001　引数追加対応
            this.SetTxtName("");
        }

        // 連想対応　HIS-IWA-0001
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxRenEnter
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void xxxRenEnter(Object Sender)
        {
            int iRenMode;
            // SetWndParam( True );
            iRenMode = ((this.cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_RENSOU_MODE);
            switch(iRenMode)
            {
                case 0:
                    //@ Unsupported property or method(C): 'ImRoma'
                    //@ Unsupported property or method(C): 'InputMode'
                    EMTxtRenso.InputMode = EMTxtRenso.ImRoma;
                    //@ Unsupported property or method(C): 'CmToKana'
                    //@ Unsupported property or method(C): 'ConvertMode'
                    EMTxtRenso.ConvertMode = EMTxtRenso.CmToKana;
                    break;
                case 1:
                    //@ Unsupported property or method(C): 'ImRoma'
                    //@ Unsupported property or method(C): 'InputMode'
                    EMTxtRenso.InputMode = EMTxtRenso.ImRoma;
                    //@ Unsupported property or method(C): 'CmToEnglish'
                    //@ Unsupported property or method(C): 'ConvertMode'
                    EMTxtRenso.ConvertMode = EMTxtRenso.CmToEnglish;
                    break;
                case 2:
                    //@ Unsupported property or method(C): 'ImKana'
                    //@ Unsupported property or method(C): 'InputMode'
                    EMTxtRenso.InputMode = EMTxtRenso.ImKana;
                    //@ Unsupported property or method(C): 'CmToKana'
                    //@ Unsupported property or method(C): 'ConvertMode'
                    EMTxtRenso.ConvertMode = EMTxtRenso.CmToKana;
                    break;
            }
            //@ Unsupported property or method(C): 'Caption'
            PMRenTitle.Caption = ((this.cRoot) as TMASL310Root).Sfnc(VKZ310Cmnu.enSfunc.MASL_SGET_RENSOU_MODE);
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxRenExit
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void xxxRenExit(Object Sender)
        {
            ((Sender) as Control).Parent.Visible = false;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxRenChange
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void xxxRenChange(Object Sender)
        {
            int iLen;
            //@ Unsupported property or method(C): 'Text'
            iLen = EMTxtRenso.Text.Length;
            //@ Unsupported property or method(A): 'Text'
            //@ Unsupported property or method(A): 'Text'
            if ((iLen == 0) || (iLen < m_iRenLength) && ((EMTxtRenso.Text[iLen] < '0') || (EMTxtRenso.Text[iLen] > '9')))
            {
                // if	length(EMTxtRenso.Text)<m_iRenLength	then
                // if	EMTxtRenso.Text=''	then
                ((this.cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_RenChange, Sender);
            }
            m_iRenLength = iLen;
            // ---<HIS-060>------------------------------------------------------------------
            //@ Unsupported property or method(C): 'Text'
            m_sRen = EMTxtRenso.Text;
            // ------------------------------------------------------------------<HIS-060>---

        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxRenKeyDown
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual void xxxRenKeyDown(Object Sender, ref ushort Key, object Shift)
        {
            int iRenMode;
            int iNumLen;
            string sNum1;
            string sNum2;
            // (*H0006 20020329 khattori 新規連想パーツ対応*)
            ((this.cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_KeyDown, Key, Shift);
            // //////////////////////////////////////////////////////////////////////////////
            // 連想入力モード			連想パーツプロパティ		連想Ｃａｐｔｉｏｎ
            // 入力モード	変換モード
            // ０＝ローマ字ー＞カナ	ImRoma		CmToKana		連想Rｶ
            // １＝英数				ImRoma		CmToEnglish		連想 A
            // ２＝かなー＞カナ		ImKana		CmToKana		連想 ｶ
            // //////////////////////////////////////////////////////////////////////////////
            //@ Undeclared identifier(3): 'VK_F9'
            if ((Key == VK_F9))
            {
                iRenMode =  -1;
                iRenMode = ((this.cRoot) as TMASL310Root).Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_RENSOU_MODE, iRenMode);
                switch(iRenMode)
                {
                    case 0:
                        //@ Unsupported property or method(C): 'ImRoma'
                        //@ Unsupported property or method(C): 'InputMode'
                        EMTxtRenso.InputMode = EMTxtRenso.ImRoma;
                        //@ Unsupported property or method(C): 'CmToKana'
                        //@ Unsupported property or method(C): 'ConvertMode'
                        EMTxtRenso.ConvertMode = EMTxtRenso.CmToKana;
                        break;
                    case 1:
                        //@ Unsupported property or method(C): 'ImRoma'
                        //@ Unsupported property or method(C): 'InputMode'
                        EMTxtRenso.InputMode = EMTxtRenso.ImRoma;
                        //@ Unsupported property or method(C): 'CmToEnglish'
                        //@ Unsupported property or method(C): 'ConvertMode'
                        EMTxtRenso.ConvertMode = EMTxtRenso.CmToEnglish;
                        break;
                    case 2:
                        //@ Unsupported property or method(C): 'ImKana'
                        //@ Unsupported property or method(C): 'InputMode'
                        EMTxtRenso.InputMode = EMTxtRenso.ImKana;
                        //@ Unsupported property or method(C): 'CmToKana'
                        //@ Unsupported property or method(C): 'ConvertMode'
                        EMTxtRenso.ConvertMode = EMTxtRenso.CmToKana;
                        break;
                }
                //@ Unsupported property or method(C): 'Caption'
                PMRenTitle.Caption = ((this.cRoot) as TMASL310Root).Sfnc(VKZ310Cmnu.enSfunc.MASL_SGET_RENSOU_MODE);
            }
            //@ Undeclared identifier(3): 'VK_RETURN'
            //@ Undeclared identifier(3): 'VK_TAB'
            if (((Key == VK_RETURN) || (Key == VK_TAB)) && (Shift == new object[] {}))
            {
                //@ Undeclared identifier(3): 'TMAssocEdit'
                //@ Unsupported property or method(D): 'Parent'
                //@ Unsupported property or method(D): 'Tag'
                if (TMAssocEdit(Sender).Parent.Tag == 1)
                {
                    //@ Undeclared identifier(3): 'TMAssocEdit'
                    //@ Unsupported property or method(D): 'Parent'
                    //@ Unsupported property or method(D): 'Tag'
                    TMAssocEdit(Sender).Parent.Tag = 0;
                    //@ Undeclared identifier(3): 'TMAssocEdit'
                    //@ Unsupported property or method(D): 'Text'
                    iNumLen = TMAssocEdit(Sender).Text.Length;
                    sNum1 = "";
                    sNum2 = "";
                    if (iNumLen > 1)
                    {
                        //@ Undeclared identifier(3): 'TMAssocEdit'
                        //@ Unsupported property or method(D): 'Text'
                        //@ Unsupported function or procedure: 'Copy'
                        sNum2 = Copy(TMAssocEdit(Sender).Text, iNumLen - 1, 1);
                    }
                    if (iNumLen > 0)
                    {
                        //@ Undeclared identifier(3): 'TMAssocEdit'
                        //@ Unsupported property or method(D): 'Text'
                        //@ Unsupported function or procedure: 'Copy'
                        sNum1 = Copy(TMAssocEdit(Sender).Text, iNumLen, 1);
                    }
                    if ((sNum1 >= '0') && (sNum1 <= '9'))
                    {
                        if ((sNum2 >= '1') && (sNum2 <= '3'))
                        {
                            sNum1 = sNum2 + sNum1;
                        }
                        ((oRenMoto) as TextBox).Text = sNum1;
                        //@ Undeclared identifier(3): 'TMNumEdit'
                        if (oRenMoto is TMNumEdit)
                        {
                            //@ Undeclared identifier(3): 'TMNumEdit'
                            //@ Unsupported property or method(B): 'OnKeyDown'
                            TMNumEdit(oRenMoto).OnKeyDown(oRenMoto, Key, Shift);
                        }
                        //@ Undeclared identifier(3): 'TMTxtEdit'
                        if (oRenMoto is TMTxtEdit)
                        {
                            //@ Undeclared identifier(3): 'TMTxtEdit'
                            //@ Unsupported property or method(B): 'OnKeyDown'
                            TMTxtEdit(oRenMoto).OnKeyDown(oRenMoto, Key, Shift);
                        }
                    }
                }
                else
                {
                    // 呼び元に戻る
                    Key = 0;
                    //@ Unsupported property or method(C): 'Text'
                    if (EMTxtRenso.Text != "")
                    {
                        //@ Unsupported property or method(C): 'Tag'
                        EMTxtRenso.Tag = 1;
                    }
                    // 確定ﾌﾗｸﾞをOnに
                    //@ Unsupported property or method(B): 'SetFocus'
                    oRenMoto.SetFocus();
                }
            }
            //@ Undeclared identifier(3): 'VK_HOME'
            //@ Undeclared identifier(3): 'VK_END'
            //@ Undeclared identifier(3): 'VK_ESCAPE'
            if (((Key == VK_HOME) || (Key == VK_END) || (Key == VK_ESCAPE)) && (Shift == new object[] {}))
            {
                Key = 0;
                //@ Unsupported property or method(B): 'SetFocus'
                oRenMoto.SetFocus();
            }
        }

        // (*H0006 20020329 khattori 新規連想パーツ対応*)
        // (*H0006 20020329 khattori 新規連想パーツ対応*)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // xxxRenKeyDown
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual void xxxRenAssocEvent(Object Sender, ref string Key)
        {
            if ((Key[Key.Length] < '0') || (Key[Key.Length] > '9'))
            {
                ((this.cRoot) as TMASL310Root).Wfnc(VKZ310Cmnu.enWfunc.MASL_WND_RenChange, Sender);
            }
        }

#endif
    } // end TMASL310HeadAc

    // __MASL310HEADH_INC__
    // ******************************************************************************
    // Proccess	:	TMASL310Ind
    // Name		:	K.Hattori(MJS)
    // Date		:	2000/12/08
    // Parameter	:
    // Return		:
    // ******************************************************************************
    public class TMASL310Ind: ArrayList
    {
        // Public 宣言
        public object pRoot = null;
        public TMASL310Item Itm = null;
        public TMComboBox PMComboBox3 = null;
        public TMComboBox PMComboBox4 = null;
        public TMPanel PMPanelHdSjFst = null;
        public TMPanel PMPanelHdSjSnd = null;
        // __MASL310HEADB_INC__
        // ******************************************************************************
        // Proccess	:	TMASL310Ind
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // <HIS-014> 2007/05/08 T.Yamaguchi	伝票 対応
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create()
        public TMASL310Ind() : base()
        {
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 終了処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //@ Destructor  Destroy()
        ~TMASL310Ind()
        {
            DeleteItem();
            base.Destroy();
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 削除処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void DeleteItem()
        {
            int idx;
            TMASL310IFunc pFunc;
            for (idx = 0; idx < this.Count; idx ++ )
            {
                pFunc = this[idx];
                if (pFunc != null)
                {
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pFunc);
                }
            }
            this.Clear();
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetRootAddress(object[] arPrm01)
        {
            pRoot = arPrm01[0];
            Itm = ((arPrm01[1]) as TMASL310Item);
            // 指示項目操作クラス
            //@ Undeclared identifier(3): 'TMComboBox'
            PMComboBox3 = TMComboBox(arPrm01[2]);
            //@ Undeclared identifier(3): 'TMComboBox'
            PMComboBox4 = TMComboBox(arPrm01[3]);
            //@ Undeclared identifier(3): 'TMPanel'
            PMPanelHdSjFst = TMPanel(arPrm01[4]);
            //@ Undeclared identifier(3): 'TMPanel'
            PMPanelHdSjSnd = TMPanel(arPrm01[5]);
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 他モード処理コード取得
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public object GetBrother(int iPar)
        {
            object result;
            TMASL310Root cRoot;
            object pRetn;
            int iSjiCode;
            int iBrotherCode;
            int iIndex1;
            int iIndex2;
            TMASL310IFunc prFunc;
            // ファンクションセット
            TMASL310IFunc rFunc;
            TMASL310IFunc rFunc2;
            pRetn = null;
            cRoot = ((pRoot) as TMASL310Root);
            DeleteItem();
            iBrotherCode = Itm.ReadIniInt(iPar, "Brth");
            if (iBrotherCode !=  -1)
            {
                this.Count = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_MAX + 1;
                // ---<HIS-014>------------------------------------------------------------------
                // 担当者別制御
                iSjiCode = Itm.ReadIniInt(iPar, "Mama");
                // iSjiCode:=cRoot.Ifnc(MASL_IGET_SIJI_CODE);
                // ------------------------------------------------------------------<HIS-014>---
                for (iIndex1 = 0; iIndex1 <= 100; iIndex1 ++ )
                {
                    rFunc = Itm.ReadIniRec(iSjiCode, iIndex1 + 1);
                    if (rFunc.iOpCode <= 0)
                    {
                        break;
                    }
                    if (rFunc.sProg == 'z')
                    {
                        break;
                    }
                    if (rFunc.sProg == "none")
                    {
                        break;
                    }
                    if (rFunc.sProg == "ac-change")
                    {
                        break;
                    }
                    if (rFunc.sProg == 'x')
                    {
                        for (iIndex2 = 0; iIndex2 <= 100; iIndex2 ++ )
                        {
                            rFunc2 = Itm.ReadIniRec(rFunc.iOpCode, iIndex2 + 1);
                            if (rFunc2.iOpCode <= 0)
                            {
                                break;
                            }
                            if (iBrotherCode == rFunc2.iBrotherCode)
                            {
                                if (this[rFunc2.iMode] == null)
                                {
                                    prFunc = new TMASL310IFunc();
                                    prFunc = rFunc2;
                                    this[rFunc2.iMode] = prFunc;
                                }
                            }
                        }
                    }
                    else
                    {
                        if (iBrotherCode == rFunc.iBrotherCode)
                        {
                            if (this[rFunc.iMode] == null)
                            {
                                prFunc = new TMASL310IFunc();
                                prFunc = rFunc;
                                this[rFunc.iMode] = prFunc;
                            }
                        }
                    }
                }
                pRetn = this;
            }
            result = pRetn;
            return result;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 他モード処理コード設定
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetBrother(int iPar)
        {
            TMASL310Root cRoot;
            int iNumb;
            int iLevel;
            int iSjiCode;
            int iWkCode;
            int iFstCode;
            int iSndCode;
            int iIndex1;
            int iIndex2;
            iFstCode =  -1;
            iSndCode =  -1;
            cRoot = ((pRoot) as TMASL310Root);
            iLevel = Itm.ReadIniInt(iPar, "Levl");
            // ドリルダウン専用（伝票表示等）か？
            if (iLevel == 400)
            {
                return;
            }
            // 第１指示か？
            if (iLevel == 200)
            {
                iFstCode = iPar;
            }
            // 第２指示か？
            if (iLevel == 300)
            {
                iFstCode = Itm.ReadIniInt(iPar, "Mama");
                iSndCode = iPar;
            }
            if (iFstCode !=  -1)
            {
                iSjiCode = cRoot.Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_CODE);
                for (iIndex1 = 0; iIndex1 <= 100; iIndex1 ++ )
                {
                    iWkCode = Itm.ReadIniInt(iSjiCode, "Code", iIndex1 + 1);
                    if (iWkCode ==  -1)
                    {
                        break;
                    }
                    if (iWkCode == iFstCode)
                    {
                        //@ Unsupported property or method(C): 'Enabled'
                        PMComboBox3.Enabled = true;
                        //@ Unsupported property or method(C): 'ItemIndex'
                        PMComboBox3.ItemIndex = iIndex1;
                        //@ Unsupported property or method(A): 'Items'
                        // 選択不可
                        if (PMComboBox3.Items[iNumb - 1] == "-,")
                        {
                            //@ Unsupported property or method(C): 'Caption'
                            PMPanelHdSjFst.Caption = "   - " + Itm.ReadIniRec(iFstCode).sCaption;
                        }
                        else
                        {
                            //@ Unsupported function or procedure: 'Format'
                            //@ Unsupported property or method(C): 'Caption'
                            PMPanelHdSjFst.Caption = Format("  %2d ", new int[] {iIndex1 + 1}) + Itm.ReadIniRec(iFstCode).sCaption;
                        }
                        iNumb = iIndex1 + 1;
                        cRoot.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FST_NUMB, iNumb);
                        // 第１指示の選択指示Ｎｏ
                        cRoot.Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FST_CODE, iFstCode);
                        // 第１指示の選択処理ｺｰﾄﾞ
                        break;
                    }
                }
            }
            if (iSndCode !=  -1)
            {
                for (iIndex1 = 0; iIndex1 <= 100; iIndex1 ++ )
                {
                    iWkCode = Itm.ReadIniInt(iFstCode, "Code", iIndex1 + 1);
                    if (iWkCode ==  -1)
                    {
                        break;
                    }
                    if (iWkCode == iSndCode)
                    {
                        //@ Unsupported property or method(C): 'Enabled'
                        PMComboBox4.Enabled = true;
                        //@ Unsupported property or method(C): 'Items'
                        //@ Unsupported property or method(D): 'Clear'
                        PMComboBox4.Items.Clear;
                        for (iIndex2 = 0; iIndex2 <= 100; iIndex2 ++ )
                        {
                            iWkCode = Itm.ReadIniInt(iFstCode, "Code", iIndex2 + 1);
                            if (iWkCode > 0)
                            {
                                //@ Unsupported function or procedure: 'Format'
                                //@ Unsupported property or method(C): 'Items'
                                //@ Unsupported property or method(B): 'Add'
                                PMComboBox4.Items.Add(Format("%d", new int[] {iIndex2 + 1}) + ',' + Itm.ReadIniRec(iWkCode).sCaption);
                            }
                        }
                        //@ Unsupported property or method(C): 'ItemIndex'
                        PMComboBox4.ItemIndex = iIndex1;
                        //@ Unsupported function or procedure: 'Format'
                        //@ Unsupported property or method(C): 'Caption'
                        PMPanelHdSjSnd.Caption = Format("  %2d ", new int[] {iIndex1 + 1}) + Itm.ReadIniRec(iSndCode).sCaption;
                        break;
                    }
                }
            }
            else
            {
                //@ Unsupported property or method(C): 'Enabled'
                PMComboBox4.Enabled = false;
                //@ Unsupported property or method(C): 'Items'
                //@ Unsupported property or method(D): 'Clear'
                PMComboBox4.Items.Clear;
                //@ Unsupported property or method(C): 'Caption'
                PMPanelHdSjSnd.Caption = "";
            }
        }

#endif
    } // end TMASL310Ind

    // __MASL310INDH_INC__
    // ******************************************************************************
    // Proccess	:	TMASL310SelMonth
    // Name		:	K.Hattori(MJS)
    // Date		:	2000/12/08
    // Parameter	:
    // Return		:
    // ******************************************************************************
    // (*H0001	20010515 khattori 月の表現*)
    public class TMASL310SelMonth: ArrayList
    {
        // Published 宣言
        public int WaSei
        {
          get {
            return iWrekiSreki;
          }
          set {
            SetWaSei(value);
          }
        }
        // 和暦／西暦区分
        public int EntStr
        {
          get {
            return iEntStrMonth;
          }
          set {
            SetEntStr(value);
          }
        }
        // 仕訳入力開始月
        public int TrmStr
        {
          get {
            return iTrmStrDate;
          }
          set {
            SetTrmStr(value);
          }
        }
        // 決算開始日
        public int TrmEnd
        {
          get {
            return iTrmEndDate;
          }
          set {
            SetTrmEnd(value);
          }
        }
        // 決算終了日
        public int Gettyuu
        {
          get {
            return iGettyuu;
          }
          set {
            SetGettyuu(value);
          }
        }
        // 月中開始日
        public int Kessan
        {
          get {
            return iKessan;
          }
          set {
            SetKessan(value);
          }
        }
        // 中間決算採用区分
        public int Kotei
        {
          get {
            return GetKotei();
          }
          set {
            SetKotei(value);
          }
        }
        // 月固定／月可変区分
        public TMASL310IMonth CurMonth
        {
          get {
            return rMMonth;
          }
          set {
            SetCurMonth(value);
          }
        }
        // Private 宣言
        private int iWrekiSreki = 0;
        // 和暦／西暦区分
        private int iEntStrMonth = 0;
        // 仕訳入力開始月
        private int iTrmStrDate = 0;
        // 決算開始日
        private int iTrmEndDate = 0;
        // 決算終了日
        private int iGettyuu = 0;
        // 月中開始日
        private int iKessan = 0;
        // 中間決算採用区分
        private int iKotei = 0;
        // 月固定／月可変区分
        private TMASL310IMonth rMMonth = null;
        // Public 宣言
        public object m_pRoot = null;
        public TMjsAppRecord m_pRec = null;
        // Bpl管理構造体
        // sTukiKahenView		:	String;
        // __MASL310INDB_INC__
        // ******************************************************************************
        // Proccess	:	TMASL310SelMonth
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:
        // Return		:
        // ******************************************************************************
        // (*H0001	20010515 khattori 月の表現*)
        // (*H0038 20030904 khattori	分散入力<単一入力>*)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create()
        public TMASL310SelMonth() : base()
        {
            rMMonth.iInner =  -1;
            // 内部月

        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetRootAddress(object[] arPrm01)
        {
            m_pRoot = arPrm01[0];
            m_pRec = arPrm01[1];
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 終了処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //@ Destructor  Destroy()
        ~TMASL310SelMonth()
        {
            DeleteItem();
            base.Destroy();
        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 削除処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void DeleteItem()
        {
            int idx;
            TMASL310IMonth prMonth;
            for (idx = 0; idx < this.Count; idx ++ )
            {
                if (this[idx] != null)
                {
                    prMonth = this[idx];
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(prMonth);
                }
            }
            this.Clear();
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 作成処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void Init(object AOwner, TMDataModulef m_cMDModule, int iMode)
        {
            TMasMonth cMasMonth;
            TDataBase m_FCopDB;
            // (*db*)
            TMQuery m_FdqMonthInfo;
            // (*db*)
            TMQuery m_FdqMFixInfo;
            // (*db*)
            // (*H0001	20010515 khattori 月の表現*)
            // m_FdqNamInfo	:	TMQuery;		(*db*)
            // saKessan		:	array[0..3] of array[0..2] of String;	//	決算月の文言
            string sDateDsp;
            string snMonth;
            int iFixKbn1;
            int idx;
            int idxStr;
            int idxEnd;
            enTblList tlTblList;
            object pQuery;
            int iHassei;
            int iEComKbn5;
            string sHassei;
            // 仕訳発生区分
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_DTMAIN;
            pQuery = ((m_pRoot) as TMASL310Root).Pfnc(VKZ310Cmnu.enPfunc.MASL_PREF_TBL_LIST, tlTblList);
            iHassei = 0;
            iEComKbn5 = 0;
            if (pQuery != null)
            {
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                iHassei = TMQuery(pQuery).GetFld("DataKbn").AsInteger;
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                iEComKbn5 = TMQuery(pQuery).GetFld("EComKbn5").AsInteger;
            }
            if (iHassei == 0)
            {
                sHassei = '0';
            }
            else
            {
                sHassei = (iHassei).ToString();
            }
            if (m_cMDModule != null)
            {
                //@ Unsupported property or method(A): 'COPDBOpen'
                m_FCopDB = m_cMDModule.COPDBOpen(0, m_pRec.m_iCorpID);
                if (m_FCopDB != null)
                {
                    m_FdqMonthInfo = new TMQuery(AOwner);
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FCopDB, m_FdqMonthInfo);
                    cMasMonth = new TMasMonth();
                    //@ Unsupported property or method(A): 'Init'
                    cMasMonth.Init(m_FdqMonthInfo);
                    // (*H0001	20010515 khattori 月の表現*)
                    // m_FdqNamInfo:=TMQuery.Create(AOwner);
                    // m_cMDModule.SetDBInfoToQuery(m_FCopDB,m_FdqNamInfo);
                    // with	m_FdqNamInfo	do
                    // begin
                    // Close;
                    // SQL.Clear;
                    // SQL.ADD('SELECT NamCode,NamValue ');
                    // SQL.ADD('FROM NamInfo ');
                    // SQL.ADD('WHERE NamCode BETWEEN 111 AND 143 ');
                    // SQL.ADD('ORDER BY NamCode');//　昇順
                    // Open;
                    // while not eof do
                    // begin
                    // case GetFld('NamCode').AsInteger of
                    // 111:	saKessan[0][0]		:= GetFld('NamValue').AsString;		//　21月
                    // 112:	saKessan[0][1]		:= GetFld('NamValue').AsString;		//　22月
                    // 113:	saKessan[0][2]		:= GetFld('NamValue').AsString;		//　23月
                    // 121:	saKessan[1][0]		:= GetFld('NamValue').AsString;		//　81月
                    // 122:	saKessan[1][1]		:= GetFld('NamValue').AsString;		//　82月
                    // 123:	saKessan[1][2]		:= GetFld('NamValue').AsString;		//　83月
                    // 131:	saKessan[2][0]		:= GetFld('NamValue').AsString;		//　31月
                    // 132:	saKessan[2][1]		:= GetFld('NamValue').AsString;		//　32月
                    // 133:	saKessan[2][2]		:= GetFld('NamValue').AsString;		//　33月
                    // 141:	saKessan[3][0]		:= GetFld('NamValue').AsString;		//　91月
                    // 142:	saKessan[3][1]		:= GetFld('NamValue').AsString;		//　92月
                    // 143:	saKessan[3][2]		:= GetFld('NamValue').AsString;		//　93月
                    // end;
                    // Next;
                    // end;
                    // Close;
                    // Free;
                    // end;
                    m_FdqMFixInfo = new TMQuery(AOwner);
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FCopDB, m_FdqMFixInfo);
                    DeleteItem();
                    //@ Unsupported property or method(D): 'RecMax'
                    for (idx = 0; idx <= m_FdqMFixInfo.RecMax; idx ++ )
                    {
                        // 実在？
                        //@ Unsupported property or method(B): 'MonthRec'
                        //@ Unsupported property or method(D): 'iNMonth'
                        //@ Unsupported property or method(B): 'MonthRec'
                        //@ Unsupported property or method(D): 'iSaiyo'
                        if ((m_FdqMFixInfo.MonthRec[idx].iNMonth ==  -1) || (m_FdqMFixInfo.MonthRec[idx].iSaiyo == 1))
                        {
                            continue;
                        }
                        idxStr = idx;
                        idxEnd = idx;
                        // ※　仕訳入力開始月に締め後及び決算月が指定されることは無い	20001116 岩田部長に確認済み
                        // ０月
                        if (idx == 0)
                        {
                            // (*H0038 20030904 khattori	分散入力<単一入力>*)
                            // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR		)	and
                            if ((m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU_BUN) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN) && (m_pRec.m_iProgramCode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN))
                            {
                                continue;
                            }
                            // 出納帳入力は０月無し
                            // if	(m_pRec^.m_iProgramCode<>MASL_PROC_CODE_TAXITU) and
                            // (m_pRec^.m_iProgramCode<>MASL_PROC_CODE_MONTHR)	then	continue;	//	出納帳入力は０月無し
                            // if	(m_pRec^.m_iProgramCode=311000)	then	continue;	//	出納帳入力は０月無し
                            idxEnd = EntStr;
                        // ０月の終了日は、仕訳入力開始月の開始日前の日
                        // idxEnd:=EntStr-1;	//	０月の終了日は、仕訳入力開始月の前の月の終了日
                        // if	(idxEnd<>0) and ((idxEnd mod 10)=0)	then	idxEnd:=idxEnd-3;
                        }
                        // ---<VK07> Del ----------------------------------------------------------------
                        // else if idx<EntStr	then	continue;	//	仕訳入力開始月以前
                        // -----------------------------------------------------------------<VK07> Del---
                        if (idx == 0)
                        {
                            snMonth = '0';
                        }
                        else
                        {
                            snMonth = (idx).ToString();
                        }
                        // 翌期で、翌期更新済みのとき、入力／修正／削除不可
                        if (((idx / 40 as object) == 1) && (iEComKbn5 == 1))
                        {
                            iFixKbn1 = 1;
                        }
                        else
                        {
                            // 月次確定情報	MFixInfo
                            //@ Unsupported function or procedure: 'Close'
                            Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            m_FdqMFixInfo.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            m_FdqMFixInfo.SQL.Add("select SwkInpKbn from MFixInfo");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            m_FdqMFixInfo.SQL.Add("where(NMonth=" + snMonth + ")and(FixKbn1=1)");
                            // SQL.Add('where((SwkInpKbn<='+sHassei+')and');
                            // SQL.Add('()');
                            //@ Unsupported property or method(D): 'Open'
                            m_FdqMFixInfo.Open;
                            iFixKbn1 = 0;
                            //@ Unsupported function or procedure: 'eof'
                            while (!eof)
                            {
                                // 自分が月次確定
                                // ---<VK07> 上位は見ない--------------------------------------------------------
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                if (m_FdqMFixInfo.GetFld("SwkInpKbn").AsInteger == iHassei)
                                {
                                    // if	GetFld('SwkInpKbn').AsInteger<=iHassei	then
                                    // ---------------------------------------------------------------------<VK07>---
                                    iFixKbn1 = 1;
                                    break;
                                }
                                // 直下が月次確定
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                if (m_FdqMFixInfo.GetFld("SwkInpKbn").AsInteger == iHassei + 1)
                                {
                                    iFixKbn1 = 2;
                                }
                                //@ Unsupported property or method(D): 'NEXT'
                                m_FdqMFixInfo.NEXT;
                            }
                        }
                        // (*H0001	20010515 khattori 月の表現*)
                        if ((idx % 10) > 4)
                        {
                            //@ Unsupported property or method(B): 'MonthRec'
                            //@ Unsupported property or method(D): 'sDateDsp1'
                            sDateDsp = m_FdqMFixInfo.MonthRec[idx].sDateDsp1;
                        }
                        // if	idx>44				then	sDateDsp:=saKessan[0][idx - 45]
                        // else if	(idx mod 10)>4	then	sDateDsp:=saKessan[idx div 10][idx mod 10 - 5];
                        // if	((idx mod 10)>4) and (sDateDsp='')	then	sDateDsp:=MonthRec[idx].sDateDsp1;
                        // ０月
                        if (idx == 0)
                        {
                            // 月選択リスト作成
                            //@ Unsupported property or method(B): 'MonthRec'
                            //@ Unsupported property or method(D): 'iExMonth'
                            //@ Unsupported property or method(B): 'MonthRec'
                            //@ Unsupported property or method(D): 'dStDate'
                            //@ Unsupported function or procedure: 'FormatDateTime'
                            //@ Unsupported property or method(B): 'MonthRec'
                            //@ Unsupported property or method(D): 'dStDate'
                            //@ Unsupported function or procedure: 'FormatDateTime'
                            SetRecSet(idx, m_FdqMFixInfo.MonthRec[idx].iExMonth, iFixKbn1, (idx / 40 as object), Convert.ToInt32(FormatDateTime("yyyymmdd", m_FdqMFixInfo.MonthRec[idxStr].dStDate)), Convert.ToInt32(FormatDateTime("yyyymmdd", m_FdqMFixInfo.MonthRec[idxEnd].dStDate - 1)));
                        }
                        else
                        {
                            // 月選択リスト作成
                            //@ Unsupported property or method(B): 'MonthRec'
                            //@ Unsupported property or method(D): 'iExMonth'
                            //@ Unsupported property or method(B): 'MonthRec'
                            //@ Unsupported property or method(D): 'dStDate'
                            //@ Unsupported function or procedure: 'FormatDateTime'
                            //@ Unsupported property or method(B): 'MonthRec'
                            //@ Unsupported property or method(D): 'dEdDate'
                            //@ Unsupported function or procedure: 'FormatDateTime'
                            // (*H0001	20010515 khattori 月の表現*)
                            SetRecSet(idx, m_FdqMFixInfo.MonthRec[idx].iExMonth, iFixKbn1, (idx / 40 as object), Convert.ToInt32(FormatDateTime("yyyymmdd", m_FdqMFixInfo.MonthRec[idxStr].dStDate)), Convert.ToInt32(FormatDateTime("yyyymmdd", m_FdqMFixInfo.MonthRec[idxEnd].dEdDate)), sDateDsp);
                        }
                    }
                    //@ Unsupported property or method(C): 'Free'
                    cMasMonth.Free;
                    //@ Unsupported property or method(D): 'Free'
                    m_FdqMFixInfo.Free;
                    //@ Unsupported property or method(D): 'Free'
                    m_FdqMonthInfo.Free;
                    //@ Unsupported property or method(A): 'COPDBClose'
                    m_cMDModule.COPDBClose(m_FCopDB);
                }
            }
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 作成処理（ＦＡＳ専用）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void Init()
        {
            // ０月
            // 月選択リスト作成
            SetRecSet(0, 0, 0, 0, 0, 1);
        }

        // (*H0001	20010515 khattori 月の表現*)
        // 月次確定情報	MFixInfo
        // 内部月			NMonth		"0月：当期以前	1月〜37月：当期	41月〜47月：翌期"
        // 仕訳発生区分	SwkInpKbn	0:事務所（全店） 1:顧問先（本店） 2:支店 3:部署
        // 月次確定区分	FixKbn1		1:確定済 2:確定後解除
        // 予備			FixKbn2
        // 更新日時		UpdateTime	yyyy/mm/dd hh:mm:ss
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 作成処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // (*H0001	20010515 khattori 月の表現*)
        public void SetRecSet(int iInner, int iOuter, int iFixMonth, int iNextTerm, int iStartDate, int iEndDate, string sDateDsp)
        {
            // (iInner,iOuter,iFixMonth,iNextTerm,iStartDate,iEndDate:Integer);
            // const
            // 決算月の文言
            // saKessan: array[0..4] of array[0..2] of String=
            // ((	'第１四半期決算月１'		,'第１四半期決算月２'		,'第１四半期決算月３'		),
            // (	'中間決算月１'				,'中間決算月２'				,'中間決算月３'				),
            // (	'第３四半期決算月１'		,'第３四半期決算月２'		,'第３四半期決算月３'		),
            // (	'決算月１'					,'決算月２'					,'決算月３'					),
            // (	'翌期　第１四半期決算月１'	,'翌期　第１四半期決算月２'	,'翌期　第１四半期決算月３'	));
            TMASL310IMonth prMonth;
            string sSel;
            string sViewM;
            string sViewF;
            string sViewN;
            string sViewT;
            int iWork;
            // 選択文字
            if (iNextTerm == 1)
            {
                sSel = '.';
            }
            // 翌期
            sSel = sSel + (iOuter).ToString();
            // 外部月
            // ２桁目使用可能
            if (iOuter == 1)
            {
                sSel = sSel + '.';
            }
            // １月（１０、１１、１２月が有る為）
            if ((iOuter == 2) && (Kessan == 2))
            {
                sSel = sSel + '.';
            }
            // ２月（２１、２２、２３月が有る為）
            if ((iOuter == 3) && (Kessan == 2))
            {
                sSel = sSel + '.';
            }
            // ３月（３１、３２、３３月が有る為）
            if ((iOuter == 8) && (Kessan > 0))
            {
                sSel = sSel + '.';
            }
            // ８月（８１、８２、８３月が有る為）
            if (iOuter == 9)
            {
                sSel = sSel + '.';
            }
            // ９月（９１、９２、９３月が有る為）
            sViewM = (iOuter).ToString() + '月';
            // 編集部表示文字
            sViewF = "";
            if (iFixMonth == 1)
            {
                sViewF = '◎';
            }
            // 月次確定済み
            // ※※※※※	事務所で見た時の顧問先の月次確定を○で表示する	※※※※※
            if (iFixMonth == 2)
            {
                sViewF = '○';
            }
            // 月次確定済み
            sViewN = "";
            if (iNextTerm == 1)
            {
                sViewN = '翌';
            }
            // 翌期
            // 期間部表示文字
            // (*H0001	20010515 khattori 月の表現*)
            if (iInner > 44)
            {
                sViewT = "翌期　" + sDateDsp;
            }
            else if ((iInner % 10) > 4)
            {
                sViewT = sDateDsp;
            }
            else
            {
                if ((iStartDate != 0) && (iInner != 0))
                {
                    iWork = iStartDate / 10000;
                    if (iNextTerm == 1)
                    {
                        if (WaSei == 0)
                        {
                            iWork = iWork - 1988;
                        }
                        // 和暦
                        sViewT = (iWork).ToString() + '/';
                    // 西暦
                    }
                    iWork = (iStartDate / 100) % 100;
                    sViewT = sViewT + (iWork).ToString() + '/';
                    iWork = iStartDate % 100;
                    sViewT = sViewT + (iWork).ToString();
                    // (*H0001	20010515 khattori 月の表現*)
                    if ((iStartDate != iEndDate) && (iEndDate != 0))
                    {
                        sViewT = sViewT + " 〜 ";
                    }
                }
                if (iStartDate != iEndDate)
                {
                    iWork = iEndDate / 10000;
                    if (iNextTerm == 1)
                    {
                        if (WaSei == 0)
                        {
                            iWork = iWork - 1988;
                        }
                        sViewT = sViewT + (iWork).ToString() + '/';
                    }
                    iWork = (iEndDate / 100) % 100;
                    sViewT = sViewT + (iWork).ToString() + '/';
                    iWork = iEndDate % 100;
                    sViewT = sViewT + (iWork).ToString();
                    if ((iInner == 0))
                    {
                        sViewT = sViewT + "以前";
                    }
                // ０月
                }
            }
            // 自分の基底クラスのＬｉｓｔへ追加（Disposeは終了処理で行う）
            prMonth = new TMASL310IMonth();
            prMonth.iInner = iInner;
            // 内部月
            prMonth.iOuter = iOuter;
            // 外部月
            prMonth.iFixMonth = iFixMonth;
            // 月次確定
            prMonth.iNextTerm = iNextTerm;
            // 翌期
            prMonth.sSelMonth = sSel;
            // Comboへの入力月
            prMonth.sViewFix = sViewF;
            // Combo上の月次確定文字
            prMonth.sViewNext = sViewN;
            // Combo上の翌期文字
            prMonth.sViewMonth = sViewM;
            // Combo上の表示月
            prMonth.sViewTerm = sViewT;
            // 期間
            prMonth.iStartDate = iStartDate;
            // 〃　開始日
            prMonth.iEndDate = iEndDate;
            // 〃　終了日
            this.Add(prMonth);
        }

        // procedure	SetRecSet	(iInner,iOuter,iFixMonth,iNextTerm,iStartDate,iEndDate:Integer);
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 和暦／西暦区分セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetWaSei(int iVar)
        {
            iWrekiSreki = iVar;
        }

        // 和暦／西暦区分セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 仕訳入力開始月セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetEntStr(int iVar)
        {
            if (iVar < 1)
            {
                iVar = 1;
            }
            iEntStrMonth = iVar;
        }

        // 仕訳入力開始月セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 決算開始年月日セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetTrmStr(int iVar)
        {
            iTrmStrDate = iVar;
        }

        // 決算開始年月日セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 決算終了年月日セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetTrmEnd(int iVar)
        {
            iTrmEndDate = iVar;
        }

        // 決算終了年月日セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 月中開始日セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetGettyuu(int iVar)
        {
            iGettyuu = iVar;
        }

        // 月中開始日セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 中間決算採用区分セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetKessan(int iVar)
        {
            iKessan = iVar;
        }

        // 中間決算採用区分セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 月固定／月可変区分セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetKotei(int iVar)
        {
            iKotei = iVar;
        }

        // 月固定／月可変区分
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // カレント月セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetCurMonth(TMASL310IMonth rVar)
        {
            rMMonth = rVar;
        }

        // カレント月セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 月固定／月可変区分ゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public int GetKotei()
        {
            int result;
            result = iKotei;
            if ((CurMonth.iInner == 0) || (CurMonth.iInner > 40))
            {
                result = 0;
            }
            // ０月と翌期は月固定

            return result;
        }

#endif
    } // end TMASL310SelMonth

    // __MASL310SELMONTHH_INC__
    // ******************************************************************************
    // Proccess	:	TMASL310GetTaxRate
    // Name		:	T.Yamaguchi(MJS)
    // Date		:	2013/06/21
    // Uses		:	Windows, Classes, Graphics, Controls
    // History		:
    // ******************************************************************************
    // 科目情報レコード
    public struct TKmkRec
    {
        public int iGCd;
        // 科目コード
        public int iDCKbn;
        // 正残区分		(0:借方 1:貸方)
        public int iTKbn;
    } // end TKmkRec

    // 消費税率管理クラス
    public class TMASL310GetTaxRate
    {
        private TMDataModulef DataModule
        {
          get {
            return GetDModule();
          }
        }
        // 会計期間(自／至)    ※自身で取得しているが外部からも変更できるようにしておく
        public int StDate
        {
          get {
            return m_iStDate;
          }
          set {
            m_iStDate = value;
          }
        }
        public int EdDate
        {
          get {
            return m_iEdDate;
          }
          set {
            m_iEdDate = value;
          }
        }
        private TMjsAppRecord m_pRec = null;
        private TMASL310ITaxRate[] m_DicRate;
        // DIC_COTXRATE データ
        private int m_iStDate = 0;
        // 会計期間(自)
        private int m_iEdDate = 0;
        // 会計期間(至)    ※翌３ヶ月を含む
        private byte m_iNUseRate = 0;
        // 消費税率入力区分(0:すべて使用)
        private int m_iImport = 0;
        // 輸入取引区分
        private int m_iKCdRTax = 0;
        // 特定科目コード：仮受消費税
        private int m_iKCdPTax = 0;
        // 特定科目コード：仮払消費税
        private int m_iKCdSAdj = 0;
        // 特定科目コード：売上調整勘定
        private int m_iKCdPAdj = 0;
        // 特定科目コード：仕入調整勘定
        private int[] m_iKCdBDbt;
        // __MASL310SELMONTHB_INC__
        // ******************************************************************************
        // Proccess	:	TMASL310GetTaxRate
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2013/06/21
        // Uses		:	Windows, Classes, Graphics, Controls
        // History		:
        // ******************************************************************************
        // TMASL310GetTaxRate
        // ******************************************************************************
        // Proccess  :	初期処理
        // Parameter : pRoot	^TMASL310Root			//	使用しない(互換性のため)
        // pRec	^TMjsAppRecord
        // Return    : None
        // ******************************************************************************
        public void Init(object pRoot, object pRec)
        {
            m_pRec = pRec;
            ReadData();
            MakeDicRate();
        }

        // ******************************************************************************
        // Proccess  :	消費税率 情報取得
        // Parameter : pPar	^TMASL310ITaxParam
        // Return    : Integer	セットされた消費税率情報のレコード数
        // ******************************************************************************
        public int GetTaxRate(object pPar)
        {
            int result;
            int iCombi;
            // 消費税性格(enTaxCombi の Integer 値)
            TKmkRec[] rcKms = new TKmkRec[1 + 1];
            TMASL310ITaxRate[] arRet;
            result = 0;
            if (pPar == null)
            {
                return result;
            }
            // 戻り値用変数初期化
            //@ Unsupported function or procedure: 'FillChar'
            FillChar(arRet, sizeof(arRet), 0);
            TMASL310ITaxParam _wvar1 = ((TMASL310ITaxParam)(pPar));
            TMASL310ITaxJudge _wvar2 = _wvar1.stTaxJudge;
            try {
                iCombi = (int)(_wvar2.eTaxCombi);
                // 科目情報
                rcKms[0].iGCd = _wvar2.iKMRGCode;
                // 借方 科目コード
                rcKms[0].iDCKbn = _wvar2.iKMRDCKbn;
                // 借方 正残区分
                rcKms[0].iTKbn = _wvar2.iKMRTaxKbn;
                // 借方 消費税科目区分
                rcKms[1].iGCd = _wvar2.iKMSGCode;
                // 貸方 科目コード
                rcKms[1].iDCKbn = _wvar2.iKMSDCKbn;
                // 貸方 正残区分
                rcKms[1].iTKbn = _wvar2.iKMSTaxKbn;
                // 貸方 消費税科目区分
                // 消費税科目性格 自動算出
                if (iCombi == (int)(VKZ310Cmnu.enTaxCombi.MASL_TAX_AUTO))
                {
                    iCombi = GetTaxCombi(rcKms);
                }
                // 消費税率情報 取得
                if (iCombi != (int)(VKZ310Cmnu.enTaxCombi.MASL_TAX_FREE))
                {
                    result = CalcTaxRate(((enTaxCombi)(iCombi)), _wvar1.iPrimCd, _wvar1.iPrimRateCd, _wvar1.iDate, _wvar1.bInput, _wvar1.bTeikei, ref arRet);
                }
            } finally {
                _wvar1.stTaxRate = arRet;
            }
            return result;
        }

        // 特定科目コード：貸倒償却１〜５
        // ******************************************************************************
        // Proccess  :	貸借科目から消費税性格を取得
        // Parameter : rcKms	array of TKmkRec	科目情報レコード [0:借方] [1:貸方]
        // Return    : Integer						消費税性格
        // ******************************************************************************
        private int GetTaxCombi(TKmkRec[] rcKms)
        {
            int result;
            // 貸方	非消	売上	仕入	売調	仕調	仮受	仮払	貸倒
            // 借方
            // 非消費税	Ｘ		売		仕		売		Ｘ		受		払		倒
            // 売上		売		売		売		売		売		受		払		Ｘ
            // 仕入		仕		仕		仕		仕		仕		受		払		Ｘ
            // 売上調整	Ｘ		売		仕		売		Ｘ		受		払		倒
            // 仕入調整	仕		仕		仕		仕		仕		受		払		Ｘ
            // 仮受消費税	受		受		受		受		受		受		受		Ｘ
            // 仮払消費税	払		払		払		払		払		払		払		Ｘ
            // 貸倒償却	倒		Ｘ		Ｘ		Ｘ		倒		Ｘ		Ｘ		倒
            int[, ] CombiPtn = {{0, 1, 2, 1, 0, 5, 6, 7}, {1, 1, 1, 1, 1, 5, 6, 0}, {2, 2, 2, 2, 2, 5, 6, 0}, {0, 1, 2, 1, 0, 5, 6, 7}, {2, 2, 2, 2, 2, 5, 6, 0}, {5, 5, 5, 5, 5, 5, 5, 0}, {6, 6, 6, 6, 6, 6, 6, 0}, {7, 0, 0, 0, 7, 0, 0, 7}};
            int iDCombi;
            // 消費税性格(借方)
            int iCCombi;
            // 消費税性格(貸方)
            iDCombi = (int)(VKZ310Cmnu.enTaxCombi.MASL_TAX_FREE);
            iCCombi = (int)(VKZ310Cmnu.enTaxCombi.MASL_TAX_FREE);
            // 借方
            if (rcKms[0].iGCd != 0)
            {
                iDCombi = GetKmkCombi(rcKms[0], 0);
            }
            else if (rcKms[1].iGCd != 0)
            {
                iDCombi = GetKmkCombi(rcKms[1], 0);
            }
            // 貸方
            if (rcKms[1].iGCd != 0)
            {
                iCCombi = GetKmkCombi(rcKms[1], 1);
            }
            else if (rcKms[0].iGCd != 0)
            {
                iCCombi = GetKmkCombi(rcKms[0], 1);
            }
            result = CombiPtn[iDCombi][iCCombi];
            return result;
        }

        // ******************************************************************************
        // Proccess  :	科目の消費税性格を取得
        // Parameter :	rcKm	TKmkRec				科目情報レコード
        // iLoan	Integer				貸借			(0:借方 1:貸方)
        // Return    : Integer						消費税性格
        // ******************************************************************************
        private int GetKmkCombi(TKmkRec rcKm, int iLoan)
        {
            int result;
            enTaxCombi eRet;
            eRet = VKZ310Cmnu.enTaxCombi.MASL_TAX_FREE;
            result = (int)(eRet);
            try {
                if (rcKm.iGCd == 0)
                {
                    return result;
                }
                if ((rcKm.iGCd == m_iKCdRTax))
                {
                    // 仮受消費税
                    eRet = VKZ310Cmnu.enTaxCombi.MASL_TAX_RECEIVE;
                }
                else if ((rcKm.iGCd == m_iKCdPTax))
                {
                    // 仮払消費税
                    eRet = VKZ310Cmnu.enTaxCombi.MASL_TAX_PAYMENT;
                }
                else if ((rcKm.iGCd == m_iKCdSAdj))
                {
                    if ((rcKm.iDCKbn == iLoan))
                    {
                        // 売上調整勘定(正残のみ)
                        eRet = VKZ310Cmnu.enTaxCombi.MASL_TAX_SL_TUNE;
                    }
                }
                else if ((rcKm.iGCd == m_iKCdPAdj))
                {
                    if ((rcKm.iDCKbn == iLoan))
                    {
                        // 仕入調整勘定(正残のみ)
                        eRet = VKZ310Cmnu.enTaxCombi.MASL_TAX_ST_TUNE;
                    }
                }
                else if ((rcKm.iGCd == m_iKCdBDbt[1]) || (rcKm.iGCd == m_iKCdBDbt[2]) || (rcKm.iGCd == m_iKCdBDbt[3]) || (rcKm.iGCd == m_iKCdBDbt[4]) || (rcKm.iGCd == m_iKCdBDbt[5]))
                {
                    // 貸倒償却
                    eRet = VKZ310Cmnu.enTaxCombi.MASL_TAX_BAD_DEB;
                }
                else if ((rcKm.iTKbn == 1))
                {
                    // 売上
                    eRet = VKZ310Cmnu.enTaxCombi.MASL_TAX_SALE;
                }
                else if ((rcKm.iTKbn == 2))
                {
                    // 仕入
                    eRet = VKZ310Cmnu.enTaxCombi.MASL_TAX_STOCK;
                }
            } finally {
                result = (int)(eRet);
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	消費税率 算出
        // Parameter : eCombi	enTaxCombi		消費税性格
        // iTCd	Integer			消費税コード
        // iTRate	Integer			消費税率コード
        // iDate	Integer			日付
        // bInp	Boolean			入力モード(True:入力  False:検索条件)
        // bTeikei	Boolean			定型モード(True:定型  False:通常入力)
        // arRet	TMASL310ITaxRateAr
        // Return    : Integer					arRet のレコード数
        // ******************************************************************************
        private int CalcTaxRate(enTaxCombi eCombi, int iTCd, int iTRate, int iDate, bool bInp, bool bTeikei, ref TMASL310ITaxRate[] arRet)
        {
            int result;
            int iCnt;
            int iLoop;
            int iFm;
            int iTo;
            int iWk1;
            int iWk2;
            TBits TFlg;
            // 税率使用フラグ 消費税等(国税＋地方税)
            TBits SFlg;
            // 税率使用フラグ 国税
            TBits LFlg;
            // 税率使用フラグ 地方税
            byte[] ExFlg;
            // 例外税率区分値 0:標準税率 1:例外税率 2:施行日前 3:入力不可
            int iRCd;
            // 日付から判断した標準税率(入力不可を考慮しない)
            TMASL310ITaxRate[] wkRet;
            result = 0;
            iRCd =  -1;
            TFlg = new TBits();
            //@ Unsupported property or method(C): 'Size'
            TFlg.Size = m_DicRate.Length;
            SFlg = new TBits();
            //@ Unsupported property or method(C): 'Size'
            //@ Unsupported property or method(C): 'Size'
            SFlg.Size = TFlg.Size;
            LFlg = new TBits();
            //@ Unsupported property or method(C): 'Size'
            //@ Unsupported property or method(C): 'Size'
            LFlg.Size = TFlg.Size;
            try {
                iCnt =  -1;
                // 非課税、不課税、不明
                if ((new ArrayList(new int[] {30, 40, 99}).Contains(iTCd)))
                {
                    return result;
                // 輸出売上
                }
                else if ((eCombi == VKZ310Cmnu.enTaxCombi.MASL_TAX_SALE) && (iTCd >= 60 && iTCd<= 69))
                {
                    return result;
                // 不課税(免税)
                // 輸入仕入(内税)
                }
                else if ((eCombi == VKZ310Cmnu.enTaxCombi.MASL_TAX_STOCK) && (iTCd >= 70 && iTCd<= 79))
                {
                    iCnt = 0;
                    // 5% 以降の国税＋地方税
                    iFm = m_DicRate.GetUpperBound(0);
                    iTo = 2;
                    // 5%
                    for (iLoop = iFm; iLoop >= iTo; iLoop-- )
                    {
                        TFlg[iLoop] = true;
                    }
                // 輸入仕入(外税＆国税／地方税分割)
                }
                else if ((m_iImport == 2))
                {
                    // 仕入
                    if ((eCombi == VKZ310Cmnu.enTaxCombi.MASL_TAX_STOCK))
                    {
                        iFm = m_DicRate.GetUpperBound(0);
                        iTo = 2;
                        switch(iTCd)
                        {
                            // 5%
                            // Modify the A .. B: 60 .. 64
                            case 60:
                                // 輸入仕入(国税)
                                iCnt = 0;
                                for (iLoop = iFm; iLoop >= iTo; iLoop-- )
                                {
                                    SFlg[iLoop] = true;
                                }
                                break;
                            // Modify the A .. B: 65 .. 69
                            case 65:
                                // 輸入仕入(地方税)
                                iCnt = 0;
                                for (iLoop = iFm; iLoop >= iTo; iLoop-- )
                                {
                                    LFlg[iLoop] = true;
                                }
                                break;
                        }
                    // 仮払消費税
                    }
                    else if ((eCombi == VKZ310Cmnu.enTaxCombi.MASL_TAX_PAYMENT))
                    {
                        iFm = m_DicRate.GetUpperBound(0);
                        iTo = 2;
                        switch(iTCd)
                        {
                            case 0:
                                // 5%
                                // 指定なし
                                iCnt = 0;
                                iTo = 0;
                                // 0%
                                // 全部が対象
                                for (iLoop = iFm; iLoop >= iTo; iLoop-- )
                                {
                                    TFlg[iLoop] = true;
                                    SFlg[iLoop] = true;
                                    LFlg[iLoop] = true;
                                }
                                break;
                            // Modify the A .. B: 60 .. 64
                            case 60:
                                // 輸入仕入(国税)
                                iCnt = 0;
                                for (iLoop = iFm; iLoop >= iTo; iLoop-- )
                                {
                                    SFlg[iLoop] = true;
                                }
                                break;
                            // Modify the A .. B: 65 .. 69
                            case 65:
                                // 輸入仕入(地方税)
                                iCnt = 0;
                                for (iLoop = iFm; iLoop >= iTo; iLoop-- )
                                {
                                    LFlg[iLoop] = true;
                                }
                                break;
                        }
                    }
                }
            }
        }
    }
    // 通常の消費税取引
    if (iCnt ==  -1)
    {
        iCnt = 0;
        iFm = m_DicRate.GetUpperBound(0);
        iTo = 1;
        // 3%
        for (iLoop = iFm; iLoop >= iTo; iLoop-- )
        {
            TFlg[iLoop] = true;
        }
    }
    // 0%
    // 検索条件    条件指定なし
    // 定型モード  0%領域を「999:標準税率」として使う	※定型モードと検索モードの併用はない前提
    if (bTeikei || !bInp)
    {
        TFlg[0] = true;
    }
    // 補正(国税、地方税の 3%、0% は無効)
    for (iLoop = 0; iLoop <= 1; iLoop ++ )
    {
        SFlg[iLoop] = false;
        LFlg[iLoop] = false;
    }
    // 例外税率
    ExFlg = new byte[m_DicRate.Length];
    if (bInp)
    {
        //@ Unsupported function or procedure: 'FillChar'
        FillChar(ExFlg[0], sizeof(ExFlg[0]) * ExFlg.Length, 1);
        if (iDate > 0)
        {
            // チェック対象日
            iWk1 = iDate;
        }
        else
        {
            iWk1 = m_iStDate;
        }
        // 会計期間(自)
        iFm = m_DicRate.GetUpperBound(0);
        iTo = 1;
        // 3%
        for (iLoop = iFm; iLoop >= iTo; iLoop-- )
        {
            ExFlg[iLoop] = 0;
            // 標準税率
            if (iWk1 >= m_DicRate[iLoop].iStartYMD)
            {
                break;
            }
        }
    }
    else
    {
        // 例外税率の設定はしない(すべて標準扱い)
        //@ Unsupported function or procedure: 'FillChar'
        FillChar(ExFlg[0], sizeof(ExFlg[0]) * ExFlg.Length, 0);
    }
    // 施行日前
    if (iDate > 0)
    {
        // チェック対象日
        iWk1 = iDate;
    }
    else
    {
        iWk1 = m_iEdDate;
    }
    // 会計期間(至)
    iFm = m_DicRate.GetUpperBound(0);
    iTo = 2;
    // 5%	※3%は施行日チェックに含めない(仕訳入力は税率ありきなので消費税がない期間も3%として扱う)
    for (iLoop = iFm; iLoop >= iTo; iLoop-- )
    {
        if (iWk1 < m_DicRate[iLoop].iStartYMD)
        {
            ExFlg[iLoop] = 2;
        // 施行日前
        }
    }
    // 日付から判断した標準税率を保存
    iFm = m_DicRate.GetUpperBound(0);
    iTo = 1;
    // 3%
    for (iLoop = iFm; iLoop >= iTo; iLoop-- )
    {
        if (ExFlg[iLoop] == 0)
        {
            iRCd = iLoop;
            break;
        }
    }
    // 入力不可(消費税率入力区分を参照)
    // 検索条件、定型モード(登録処理)は適用対象外
    if (bInp && !bTeikei)
    {
        iFm = m_DicRate.GetUpperBound(0);
        iTo = 1;
        // 3%
        for (iLoop = iFm; iLoop >= iTo; iLoop-- )
        {
            iWk1 = m_iNUseRate >> (iLoop - 1);
            // 対象の税率を０ビット目に移動
            if ((iWk1 & 1) != 0)
            {
                // ０ビット目は１か？(１なら使用不可)
                ExFlg[iLoop] = 3;
            // 入力不可
            }
        }
    }
    // 消費税率構造体 取得
    //@ Unsupported function or procedure: 'FillChar'
    FillChar(wkRet, sizeof(wkRet), 0);
    iFm = m_DicRate.GetUpperBound(0);
    iTo = 1;
    // 3%
    // 消費税等(国税＋地方税)
    for (iLoop = iFm; iLoop >= iTo; iLoop-- )
    {
        if (TFlg[iLoop])
        {
            iCnt ++;
            wkRet[iCnt] = GetRateRec(iLoop, 0);
            wkRet[iCnt].iStandard = ExFlg[iLoop];
        }
    }
    // 国税
    for (iLoop = iFm; iLoop >= iTo; iLoop-- )
    {
        if (SFlg[iLoop])
        {
            iCnt ++;
            wkRet[iCnt] = GetRateRec(iLoop, 1);
            wkRet[iCnt].iStandard = ExFlg[iLoop];
        }
    }
    // 地方税
    for (iLoop = iFm; iLoop >= iTo; iLoop-- )
    {
        if (LFlg[iLoop])
        {
            iCnt ++;
            wkRet[iCnt] = GetRateRec(iLoop, 2);
            wkRet[iCnt].iStandard = ExFlg[iLoop];
        }
    }
    // 0%
    if (TFlg[0])
    {
        iCnt ++;
        wkRet[iCnt] = GetRateRec(0, 0);
        // 定型モード
        if (bTeikei)
        {
            // 「999:標準税率」として扱う
            wkRet[iCnt].iRateCD = 999;
        }
    }
    // 並べ替え(トグル順の考慮)
    iFm =  -1;
    iTo = iCnt;
    // 優先税率による並べ替え
    if (iTRate > 0)
    {
        for (iLoop = wkRet.GetLowerBound(0); iLoop <= iTo; iLoop ++ )
        {
            if (iTRate < 100)
            {
                iWk1 = iTRate;
            }
            else
            {
                iWk1 = (iTRate + 1 - 100) / 2 + 1;
            }
            if (wkRet[iLoop].iRateCD < 100)
            {
                iWk2 = wkRet[iLoop].iRateCD;
            }
            else
            {
                iWk2 = (wkRet[iLoop].iRateCD + 1 - 100) / 2 + 1;
            }
            if (iWk1 == iWk2)
            {
                iFm = iLoop;
                break;
            }
        }
    }
    // 使用可能税率(標準税率 or 例外税率)による並べ替え
    // 優先税率の指定なし or 優先税率と合致しなかったケース
    if (iFm ==  -1)
    {
        for (iLoop = wkRet.GetLowerBound(0); iLoop <= iTo; iLoop ++ )
        {
            if (new ArrayList(new int[] {0, 1}).Contains(wkRet[iLoop].iStandard))
            {
                iFm = iLoop;
                break;
            }
        }
    }
    // 入力不可まで緩和しての標準税率による並べ替え
    if ((iFm ==  -1) && (iRCd >  -1))
    {
        for (iLoop = wkRet.GetLowerBound(0); iLoop <= iTo; iLoop ++ )
        {
            if (wkRet[iLoop].iRateCD < 100)
            {
                iWk1 = wkRet[iLoop].iRateCD;
            }
            else
            {
                iWk1 = (wkRet[iLoop].iRateCD + 1 - 100) / 2 + 1;
            }
            if (iRCd == iWk1)
            {
                iFm = iLoop;
                break;
            }
        }
    }
    // 並べ替えあり
    if (iFm > wkRet.GetLowerBound(0))
    {
        iCnt = arRet.GetLowerBound(0) - 1;
        for (iLoop = iFm; iLoop <= iTo; iLoop ++ )
        {
            iCnt ++;
            arRet[iCnt] = wkRet[iLoop];
        }
        for (iLoop = wkRet.GetLowerBound(0); iLoop < iFm; iLoop ++ )
        {
            iCnt ++;
            arRet[iCnt] = wkRet[iLoop];
        }
    // 並べ替えなし
    }
    else
    {
        arRet = wkRet;
    }
    result = iCnt;
} finally {
    //@ Unsupported property or method(A): 'Free'
    TFlg.Free();
    //@ Unsupported property or method(A): 'Free'
    SFlg.Free();
    //@ Unsupported property or method(A): 'Free'
    LFlg.Free();
}
            return result;
        }

        // ******************************************************************************
        // Proccess  :	消費税率構造体 取得
        // Parameter : iCd		Integer			消費税率コード
        // iType	Integer			税率タイプ
        // 0: 消費税等(国税＋地方税)
        // 1: 国税
        // 2: 地方税
        // Return    : None
        // ******************************************************************************
        private TMASL310ITaxRate GetRateRec(int iCd, int iType)
        {
            TMASL310ITaxRate result;
            result.iStandard = 0;
            result.iClassCD = m_DicRate[iCd].iClassCD;
            result.iRateCD = m_DicRate[iCd].iRateCD;
            result.iStartYMD = m_DicRate[iCd].iStartYMD;
            result.iStateRate = m_DicRate[iCd].iStateRate;
            result.iLocalRate = m_DicRate[iCd].iLocalRate;
            // 国税、地方税分割は 5% から
            if ((iCd < 2) && (iType > 0))
            {
                iType = 0;
            }
            switch(iType)
            {
                case 1:
                    // 国税
                    result.iRateCD = (m_DicRate[iCd].iRateCD - 1) * 2 + 100 - 1;
                    result.iTaxRate = m_DicRate[iCd].iStateRate;
                    break;
                case 2:
                    // 地方税
                    result.iRateCD = (m_DicRate[iCd].iRateCD - 1) * 2 + 100;
                    result.iTaxRate = m_DicRate[iCd].iLocalRate;
                    break;
                default:
                    // 消費税等(国税＋地方税)
                    result.iRateCD = m_DicRate[iCd].iRateCD;
                    result.iTaxRate = m_DicRate[iCd].iTaxRate;
                    break;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ＤＢから必要な情報を取得
        // Parameter : None
        // Return    : None
        // ******************************************************************************
        private void ReadData()
        {
            TMQuery cQue;
            TDataBase cCopDB;
            int iCnt;
            int iLoop;
            if (DataModule != null)
            {
                cQue = new TMQuery(null);
                //@ Unsupported property or method(A): 'COPDBOpen'
                cCopDB = DataModule.COPDBOpen(0, m_pRec.m_iCorpID);
                //@ Unsupported property or method(C): 'SQL'
                 _wvar1 = cQue.SQL;
                try {
                    //@ Unsupported property or method(D): 'UniDirectional'
                    _wvar1.UniDirectional = true;
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    DataModule.SetDBInfoToQuery(cCopDB, cQue);
                    // 会社基本情報
                    //@ Unsupported property or method(B): 'BeginUpdate'
                    _wvar1.BeginUpdate();
                    //@ Unsupported property or method(B): 'Clear'
                    _wvar1.Clear();
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("SELECT KStDate FROM DTMAIN");
                    //@ Unsupported property or method(B): 'EndUpdate'
                    _wvar1.EndUpdate();
                    //@ Unsupported property or method(B): 'Open'
                    if (_wvar1.Open())
                    {
                        try {
                            //@ Unsupported function or procedure: 'Eof'
                            if (!Eof)
                            {
                                //@ Unsupported property or method(B): 'Fields'
                                //@ Unsupported property or method(D): 'AsDateTime'
                                //@ Unsupported function or procedure: 'FormatDateTime'
                                m_iStDate = Convert.ToInt32(FormatDateTime("yyyymmdd", _wvar1.Fields[0].AsDateTime));
                            }
                        // 会計期間(自)
                        } finally {
                            //Warning: unsupport Close
                            Close();
                        }
                    }
                    // 月度管理情報
                    //@ Unsupported property or method(B): 'BeginUpdate'
                    _wvar1.BeginUpdate();
                    //@ Unsupported property or method(B): 'Clear'
                    _wvar1.Clear();
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("SELECT EndDate FROM MonthInfo");
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("WHERE NMonth IN(37,47)");
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("ORDER BY NMonth DESC");
                    // 通常時:47月 短縮時:37月
                    //@ Unsupported property or method(B): 'EndUpdate'
                    _wvar1.EndUpdate();
                    //@ Unsupported property or method(B): 'Open'
                    if (_wvar1.Open())
                    {
                        try {
                            //@ Unsupported function or procedure: 'Eof'
                            if (!Eof)
                            {
                                //@ Unsupported property or method(B): 'Fields'
                                //@ Unsupported property or method(D): 'AsDateTime'
                                //@ Unsupported function or procedure: 'FormatDateTime'
                                m_iEdDate = Convert.ToInt32(FormatDateTime("yyyymmdd", _wvar1.Fields[0].AsDateTime));
                            }
                        // 会計期間(至) ※翌３ヶ月を含む
                        } finally {
                            //Warning: unsupport Close
                            Close();
                        }
                    }
                    // 区分情報
                    //@ Unsupported property or method(B): 'BeginUpdate'
                    _wvar1.BeginUpdate();
                    //@ Unsupported property or method(B): 'Clear'
                    _wvar1.Clear();
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("SELECT GnPuKbn31 FROM KbnInfo");
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("WHERE RecKbn=23");
                    //@ Unsupported property or method(B): 'EndUpdate'
                    _wvar1.EndUpdate();
                    //@ Unsupported property or method(B): 'Open'
                    if (_wvar1.Open())
                    {
                        try {
                            //@ Unsupported function or procedure: 'Eof'
                            if (!Eof)
                            {
                                //@ Unsupported property or method(B): 'Fields'
                                //@ Unsupported property or method(D): 'AsInteger'
                                m_iNUseRate = _wvar1.Fields[0].AsInteger;
                            }
                        // 消費税率入力区分
                        } finally {
                            //Warning: unsupport Close
                            Close();
                        }
                    }
                    // 消費税基本情報
                    //@ Unsupported property or method(B): 'BeginUpdate'
                    _wvar1.BeginUpdate();
                    //@ Unsupported property or method(B): 'Clear'
                    _wvar1.Clear();
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("SELECT ImportKbn FROM TaxInfo");
                    //@ Unsupported property or method(B): 'EndUpdate'
                    _wvar1.EndUpdate();
                    //@ Unsupported property or method(B): 'Open'
                    if (_wvar1.Open())
                    {
                        try {
                            //@ Unsupported function or procedure: 'Eof'
                            if (!Eof)
                            {
                                //@ Unsupported property or method(B): 'Fields'
                                //@ Unsupported property or method(D): 'AsInteger'
                                m_iImport = _wvar1.Fields[0].AsInteger;
                            }
                        // 輸入取引区分
                        } finally {
                            //Warning: unsupport Close
                            Close();
                        }
                    }
                    // 特定科目情報
                    //@ Unsupported property or method(B): 'BeginUpdate'
                    _wvar1.BeginUpdate();
                    //@ Unsupported property or method(B): 'Clear'
                    _wvar1.Clear();
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("SELECT SpeCode, KmkCode FROM KmkInfo");
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("WHERE (SpeCode>30100 AND SpeCode<30200)");
                    //@ Unsupported property or method(B): 'EndUpdate'
                    _wvar1.EndUpdate();
                    //@ Unsupported property or method(B): 'Open'
                    if (_wvar1.Open())
                    {
                        try {
                            //@ Unsupported function or procedure: 'Eof'
                            while (!Eof)
                            {
                                //@ Unsupported property or method(B): 'Fields'
                                //@ Unsupported property or method(D): 'AsInteger'
                                switch(_wvar1.Fields[0].AsInteger)
                                {
                                    case 30101:
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdRTax = _wvar1.Fields[1].AsInteger;
                                        break;
                                    case 30102:
                                        // 仮受消費税
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdPTax = _wvar1.Fields[1].AsInteger;
                                        break;
                                    case 30103:
                                        // 仮払消費税
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdSAdj = _wvar1.Fields[1].AsInteger;
                                        break;
                                    case 30104:
                                        // 売上調整勘定
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdPAdj = _wvar1.Fields[1].AsInteger;
                                        break;
                                    case 30105:
                                        // 仕入調整勘定
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdBDbt[1] = _wvar1.Fields[1].AsInteger;
                                        break;
                                    case 30106:
                                        // 貸倒償却１
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdBDbt[2] = _wvar1.Fields[1].AsInteger;
                                        break;
                                    case 30107:
                                        // 貸倒償却２
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdBDbt[3] = _wvar1.Fields[1].AsInteger;
                                        break;
                                    case 30108:
                                        // 貸倒償却３
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdBDbt[4] = _wvar1.Fields[1].AsInteger;
                                        break;
                                    case 30109:
                                        // 貸倒償却４
                                        //@ Unsupported property or method(B): 'Fields'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        m_iKCdBDbt[5] = _wvar1.Fields[1].AsInteger;
                                        break;
                                // 貸倒償却５
                                }
                                //@ Unsupported property or method(B): 'Next'
                                _wvar1.Next();
                            }
                        } finally {
                            //Warning: unsupport Close
                            Close();
                        }
                    }
                } finally {
                    //@ Unsupported property or method(B): 'Free'
                    cQue.Free();
                    //@ Unsupported property or method(A): 'COPDBClose'
                    DataModule.COPDBClose(cCopDB);
                }
            }
        }

        // ******************************************************************************
        // Proccess  :	消費税率構造体 辞書データ作成
        // Parameter : None
        // Return    : None
        // ******************************************************************************
        private void MakeDicRate()
        {
            TMQuery cQue;
            TDataBase cCmnDB;
            int iCnt;
            int iLoop;
            m_DicRate = null;
            if (DataModule != null)
            {
                cQue = new TMQuery(null);
                //@ Unsupported property or method(A): 'CTLDBOpen'
                cCmnDB = DataModule.CTLDBOpen();
                //@ Unsupported property or method(C): 'SQL'
                 _wvar1 = cQue.SQL;
                try {
                    //@ Unsupported property or method(D): 'UniDirectional'
                    _wvar1.UniDirectional = true;
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    DataModule.SetDBInfoToQuery(cCmnDB, cQue);
                    //@ Unsupported property or method(B): 'BeginUpdate'
                    _wvar1.BeginUpdate();
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("SELECT * FROM DIC_COTXRATE");
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("WHERE ClassCD=0");
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.Add("ORDER BY RateCD");
                    //@ Unsupported property or method(B): 'EndUpdate'
                    _wvar1.EndUpdate();
                    //@ Unsupported property or method(B): 'Open'
                    if (_wvar1.Open())
                    {
                        //@ Unsupported property or method(D): 'RecordCount'
                        iCnt = _wvar1.RecordCount;
                        m_DicRate = new TMASL310ITaxRate[iCnt + 1];
                        //@ Unsupported function or procedure: 'FillChar'
                        FillChar(m_DicRate[0], sizeof(m_DicRate[0]) * m_DicRate.Length, 0);
                        for (iLoop = 1; iLoop <= iCnt; iLoop ++ )
                        {
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            m_DicRate[iLoop].iClassCD = _wvar1.GetFld("ClassCD").AsInteger;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsInteger'
                            m_DicRate[iLoop].iRateCD = _wvar1.GetFld("RateCD").AsInteger;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsDateTime'
                            //@ Unsupported function or procedure: 'FormatDateTime'
                            m_DicRate[iLoop].iStartYMD = Convert.ToInt32(FormatDateTime("yyyymmdd", _wvar1.GetFld("StartYMD").AsDateTime));
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsCurrency'
                            m_DicRate[iLoop].iTaxRate = _wvar1.GetFld("TaxRate").AsCurrency;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsCurrency'
                            m_DicRate[iLoop].iStateRate = _wvar1.GetFld("StateRate").AsCurrency;
                            //@ Unsupported property or method(B): 'GetFld'
                            //@ Unsupported property or method(D): 'AsCurrency'
                            m_DicRate[iLoop].iLocalRate = _wvar1.GetFld("LocalRate").AsCurrency;
                            //@ Unsupported property or method(B): 'Next'
                            _wvar1.Next();
                        }
                        //Warning: unsupport Close
                        Close();
                    }
                } finally {
                    //@ Unsupported property or method(B): 'Free'
                    cQue.Free();
                    //@ Unsupported property or method(A): 'CTLDBClose'
                    DataModule.CTLDBClose(cCmnDB);
                }
            }
        }

        // ******************************************************************************
        // Property  :	DataModule
        // ******************************************************************************
        private TMDataModulef GetDModule()
        {
            TMDataModulef result;
            if (m_pRec == null)
            {
                result = null;
            }
            else
            {
                //@ Undeclared identifier(3): 'TMDataModulef'
                result = TMDataModulef(m_pRec.m_pDBModule);
            }
            return result;
        }

#endif
    } // end TMASL310GetTaxRate

    // __MASL310GETTAXRATEH_INC__
    // ******************************************************************************
    // System		: 顧問先入力システム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310EntryIF_VK07H
    // Comment		: 仕訳更新
    // ******************************************************************************
    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310TrnIFH
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // ******************************************************************************
    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310TrnSwkHeadH
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // ******************************************************************************
    public class TVKZL310Trn_SwkHead
    {
        public int IncSize
        {
          get {
            return FIncSize;
          }
          set {
            SetIncSize(value);
          }
        }
        public byte HSrchNoAutoSet
        {
          get {
            return FHSrchNoAutoSet;
          }
          set {
            SetHSrchNoAutoSet(value);
          }
        }
        // ヘッダ検索ＮＯ自動付番区分
        public DateTime DenDate
        {
          get {
            return FDenDate;
          }
          set {
            SetDenDate(value);
          }
        }
        // 伝票日付
        public byte NMonth
        {
          get {
            return FNMonth;
          }
          set {
            SetNMonth(value);
          }
        }
        // 仕訳内部月
        public byte SwkInpKbn
        {
          get {
            return FSwkInpKbn;
          }
          set {
            SetSwkInpKbn(value);
          }
        }
        // 仕訳発生区分
        public byte DataClass
        {
          get {
            return FDataClass;
          }
          set {
            SetDataClass(value);
          }
        }
        // データ種別
        public byte SwkForm
        {
          get {
            return FSwkForm;
          }
          set {
            SetSwkForm(value);
          }
        }
        // 仕訳入力形式
        public int HSrchNo
        {
          get {
            return FHSrchNo;
          }
          set {
            SetHSrchNo(value);
          }
        }
        // ヘッダ検索ＮＯ
        public string RHSrchNo
        {
          get {
            return FRHSrchNo;
          }
          set {
            SetRHSrchNo(value);
          }
        }
        // 相手側検索ＮＯ
        public string DenNo
        {
          get {
            return FDenNo;
          }
          set {
            SetDenNo(value);
          }
        }
        // 伝票ＮＯ
        public string LeafNo
        {
          get {
            return FLeafNo;
          }
          set {
            SetLeafNo(value);
          }
        }
        // 証憑ＮＯ
        public string BusCode
        {
          get {
            return FBusCode;
          }
          set {
            SetBusCode(value);
          }
        }
        // 入力部署コード
        public int BusHSrchNo
        {
          get {
            return FBusHSrchNo;
          }
          set {
            SetBusHSrchNo(value);
          }
        }
        // 入力部署検索NO
        public byte DenClass
        {
          get {
            return FDenClass;
          }
          set {
            SetDenClass(value);
          }
        }
        // 伝票種別NO
        public DateTime BDenDate
        {
          get {
            return FBDenDate;
          }
          set {
            SetBDenDate(value);
          }
        }
        // 伝票日付
        public byte BNMonth
        {
          get {
            return FBNMonth;
          }
          set {
            SetBNMonth(value);
          }
        }
        // 仕訳内部月
        public int BHSrchNo
        {
          get {
            return FBHSrchNo;
          }
          set {
            SetBHSrchNo(value);
          }
        }
        // ヘッダ検索ＮＯ
        public byte StaffKbn02
        {
          get {
            return FStaffKbn02;
          }
          set {
            SetStaffKbn02(value);
          }
        }
        // 担当者区分
        public int StaffCode02
        {
          get {
            return FStaffCode02;
          }
          set {
            SetStaffCode02(value);
          }
        }
        // 担当者コード
        public string StaffName02
        {
          get {
            return FStaffName02;
          }
          set {
            SetStaffName02(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime02
        {
          get {
            return FUpdateTime02;
          }
          set {
            SetUpdateTime02(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn02
        {
          get {
            return FOkKbn02;
          }
          set {
            SetOkKbn02(value);
          }
        }
        // 承認区分
        public string OkComnt02
        {
          get {
            return FOkComnt02;
          }
          set {
            SetOkComnt02(value);
          }
        }
        // 承認コメント
        public byte StaffKbn03
        {
          get {
            return FStaffKbn03;
          }
          set {
            SetStaffKbn03(value);
          }
        }
        // 担当者区分
        public int StaffCode03
        {
          get {
            return FStaffCode03;
          }
          set {
            SetStaffCode03(value);
          }
        }
        // 担当者コード
        public string StaffName03
        {
          get {
            return FStaffName03;
          }
          set {
            SetStaffName03(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime03
        {
          get {
            return FUpdateTime03;
          }
          set {
            SetUpdateTime03(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn03
        {
          get {
            return FOkKbn03;
          }
          set {
            SetOkKbn03(value);
          }
        }
        // 承認区分
        public string OkComnt03
        {
          get {
            return FOkComnt03;
          }
          set {
            SetOkComnt03(value);
          }
        }
        // 承認コメント
        public byte StaffKbn11
        {
          get {
            return FStaffKbn11;
          }
          set {
            SetStaffKbn11(value);
          }
        }
        // 担当者区分
        public int StaffCode11
        {
          get {
            return FStaffCode11;
          }
          set {
            SetStaffCode11(value);
          }
        }
        // 担当者コード
        public string StaffName11
        {
          get {
            return FStaffName11;
          }
          set {
            SetStaffName11(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime11
        {
          get {
            return FUpdateTime11;
          }
          set {
            SetUpdateTime11(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn11
        {
          get {
            return FOkKbn11;
          }
          set {
            SetOkKbn11(value);
          }
        }
        // 承認区分
        public string OkComnt11
        {
          get {
            return FOkComnt11;
          }
          set {
            SetOkComnt11(value);
          }
        }
        // 承認コメント
        public byte StaffKbn12
        {
          get {
            return FStaffKbn12;
          }
          set {
            SetStaffKbn12(value);
          }
        }
        // 担当者区分
        public int StaffCode12
        {
          get {
            return FStaffCode12;
          }
          set {
            SetStaffCode12(value);
          }
        }
        // 担当者コード
        public string StaffName12
        {
          get {
            return FStaffName12;
          }
          set {
            SetStaffName12(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime12
        {
          get {
            return FUpdateTime12;
          }
          set {
            SetUpdateTime12(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn12
        {
          get {
            return FOkKbn12;
          }
          set {
            SetOkKbn12(value);
          }
        }
        // 承認区分
        public string OkComnt12
        {
          get {
            return FOkComnt12;
          }
          set {
            SetOkComnt12(value);
          }
        }
        // 承認コメント
        public byte StaffKbn21
        {
          get {
            return FStaffKbn21;
          }
          set {
            SetStaffKbn21(value);
          }
        }
        // 担当者区分
        public int StaffCode21
        {
          get {
            return FStaffCode21;
          }
          set {
            SetStaffCode21(value);
          }
        }
        // 担当者コード
        public string StaffName21
        {
          get {
            return FStaffName21;
          }
          set {
            SetStaffName21(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime21
        {
          get {
            return FUpdateTime21;
          }
          set {
            SetUpdateTime21(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn21
        {
          get {
            return FOkKbn21;
          }
          set {
            SetOkKbn21(value);
          }
        }
        // 承認区分
        public string OkComnt21
        {
          get {
            return FOkComnt21;
          }
          set {
            SetOkComnt21(value);
          }
        }
        // 承認コメント
        public byte StaffKbn22
        {
          get {
            return FStaffKbn22;
          }
          set {
            SetStaffKbn22(value);
          }
        }
        // 担当者区分
        public int StaffCode22
        {
          get {
            return FStaffCode22;
          }
          set {
            SetStaffCode22(value);
          }
        }
        // 担当者コード
        public string StaffName22
        {
          get {
            return FStaffName22;
          }
          set {
            SetStaffName22(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime22
        {
          get {
            return FUpdateTime22;
          }
          set {
            SetUpdateTime22(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn22
        {
          get {
            return FOkKbn22;
          }
          set {
            SetOkKbn22(value);
          }
        }
        // 承認区分
        public string OkComnt22
        {
          get {
            return FOkComnt22;
          }
          set {
            SetOkComnt22(value);
          }
        }
        // 承認コメント
        public byte StaffKbn23
        {
          get {
            return FStaffKbn23;
          }
          set {
            SetStaffKbn23(value);
          }
        }
        public int StaffCode23
        {
          get {
            return FStaffCode23;
          }
          set {
            SetStaffCode23(value);
          }
        }
        public string StaffName23
        {
          get {
            return FStaffName23;
          }
          set {
            SetStaffName23(value);
          }
        }
        public DateTime UpdateTime23
        {
          get {
            return FUpdateTime23;
          }
          set {
            SetUpdateTime23(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn23
        {
          get {
            return FOkKbn23;
          }
          set {
            SetOkKbn23(value);
          }
        }
        public string OkComnt23
        {
          get {
            return FOkComnt23;
          }
          set {
            SetOkComnt23(value);
          }
        }
        public byte StaffKbn31
        {
          get {
            return FStaffKbn31;
          }
          set {
            SetStaffKbn31(value);
          }
        }
        // 担当者区分
        public int StaffCode31
        {
          get {
            return FStaffCode31;
          }
          set {
            SetStaffCode31(value);
          }
        }
        // 担当者コード
        public string StaffName31
        {
          get {
            return FStaffName31;
          }
          set {
            SetStaffName31(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime31
        {
          get {
            return FUpdateTime31;
          }
          set {
            SetUpdateTime31(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn31
        {
          get {
            return FOkKbn31;
          }
          set {
            SetOkKbn31(value);
          }
        }
        // 承認区分
        public string OkComnt31
        {
          get {
            return FOkComnt31;
          }
          set {
            SetOkComnt31(value);
          }
        }
        // 承認コメント
        public byte StaffKbn32
        {
          get {
            return FStaffKbn32;
          }
          set {
            SetStaffKbn32(value);
          }
        }
        // 担当者区分
        public int StaffCode32
        {
          get {
            return FStaffCode32;
          }
          set {
            SetStaffCode32(value);
          }
        }
        // 担当者コード
        public string StaffName32
        {
          get {
            return FStaffName32;
          }
          set {
            SetStaffName32(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime32
        {
          get {
            return FUpdateTime32;
          }
          set {
            SetUpdateTime32(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn32
        {
          get {
            return FOkKbn32;
          }
          set {
            SetOkKbn32(value);
          }
        }
        // 承認区分
        public string OkComnt32
        {
          get {
            return FOkComnt32;
          }
          set {
            SetOkComnt32(value);
          }
        }
        // 承認コメント
        public byte StaffKbn41
        {
          get {
            return FStaffKbn41;
          }
          set {
            SetStaffKbn41(value);
          }
        }
        // 担当者区分
        public int StaffCode41
        {
          get {
            return FStaffCode41;
          }
          set {
            SetStaffCode41(value);
          }
        }
        // 担当者コード
        public string StaffName41
        {
          get {
            return FStaffName41;
          }
          set {
            SetStaffName41(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime41
        {
          get {
            return FUpdateTime41;
          }
          set {
            SetUpdateTime41(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn41
        {
          get {
            return FOkKbn41;
          }
          set {
            SetOkKbn41(value);
          }
        }
        // 承認区分
        public string OkComnt41
        {
          get {
            return FOkComnt41;
          }
          set {
            SetOkComnt41(value);
          }
        }
        // 承認コメント
        public byte StaffKbn42
        {
          get {
            return FStaffKbn42;
          }
          set {
            SetStaffKbn42(value);
          }
        }
        // 担当者区分
        public int StaffCode42
        {
          get {
            return FStaffCode42;
          }
          set {
            SetStaffCode42(value);
          }
        }
        // 担当者コード
        public string StaffName42
        {
          get {
            return FStaffName42;
          }
          set {
            SetStaffName42(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime42
        {
          get {
            return FUpdateTime42;
          }
          set {
            SetUpdateTime42(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn42
        {
          get {
            return FOkKbn42;
          }
          set {
            SetOkKbn42(value);
          }
        }
        // 承認区分
        public string OkComnt42
        {
          get {
            return FOkComnt42;
          }
          set {
            SetOkComnt42(value);
          }
        }
        // 承認コメント
        public byte StaffKbn51
        {
          get {
            return FStaffKbn51;
          }
          set {
            SetStaffKbn51(value);
          }
        }
        // 担当者区分
        public int StaffCode51
        {
          get {
            return FStaffCode51;
          }
          set {
            SetStaffCode51(value);
          }
        }
        // 担当者コード
        public string StaffName51
        {
          get {
            return FStaffName51;
          }
          set {
            SetStaffName51(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime51
        {
          get {
            return FUpdateTime51;
          }
          set {
            SetUpdateTime51(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn51
        {
          get {
            return FOkKbn51;
          }
          set {
            SetOkKbn51(value);
          }
        }
        // 承認区分
        public string OkComnt51
        {
          get {
            return FOkComnt51;
          }
          set {
            SetOkComnt51(value);
          }
        }
        // 承認コメント
        public byte StaffKbn52
        {
          get {
            return FStaffKbn52;
          }
          set {
            SetStaffKbn52(value);
          }
        }
        // 担当者区分
        public int StaffCode52
        {
          get {
            return FStaffCode52;
          }
          set {
            SetStaffCode52(value);
          }
        }
        // 担当者コード
        public string StaffName52
        {
          get {
            return FStaffName52;
          }
          set {
            SetStaffName52(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime52
        {
          get {
            return FUpdateTime52;
          }
          set {
            SetUpdateTime52(value);
          }
        }
        // 入力／修正日時
        public byte OkKbn52
        {
          get {
            return FOkKbn52;
          }
          set {
            SetOkKbn52(value);
          }
        }
        // 承認区分
        public string OkComnt52
        {
          get {
            return FOkComnt52;
          }
          set {
            SetOkComnt52(value);
          }
        }
        // 承認コメント
        public byte FusenKbn
        {
          get {
            return FFusenKbn;
          }
          set {
            SetFusenKbn(value);
          }
        }
        // 付箋区分
        public string FusenCmnt
        {
          get {
            return FFusenCmnt;
          }
          set {
            SetFusenCmnt(value);
          }
        }
        private int IUDKbn = 0;
        private int SwkHDKbn = 0;
        private int FIncSize = 0;
        private byte FHSrchNoAutoSet = 0;
        private DateTime FDenDate;
        private byte FNMonth = 0;
        private byte FSwkInpKbn = 0;
        private byte FDataClass = 0;
        private byte FSwkForm = 0;
        private int FHSrchNo = 0;
        private string FRHSrchNo = String.Empty;
        private string FDenNo = String.Empty;
        private string FLeafNo = String.Empty;
        private string FBusCode = String.Empty;
        // 入力部署コード
        private int FBusHSrchNo = 0;
        // 入力部署検索NO
        private byte FDenClass = 0;
        // 伝票種別NO
        private DateTime FBDenDate;
        private byte FBNMonth = 0;
        private int FBHSrchNo = 0;
        private byte FStaffKbn02 = 0;
        private int FStaffCode02 = 0;
        private string FStaffName02 = String.Empty;
        private DateTime FUpdateTime02;
        private byte FOkKbn02 = 0;
        private string FOkComnt02 = String.Empty;
        private byte FStaffKbn03 = 0;
        private int FStaffCode03 = 0;
        private string FStaffName03 = String.Empty;
        private DateTime FUpdateTime03;
        private byte FOkKbn03 = 0;
        private string FOkComnt03 = String.Empty;
        private byte FStaffKbn11 = 0;
        private int FStaffCode11 = 0;
        private string FStaffName11 = String.Empty;
        private DateTime FUpdateTime11;
        private byte FOkKbn11 = 0;
        private string FOkComnt11 = String.Empty;
        private byte FStaffKbn12 = 0;
        private int FStaffCode12 = 0;
        private string FStaffName12 = String.Empty;
        private DateTime FUpdateTime12;
        private byte FOkKbn12 = 0;
        private string FOkComnt12 = String.Empty;
        private byte FStaffKbn21 = 0;
        private int FStaffCode21 = 0;
        private string FStaffName21 = String.Empty;
        private DateTime FUpdateTime21;
        private byte FOkKbn21 = 0;
        private string FOkComnt21 = String.Empty;
        private byte FStaffKbn22 = 0;
        private int FStaffCode22 = 0;
        private string FStaffName22 = String.Empty;
        private DateTime FUpdateTime22;
        private byte FOkKbn22 = 0;
        private string FOkComnt22 = String.Empty;
        private byte FStaffKbn23 = 0;
        private int FStaffCode23 = 0;
        private string FStaffName23 = String.Empty;
        private DateTime FUpdateTime23;
        private byte FOkKbn23 = 0;
        private string FOkComnt23 = String.Empty;
        private byte FStaffKbn31 = 0;
        private int FStaffCode31 = 0;
        private string FStaffName31 = String.Empty;
        private DateTime FUpdateTime31;
        private byte FOkKbn31 = 0;
        private string FOkComnt31 = String.Empty;
        private byte FStaffKbn32 = 0;
        private int FStaffCode32 = 0;
        private string FStaffName32 = String.Empty;
        private DateTime FUpdateTime32;
        private byte FOkKbn32 = 0;
        private string FOkComnt32 = String.Empty;
        private byte FStaffKbn41 = 0;
        private int FStaffCode41 = 0;
        private string FStaffName41 = String.Empty;
        private DateTime FUpdateTime41;
        private byte FOkKbn41 = 0;
        private string FOkComnt41 = String.Empty;
        private byte FStaffKbn42 = 0;
        private int FStaffCode42 = 0;
        private string FStaffName42 = String.Empty;
        private DateTime FUpdateTime42;
        private byte FOkKbn42 = 0;
        private string FOkComnt42 = String.Empty;
        private byte FStaffKbn51 = 0;
        private int FStaffCode51 = 0;
        private string FStaffName51 = String.Empty;
        private DateTime FUpdateTime51;
        private byte FOkKbn51 = 0;
        private string FOkComnt51 = String.Empty;
        private byte FStaffKbn52 = 0;
        private int FStaffCode52 = 0;
        private string FStaffName52 = String.Empty;
        private DateTime FUpdateTime52;
        private byte FOkKbn52 = 0;
        private string FOkComnt52 = String.Empty;
        private byte FFusenKbn = 0;
        private string FFusenCmnt = String.Empty;
        private byte HSrchNoAutoSetF = 0;
        private byte DenDateF = 0;
        private byte NMonthF = 0;
        private byte SwkInpKbnF = 0;
        private byte DataClassF = 0;
        private byte SwkFormF = 0;
        private byte HSrchNoF = 0;
        private byte RHSrchNoF = 0;
        private byte DenNoF = 0;
        private byte LeafNoF = 0;
        private byte BusCodeF = 0;
        private byte BusHSrchNoF = 0;
        private byte DenClassF = 0;
        // 伝票種別NO
        private byte BDenDateF = 0;
        private byte BNMonthF = 0;
        private byte BHSrchNoF = 0;
        private byte StaffKbn02F = 0;
        private byte StaffCode02F = 0;
        private byte StaffName02F = 0;
        private byte UpdateTime02F = 0;
        private byte OkKbn02F = 0;
        private byte OkComnt02F = 0;
        private byte StaffKbn03F = 0;
        private byte StaffCode03F = 0;
        private byte StaffName03F = 0;
        private byte UpdateTime03F = 0;
        private byte OkKbn03F = 0;
        private byte OkComnt03F = 0;
        private byte StaffKbn11F = 0;
        private byte StaffCode11F = 0;
        private byte StaffName11F = 0;
        private byte UpdateTime11F = 0;
        private byte OkKbn11F = 0;
        private byte OkComnt11F = 0;
        private byte StaffKbn12F = 0;
        private byte StaffCode12F = 0;
        private byte StaffName12F = 0;
        private byte UpdateTime12F = 0;
        private byte OkKbn12F = 0;
        private byte OkComnt12F = 0;
        private byte StaffKbn21F = 0;
        private byte StaffCode21F = 0;
        private byte StaffName21F = 0;
        private byte UpdateTime21F = 0;
        private byte OkKbn21F = 0;
        private byte OkComnt21F = 0;
        private byte StaffKbn22F = 0;
        private byte StaffCode22F = 0;
        private byte StaffName22F = 0;
        private byte UpdateTime22F = 0;
        private byte OkKbn22F = 0;
        private byte OkComnt22F = 0;
        private byte StaffKbn23F = 0;
        private byte StaffCode23F = 0;
        private byte StaffName23F = 0;
        private byte UpdateTime23F = 0;
        private byte OkKbn23F = 0;
        private byte OkComnt23F = 0;
        private byte StaffKbn31F = 0;
        private byte StaffCode31F = 0;
        private byte StaffName31F = 0;
        private byte UpdateTime31F = 0;
        private byte OkKbn31F = 0;
        private byte OkComnt31F = 0;
        private byte StaffKbn32F = 0;
        private byte StaffCode32F = 0;
        private byte StaffName32F = 0;
        private byte UpdateTime32F = 0;
        private byte OkKbn32F = 0;
        private byte OkComnt32F = 0;
        private byte StaffKbn41F = 0;
        private byte StaffCode41F = 0;
        private byte StaffName41F = 0;
        private byte UpdateTime41F = 0;
        private byte OkKbn41F = 0;
        private byte OkComnt41F = 0;
        private byte StaffKbn42F = 0;
        private byte StaffCode42F = 0;
        private byte StaffName42F = 0;
        private byte UpdateTime42F = 0;
        private byte OkKbn42F = 0;
        private byte OkComnt42F = 0;
        private byte StaffKbn51F = 0;
        private byte StaffCode51F = 0;
        private byte StaffName51F = 0;
        private byte UpdateTime51F = 0;
        private byte OkKbn51F = 0;
        private byte OkComnt51F = 0;
        private byte StaffKbn52F = 0;
        private byte StaffCode52F = 0;
        private byte StaffName52F = 0;
        private byte UpdateTime52F = 0;
        private byte OkKbn52F = 0;
        private byte OkComnt52F = 0;
        private byte FusenKbnF = 0;
        private byte FusenCmntF = 0;
        private ArrayList RecList = null;
        // __MASL310GETTAXRATEB_INC__
        // ******************************************************************************
        // System		: 顧問先入力システム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310FixIF_VK07B
        // Comment		: 仕訳更新
        // ******************************************************************************
#if !__VKZL310EntryIF_VK07B_INC__
#define __VKZL310EntryIF_VK07B_INC__
        // ******************************************************************************
        // System		: ACELINK Navi会計大将 VKシステム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310TrnIFB
        // Name		: Y.Sato
        // Create		: 2007/05/11
        // Comment		: 仕訳更新
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
#if !__VKZL310TrnIFB_INC__
#define __VKZL310TrnIFB_INC__
        // ******************************************************************************
        // System		: ACELINK Navi会計大将 VKシステム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310TrnSwkHeadB
        // Name		: Y.Sato
        // Create		: 2007/05/11
        // Comment		: 仕訳更新
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
#if !__VKZL310TrnSwkHeadB_INC__
#define __VKZL310TrnSwkHeadB_INC__
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TVKZL310Trn_SwkHead()
        {
            FIncSize = 1;
            RecList = new ArrayList();
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2004/04/20
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TVKZL310Trn_SwkHead()
        {
            Clear();
            //@ Unsupported property or method(C): 'Free'
            RecList.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: レコードをクリア
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Clear()
        {
            int Index;
            TVKZL310TrnHRec pRec;
            for (Index = 0; Index < RecList.Count; Index ++ )
            {
                pRec = RecList[Index];
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
            }
            RecList.Clear();
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを開始
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: iValue1	処理区分 0:追加 1:修正 2:削除
        // : iValue2	データセットフラグ（修正のときのみ） 0:変更なし 1:変更あり
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Add(int iValue1, int iValue2)
        {
            IUDKbn = iValue1;
            SwkHDKbn = iValue2;
            FHSrchNoAutoSet = 0;
            FDenDate = 0;
            FNMonth = 0;
            FSwkInpKbn = 0;
            FDataClass = 0;
            FSwkForm = 0;
            FHSrchNo = 0;
            FRHSrchNo = "";
            FDenNo = "";
            FLeafNo = "";
            FBusCode = "";
            FBusHSrchNo = 0;
            FDenClass = 0;
            FBDenDate = 0;
            FBNMonth = 0;
            FBHSrchNo = 0;
            FStaffKbn02 = 0;
            FStaffCode02 = 0;
            FStaffName02 = "";
            FUpdateTime02 = 0;
            FOkKbn02 = 0;
            FOkComnt02 = "";
            FStaffKbn03 = 0;
            FStaffCode03 = 0;
            FStaffName03 = "";
            FUpdateTime03 = 0;
            FOkKbn03 = 0;
            FOkComnt03 = "";
            FStaffKbn11 = 0;
            FStaffCode11 = 0;
            FStaffName11 = "";
            FUpdateTime11 = 0;
            FOkKbn11 = 0;
            FOkComnt11 = "";
            FStaffKbn12 = 0;
            FStaffCode12 = 0;
            FStaffName12 = "";
            FUpdateTime12 = 0;
            FOkKbn12 = 0;
            FOkComnt12 = "";
            FStaffKbn21 = 0;
            FStaffCode21 = 0;
            FStaffName21 = "";
            FUpdateTime21 = 0;
            FOkKbn21 = 0;
            FOkComnt21 = "";
            FStaffKbn22 = 0;
            FStaffCode22 = 0;
            FStaffName22 = "";
            FUpdateTime22 = 0;
            FOkKbn22 = 0;
            FOkComnt22 = "";
            FStaffKbn23 = 0;
            FStaffCode23 = 0;
            FStaffName23 = "";
            FUpdateTime23 = 0;
            FOkKbn23 = 0;
            FOkComnt23 = "";
            FStaffKbn31 = 0;
            FStaffCode31 = 0;
            FStaffName31 = "";
            FUpdateTime31 = 0;
            FOkKbn31 = 0;
            FOkComnt31 = "";
            FStaffKbn32 = 0;
            FStaffCode32 = 0;
            FStaffName32 = "";
            FUpdateTime32 = 0;
            FOkKbn32 = 0;
            FOkComnt32 = "";
            FStaffKbn41 = 0;
            FStaffCode41 = 0;
            FStaffName41 = "";
            FUpdateTime41 = 0;
            FOkKbn41 = 0;
            FOkComnt41 = "";
            FStaffKbn42 = 0;
            FStaffCode42 = 0;
            FStaffName42 = "";
            FUpdateTime42 = 0;
            FOkKbn42 = 0;
            FOkComnt42 = "";
            FStaffKbn51 = 0;
            FStaffCode51 = 0;
            FStaffName51 = "";
            FUpdateTime51 = 0;
            FOkKbn51 = 0;
            FOkComnt51 = "";
            FStaffKbn52 = 0;
            FStaffCode52 = 0;
            FStaffName52 = "";
            FUpdateTime52 = 0;
            FOkKbn52 = 0;
            FOkComnt52 = "";
            FFusenKbn = 0;
            FFusenCmnt = "";
            HSrchNoAutoSetF = 0;
            DenDateF = 0;
            NMonthF = 0;
            SwkInpKbnF = 0;
            DataClassF = 0;
            SwkFormF = 0;
            HSrchNoF = 0;
            RHSrchNoF = 0;
            DenNoF = 0;
            LeafNoF = 0;
            BusCodeF = 0;
            BusHSrchNoF = 0;
            DenClassF = 0;
            BDenDateF = 0;
            BNMonthF = 0;
            BHSrchNoF = 0;
            StaffKbn02F = 0;
            StaffCode02F = 0;
            StaffName02F = 0;
            UpdateTime02F = 0;
            OkKbn02F = 0;
            OkComnt02F = 0;
            StaffKbn03F = 0;
            StaffCode03F = 0;
            StaffName03F = 0;
            UpdateTime03F = 0;
            OkKbn03F = 0;
            OkComnt03F = 0;
            StaffKbn11F = 0;
            StaffCode11F = 0;
            StaffName11F = 0;
            UpdateTime11F = 0;
            OkKbn11F = 0;
            OkComnt11F = 0;
            StaffKbn12F = 0;
            StaffCode12F = 0;
            StaffName12F = 0;
            UpdateTime12F = 0;
            OkKbn12F = 0;
            OkComnt12F = 0;
            StaffKbn21F = 0;
            StaffCode21F = 0;
            StaffName21F = 0;
            UpdateTime21F = 0;
            OkKbn21F = 0;
            OkComnt21F = 0;
            StaffKbn22F = 0;
            StaffCode22F = 0;
            StaffName22F = 0;
            UpdateTime22F = 0;
            OkKbn22F = 0;
            OkComnt22F = 0;
            StaffKbn23F = 0;
            StaffCode23F = 0;
            StaffName23F = 0;
            UpdateTime23F = 0;
            OkKbn23F = 0;
            OkComnt23F = 0;
            StaffKbn31F = 0;
            StaffCode31F = 0;
            StaffName31F = 0;
            UpdateTime31F = 0;
            OkKbn31F = 0;
            OkComnt31F = 0;
            StaffKbn32F = 0;
            StaffCode32F = 0;
            StaffName32F = 0;
            UpdateTime32F = 0;
            OkKbn32F = 0;
            OkComnt32F = 0;
            StaffKbn41F = 0;
            StaffCode41F = 0;
            StaffName41F = 0;
            UpdateTime41F = 0;
            OkKbn41F = 0;
            OkComnt41F = 0;
            StaffKbn42F = 0;
            StaffCode42F = 0;
            StaffName42F = 0;
            UpdateTime42F = 0;
            OkKbn42F = 0;
            OkComnt42F = 0;
            StaffKbn51F = 0;
            StaffCode51F = 0;
            StaffName51F = 0;
            UpdateTime51F = 0;
            OkKbn51F = 0;
            OkComnt51F = 0;
            StaffKbn52F = 0;
            StaffCode52F = 0;
            StaffName52F = 0;
            UpdateTime52F = 0;
            OkKbn52F = 0;
            OkComnt52F = 0;
            FusenKbnF = 0;
            FusenCmntF = 0;
        }

        public void Add(int iValue1)
        {
            Add(iValue1, 1);
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを終了
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Post()
        {
            TVKZL310TrnHRec pRec;
            if (RecList.Capacity <= RecList.Count)
            {
                RecList.Capacity = RecList.Capacity + FIncSize;
            }
            pRec = new TVKZL310TrnHRec();
            pRec.IUDKbn = IUDKbn;
            pRec.SwkHDKbn = SwkHDKbn;
            pRec.HSrchNoAutoSet = FHSrchNoAutoSet;
            pRec.HSrchNoAutoSetF = HSrchNoAutoSetF;
            pRec.DenDate = FDenDate;
            pRec.DenDateF = DenDateF;
            pRec.NMonth = FNMonth;
            pRec.NMonthF = NMonthF;
            pRec.SwkInpKbn = FSwkInpKbn;
            pRec.SwkInpKbnF = SwkInpKbnF;
            pRec.DataClass = FDataClass;
            pRec.DataClassF = DataClassF;
            pRec.SwkForm = FSwkForm;
            pRec.SwkFormF = SwkFormF;
            pRec.HSrchNo = FHSrchNo;
            pRec.HSrchNoF = HSrchNoF;
            pRec.RHSrchNo = FRHSrchNo;
            pRec.RHSrchNoF = RHSrchNoF;
            pRec.DenNo = FDenNo;
            pRec.DenNoF = DenNoF;
            pRec.LeafNo = FLeafNo;
            pRec.LeafNoF = LeafNoF;
            pRec.BusCode = FBusCode;
            pRec.BusCodeF = BusCodeF;
            pRec.BusHSrchNo = BusHSrchNo;
            pRec.BusHSrchNoF = BusHSrchNoF;
            pRec.DenClass = FDenClass;
            pRec.DenClassF = DenClassF;
            pRec.BDenDate = FBDenDate;
            pRec.BDenDateF = BDenDateF;
            pRec.BNMonth = FBNMonth;
            pRec.BNMonthF = BNMonthF;
            pRec.BHSrchNo = FBHSrchNo;
            pRec.BHSrchNoF = BHSrchNoF;
            pRec.StaffKbn02 = FStaffKbn02;
            pRec.StaffKbn02F = StaffKbn02F;
            pRec.StaffCode02 = FStaffCode02;
            pRec.StaffCode02F = StaffCode02F;
            pRec.StaffName02 = FStaffName02;
            pRec.StaffName02F = StaffName02F;
            pRec.UpdateTime02 = FUpdateTime02;
            pRec.UpdateTime02F = UpdateTime02F;
            pRec.OkKbn02 = FOkKbn02;
            pRec.OkKbn02F = OkKbn02F;
            pRec.OkComnt02 = FOkComnt02;
            pRec.OkComnt02F = OkComnt02F;
            pRec.StaffKbn03 = FStaffKbn03;
            pRec.StaffKbn03F = StaffKbn03F;
            pRec.StaffCode03 = FStaffCode03;
            pRec.StaffCode03F = StaffCode03F;
            pRec.StaffName03 = FStaffName03;
            pRec.StaffName03F = StaffName03F;
            pRec.UpdateTime03 = FUpdateTime03;
            pRec.UpdateTime03F = UpdateTime03F;
            pRec.OkKbn03 = FOkKbn03;
            pRec.OkKbn03F = OkKbn03F;
            pRec.OkComnt03 = FOkComnt03;
            pRec.OkComnt03F = OkComnt03F;
            pRec.StaffKbn11 = FStaffKbn11;
            pRec.StaffKbn11F = StaffKbn11F;
            pRec.StaffCode11 = FStaffCode11;
            pRec.StaffCode11F = StaffCode11F;
            pRec.StaffName11 = FStaffName11;
            pRec.StaffName11F = StaffName11F;
            pRec.UpdateTime11 = FUpdateTime11;
            pRec.UpdateTime11F = UpdateTime11F;
            pRec.OkKbn11 = FOkKbn11;
            pRec.OkKbn11F = OkKbn11F;
            pRec.OkComnt11 = FOkComnt11;
            pRec.OkComnt11F = OkComnt11F;
            pRec.StaffKbn12 = FStaffKbn12;
            pRec.StaffKbn12F = StaffKbn12F;
            pRec.StaffCode12 = FStaffCode12;
            pRec.StaffCode12F = StaffCode12F;
            pRec.StaffName12 = FStaffName12;
            pRec.StaffName12F = StaffName12F;
            pRec.UpdateTime12 = FUpdateTime12;
            pRec.UpdateTime12F = UpdateTime12F;
            pRec.OkKbn12 = FOkKbn12;
            pRec.OkKbn12F = OkKbn12F;
            pRec.OkComnt12 = FOkComnt12;
            pRec.OkComnt12F = OkComnt12F;
            pRec.StaffKbn21 = FStaffKbn21;
            pRec.StaffKbn21F = StaffKbn21F;
            pRec.StaffCode21 = FStaffCode21;
            pRec.StaffCode21F = StaffCode21F;
            pRec.StaffName21 = FStaffName21;
            pRec.StaffName21F = StaffName21F;
            pRec.UpdateTime21 = FUpdateTime21;
            pRec.UpdateTime21F = UpdateTime21F;
            pRec.OkKbn21 = FOkKbn21;
            pRec.OkKbn21F = OkKbn21F;
            pRec.OkComnt21 = FOkComnt21;
            pRec.OkComnt21F = OkComnt21F;
            pRec.StaffKbn22 = FStaffKbn22;
            pRec.StaffKbn22F = StaffKbn22F;
            pRec.StaffCode22 = FStaffCode22;
            pRec.StaffCode22F = StaffCode22F;
            pRec.StaffName22 = FStaffName22;
            pRec.StaffName22F = StaffName22F;
            pRec.UpdateTime22 = FUpdateTime22;
            pRec.UpdateTime22F = UpdateTime22F;
            pRec.OkKbn22 = FOkKbn22;
            pRec.OkKbn22F = OkKbn22F;
            pRec.OkComnt22 = FOkComnt22;
            pRec.OkComnt22F = OkComnt22F;
            pRec.StaffKbn23 = FStaffKbn23;
            pRec.StaffKbn23F = StaffKbn23F;
            pRec.StaffCode23 = FStaffCode23;
            pRec.StaffCode23F = StaffCode23F;
            pRec.StaffName23 = FStaffName23;
            pRec.StaffName23F = StaffName23F;
            pRec.UpdateTime23 = FUpdateTime23;
            pRec.UpdateTime23F = UpdateTime23F;
            pRec.OkKbn23 = FOkKbn23;
            pRec.OkKbn23F = OkKbn23F;
            pRec.OkComnt23 = FOkComnt23;
            pRec.OkComnt23F = OkComnt23F;
            pRec.StaffKbn31 = FStaffKbn31;
            pRec.StaffKbn31F = StaffKbn31F;
            pRec.StaffCode31 = FStaffCode31;
            pRec.StaffCode31F = StaffCode31F;
            pRec.StaffName31 = FStaffName31;
            pRec.StaffName31F = StaffName31F;
            pRec.UpdateTime31 = FUpdateTime31;
            pRec.UpdateTime31F = UpdateTime31F;
            pRec.OkKbn31 = FOkKbn31;
            pRec.OkKbn31F = OkKbn31F;
            pRec.OkComnt31 = FOkComnt31;
            pRec.OkComnt31F = OkComnt31F;
            pRec.StaffKbn32 = FStaffKbn32;
            pRec.StaffKbn32F = StaffKbn32F;
            pRec.StaffCode32 = FStaffCode32;
            pRec.StaffCode32F = StaffCode32F;
            pRec.StaffName32 = FStaffName32;
            pRec.StaffName32F = StaffName32F;
            pRec.UpdateTime32 = FUpdateTime32;
            pRec.UpdateTime32F = UpdateTime32F;
            pRec.OkKbn32 = FOkKbn32;
            pRec.OkKbn32F = OkKbn32F;
            pRec.OkComnt32 = FOkComnt32;
            pRec.OkComnt32F = OkComnt32F;
            pRec.StaffKbn41 = FStaffKbn41;
            pRec.StaffKbn41F = StaffKbn41F;
            pRec.StaffCode41 = FStaffCode41;
            pRec.StaffCode41F = StaffCode41F;
            pRec.StaffName41 = FStaffName41;
            pRec.StaffName41F = StaffName41F;
            pRec.UpdateTime41 = FUpdateTime41;
            pRec.UpdateTime41F = UpdateTime41F;
            pRec.OkKbn41 = FOkKbn41;
            pRec.OkKbn41F = OkKbn41F;
            pRec.OkComnt41 = FOkComnt41;
            pRec.OkComnt41F = OkComnt41F;
            pRec.StaffKbn42 = FStaffKbn42;
            pRec.StaffKbn42F = StaffKbn42F;
            pRec.StaffCode42 = FStaffCode42;
            pRec.StaffCode42F = StaffCode42F;
            pRec.StaffName42 = FStaffName42;
            pRec.StaffName42F = StaffName42F;
            pRec.UpdateTime42 = FUpdateTime42;
            pRec.UpdateTime42F = UpdateTime42F;
            pRec.OkKbn42 = FOkKbn42;
            pRec.OkKbn42F = OkKbn42F;
            pRec.OkComnt42 = FOkComnt42;
            pRec.OkComnt42F = OkComnt42F;
            pRec.StaffKbn51 = FStaffKbn51;
            pRec.StaffKbn51F = StaffKbn51F;
            pRec.StaffCode51 = FStaffCode51;
            pRec.StaffCode51F = StaffCode51F;
            pRec.StaffName51 = FStaffName51;
            pRec.StaffName51F = StaffName51F;
            pRec.UpdateTime51 = FUpdateTime51;
            pRec.UpdateTime51F = UpdateTime51F;
            pRec.OkKbn51 = FOkKbn51;
            pRec.OkKbn51F = OkKbn51F;
            pRec.OkComnt51 = FOkComnt51;
            pRec.OkComnt51F = OkComnt51F;
            pRec.StaffKbn52 = FStaffKbn52;
            pRec.StaffKbn52F = StaffKbn52F;
            pRec.StaffCode52 = FStaffCode52;
            pRec.StaffCode52F = StaffCode52F;
            pRec.StaffName52 = FStaffName52;
            pRec.StaffName52F = StaffName52F;
            pRec.UpdateTime52 = FUpdateTime52;
            pRec.UpdateTime52F = UpdateTime52F;
            pRec.OkKbn52 = FOkKbn52;
            pRec.OkKbn52F = OkKbn52F;
            pRec.OkComnt52 = FOkComnt52;
            pRec.OkComnt52F = OkComnt52F;
            pRec.FusenKbn = FFusenKbn;
            pRec.FusenKbnF = FusenKbnF;
            pRec.FusenCmnt = FFusenCmnt;
            pRec.FusenCmntF = FusenCmntF;
            RecList.Add(pRec);
        }

        // ******************************************************************************
        // Proccess	: レコードを取得
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: TVKZL310TrnHRecList
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public TVKZL310TrnHRec[] GetRecList()
        {
            TVKZL310TrnHRec[] result;
            int Index;
            result = new TVKZL310TrnHRec[RecList.Count];
            for (Index = 0; Index < RecList.Count; Index ++ )
            {
                result[Index] = ((RecList[Index]) as TVKZL310TrnHRec);
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: IncSizeをセット
        // Name		: Y.Sato
        // Date		: 2003/12/26
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetIncSize(int Value)
        {
            if ((FIncSize != Value) && (FIncSize > 0))
            {
                FIncSize = Value;
            }
        }

        // ******************************************************************************
        // Proccess	: フラグを立てる
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetHSrchNoAutoSet(byte Value)
        {
            FHSrchNoAutoSet = Value;
            HSrchNoAutoSetF = 1;
        }

        private void SetDenDate(DateTime Value)
        {
            FDenDate = Value;
            DenDateF = 1;
        }

        private void SetNMonth(byte Value)
        {
            FNMonth = Value;
            NMonthF = 1;
        }

        private void SetSwkInpKbn(byte Value)
        {
            FSwkInpKbn = Value;
            SwkInpKbnF = 1;
        }

        private void SetDataClass(byte Value)
        {
            FDataClass = Value;
            DataClassF = 1;
        }

        private void SetSwkForm(byte Value)
        {
            FSwkForm = Value;
            SwkFormF = 1;
        }

        private void SetHSrchNo(int Value)
        {
            FHSrchNo = Value;
            HSrchNoF = 1;
        }

        private void SetRHSrchNo(string Value)
        {
            FRHSrchNo = Value;
            RHSrchNoF = 1;
        }

        private void SetDenNo(string Value)
        {
            FDenNo = Value;
            DenNoF = 1;
        }

        private void SetLeafNo(string Value)
        {
            FLeafNo = Value;
            LeafNoF = 1;
        }

        private void SetBusCode(string Value)
        {
            FBusCode = Value;
            BusCodeF = 1;
        }

        private void SetBusHSrchNo(int Value)
        {
            FBusHSrchNo = Value;
            BusHSrchNoF = 1;
        }

        private void SetDenClass(byte Value)
        {
            FDenClass = Value;
            DenClassF = 1;
        }

        private void SetBDenDate(DateTime Value)
        {
            FBDenDate = Value;
            BDenDateF = 1;
        }

        private void SetBNMonth(byte Value)
        {
            FBNMonth = Value;
            BNMonthF = 1;
        }

        private void SetBHSrchNo(int Value)
        {
            FBHSrchNo = Value;
            BHSrchNoF = 1;
        }

        private void SetStaffKbn02(byte Value)
        {
            FStaffKbn02 = Value;
            StaffKbn02F = 1;
        }

        private void SetStaffCode02(int Value)
        {
            FStaffCode02 = Value;
            StaffCode02F = 1;
        }

        private void SetStaffName02(string Value)
        {
            FStaffName02 = Value;
            StaffName02F = 1;
        }

        private void SetUpdateTime02(DateTime Value)
        {
            FUpdateTime02 = Value;
            UpdateTime02F = 1;
        }

        private void SetOkKbn02(byte Value)
        {
            FOkKbn02 = Value;
            OkKbn02F = 1;
        }

        private void SetOkComnt02(string Value)
        {
            FOkComnt02 = Value;
            OkComnt02F = 1;
        }

        private void SetStaffKbn03(byte Value)
        {
            FStaffKbn03 = Value;
            StaffKbn03F = 1;
        }

        private void SetStaffCode03(int Value)
        {
            FStaffCode03 = Value;
            StaffCode03F = 1;
        }

        private void SetStaffName03(string Value)
        {
            FStaffName03 = Value;
            StaffName03F = 1;
        }

        private void SetUpdateTime03(DateTime Value)
        {
            FUpdateTime03 = Value;
            UpdateTime03F = 1;
        }

        private void SetOkKbn03(byte Value)
        {
            FOkKbn03 = Value;
            OkKbn03F = 1;
        }

        private void SetOkComnt03(string Value)
        {
            FOkComnt03 = Value;
            OkComnt03F = 1;
        }

        private void SetStaffKbn11(byte Value)
        {
            FStaffKbn11 = Value;
            StaffKbn11F = 1;
        }

        private void SetStaffCode11(int Value)
        {
            FStaffCode11 = Value;
            StaffCode11F = 1;
        }

        private void SetStaffName11(string Value)
        {
            FStaffName11 = Value;
            StaffName11F = 1;
        }

        private void SetUpdateTime11(DateTime Value)
        {
            FUpdateTime11 = Value;
            UpdateTime11F = 1;
        }

        private void SetOkKbn11(byte Value)
        {
            FOkKbn11 = Value;
            OkKbn11F = 1;
        }

        private void SetOkComnt11(string Value)
        {
            FOkComnt11 = Value;
            OkComnt11F = 1;
        }

        private void SetStaffKbn12(byte Value)
        {
            FStaffKbn12 = Value;
            StaffKbn12F = 1;
        }

        private void SetStaffCode12(int Value)
        {
            FStaffCode12 = Value;
            StaffCode12F = 1;
        }

        private void SetStaffName12(string Value)
        {
            FStaffName12 = Value;
            StaffName12F = 1;
        }

        private void SetUpdateTime12(DateTime Value)
        {
            FUpdateTime12 = Value;
            UpdateTime12F = 1;
        }

        private void SetOkKbn12(byte Value)
        {
            FOkKbn12 = Value;
            OkKbn12F = 1;
        }

        private void SetOkComnt12(string Value)
        {
            FOkComnt12 = Value;
            OkComnt12F = 1;
        }

        private void SetStaffKbn21(byte Value)
        {
            FStaffKbn21 = Value;
            StaffKbn21F = 1;
        }

        private void SetStaffCode21(int Value)
        {
            FStaffCode21 = Value;
            StaffCode21F = 1;
        }

        private void SetStaffName21(string Value)
        {
            FStaffName21 = Value;
            StaffName21F = 1;
        }

        private void SetUpdateTime21(DateTime Value)
        {
            FUpdateTime21 = Value;
            UpdateTime21F = 1;
        }

        private void SetOkKbn21(byte Value)
        {
            FOkKbn21 = Value;
            OkKbn21F = 1;
        }

        private void SetOkComnt21(string Value)
        {
            FOkComnt21 = Value;
            OkComnt21F = 1;
        }

        private void SetStaffKbn22(byte Value)
        {
            FStaffKbn22 = Value;
            StaffKbn22F = 1;
        }

        private void SetStaffCode22(int Value)
        {
            FStaffCode22 = Value;
            StaffCode22F = 1;
        }

        private void SetStaffName22(string Value)
        {
            FStaffName22 = Value;
            StaffName22F = 1;
        }

        private void SetUpdateTime22(DateTime Value)
        {
            FUpdateTime22 = Value;
            UpdateTime22F = 1;
        }

        private void SetOkKbn22(byte Value)
        {
            FOkKbn22 = Value;
            OkKbn22F = 1;
        }

        private void SetOkComnt22(string Value)
        {
            FOkComnt22 = Value;
            OkComnt22F = 1;
        }

        private void SetStaffKbn23(byte Value)
        {
            FStaffKbn23 = Value;
            StaffKbn23F = 1;
        }

        private void SetStaffCode23(int Value)
        {
            FStaffCode23 = Value;
            StaffCode23F = 1;
        }

        private void SetStaffName23(string Value)
        {
            FStaffName23 = Value;
            StaffName23F = 1;
        }

        private void SetUpdateTime23(DateTime Value)
        {
            FUpdateTime23 = Value;
            UpdateTime23F = 1;
        }

        private void SetOkKbn23(byte Value)
        {
            FOkKbn23 = Value;
            OkKbn23F = 1;
        }

        private void SetOkComnt23(string Value)
        {
            FOkComnt23 = Value;
            OkComnt23F = 1;
        }

        private void SetStaffKbn31(byte Value)
        {
            FStaffKbn31 = Value;
            StaffKbn31F = 1;
        }

        private void SetStaffCode31(int Value)
        {
            FStaffCode31 = Value;
            StaffCode31F = 1;
        }

        private void SetStaffName31(string Value)
        {
            FStaffName31 = Value;
            StaffName31F = 1;
        }

        private void SetUpdateTime31(DateTime Value)
        {
            FUpdateTime31 = Value;
            UpdateTime31F = 1;
        }

        private void SetOkKbn31(byte Value)
        {
            FOkKbn31 = Value;
            OkKbn31F = 1;
        }

        private void SetOkComnt31(string Value)
        {
            FOkComnt31 = Value;
            OkComnt31F = 1;
        }

        private void SetStaffKbn32(byte Value)
        {
            FStaffKbn32 = Value;
            StaffKbn32F = 1;
        }

        private void SetStaffCode32(int Value)
        {
            FStaffCode32 = Value;
            StaffCode32F = 1;
        }

        private void SetStaffName32(string Value)
        {
            FStaffName32 = Value;
            StaffName32F = 1;
        }

        private void SetUpdateTime32(DateTime Value)
        {
            FUpdateTime32 = Value;
            UpdateTime32F = 1;
        }

        private void SetOkKbn32(byte Value)
        {
            FOkKbn32 = Value;
            OkKbn32F = 1;
        }

        private void SetOkComnt32(string Value)
        {
            FOkComnt32 = Value;
            OkComnt32F = 1;
        }

        private void SetStaffKbn41(byte Value)
        {
            FStaffKbn41 = Value;
            StaffKbn41F = 1;
        }

        private void SetStaffCode41(int Value)
        {
            FStaffCode41 = Value;
            StaffCode41F = 1;
        }

        private void SetStaffName41(string Value)
        {
            FStaffName41 = Value;
            StaffName41F = 1;
        }

        private void SetUpdateTime41(DateTime Value)
        {
            FUpdateTime41 = Value;
            UpdateTime41F = 1;
        }

        private void SetOkKbn41(byte Value)
        {
            FOkKbn41 = Value;
            OkKbn41F = 1;
        }

        private void SetOkComnt41(string Value)
        {
            FOkComnt41 = Value;
            OkComnt41F = 1;
        }

        private void SetStaffKbn42(byte Value)
        {
            FStaffKbn42 = Value;
            StaffKbn42F = 1;
        }

        private void SetStaffCode42(int Value)
        {
            FStaffCode42 = Value;
            StaffCode42F = 1;
        }

        private void SetStaffName42(string Value)
        {
            FStaffName42 = Value;
            StaffName42F = 1;
        }

        private void SetUpdateTime42(DateTime Value)
        {
            FUpdateTime42 = Value;
            UpdateTime42F = 1;
        }

        private void SetOkKbn42(byte Value)
        {
            FOkKbn42 = Value;
            OkKbn42F = 1;
        }

        private void SetOkComnt42(string Value)
        {
            FOkComnt42 = Value;
            OkComnt42F = 1;
        }

        private void SetStaffKbn51(byte Value)
        {
            FStaffKbn51 = Value;
            StaffKbn51F = 1;
        }

        private void SetStaffCode51(int Value)
        {
            FStaffCode51 = Value;
            StaffCode51F = 1;
        }

        private void SetStaffName51(string Value)
        {
            FStaffName51 = Value;
            StaffName51F = 1;
        }

        private void SetUpdateTime51(DateTime Value)
        {
            FUpdateTime51 = Value;
            UpdateTime51F = 1;
        }

        private void SetOkKbn51(byte Value)
        {
            FOkKbn51 = Value;
            OkKbn51F = 1;
        }

        private void SetOkComnt51(string Value)
        {
            FOkComnt51 = Value;
            OkComnt51F = 1;
        }

        private void SetStaffKbn52(byte Value)
        {
            FStaffKbn52 = Value;
            StaffKbn52F = 1;
        }

        private void SetStaffCode52(int Value)
        {
            FStaffCode52 = Value;
            StaffCode52F = 1;
        }

        private void SetStaffName52(string Value)
        {
            FStaffName52 = Value;
            StaffName52F = 1;
        }

        private void SetUpdateTime52(DateTime Value)
        {
            FUpdateTime52 = Value;
            UpdateTime52F = 1;
        }

        private void SetOkKbn52(byte Value)
        {
            FOkKbn52 = Value;
            OkKbn52F = 1;
        }

        private void SetOkComnt52(string Value)
        {
            FOkComnt52 = Value;
            OkComnt52F = 1;
        }

        private void SetFusenKbn(byte Value)
        {
            FFusenKbn = Value;
            FusenKbnF = 1;
        }

        private void SetFusenCmnt(string Value)
        {
            FFusenCmnt = Value;
            FusenCmntF = 1;
        }

#endif
    } // end TVKZL310Trn_SwkHead

    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310TrnSwkDetailH
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // ******************************************************************************
    public class TVKZL310Trn_SwkDetail
    {
        public int IncSize
        {
          get {
            return FIncSize;
          }
          set {
            SetIncSize(value);
          }
        }
        public byte NMonth
        {
          get {
            return FNMonth;
          }
          set {
            SetNMonth(value);
          }
        }
        // 仕訳内部月
        public byte SwkInpKbn
        {
          get {
            return FSwkInpKbn;
          }
          set {
            SetSwkInpKbn(value);
          }
        }
        // 仕訳発生区分
        public int DSrchNo
        {
          get {
            return FDSrchNo;
          }
          set {
            SetDSrchNo(value);
          }
        }
        // 明細検索ＮＯ
        public int BDSrchNo
        {
          get {
            return FBDSrchNo;
          }
          set {
            SetBDSrchNo(value);
          }
        }
        // 明細検索ＮＯ(更新前) 内部処理でのみ使用
        public int RowNo
        {
          get {
            return FRowNo;
          }
          set {
            SetRowNo(value);
          }
        }
        // 伝票明細ＮＯ
        public int HSrchNo
        {
          get {
            return FHSrchNo;
          }
          set {
            SetHSrchNo(value);
          }
        }
        // 仕訳ヘッダ検索ＮＯ
        public string RDSrchNo
        {
          get {
            return FRDSrchNo;
          }
          set {
            SetRDSrchNo(value);
          }
        }
        // 相手側明細検索ＮＯ
        public int DKmkCode
        {
          get {
            return FDKmkCode;
          }
          set {
            SetDKmkCode(value);
          }
        }
        // 科目コード
        public int DSubCode
        {
          get {
            return FDSubCode;
          }
          set {
            SetDSubCode(value);
          }
        }
        // 細目科目コード
        public string DBmnCode
        {
          get {
            return FDBmnCode;
          }
          set {
            SetDBmnCode(value);
          }
        }
        // 部門コード
        public string DSegCode1
        {
          get {
            return FDSegCode1;
          }
          set {
            SetDSegCode1(value);
          }
        }
        // セグメントコード１
        public byte DHojKbn1
        {
          get {
            return FDHojKbn1;
          }
          set {
            SetDHojKbn1(value);
          }
        }
        // 第１補助区分
        public string DHojCode1
        {
          get {
            return FDHojCode1;
          }
          set {
            SetDHojCode1(value);
          }
        }
        // 第１補助コード
        public byte DHojKbn2
        {
          get {
            return FDHojKbn2;
          }
          set {
            SetDHojKbn2(value);
          }
        }
        // 第２補助区分
        public string DHojCode2
        {
          get {
            return FDHojCode2;
          }
          set {
            SetDHojCode2(value);
          }
        }
        // 第２補助コード
        public string DKojCode
        {
          get {
            return FDKojCode;
          }
          set {
            SetDKojCode(value);
          }
        }
        // 工事コード
        public string DKsyCode
        {
          get {
            return FDKsyCode;
          }
          set {
            SetDKsyCode(value);
          }
        }
        // 工種コード
        public string DBsBmnCd
        {
          get {
            return FDBsBmnCd;
          }
          set {
            SetDBsBmnCd(value);
          }
        }
        // 仮受/仮払消費税部門コード
        public string DBankCode
        {
          get {
            return FDBankCode;
          }
          set {
            SetDBankCode(value);
          }
        }
        // 銀行コード
        public byte DTaxKbn
        {
          get {
            return FDTaxKbn;
          }
          set {
            SetDTaxKbn(value);
          }
        }
        // 消費税売上／仕入区分
        public byte DTypeCd
        {
          get {
            return FDTypeCd;
          }
          set {
            SetDTypeCd(value);
          }
        }
        // 業種コード
        public byte DTaxInc
        {
          get {
            return FDTaxInc;
          }
          set {
            SetDTaxInc(value);
          }
        }
        // 税抜／税込区分
        public int CKmkCode
        {
          get {
            return FCKmkCode;
          }
          set {
            SetCKmkCode(value);
          }
        }
        // 科目コード
        public int CSubCode
        {
          get {
            return FCSubCode;
          }
          set {
            SetCSubCode(value);
          }
        }
        // 細目科目コード
        public string CBmnCode
        {
          get {
            return FCBmnCode;
          }
          set {
            SetCBmnCode(value);
          }
        }
        // 部門コード
        public string CSegCode1
        {
          get {
            return FCSegCode1;
          }
          set {
            SetCSegCode1(value);
          }
        }
        // セグメントコード１
        public byte CHojKbn1
        {
          get {
            return FCHojKbn1;
          }
          set {
            SetCHojKbn1(value);
          }
        }
        // 第１補助区分
        public string CHojCode1
        {
          get {
            return FCHojCode1;
          }
          set {
            SetCHojCode1(value);
          }
        }
        // 第１補助コード
        public byte CHojKbn2
        {
          get {
            return FCHojKbn2;
          }
          set {
            SetCHojKbn2(value);
          }
        }
        // 第２補助区分
        public string CHojCode2
        {
          get {
            return FCHojCode2;
          }
          set {
            SetCHojCode2(value);
          }
        }
        // 第２補助コード
        public string CKojCode
        {
          get {
            return FCKojCode;
          }
          set {
            SetCKojCode(value);
          }
        }
        // 工事コード
        public string CKsyCode
        {
          get {
            return FCKsyCode;
          }
          set {
            SetCKsyCode(value);
          }
        }
        // 工種コード
        public string CBsBmnCd
        {
          get {
            return FCBsBmnCd;
          }
          set {
            SetCBsBmnCd(value);
          }
        }
        // 仮受/仮払消費税部門コード
        public string CBankCode
        {
          get {
            return FCBankCode;
          }
          set {
            SetCBankCode(value);
          }
        }
        // 銀行コード
        public byte CTaxKbn
        {
          get {
            return FCTaxKbn;
          }
          set {
            SetCTaxKbn(value);
          }
        }
        // 消費税売上／仕入区分
        public byte CTypeCd
        {
          get {
            return FCTypeCd;
          }
          set {
            SetCTypeCd(value);
          }
        }
        // 業種コード
        public byte CTaxInc
        {
          get {
            return FCTaxInc;
          }
          set {
            SetCTaxInc(value);
          }
        }
        // 税抜／税込区分
        public byte CashKbn
        {
          get {
            return FCashKbn;
          }
          set {
            SetCashKbn(value);
          }
        }
        // 資金繰入力区分
        public byte CashCode
        {
          get {
            return FCashCode;
          }
          set {
            SetCashCode(value);
          }
        }
        // 資金繰コード
        public byte TaxCode
        {
          get {
            return FTaxCode;
          }
          set {
            SetTaxCode(value);
          }
        }
        // 消費税コード
        public short TaxRate
        {
          get {
            return FTaxRate;
          }
          set {
            SetTaxRate(value);
          }
        }
        // 消費税率区分
        public byte ExcptRate
        {
          get {
            return FExcptRate;
          }
          set {
            SetExcptRate(value);
          }
        }
        // 例外税率区分
        public byte TaxInpKbn
        {
          get {
            return FTaxInpKbn;
          }
          set {
            SetTaxInpKbn(value);
          }
        }
        // 外税同時入力区分
        public decimal InpSum
        {
          get {
            return FInpSum;
          }
          set {
            SetInpSum(value);
          }
        }
        // 金額（入力金額）
        public decimal TaxSum
        {
          get {
            return FTaxSum;
          }
          set {
            SetTaxSum(value);
          }
        }
        // 消費税額
        public byte InpPoInt
        {
          get {
            return FInpPoInt;
          }
          set {
            SetInpPoInt(value);
          }
        }
        // 金額小数点桁数
        public byte TaxPoInt
        {
          get {
            return FTaxPoInt;
          }
          set {
            SetTaxPoInt(value);
          }
        }
        // 消費税額小数点桁数
        public int LimitDate
        {
          get {
            return FLimitDate;
          }
          set {
            SetLimitDate(value);
          }
        }
        // 期日
        public string Tekiyo
        {
          get {
            return FTekiyo;
          }
          set {
            SetTekiyo(value);
          }
        }
        // 摘要
        public int TekiCd1
        {
          get {
            return FTekiCd1;
          }
          set {
            SetTekiCd1(value);
          }
        }
        // 固定摘要コード１
        public int TekiCd2
        {
          get {
            return FTekiCd2;
          }
          set {
            SetTekiCd2(value);
          }
        }
        // 固定摘要コード２
        public int TekiCd3
        {
          get {
            return FTekiCd3;
          }
          set {
            SetTekiCd3(value);
          }
        }
        // 固定摘要コード３
        public int TekiCd4
        {
          get {
            return FTekiCd4;
          }
          set {
            SetTekiCd4(value);
          }
        }
        // 固定摘要コード４
        public int TekiCd5
        {
          get {
            return FTekiCd5;
          }
          set {
            SetTekiCd5(value);
          }
        }
        // 固定摘要コード５
        public byte NonAcc
        {
          get {
            return FNonAcc;
          }
          set {
            SetNonAcc(value);
          }
        }
        // 非会計データ区分
        public byte ImgKbn
        {
          get {
            return FImgKbn;
          }
          set {
            SetImgKbn(value);
          }
        }
        // ＯＣＲイメージ摘要区分
        public byte SwkInpKbn2
        {
          get {
            return FSwkInpKbn2;
          }
          set {
            SetSwkInpKbn2(value);
          }
        }
        // 仕訳発生区分(修正)
        public DateTime FirstDate
        {
          get {
            return FFirstDate;
          }
          set {
            SetFirstDate(value);
          }
        }
        // 初回入力日時
        public byte FkSetKbn
        {
          get {
            return FFkSetKbn;
          }
          set {
            SetFkSetKbn(value);
          }
        }
        // 複合セット処理区分
        public string BusCode
        {
          get {
            return FBusCode;
          }
          set {
            SetBusCode(value);
          }
        }
        // 入力部署コード
        public int BusDSrchNo
        {
          get {
            return FBusDSrchNo;
          }
          set {
            SetBusDSrchNo(value);
          }
        }
        // 入力部署検索NO
        public byte StaffKbn01
        {
          get {
            return FStaffKbn01;
          }
          set {
            SetStaffKbn01(value);
          }
        }
        // 担当者区分
        public int StaffCode01
        {
          get {
            return FStaffCode01;
          }
          set {
            SetStaffCode01(value);
          }
        }
        // 担当者コード
        public string StaffName01
        {
          get {
            return FStaffName01;
          }
          set {
            SetStaffName01(value);
          }
        }
        // 担当者名
        public DateTime UpdateTime01
        {
          get {
            return FUpdateTime01;
          }
          set {
            SetUpdateTime01(value);
          }
        }
        // 入力／修正日時
        public byte FusenKbn
        {
          get {
            return FFusenKbn;
          }
          set {
            SetFusenKbn(value);
          }
        }
        // 付箋区分
        public string FusenCmnt
        {
          get {
            return FFusenCmnt;
          }
          set {
            SetFusenCmnt(value);
          }
        }
        // 付箋コメント
        public byte SwkAIKbn
        {
          get {
            return FSwkAIKbn;
          }
          set {
            SetSwkAIKbn(value);
          }
        }
        // 仕訳付加情報セットフラグ
        public int FKmkCode
        {
          get {
            return FFKmkCode;
          }
          set {
            SetFKmkCode(value);
          }
        }
        // 複合勘定科目コード
        public int FSubCode
        {
          get {
            return FFSubCode;
          }
          set {
            SetFSubCode(value);
          }
        }
        // 複合細目科目コード
        public string FBmnCode
        {
          get {
            return FFBmnCode;
          }
          set {
            SetFBmnCode(value);
          }
        }
        // 複合部門コード
        public string FSegCode1
        {
          get {
            return FFSegCode1;
          }
          set {
            SetFSegCode1(value);
          }
        }
        // 複合セグメントコード
        public string FHojCode1
        {
          get {
            return FFHojCode1;
          }
          set {
            SetFHojCode1(value);
          }
        }
        // 複合第1補助コード
        public string FHojCode2
        {
          get {
            return FFHojCode2;
          }
          set {
            SetFHojCode2(value);
          }
        }
        // 複合第2補助コード
        public string FKojCode
        {
          get {
            return FFKojCode;
          }
          set {
            SetFKojCode(value);
          }
        }
        // 複合工事コード
        public string FKsyCode
        {
          get {
            return FFKsyCode;
          }
          set {
            SetFKsyCode(value);
          }
        }
        // 複合工種コード
        public string NumValue1
        {
          get {
            return FNumValue1;
          }
          set {
            SetNumValue1(value);
          }
        }
        // 番号１（請求書ＮＯ）
        public string NumValue2
        {
          get {
            return FNumValue2;
          }
          set {
            SetNumValue2(value);
          }
        }
        // 番号２（契約書ＮＯ）
        public string BillNum
        {
          get {
            return FBillNum;
          }
          set {
            SetBillNum(value);
          }
        }
        // 手形番号
        public string BillCNum
        {
          get {
            return FBillCNum;
          }
          set {
            SetBillCNum(value);
          }
        }
        // 手形管理番号
        public byte BillClass
        {
          get {
            return FBillClass;
          }
          set {
            SetBillClass(value);
          }
        }
        // 手形種別
        public string BillRank
        {
          get {
            return FBillRank;
          }
          set {
            SetBillRank(value);
          }
        }
        // 手形信用度
        public int DateIssue
        {
          get {
            return FDateIssue;
          }
          set {
            SetDateIssue(value);
          }
        }
        // 手形振出日
        public string DrawName
        {
          get {
            return FDrawName;
          }
          set {
            SetDrawName(value);
          }
        }
        // 手形振出人
        public string ExgPlace
        {
          get {
            return FExgPlace;
          }
          set {
            SetExgPlace(value);
          }
        }
        // 支払場所
        public byte FinCode
        {
          get {
            return FFinCode;
          }
          set {
            SetFinCode(value);
          }
        }
        // 顛末コード
        public string FinBank
        {
          get {
            return FFinBank;
          }
          set {
            SetFinBank(value);
          }
        }
        // 顛末銀行コード
        public int HndKmkCd
        {
          get {
            return FHndKmkCd;
          }
          set {
            SetHndKmkCd(value);
          }
        }
        // 譲渡勘定科目コード
        public int HndSubCd
        {
          get {
            return FHndSubCd;
          }
          set {
            SetHndSubCd(value);
          }
        }
        // 譲渡細目科目コード
        public string HndHojCd
        {
          get {
            return FHndHojCd;
          }
          set {
            SetHndHojCd(value);
          }
        }
        // 譲渡先コード
        public int ChgComCd
        {
          get {
            return FChgComCd;
          }
          set {
            SetChgComCd(value);
          }
        }
        // 付替先会社コード
        public short ChgBraCd
        {
          get {
            return FChgBraCd;
          }
          set {
            SetChgBraCd(value);
          }
        }
        // 付替先本支店コード
        public byte ChgDCKbn
        {
          get {
            return FChgDCKbn;
          }
          set {
            SetChgDCKbn(value);
          }
        }
        // 貸借区分
        public int ChgKmkCd
        {
          get {
            return FChgKmkCd;
          }
          set {
            SetChgKmkCd(value);
          }
        }
        // 相手科目コード
        public int ChgSubCd
        {
          get {
            return FChgSubCd;
          }
          set {
            SetChgSubCd(value);
          }
        }
        // 相手細目科目コード
        public string ChgBmnCd
        {
          get {
            return FChgBmnCd;
          }
          set {
            SetChgBmnCd(value);
          }
        }
        // 相手部門コード
        public string ChgHojCd1
        {
          get {
            return FChgHojCd1;
          }
          set {
            SetChgHojCd1(value);
          }
        }
        // 相手第１補助コード
        public string ChgHojCd2
        {
          get {
            return FChgHojCd2;
          }
          set {
            SetChgHojCd2(value);
          }
        }
        // 相手第２補助コード
        public string ChgKojCd
        {
          get {
            return FChgKojCd;
          }
          set {
            SetChgKojCd(value);
          }
        }
        // 相手工事コード
        public string ChgKsyCd
        {
          get {
            return FChgKsyCd;
          }
          set {
            SetChgKsyCd(value);
          }
        }
        // 相手工種コード
        public int ChgDate
        {
          get {
            return FChgDate;
          }
          set {
            SetChgDate(value);
          }
        }
        // 期日
        public int ChgAitCd
        {
          get {
            return FChgAitCd;
          }
          set {
            SetChgAitCd(value);
          }
        }
        // 本支店勘定コード
        public byte ChgTaxCd
        {
          get {
            return FChgTaxCd;
          }
          set {
            SetChgTaxCd(value);
          }
        }
        // 消費税コード
        public short ChgTaxRate
        {
          get {
            return FChgTaxRate;
          }
          set {
            SetChgTaxRate(value);
          }
        }
        // 消費税率区分
        public byte ChgTypeCd
        {
          get {
            return FChgTypeCd;
          }
          set {
            SetChgTypeCd(value);
          }
        }
        // 業種区分
        public decimal ChgTaxSum
        {
          get {
            return FChgTaxSum;
          }
          set {
            SetChgTaxSum(value);
          }
        }
        // 消費税額
        public string ChgNum1
        {
          get {
            return FChgNum1;
          }
          set {
            SetChgNum1(value);
          }
        }
        // 番号１（請求書ＮＯ）
        public string ChgNum2
        {
          get {
            return FChgNum2;
          }
          set {
            SetChgNum2(value);
          }
        }
        // 番号２（契約書ＮＯ）
        public decimal InpSum2
        {
          get {
            return FInpSum2;
          }
          set {
            SetInpSum2(value);
          }
        }
        // 数量 (外貨金額)
        public decimal TaxSum2
        {
          get {
            return FTaxSum2;
          }
          set {
            SetTaxSum2(value);
          }
        }
        // 単価 (外貨レート)
        public byte InpPoInt2
        {
          get {
            return FInpPoInt2;
          }
          set {
            SetInpPoInt2(value);
          }
        }
        // 数量小数点桁数
        public byte TaxPoInt2
        {
          get {
            return FTaxPoInt2;
          }
          set {
            SetTaxPoInt2(value);
          }
        }
        // 単価小数点桁数
        public int FinDate
        {
          get {
            return FFinDate;
          }
          set {
            SetFinDate(value);
          }
        }
        // 受取手形顛末処理日
        public int SwkDicNo
        {
          get {
            return FSwkDicNo;
          }
          set {
            SetSwkDicNo(value);
          }
        }
        // 仕訳辞書NO
        public byte SaddKbn1
        {
          get {
            return FSaddKbn1;
          }
          set {
            SetSaddKbn1(value);
          }
        }
        public short SaddKbn2
        {
          get {
            return FSaddKbn2;
          }
          set {
            SetSaddKbn2(value);
          }
        }
        public short SaddKbn3
        {
          get {
            return FSaddKbn3;
          }
          set {
            SetSaddKbn3(value);
          }
        }
        // 借方番号
        public string DNumValue1
        {
          get {
            return FDNumValue1;
          }
          set {
            SetDNumValue1(value);
          }
        }
        // 番号１（請求書ＮＯ）
        public string DNumValue2
        {
          get {
            return FDNumValue2;
          }
          set {
            SetDNumValue2(value);
          }
        }
        // 番号２（契約書ＮＯ）
        public string DNumValue3
        {
          get {
            return FDNumValue3;
          }
          set {
            SetDNumValue3(value);
          }
        }
        // 番号３
        public string DNumValue4
        {
          get {
            return FDNumValue4;
          }
          set {
            SetDNumValue4(value);
          }
        }
        // 番号４
        public string DNumValue5
        {
          get {
            return FDNumValue5;
          }
          set {
            SetDNumValue5(value);
          }
        }
        // 番号５
        public string DNumValue6
        {
          get {
            return FDNumValue6;
          }
          set {
            SetDNumValue6(value);
          }
        }
        // 番号６
        public string DNumValue7
        {
          get {
            return FDNumValue7;
          }
          set {
            SetDNumValue7(value);
          }
        }
        // 番号７
        public string DNumValue8
        {
          get {
            return FDNumValue8;
          }
          set {
            SetDNumValue8(value);
          }
        }
        // 番号８
        public string DNumValue9
        {
          get {
            return FDNumValue9;
          }
          set {
            SetDNumValue9(value);
          }
        }
        // 番号９
        public string DNumValue10
        {
          get {
            return FDNumValue10;
          }
          set {
            SetDNumValue10(value);
          }
        }
        // 番号１０
        // 貸方番号
        public string CNumValue1
        {
          get {
            return FCNumValue1;
          }
          set {
            SetCNumValue1(value);
          }
        }
        // 番号１（請求書ＮＯ）
        public string CNumValue2
        {
          get {
            return FCNumValue2;
          }
          set {
            SetCNumValue2(value);
          }
        }
        // 番号２（契約書ＮＯ）
        public string CNumValue3
        {
          get {
            return FCNumValue3;
          }
          set {
            SetCNumValue3(value);
          }
        }
        // 番号３
        public string CNumValue4
        {
          get {
            return FCNumValue4;
          }
          set {
            SetCNumValue4(value);
          }
        }
        // 番号４
        public string CNumValue5
        {
          get {
            return FCNumValue5;
          }
          set {
            SetCNumValue5(value);
          }
        }
        // 番号５
        public string CNumValue6
        {
          get {
            return FCNumValue6;
          }
          set {
            SetCNumValue6(value);
          }
        }
        // 番号６
        public string CNumValue7
        {
          get {
            return FCNumValue7;
          }
          set {
            SetCNumValue7(value);
          }
        }
        // 番号７
        public string CNumValue8
        {
          get {
            return FCNumValue8;
          }
          set {
            SetCNumValue8(value);
          }
        }
        // 番号８
        public string CNumValue9
        {
          get {
            return FCNumValue9;
          }
          set {
            SetCNumValue9(value);
          }
        }
        // 番号９
        public string CNumValue10
        {
          get {
            return FCNumValue10;
          }
          set {
            SetCNumValue10(value);
          }
        }
        // 番号１０
        // 借方可変区分
        public byte DSubKbn
        {
          get {
            return FDSubKbn;
          }
          set {
            SetDSubKbn(value);
          }
        }
        // 科目別補助科目コード区分
        public byte DBmnKbn
        {
          get {
            return FDBmnKbn;
          }
          set {
            SetDBmnKbn(value);
          }
        }
        // 部門コード区分
        public byte DSeg1Kbn
        {
          get {
            return FDSeg1Kbn;
          }
          set {
            SetDSeg1Kbn(value);
          }
        }
        // セグメントコード１区分
        public byte DHojyo1Kbn
        {
          get {
            return FDHojyo1Kbn;
          }
          set {
            SetDHojyo1Kbn(value);
          }
        }
        // 第１補助コード区分
        public byte DHojyo2Kbn
        {
          get {
            return FDHojyo2Kbn;
          }
          set {
            SetDHojyo2Kbn(value);
          }
        }
        // 第２補助コード区分
        public byte DKojKbn
        {
          get {
            return FDKojKbn;
          }
          set {
            SetDKojKbn(value);
          }
        }
        // 工事コード区分
        public byte DKsyKbn
        {
          get {
            return FDKsyKbn;
          }
          set {
            SetDKsyKbn(value);
          }
        }
        // 工種コード区分
        // 貸方可変区分
        public byte CSubKbn
        {
          get {
            return FCSubKbn;
          }
          set {
            SetCSubKbn(value);
          }
        }
        // 科目別補助科目コード区分
        public byte CBmnKbn
        {
          get {
            return FCBmnKbn;
          }
          set {
            SetCBmnKbn(value);
          }
        }
        // 部門コード区分
        public byte CSeg1Kbn
        {
          get {
            return FCSeg1Kbn;
          }
          set {
            SetCSeg1Kbn(value);
          }
        }
        // セグメントコード１区分
        public byte CHojyo1Kbn
        {
          get {
            return FCHojyo1Kbn;
          }
          set {
            SetCHojyo1Kbn(value);
          }
        }
        // 第１補助コード区分
        public byte CHojyo2Kbn
        {
          get {
            return FCHojyo2Kbn;
          }
          set {
            SetCHojyo2Kbn(value);
          }
        }
        // 第２補助コード区分
        public byte CKojKbn
        {
          get {
            return FCKojKbn;
          }
          set {
            SetCKojKbn(value);
          }
        }
        // 工事コード区分
        public byte CKsyKbn
        {
          get {
            return FCKsyKbn;
          }
          set {
            SetCKsyKbn(value);
          }
        }
        // 工種コード区分
        public string ChgSegCd1
        {
          get {
            return FChgSegCd1;
          }
          set {
            SetChgSegCd1(value);
          }
        }
        // セグメントコード１
        public int ChgTaxKbn
        {
          get {
            return FChgTaxKbn;
          }
          set {
            SetChgTaxKbn(value);
          }
        }
        // 消費税売上／仕入区分
        public int ChgExcptRate
        {
          get {
            return FChgExcptRate;
          }
          set {
            SetChgExcptRate(value);
          }
        }
        // 例外税率区分
        public int ChgCashCd
        {
          get {
            return FChgCashCd;
          }
          set {
            SetChgCashCd(value);
          }
        }
        // 資金繰コード
        public string ChgBillNum
        {
          get {
            return FChgBillNum;
          }
          set {
            SetChgBillNum(value);
          }
        }
        // 手形番号
        public string ChgBillCNum
        {
          get {
            return FChgBillCNum;
          }
          set {
            SetChgBillCNum(value);
          }
        }
        // 手形管理番号
        public byte ExeCode00
        {
          get {
            return FExeCode00;
          }
          set {
            SetExeCode00(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn00
        {
          get {
            return FExeKbn00;
          }
          set {
            SetExeKbn00(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime00
        {
          get {
            return FExeDTime00;
          }
          set {
            SetExeDTime00(value);
          }
        }
        // 実行日時
        public string ErrMess00
        {
          get {
            return FErrMess00;
          }
          set {
            SetErrMess00(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode01
        {
          get {
            return FExeCode01;
          }
          set {
            SetExeCode01(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn01
        {
          get {
            return FExeKbn01;
          }
          set {
            SetExeKbn01(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime01
        {
          get {
            return FExeDTime01;
          }
          set {
            SetExeDTime01(value);
          }
        }
        // 実行日時
        public string ErrMess01
        {
          get {
            return FErrMess01;
          }
          set {
            SetErrMess01(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode03
        {
          get {
            return FExeCode03;
          }
          set {
            SetExeCode03(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn03
        {
          get {
            return FExeKbn03;
          }
          set {
            SetExeKbn03(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime03
        {
          get {
            return FExeDTime03;
          }
          set {
            SetExeDTime03(value);
          }
        }
        // 実行日時
        public string ErrMess03
        {
          get {
            return FErrMess03;
          }
          set {
            SetErrMess03(value);
          }
        }
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署入力受信
        // ----------------------------------------------------------
        public byte ExeCode04
        {
          get {
            return FExeCode04;
          }
          set {
            SetExeCode04(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn04
        {
          get {
            return FExeKbn04;
          }
          set {
            SetExeKbn04(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime04
        {
          get {
            return FExeDTime04;
          }
          set {
            SetExeDTime04(value);
          }
        }
        // 実行日時
        public string ErrMess04
        {
          get {
            return FErrMess04;
          }
          set {
            SetErrMess04(value);
          }
        }
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署承認／保留
        // ----------------------------------------------------------
        public byte ExeCode05
        {
          get {
            return FExeCode05;
          }
          set {
            SetExeCode05(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn05
        {
          get {
            return FExeKbn05;
          }
          set {
            SetExeKbn05(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime05
        {
          get {
            return FExeDTime05;
          }
          set {
            SetExeDTime05(value);
          }
        }
        // 実行日時
        public string ErrMess05
        {
          get {
            return FErrMess05;
          }
          set {
            SetErrMess05(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode11
        {
          get {
            return FExeCode11;
          }
          set {
            SetExeCode11(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn11
        {
          get {
            return FExeKbn11;
          }
          set {
            SetExeKbn11(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime11
        {
          get {
            return FExeDTime11;
          }
          set {
            SetExeDTime11(value);
          }
        }
        // 実行日時
        public string ErrMess11
        {
          get {
            return FErrMess11;
          }
          set {
            SetErrMess11(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode12
        {
          get {
            return FExeCode12;
          }
          set {
            SetExeCode12(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn12
        {
          get {
            return FExeKbn12;
          }
          set {
            SetExeKbn12(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime12
        {
          get {
            return FExeDTime12;
          }
          set {
            SetExeDTime12(value);
          }
        }
        // 実行日時
        public string ErrMess12
        {
          get {
            return FErrMess12;
          }
          set {
            SetErrMess12(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode13
        {
          get {
            return FExeCode13;
          }
          set {
            SetExeCode13(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn13
        {
          get {
            return FExeKbn13;
          }
          set {
            SetExeKbn13(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime13
        {
          get {
            return FExeDTime13;
          }
          set {
            SetExeDTime13(value);
          }
        }
        // 実行日時
        public string ErrMess13
        {
          get {
            return FErrMess13;
          }
          set {
            SetErrMess13(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode21
        {
          get {
            return FExeCode21;
          }
          set {
            SetExeCode21(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn21
        {
          get {
            return FExeKbn21;
          }
          set {
            SetExeKbn21(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime21
        {
          get {
            return FExeDTime21;
          }
          set {
            SetExeDTime21(value);
          }
        }
        // 実行日時
        public string ErrMess21
        {
          get {
            return FErrMess21;
          }
          set {
            SetErrMess21(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode22
        {
          get {
            return FExeCode22;
          }
          set {
            SetExeCode22(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn22
        {
          get {
            return FExeKbn22;
          }
          set {
            SetExeKbn22(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime22
        {
          get {
            return FExeDTime22;
          }
          set {
            SetExeDTime22(value);
          }
        }
        // 実行日時
        public string ErrMess22
        {
          get {
            return FErrMess22;
          }
          set {
            SetErrMess22(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode23
        {
          get {
            return FExeCode23;
          }
          set {
            SetExeCode23(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn23
        {
          get {
            return FExeKbn23;
          }
          set {
            SetExeKbn23(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime23
        {
          get {
            return FExeDTime23;
          }
          set {
            SetExeDTime23(value);
          }
        }
        // 実行日時
        public string ErrMess23
        {
          get {
            return FErrMess23;
          }
          set {
            SetErrMess23(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode24
        {
          get {
            return FExeCode24;
          }
          set {
            SetExeCode24(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn24
        {
          get {
            return FExeKbn24;
          }
          set {
            SetExeKbn24(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime24
        {
          get {
            return FExeDTime24;
          }
          set {
            SetExeDTime24(value);
          }
        }
        // 実行日時
        public string ErrMess24
        {
          get {
            return FErrMess24;
          }
          set {
            SetErrMess24(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode31
        {
          get {
            return FExeCode31;
          }
          set {
            SetExeCode31(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn31
        {
          get {
            return FExeKbn31;
          }
          set {
            SetExeKbn31(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime31
        {
          get {
            return FExeDTime31;
          }
          set {
            SetExeDTime31(value);
          }
        }
        // 実行日時
        public string ErrMess31
        {
          get {
            return FErrMess31;
          }
          set {
            SetErrMess31(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode32
        {
          get {
            return FExeCode32;
          }
          set {
            SetExeCode32(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn32
        {
          get {
            return FExeKbn32;
          }
          set {
            SetExeKbn32(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime32
        {
          get {
            return FExeDTime32;
          }
          set {
            SetExeDTime32(value);
          }
        }
        // 実行日時
        public string ErrMess32
        {
          get {
            return FErrMess32;
          }
          set {
            SetErrMess32(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode33
        {
          get {
            return FExeCode33;
          }
          set {
            SetExeCode33(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn33
        {
          get {
            return FExeKbn33;
          }
          set {
            SetExeKbn33(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime33
        {
          get {
            return FExeDTime33;
          }
          set {
            SetExeDTime33(value);
          }
        }
        // 実行日時
        public string ErrMess33
        {
          get {
            return FErrMess33;
          }
          set {
            SetErrMess33(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode34
        {
          get {
            return FExeCode34;
          }
          set {
            SetExeCode34(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn34
        {
          get {
            return FExeKbn34;
          }
          set {
            SetExeKbn34(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime34
        {
          get {
            return FExeDTime34;
          }
          set {
            SetExeDTime34(value);
          }
        }
        // 実行日時
        public string ErrMess34
        {
          get {
            return FErrMess34;
          }
          set {
            SetErrMess34(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode35
        {
          get {
            return FExeCode35;
          }
          set {
            SetExeCode35(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn35
        {
          get {
            return FExeKbn35;
          }
          set {
            SetExeKbn35(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime35
        {
          get {
            return FExeDTime35;
          }
          set {
            SetExeDTime35(value);
          }
        }
        // 実行日時
        public string ErrMess35
        {
          get {
            return FErrMess35;
          }
          set {
            SetErrMess35(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode41
        {
          get {
            return FExeCode41;
          }
          set {
            SetExeCode41(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn41
        {
          get {
            return FExeKbn41;
          }
          set {
            SetExeKbn41(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime41
        {
          get {
            return FExeDTime41;
          }
          set {
            SetExeDTime41(value);
          }
        }
        // 実行日時
        public string ErrMess41
        {
          get {
            return FErrMess41;
          }
          set {
            SetErrMess41(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode42
        {
          get {
            return FExeCode42;
          }
          set {
            SetExeCode42(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn42
        {
          get {
            return FExeKbn42;
          }
          set {
            SetExeKbn42(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime42
        {
          get {
            return FExeDTime42;
          }
          set {
            SetExeDTime42(value);
          }
        }
        // 実行日時
        public string ErrMess42
        {
          get {
            return FErrMess42;
          }
          set {
            SetErrMess42(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode43
        {
          get {
            return FExeCode43;
          }
          set {
            SetExeCode43(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn43
        {
          get {
            return FExeKbn43;
          }
          set {
            SetExeKbn43(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime43
        {
          get {
            return FExeDTime43;
          }
          set {
            SetExeDTime43(value);
          }
        }
        // 実行日時
        public string ErrMess43
        {
          get {
            return FErrMess43;
          }
          set {
            SetErrMess43(value);
          }
        }
        // エラーメッセージ
        public byte ExeCode44
        {
          get {
            return FExeCode44;
          }
          set {
            SetExeCode44(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn44
        {
          get {
            return FExeKbn44;
          }
          set {
            SetExeKbn44(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime44
        {
          get {
            return FExeDTime44;
          }
          set {
            SetExeDTime44(value);
          }
        }
        // 実行日時
        public string ErrMess44
        {
          get {
            return FErrMess44;
          }
          set {
            SetErrMess44(value);
          }
        }
        // エラーメッセージ
        // ----------------------------------------------------------
        // 仮払い精算済
        // ----------------------------------------------------------
        public byte ExeCode51
        {
          get {
            return FExeCode51;
          }
          set {
            SetExeCode51(value);
          }
        }
        // 特殊処理コード
        public byte ExeKbn51
        {
          get {
            return FExeKbn51;
          }
          set {
            SetExeKbn51(value);
          }
        }
        // 修正／削除不可区分
        public DateTime ExeDTime51
        {
          get {
            return FExeDTime51;
          }
          set {
            SetExeDTime51(value);
          }
        }
        // 実行日時
        public string ErrMess51
        {
          get {
            return FErrMess51;
          }
          set {
            SetErrMess51(value);
          }
        }
        // エラーメッセージ
        public byte JNMonth21
        {
          get {
            return FJNMonth21;
          }
          set {
            SetJNMonth21(value);
          }
        }
        // 自動仕訳内部月
        public byte JSwkInpKbn21
        {
          get {
            return FJSwkInpKbn21;
          }
          set {
            SetJSwkInpKbn21(value);
          }
        }
        // 自動仕訳発生区分
        public int JDSrchNo21
        {
          get {
            return FJDSrchNo21;
          }
          set {
            SetJDSrchNo21(value);
          }
        }
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth22
        {
          get {
            return FJNMonth22;
          }
          set {
            SetJNMonth22(value);
          }
        }
        // 自動仕訳内部月
        public byte JSwkInpKbn22
        {
          get {
            return FJSwkInpKbn22;
          }
          set {
            SetJSwkInpKbn22(value);
          }
        }
        // 自動仕訳発生区分
        public int JDSrchNo22
        {
          get {
            return FJDSrchNo22;
          }
          set {
            SetJDSrchNo22(value);
          }
        }
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth23
        {
          get {
            return FJNMonth23;
          }
          set {
            SetJNMonth23(value);
          }
        }
        // 自動仕訳内部月
        public byte JSwkInpKbn23
        {
          get {
            return FJSwkInpKbn23;
          }
          set {
            SetJSwkInpKbn23(value);
          }
        }
        // 自動仕訳発生区分
        public int JDSrchNo23
        {
          get {
            return FJDSrchNo23;
          }
          set {
            SetJDSrchNo23(value);
          }
        }
        // 自動仕訳明細検索ＮＯ
        public byte JNMonth24
        {
          get {
            return FJNMonth24;
          }
          set {
            SetJNMonth24(value);
          }
        }
        // 自動仕訳内部月
        public byte JSwkInpKbn24
        {
          get {
            return FJSwkInpKbn24;
          }
          set {
            SetJSwkInpKbn24(value);
          }
        }
        // 自動仕訳発生区分
        public int JDSrchNo24
        {
          get {
            return FJDSrchNo24;
          }
          set {
            SetJDSrchNo24(value);
          }
        }
        private byte IUDKbn = 0;
        // 処理区分
        private byte SwkDTKbn = 0;
        // 仕訳明細データセットフラグ
        private int FIncSize = 0;
        private byte FNMonth = 0;
        // 仕訳内部月
        private byte FSwkInpKbn = 0;
        // 仕訳発生区分
        private int FDSrchNo = 0;
        // 明細検索ＮＯ
        private int FBDSrchNo = 0;
        // 明細検索ＮＯ(更新前) 内部処理でのみ使用
        private int FRowNo = 0;
        // 伝票明細ＮＯ
        private int FHSrchNo = 0;
        // 仕訳ヘッダ検索ＮＯ
        private string FRDSrchNo = String.Empty;
        // 相手側明細検索ＮＯ
        private int FDKmkCode = 0;
        // 科目コード
        private int FDSubCode = 0;
        // 細目科目コード
        private string FDBmnCode = String.Empty;
        // 部門コード
        private string FDSegCode1 = String.Empty;
        // セグメントコード１
        private byte FDHojKbn1 = 0;
        // 第１補助区分
        private string FDHojCode1 = String.Empty;
        // 第１補助コード
        private byte FDHojKbn2 = 0;
        // 第２補助区分
        private string FDHojCode2 = String.Empty;
        // 第２補助コード
        private string FDKojCode = String.Empty;
        // 工事コード
        private string FDKsyCode = String.Empty;
        // 工種コード
        private string FDBsBmnCd = String.Empty;
        // 仮受/仮払消費税部門コード
        private string FDBankCode = String.Empty;
        // 銀行コード
        private byte FDTaxKbn = 0;
        // 消費税売上／仕入区分
        private byte FDTypeCd = 0;
        // 業種コード
        private byte FDTaxInc = 0;
        // 税抜／税込区分
        private int FCKmkCode = 0;
        // 科目コード
        private int FCSubCode = 0;
        // 細目科目コード
        private string FCBmnCode = String.Empty;
        // 部門コード
        private string FCSegCode1 = String.Empty;
        // セグメントコード１
        private byte FCHojKbn1 = 0;
        // 第１補助区分
        private string FCHojCode1 = String.Empty;
        // 第１補助コード
        private byte FCHojKbn2 = 0;
        // 第２補助区分
        private string FCHojCode2 = String.Empty;
        // 第２補助コード
        private string FCKojCode = String.Empty;
        // 工事コード
        private string FCKsyCode = String.Empty;
        // 工種コード
        private string FCBsBmnCd = String.Empty;
        // 仮受/仮払消費税部門コード
        private string FCBankCode = String.Empty;
        // 銀行コード
        private byte FCTaxKbn = 0;
        // 消費税売上／仕入区分
        private byte FCTypeCd = 0;
        // 業種コード
        private byte FCTaxInc = 0;
        // 税抜／税込区分
        private byte FCashKbn = 0;
        // 資金繰入力区分
        private byte FCashCode = 0;
        // 資金繰コード
        private byte FTaxCode = 0;
        // 消費税コード
        private short FTaxRate = 0;
        // 消費税率区分
        private byte FExcptRate = 0;
        // 例外税率区分
        private byte FTaxInpKbn = 0;
        // 外税同時入力区分
        private decimal FInpSum = 0;
        // 金額（入力金額）
        private decimal FTaxSum = 0;
        // 消費税額
        private byte FInpPoInt = 0;
        // 金額小数点桁数
        private byte FTaxPoInt = 0;
        // 消費税額小数点桁数
        private int FLimitDate = 0;
        // 期日
        private string FTekiyo = String.Empty;
        // 摘要
        private int FTekiCd1 = 0;
        // 固定摘要コード１
        private int FTekiCd2 = 0;
        // 固定摘要コード２
        private int FTekiCd3 = 0;
        // 固定摘要コード３
        private int FTekiCd4 = 0;
        // 固定摘要コード４
        private int FTekiCd5 = 0;
        // 固定摘要コード５
        private byte FNonAcc = 0;
        // 非会計データ区分
        private byte FImgKbn = 0;
        // ＯＣＲイメージ摘要区分
        private byte FSwkInpKbn2 = 0;
        // 仕訳発生区分(修正)
        private DateTime FFirstDate;
        // 初回入力日時
        private byte FFkSetKbn = 0;
        // 複合セット処理区分
        private string FBusCode = String.Empty;
        // 入力部署コード
        private int FBusDSrchNo = 0;
        // 入力部署検索NO
        private byte FStaffKbn01 = 0;
        // 担当者区分
        private int FStaffCode01 = 0;
        // 担当者コード
        private string FStaffName01 = String.Empty;
        // 担当者名
        private DateTime FUpdateTime01;
        // 入力／修正日時
        private byte FFusenKbn = 0;
        // 付箋区分
        private string FFusenCmnt = String.Empty;
        // 付箋コメント
        private byte FSwkAIKbn = 0;
        // 仕訳付加情報セットフラグ
        private int FFKmkCode = 0;
        // 複合勘定科目コード
        private int FFSubCode = 0;
        // 複合細目科目コード
        private string FFBmnCode = String.Empty;
        // 複合部門コード
        private string FFSegCode1 = String.Empty;
        // 複合セグメントコード
        private string FFHojCode1 = String.Empty;
        // 複合第1補助コード
        private string FFHojCode2 = String.Empty;
        // 複合第2補助コード
        private string FFKojCode = String.Empty;
        // 複合工事コード
        private string FFKsyCode = String.Empty;
        // 複合工種コード
        private string FNumValue1 = String.Empty;
        // 番号１（請求書ＮＯ）
        private string FNumValue2 = String.Empty;
        // 番号２（契約書ＮＯ）
        private string FBillNum = String.Empty;
        // 手形番号
        private string FBillCNum = String.Empty;
        // 手形管理番号
        private byte FBillClass = 0;
        // 手形種別
        private string FBillRank = String.Empty;
        // 手形信用度
        private int FDateIssue = 0;
        // 手形振出日
        private string FDrawName = String.Empty;
        // 手形振出人
        private string FExgPlace = String.Empty;
        // 支払場所
        private byte FFinCode = 0;
        // 顛末コード
        private string FFinBank = String.Empty;
        // 顛末銀行コード
        private int FHndKmkCd = 0;
        // 譲渡勘定科目コード
        private int FHndSubCd = 0;
        // 譲渡細目科目コード
        private string FHndHojCd = String.Empty;
        // 譲渡先コード
        private int FChgComCd = 0;
        // 付替先会社コード
        private short FChgBraCd = 0;
        // 付替先本支店コード
        private byte FChgDCKbn = 0;
        // 貸借区分
        private int FChgKmkCd = 0;
        // 相手科目コード
        private int FChgSubCd = 0;
        // 相手細目科目コード
        private string FChgBmnCd = String.Empty;
        // 相手部門コード
        private string FChgHojCd1 = String.Empty;
        // 相手第１補助コード
        private string FChgHojCd2 = String.Empty;
        // 相手第２補助コード
        private string FChgKojCd = String.Empty;
        // 相手工事コード
        private string FChgKsyCd = String.Empty;
        // 相手工種コード
        private int FChgDate = 0;
        // 期日
        private int FChgAitCd = 0;
        // 本支店勘定コード
        private byte FChgTaxCd = 0;
        // 消費税コード
        private short FChgTaxRate = 0;
        // 消費税率区分
        private byte FChgTypeCd = 0;
        // 業種区分
        private decimal FChgTaxSum = 0;
        // 消費税額
        private string FChgNum1 = String.Empty;
        // 番号１（請求書ＮＯ）
        private string FChgNum2 = String.Empty;
        // 番号２（契約書ＮＯ）
        private decimal FInpSum2 = 0;
        // 数量 (外貨金額)
        private decimal FTaxSum2 = 0;
        // 単価 (外貨レート)
        private byte FInpPoInt2 = 0;
        // 数量小数点桁数
        private byte FTaxPoInt2 = 0;
        // 単価小数点桁数
        private int FFinDate = 0;
        // 受取手形顛末処理日
        private int FSwkDicNo = 0;
        // 仕訳辞書NO
        private byte FSaddKbn1 = 0;
        private short FSaddKbn2 = 0;
        private short FSaddKbn3 = 0;
        // 借方番号
        private string FDNumValue1 = String.Empty;
        // 番号１（請求書ＮＯ）
        private string FDNumValue2 = String.Empty;
        // 番号２（契約書ＮＯ）
        private string FDNumValue3 = String.Empty;
        // 番号３
        private string FDNumValue4 = String.Empty;
        // 番号４
        private string FDNumValue5 = String.Empty;
        // 番号５
        private string FDNumValue6 = String.Empty;
        // 番号６
        private string FDNumValue7 = String.Empty;
        // 番号７
        private string FDNumValue8 = String.Empty;
        // 番号８
        private string FDNumValue9 = String.Empty;
        // 番号９
        private string FDNumValue10 = String.Empty;
        // 番号１０
        // 貸方番号
        private string FCNumValue1 = String.Empty;
        // 番号１（請求書ＮＯ）
        private string FCNumValue2 = String.Empty;
        // 番号２（契約書ＮＯ）
        private string FCNumValue3 = String.Empty;
        // 番号３
        private string FCNumValue4 = String.Empty;
        // 番号４
        private string FCNumValue5 = String.Empty;
        // 番号５
        private string FCNumValue6 = String.Empty;
        // 番号６
        private string FCNumValue7 = String.Empty;
        // 番号７
        private string FCNumValue8 = String.Empty;
        // 番号８
        private string FCNumValue9 = String.Empty;
        // 番号９
        private string FCNumValue10 = String.Empty;
        // 番号１０
        // 借方可変区分
        private byte FDSubKbn = 0;
        // 科目別補助科目コード区分
        private byte FDBmnKbn = 0;
        // 部門コード区分
        private byte FDSeg1Kbn = 0;
        // セグメントコード１区分
        private byte FDHojyo1Kbn = 0;
        // 第１補助コード区分
        private byte FDHojyo2Kbn = 0;
        // 第２補助コード区分
        private byte FDKojKbn = 0;
        // 工事コード区分
        private byte FDKsyKbn = 0;
        // 工種コード区分
        // 貸方可変区分
        private byte FCSubKbn = 0;
        // 科目別補助科目コード区分
        private byte FCBmnKbn = 0;
        // 部門コード区分
        private byte FCSeg1Kbn = 0;
        // セグメントコード１区分
        private byte FCHojyo1Kbn = 0;
        // 第１補助コード区分
        private byte FCHojyo2Kbn = 0;
        // 第２補助コード区分
        private byte FCKojKbn = 0;
        // 工事コード区分
        private byte FCKsyKbn = 0;
        // 工種コード区分
        private string FChgSegCd1 = String.Empty;
        // セグメントコード１
        private int FChgTaxKbn = 0;
        // 消費税売上／仕入区分
        private int FChgExcptRate = 0;
        // 例外税率区分
        private int FChgCashCd = 0;
        // 資金繰コード
        private string FChgBillNum = String.Empty;
        // 手形番号
        private string FChgBillCNum = String.Empty;
        // 手形管理番号
        private byte FExeCode00 = 0;
        // 特殊処理コード
        private byte FExeKbn00 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime00;
        // 実行日時
        private string FErrMess00 = String.Empty;
        // エラーメッセージ
        private byte FExeCode01 = 0;
        // 特殊処理コード
        private byte FExeKbn01 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime01;
        // 実行日時
        private string FErrMess01 = String.Empty;
        // エラーメッセージ
        private byte FExeCode03 = 0;
        // 特殊処理コード
        private byte FExeKbn03 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime03;
        // 実行日時
        private string FErrMess03 = String.Empty;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署入力受信
        // ----------------------------------------------------------
        private byte FExeCode04 = 0;
        // 特殊処理コード
        private byte FExeKbn04 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime04;
        // 実行日時
        private string FErrMess04 = String.Empty;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署承認／保留
        // ----------------------------------------------------------
        private byte FExeCode05 = 0;
        // 特殊処理コード
        private byte FExeKbn05 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime05;
        // 実行日時
        private string FErrMess05 = String.Empty;
        // エラーメッセージ
        private byte FExeCode11 = 0;
        // 特殊処理コード
        private byte FExeKbn11 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime11;
        // 実行日時
        private string FErrMess11 = String.Empty;
        // エラーメッセージ
        private byte FExeCode12 = 0;
        // 特殊処理コード
        private byte FExeKbn12 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime12;
        // 実行日時
        private string FErrMess12 = String.Empty;
        // エラーメッセージ
        private byte FExeCode13 = 0;
        // 特殊処理コード
        private byte FExeKbn13 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime13;
        // 実行日時
        private string FErrMess13 = String.Empty;
        // エラーメッセージ
        private byte FExeCode21 = 0;
        // 特殊処理コード
        private byte FExeKbn21 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime21;
        // 実行日時
        private string FErrMess21 = String.Empty;
        // エラーメッセージ
        private byte FExeCode22 = 0;
        // 特殊処理コード
        private byte FExeKbn22 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime22;
        // 実行日時
        private string FErrMess22 = String.Empty;
        // エラーメッセージ
        private byte FExeCode23 = 0;
        // 特殊処理コード
        private byte FExeKbn23 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime23;
        // 実行日時
        private string FErrMess23 = String.Empty;
        // エラーメッセージ
        private byte FExeCode24 = 0;
        // 特殊処理コード
        private byte FExeKbn24 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime24;
        // 実行日時
        private string FErrMess24 = String.Empty;
        // エラーメッセージ
        private byte FExeCode31 = 0;
        // 特殊処理コード
        private byte FExeKbn31 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime31;
        // 実行日時
        private string FErrMess31 = String.Empty;
        // エラーメッセージ
        private byte FExeCode32 = 0;
        // 特殊処理コード
        private byte FExeKbn32 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime32;
        // 実行日時
        private string FErrMess32 = String.Empty;
        // エラーメッセージ
        private byte FExeCode33 = 0;
        // 特殊処理コード
        private byte FExeKbn33 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime33;
        // 実行日時
        private string FErrMess33 = String.Empty;
        // エラーメッセージ
        private byte FExeCode34 = 0;
        // 特殊処理コード
        private byte FExeKbn34 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime34;
        // 実行日時
        private string FErrMess34 = String.Empty;
        // エラーメッセージ
        private byte FExeCode35 = 0;
        // 特殊処理コード
        private byte FExeKbn35 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime35;
        // 実行日時
        private string FErrMess35 = String.Empty;
        // エラーメッセージ
        private byte FExeCode41 = 0;
        // 特殊処理コード
        private byte FExeKbn41 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime41;
        // 実行日時
        private string FErrMess41 = String.Empty;
        // エラーメッセージ
        private byte FExeCode42 = 0;
        // 特殊処理コード
        private byte FExeKbn42 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime42;
        // 実行日時
        private string FErrMess42 = String.Empty;
        // エラーメッセージ
        private byte FExeCode43 = 0;
        // 特殊処理コード
        private byte FExeKbn43 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime43;
        // 実行日時
        private string FErrMess43 = String.Empty;
        // エラーメッセージ
        private byte FExeCode44 = 0;
        // 特殊処理コード
        private byte FExeKbn44 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime44;
        // 実行日時
        private string FErrMess44 = String.Empty;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 仮払い精算済
        // ----------------------------------------------------------
        private byte FExeCode51 = 0;
        // 特殊処理コード
        private byte FExeKbn51 = 0;
        // 修正／削除不可区分
        private DateTime FExeDTime51;
        // 実行日時
        private string FErrMess51 = String.Empty;
        // エラーメッセージ
        private byte FJNMonth21 = 0;
        // 自動仕訳内部月
        private byte FJSwkInpKbn21 = 0;
        // 自動仕訳発生区分
        private int FJDSrchNo21 = 0;
        // 自動仕訳明細検索ＮＯ
        private byte FJNMonth22 = 0;
        // 自動仕訳内部月
        private byte FJSwkInpKbn22 = 0;
        // 自動仕訳発生区分
        private int FJDSrchNo22 = 0;
        // 自動仕訳明細検索ＮＯ
        private byte FJNMonth23 = 0;
        // 自動仕訳内部月
        private byte FJSwkInpKbn23 = 0;
        // 自動仕訳発生区分
        private int FJDSrchNo23 = 0;
        // 自動仕訳明細検索ＮＯ
        private byte FJNMonth24 = 0;
        // 自動仕訳内部月
        private byte FJSwkInpKbn24 = 0;
        // 自動仕訳発生区分
        private int FJDSrchNo24 = 0;
        // 自動仕訳明細検索ＮＯ
        // セットフラグ 0:セットなし 1:セットあり
        private byte NMonthF = 0;
        // 仕訳内部月
        private byte SwkInpKbnF = 0;
        // 仕訳発生区分
        private byte DSrchNoF = 0;
        // 明細検索ＮＯ
        private byte BDSrchNoF = 0;
        // 明細検索ＮＯ(更新前) 内部処理でのみ使用
        private byte RowNoF = 0;
        // 伝票明細ＮＯ
        private byte HSrchNoF = 0;
        // 仕訳ヘッダ検索ＮＯ
        private byte RDSrchNoF = 0;
        // 相手側明細検索ＮＯ
        private byte DKmkCodeF = 0;
        // 科目コード
        private byte DSubCodeF = 0;
        // 細目科目コード
        private byte DBmnCodeF = 0;
        // 部門コード
        private byte DSegCode1F = 0;
        // セグメントコード１
        private byte DHojKbn1F = 0;
        // 第１補助区分
        private byte DHojCode1F = 0;
        // 第１補助コード
        private byte DHojKbn2F = 0;
        // 第２補助区分
        private byte DHojCode2F = 0;
        // 第２補助コード
        private byte DKojCodeF = 0;
        // 工事コード
        private byte DKsyCodeF = 0;
        // 工種コード
        private byte DBsBmnCdF = 0;
        // 仮受/仮払消費税部門コード
        private byte DBankCodeF = 0;
        // 銀行コード
        private byte DTaxKbnF = 0;
        // 消費税売上／仕入区分
        private byte DTypeCdF = 0;
        // 業種コード
        private byte DTaxIncF = 0;
        // 税抜／税込区分
        private byte CKmkCodeF = 0;
        // 科目コード
        private byte CSubCodeF = 0;
        // 細目科目コード
        private byte CBmnCodeF = 0;
        // 部門コード
        private byte CSegCode1F = 0;
        // セグメントコード１
        private byte CHojKbn1F = 0;
        // 第１補助区分
        private byte CHojCode1F = 0;
        // 第１補助コード
        private byte CHojKbn2F = 0;
        // 第２補助区分
        private byte CHojCode2F = 0;
        // 第２補助コード
        private byte CKojCodeF = 0;
        // 工事コード
        private byte CKsyCodeF = 0;
        // 工種コード
        private byte CBsBmnCdF = 0;
        // 仮受/仮払消費税部門コード
        private byte CBankCodeF = 0;
        // 銀行コード
        private byte CTaxKbnF = 0;
        // 消費税売上／仕入区分
        private byte CTypeCdF = 0;
        // 業種コード
        private byte CTaxIncF = 0;
        // 税抜／税込区分
        private byte CashKbnF = 0;
        // 資金繰入力区分
        private byte CashCodeF = 0;
        // 資金繰コード
        private byte TaxCodeF = 0;
        // 消費税コード
        private byte TaxRateF = 0;
        // 消費税率区分
        private byte ExcptRateF = 0;
        // 例外税率区分
        private byte TaxInpKbnF = 0;
        // 外税同時入力区分
        private byte InpSumF = 0;
        // 金額（入力金額）
        private byte TaxSumF = 0;
        // 消費税額
        private byte InpPoIntF = 0;
        // 金額小数点桁数
        private byte TaxPoIntF = 0;
        // 消費税額小数点桁数
        private byte LimitDateF = 0;
        // 期日
        private byte TekiyoF = 0;
        // 摘要
        private byte TekiCd1F = 0;
        // 固定摘要コード１
        private byte TekiCd2F = 0;
        // 固定摘要コード２
        private byte TekiCd3F = 0;
        // 固定摘要コード３
        private byte TekiCd4F = 0;
        // 固定摘要コード４
        private byte TekiCd5F = 0;
        // 固定摘要コード５
        private byte NonAccF = 0;
        // 非会計データ区分
        private byte ImgKbnF = 0;
        // ＯＣＲイメージ摘要区分
        private byte SwkInpKbn2F = 0;
        // 仕訳発生区分(修正)
        private byte FirstDateF = 0;
        // 初回入力日時
        private byte FkSetKbnF = 0;
        // 複合セット処理区分
        private byte BusCodeF = 0;
        // 入力部署コード
        private byte BusDSrchNoF = 0;
        // 入力部署検索NO
        private byte StaffKbn01F = 0;
        // 担当者区分
        private byte StaffCode01F = 0;
        // 担当者コード
        private byte StaffName01F = 0;
        // 担当者名
        private byte UpdateTime01F = 0;
        // 入力／修正日時
        private byte FusenKbnF = 0;
        // 付箋区分
        private byte FusenCmntF = 0;
        // 付箋コメント
        private byte SwkAIKbnF = 0;
        // 仕訳付加情報セットフラグ
        private byte FKmkCodeF = 0;
        // 複合勘定科目コード
        private byte FSubCodeF = 0;
        // 複合細目科目コード
        private byte FBmnCodeF = 0;
        // 複合部門コード
        private byte FSegCode1F = 0;
        // 複合セグメントコード
        private byte FHojCode1F = 0;
        // 複合第1補助コード
        private byte FHojCode2F = 0;
        // 複合第2補助コード
        private byte FKojCodeF = 0;
        // 複合工事コード
        private byte FKsyCodeF = 0;
        // 複合工種コード
        private byte NumValue1F = 0;
        // 番号１（請求書ＮＯ）
        private byte NumValue2F = 0;
        // 番号２（契約書ＮＯ）
        private byte BillNumF = 0;
        // 手形番号
        private byte BillCNumF = 0;
        // 手形管理番号
        private byte BillClassF = 0;
        // 手形種別
        private byte BillRankF = 0;
        // 手形信用度
        private byte DateIssueF = 0;
        // 手形振出日
        private byte DrawNameF = 0;
        // 手形振出人
        private byte ExgPlaceF = 0;
        // 支払場所
        private byte FinCodeF = 0;
        // 顛末コード
        private byte FinBankF = 0;
        // 顛末銀行コード
        private byte HndKmkCdF = 0;
        // 譲渡勘定科目コード
        private byte HndSubCdF = 0;
        // 譲渡細目科目コード
        private byte HndHojCdF = 0;
        // 譲渡先コード
        private byte ChgComCdF = 0;
        // 付替先会社コード
        private byte ChgBraCdF = 0;
        // 付替先本支店コード
        private byte ChgDCKbnF = 0;
        // 貸借区分
        private byte ChgKmkCdF = 0;
        // 相手科目コード
        private byte ChgSubCdF = 0;
        // 相手細目科目コード
        private byte ChgBmnCdF = 0;
        // 相手部門コード
        private byte ChgHojCd1F = 0;
        // 相手第１補助コード
        private byte ChgHojCd2F = 0;
        // 相手第２補助コード
        private byte ChgKojCdF = 0;
        // 相手工事コード
        private byte ChgKsyCdF = 0;
        // 相手工種コード
        private byte ChgDateF = 0;
        // 期日
        private byte ChgAitCdF = 0;
        // 本支店勘定コード
        private byte ChgTaxCdF = 0;
        // 消費税コード
        private byte ChgTaxRateF = 0;
        // 消費税率区分
        private byte ChgTypeCdF = 0;
        // 業種区分
        private byte ChgTaxSumF = 0;
        // 消費税額
        private byte ChgNum1F = 0;
        // 番号１（請求書ＮＯ）
        private byte ChgNum2F = 0;
        // 番号２（契約書ＮＯ）
        private byte InpSum2F = 0;
        // 数量 (外貨金額)
        private byte TaxSum2F = 0;
        // 単価 (外貨レート)
        private byte InpPoInt2F = 0;
        // 数量小数点桁数
        private byte TaxPoInt2F = 0;
        // 単価小数点桁数
        private byte FinDateF = 0;
        // 受取手形顛末処理日
        private byte SwkDicNoF = 0;
        // 仕訳辞書NO
        private byte SaddKbn1F = 0;
        private byte SaddKbn2F = 0;
        private byte SaddKbn3F = 0;
        // 借方番号
        private byte DNumValue1F = 0;
        // 番号１（請求書ＮＯ）
        private byte DNumValue2F = 0;
        // 番号２（契約書ＮＯ）
        private byte DNumValue3F = 0;
        // 番号３
        private byte DNumValue4F = 0;
        // 番号４
        private byte DNumValue5F = 0;
        // 番号５
        private byte DNumValue6F = 0;
        // 番号６
        private byte DNumValue7F = 0;
        // 番号７
        private byte DNumValue8F = 0;
        // 番号８
        private byte DNumValue9F = 0;
        // 番号９
        private byte DNumValue10F = 0;
        // 番号１０
        // 貸方番号
        private byte CNumValue1F = 0;
        // 番号１（請求書ＮＯ）
        private byte CNumValue2F = 0;
        // 番号２（契約書ＮＯ）
        private byte CNumValue3F = 0;
        // 番号３
        private byte CNumValue4F = 0;
        // 番号４
        private byte CNumValue5F = 0;
        // 番号５
        private byte CNumValue6F = 0;
        // 番号６
        private byte CNumValue7F = 0;
        // 番号７
        private byte CNumValue8F = 0;
        // 番号８
        private byte CNumValue9F = 0;
        // 番号９
        private byte CNumValue10F = 0;
        // 番号１０
        // 借方可変区分
        private byte DSubKbnF = 0;
        // 科目別補助科目コード区分
        private byte DBmnKbnF = 0;
        // 部門コード区分
        private byte DSeg1KbnF = 0;
        // セグメントコード１区分
        private byte DHojyo1KbnF = 0;
        // 第１補助コード区分
        private byte DHojyo2KbnF = 0;
        // 第２補助コード区分
        private byte DKojKbnF = 0;
        // 工事コード区分
        private byte DKsyKbnF = 0;
        // 工種コード区分
        // 貸方可変区分
        private byte CSubKbnF = 0;
        // 科目別補助科目コード区分
        private byte CBmnKbnF = 0;
        // 部門コード区分
        private byte CSeg1KbnF = 0;
        // セグメントコード１区分
        private byte CHojyo1KbnF = 0;
        // 第１補助コード区分
        private byte CHojyo2KbnF = 0;
        // 第２補助コード区分
        private byte CKojKbnF = 0;
        // 工事コード区分
        private byte CKsyKbnF = 0;
        // 工種コード区分
        private byte ChgSegCd1F = 0;
        // セグメントコード１
        private byte ChgTaxKbnF = 0;
        // 消費税売上／仕入区分
        private byte ChgExcptRateF = 0;
        // 例外税率区分
        private byte ChgCashCdF = 0;
        // 資金繰コード
        private byte ChgBillNumF = 0;
        // 手形番号
        private byte ChgBillCNumF = 0;
        // 手形管理番号
        private byte ExeCode00F = 0;
        // 特殊処理コード
        private byte ExeKbn00F = 0;
        // 修正／削除不可区分
        private byte ExeDTime00F = 0;
        // 実行日時
        private byte ErrMess00F = 0;
        // エラーメッセージ
        private byte ExeCode01F = 0;
        // 特殊処理コード
        private byte ExeKbn01F = 0;
        // 修正／削除不可区分
        private byte ExeDTime01F = 0;
        // 実行日時
        private byte ErrMess01F = 0;
        // エラーメッセージ
        private byte ExeCode03F = 0;
        // 特殊処理コード
        private byte ExeKbn03F = 0;
        // 修正／削除不可区分
        private byte ExeDTime03F = 0;
        // 実行日時
        private byte ErrMess03F = 0;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署入力受信
        // ----------------------------------------------------------
        private byte ExeCode04F = 0;
        // 特殊処理コード
        private byte ExeKbn04F = 0;
        // 修正／削除不可区分
        private byte ExeDTime04F = 0;
        // 実行日時
        private byte ErrMess04F = 0;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 部署承認／保留
        // ----------------------------------------------------------
        private byte ExeCode05F = 0;
        // 特殊処理コード
        private byte ExeKbn05F = 0;
        // 修正／削除不可区分
        private byte ExeDTime05F = 0;
        // 実行日時
        private byte ErrMess05F = 0;
        // エラーメッセージ
        private byte ExeCode11F = 0;
        // 特殊処理コード
        private byte ExeKbn11F = 0;
        // 修正／削除不可区分
        private byte ExeDTime11F = 0;
        // 実行日時
        private byte ErrMess11F = 0;
        // エラーメッセージ
        private byte ExeCode12F = 0;
        // 特殊処理コード
        private byte ExeKbn12F = 0;
        // 修正／削除不可区分
        private byte ExeDTime12F = 0;
        // 実行日時
        private byte ErrMess12F = 0;
        // エラーメッセージ
        private byte ExeCode13F = 0;
        // 特殊処理コード
        private byte ExeKbn13F = 0;
        // 修正／削除不可区分
        private byte ExeDTime13F = 0;
        // 実行日時
        private byte ErrMess13F = 0;
        // エラーメッセージ
        private byte ExeCode21F = 0;
        // 特殊処理コード
        private byte ExeKbn21F = 0;
        // 修正／削除不可区分
        private byte ExeDTime21F = 0;
        // 実行日時
        private byte ErrMess21F = 0;
        // エラーメッセージ
        private byte ExeCode22F = 0;
        // 特殊処理コード
        private byte ExeKbn22F = 0;
        // 修正／削除不可区分
        private byte ExeDTime22F = 0;
        // 実行日時
        private byte ErrMess22F = 0;
        // エラーメッセージ
        private byte ExeCode23F = 0;
        // 特殊処理コード
        private byte ExeKbn23F = 0;
        // 修正／削除不可区分
        private byte ExeDTime23F = 0;
        // 実行日時
        private byte ErrMess23F = 0;
        // エラーメッセージ
        private byte ExeCode24F = 0;
        // 特殊処理コード
        private byte ExeKbn24F = 0;
        // 修正／削除不可区分
        private byte ExeDTime24F = 0;
        // 実行日時
        private byte ErrMess24F = 0;
        // エラーメッセージ
        private byte ExeCode31F = 0;
        // 特殊処理コード
        private byte ExeKbn31F = 0;
        // 修正／削除不可区分
        private byte ExeDTime31F = 0;
        // 実行日時
        private byte ErrMess31F = 0;
        // エラーメッセージ
        private byte ExeCode32F = 0;
        // 特殊処理コード
        private byte ExeKbn32F = 0;
        // 修正／削除不可区分
        private byte ExeDTime32F = 0;
        // 実行日時
        private byte ErrMess32F = 0;
        // エラーメッセージ
        private byte ExeCode33F = 0;
        // 特殊処理コード
        private byte ExeKbn33F = 0;
        // 修正／削除不可区分
        private byte ExeDTime33F = 0;
        // 実行日時
        private byte ErrMess33F = 0;
        // エラーメッセージ
        private byte ExeCode34F = 0;
        // 特殊処理コード
        private byte ExeKbn34F = 0;
        // 修正／削除不可区分
        private byte ExeDTime34F = 0;
        // 実行日時
        private byte ErrMess34F = 0;
        // エラーメッセージ
        private byte ExeCode35F = 0;
        // 特殊処理コード
        private byte ExeKbn35F = 0;
        // 修正／削除不可区分
        private byte ExeDTime35F = 0;
        // 実行日時
        private byte ErrMess35F = 0;
        // エラーメッセージ
        private byte ExeCode41F = 0;
        // 特殊処理コード
        private byte ExeKbn41F = 0;
        // 修正／削除不可区分
        private byte ExeDTime41F = 0;
        // 実行日時
        private byte ErrMess41F = 0;
        // エラーメッセージ
        private byte ExeCode42F = 0;
        // 特殊処理コード
        private byte ExeKbn42F = 0;
        // 修正／削除不可区分
        private byte ExeDTime42F = 0;
        // 実行日時
        private byte ErrMess42F = 0;
        // エラーメッセージ
        private byte ExeCode43F = 0;
        // 特殊処理コード
        private byte ExeKbn43F = 0;
        // 修正／削除不可区分
        private byte ExeDTime43F = 0;
        // 実行日時
        private byte ErrMess43F = 0;
        // エラーメッセージ
        private byte ExeCode44F = 0;
        // 特殊処理コード
        private byte ExeKbn44F = 0;
        // 修正／削除不可区分
        private byte ExeDTime44F = 0;
        // 実行日時
        private byte ErrMess44F = 0;
        // エラーメッセージ
        // ----------------------------------------------------------
        // 仮払い精算済
        // ----------------------------------------------------------
        private byte ExeCode51F = 0;
        // 特殊処理コード
        private byte ExeKbn51F = 0;
        // 修正／削除不可区分
        private byte ExeDTime51F = 0;
        // 実行日時
        private byte ErrMess51F = 0;
        // エラーメッセージ
        private byte JNMonth21F = 0;
        // 自動仕訳内部月
        private byte JSwkInpKbn21F = 0;
        // 自動仕訳発生区分
        private byte JDSrchNo21F = 0;
        // 自動仕訳明細検索ＮＯ
        private byte JNMonth22F = 0;
        // 自動仕訳内部月
        private byte JSwkInpKbn22F = 0;
        // 自動仕訳発生区分
        private byte JDSrchNo22F = 0;
        // 自動仕訳明細検索ＮＯ
        private byte JNMonth23F = 0;
        // 自動仕訳内部月
        private byte JSwkInpKbn23F = 0;
        // 自動仕訳発生区分
        private byte JDSrchNo23F = 0;
        // 自動仕訳明細検索ＮＯ
        private byte JNMonth24F = 0;
        // 自動仕訳内部月
        private byte JSwkInpKbn24F = 0;
        // 自動仕訳発生区分
        private byte JDSrchNo24F = 0;
        // 自動仕訳明細検索ＮＯ
        private ArrayList RecList = null;
        // ******************************************************************************
        // System		: ACELINK Navi会計大将 VKシステム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310TrnSwkDetailB
        // Name		: Y.Sato
        // Create		: 2007/05/11
        // Comment		: 仕訳更新
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
#if !__VKZL310TrnSwkDetailB_INC__
#define __VKZL310TrnSwkDetailB_INC__
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TVKZL310Trn_SwkDetail()
        {
            FIncSize = 1;
            RecList = new ArrayList();
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2001/10/09
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TVKZL310Trn_SwkDetail()
        {
            Clear();
            //@ Unsupported property or method(C): 'Free'
            RecList.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: レコードをクリア
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Clear()
        {
            int Index;
            TVKZL310TrnDRec pRec;
            for (Index = 0; Index < RecList.Count; Index ++ )
            {
                pRec = RecList[Index];
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
            }
            RecList.Clear();
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを開始
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: iValue1	処理区分 0:追加 1:修正 2:削除
        // : iValue2	データセットフラグ（修正のときのみ） 0:変更なし 1:変更あり
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Add(int iValue1, int iValue2)
        {
            IUDKbn = iValue1;
            SwkDTKbn = iValue2;
            FNMonth = 0;
            FSwkInpKbn = 0;
            FDSrchNo = 0;
            FBDSrchNo = 0;
            FRowNo = 0;
            FHSrchNo = 0;
            FRDSrchNo = "";
            FDKmkCode = 0;
            FDSubCode = 0;
            FDBmnCode = "";
            FDSegCode1 = "";
            FDHojKbn1 = 0;
            FDHojCode1 = "";
            FDHojKbn2 = 0;
            FDHojCode2 = "";
            FDKojCode = "";
            FDKsyCode = "";
            FDBsBmnCd = "";
            FDBankCode = "";
            FDTaxKbn = 0;
            FDTypeCd = 0;
            FDTaxInc = 0;
            FCKmkCode = 0;
            FCSubCode = 0;
            FCBmnCode = "";
            FCSegCode1 = "";
            FCHojKbn1 = 0;
            FCHojCode1 = "";
            FCHojKbn2 = 0;
            FCHojCode2 = "";
            FCKojCode = "";
            FCKsyCode = "";
            FCBsBmnCd = "";
            FCBankCode = "";
            FCTaxKbn = 0;
            FCTypeCd = 0;
            FCTaxInc = 0;
            FCashKbn = 0;
            FCashCode = 0;
            FTaxCode = 0;
            FTaxRate = 0;
            FExcptRate = 0;
            FTaxInpKbn = 0;
            FInpSum = 0;
            FTaxSum = 0;
            FInpPoInt = 0;
            FTaxPoInt = 0;
            FLimitDate = 0;
            FTekiyo = "";
            FTekiCd1 = 0;
            FTekiCd2 = 0;
            FTekiCd3 = 0;
            FTekiCd4 = 0;
            FTekiCd5 = 0;
            FNonAcc = 0;
            FImgKbn = 0;
            FSwkInpKbn2 = 0;
            FFirstDate = 0;
            FFkSetKbn = 0;
            FBusCode = "";
            // 入力部署コード
            FBusDSrchNo = 0;
            // 入力部署検索NO
            FStaffKbn01 = 0;
            FStaffCode01 = 0;
            FStaffName01 = "";
            FUpdateTime01 = 0;
            FFusenKbn = 0;
            FFusenCmnt = "";
            FSwkAIKbn = 0;
            FFKmkCode = 0;
            FFSubCode = 0;
            FFBmnCode = "";
            FFSegCode1 = "";
            FFHojCode1 = "";
            FFHojCode2 = "";
            FFKojCode = "";
            FFKsyCode = "";
            FNumValue1 = "";
            FNumValue2 = "";
            FBillNum = "";
            FBillCNum = "";
            FBillClass = 0;
            FBillRank = "";
            FDateIssue = 0;
            FDrawName = "";
            FExgPlace = "";
            FFinCode = 0;
            FFinBank = "";
            FHndKmkCd = 0;
            FHndSubCd = 0;
            FHndHojCd = "";
            FChgComCd = 0;
            FChgBraCd = 0;
            FChgDCKbn = 0;
            FChgKmkCd = 0;
            FChgSubCd = 0;
            FChgBmnCd = "";
            FChgHojCd1 = "";
            FChgHojCd2 = "";
            FChgKojCd = "";
            FChgKsyCd = "";
            FChgDate = 0;
            FChgAitCd = 0;
            FChgTaxCd = 0;
            FChgTaxRate = 0;
            FChgTypeCd = 0;
            FChgTaxSum = 0;
            FChgNum1 = "";
            FChgNum2 = "";
            FInpSum2 = 0;
            FTaxSum2 = 0;
            FInpPoInt2 = 0;
            FTaxPoInt2 = 0;
            FFinDate = 0;
            FSwkDicNo = 0;
            FSaddKbn1 = 0;
            FSaddKbn2 = 0;
            FSaddKbn3 = 0;
            FDNumValue1 = "";
            FDNumValue2 = "";
            FDNumValue3 = "";
            FDNumValue4 = "";
            FDNumValue5 = "";
            FDNumValue6 = "";
            FDNumValue7 = "";
            FDNumValue8 = "";
            FDNumValue9 = "";
            FDNumValue10 = "";
            FCNumValue1 = "";
            FCNumValue2 = "";
            FCNumValue3 = "";
            FCNumValue4 = "";
            FCNumValue5 = "";
            FCNumValue6 = "";
            FCNumValue7 = "";
            FCNumValue8 = "";
            FCNumValue9 = "";
            FCNumValue10 = "";
            FDSubKbn = 0;
            FDBmnKbn = 0;
            FDSeg1Kbn = 0;
            FDHojyo1Kbn = 0;
            FDHojyo2Kbn = 0;
            FDKojKbn = 0;
            FDKsyKbn = 0;
            FCSubKbn = 0;
            FCBmnKbn = 0;
            FCSeg1Kbn = 0;
            FCHojyo1Kbn = 0;
            FCHojyo2Kbn = 0;
            FCKojKbn = 0;
            FCKsyKbn = 0;
            FChgSegCd1 = "";
            FChgTaxKbn = 0;
            FChgExcptRate = 0;
            FChgCashCd = 0;
            FChgBillNum = "";
            FChgBillCNum = "";
            FExeCode00 = 0;
            FExeKbn00 = 0;
            FExeDTime00 = 0;
            FErrMess00 = "";
            FExeCode01 = 0;
            FExeKbn01 = 0;
            FExeDTime01 = 0;
            FErrMess01 = "";
            FExeCode03 = 0;
            FExeKbn03 = 0;
            FExeDTime03 = 0;
            FErrMess03 = "";
            // ----------------------------------------------------------
            // 部署入力受信
            // ----------------------------------------------------------
            FExeCode04 = 0;
            FExeKbn04 = 0;
            FExeDTime04 = 0;
            FErrMess04 = "";
            // ----------------------------------------------------------
            // 部署承認／保留
            // ----------------------------------------------------------
            FExeCode05 = 0;
            FExeKbn05 = 0;
            FExeDTime05 = 0;
            FErrMess05 = "";
            FExeCode11 = 0;
            FExeKbn11 = 0;
            FExeDTime11 = 0;
            FErrMess11 = "";
            FExeCode12 = 0;
            FExeKbn12 = 0;
            FExeDTime12 = 0;
            FErrMess12 = "";
            FExeCode13 = 0;
            FExeKbn13 = 0;
            FExeDTime13 = 0;
            FErrMess13 = "";
            FExeCode21 = 0;
            FExeKbn21 = 0;
            FExeDTime21 = 0;
            FErrMess21 = "";
            FExeCode22 = 0;
            FExeKbn22 = 0;
            FExeDTime22 = 0;
            FErrMess22 = "";
            FExeCode23 = 0;
            FExeKbn23 = 0;
            FExeDTime23 = 0;
            FErrMess23 = "";
            FExeCode24 = 0;
            FExeKbn24 = 0;
            FExeDTime24 = 0;
            FErrMess24 = "";
            FExeCode31 = 0;
            FExeKbn31 = 0;
            FExeDTime31 = 0;
            FErrMess31 = "";
            FExeCode32 = 0;
            FExeKbn32 = 0;
            FExeDTime32 = 0;
            FErrMess32 = "";
            FExeCode33 = 0;
            FExeKbn33 = 0;
            FExeDTime33 = 0;
            FErrMess33 = "";
            FExeCode34 = 0;
            FExeKbn34 = 0;
            FExeDTime34 = 0;
            FErrMess34 = "";
            FExeCode35 = 0;
            FExeKbn35 = 0;
            FExeDTime35 = 0;
            FErrMess35 = "";
            FExeCode41 = 0;
            FExeKbn41 = 0;
            FExeDTime41 = 0;
            FErrMess41 = "";
            FExeCode42 = 0;
            FExeKbn42 = 0;
            FExeDTime42 = 0;
            FErrMess42 = "";
            FExeCode43 = 0;
            FExeKbn43 = 0;
            FExeDTime43 = 0;
            FErrMess43 = "";
            FExeCode44 = 0;
            FExeKbn44 = 0;
            FExeDTime44 = 0;
            FErrMess44 = "";
            // ----------------------------------------------------------
            // 仮払い精算済
            // ----------------------------------------------------------
            FExeCode51 = 0;
            FExeKbn51 = 0;
            FExeDTime51 = 0;
            FErrMess51 = "";
            FJNMonth21 = 0;
            FJSwkInpKbn21 = 0;
            FJDSrchNo21 = 0;
            FJNMonth22 = 0;
            FJSwkInpKbn22 = 0;
            FJDSrchNo22 = 0;
            FJNMonth23 = 0;
            FJSwkInpKbn23 = 0;
            FJDSrchNo23 = 0;
            FJNMonth24 = 0;
            FJSwkInpKbn24 = 0;
            FJDSrchNo24 = 0;
            NMonthF = 0;
            // 仕訳内部月
            SwkInpKbnF = 0;
            // 仕訳発生区分
            DSrchNoF = 0;
            // 明細検索ＮＯ
            BDSrchNoF = 0;
            // 明細検索ＮＯ(更新前) 内部処理でのみ使用
            RowNoF = 0;
            // 伝票明細ＮＯ
            HSrchNoF = 0;
            // 仕訳ヘッダ検索ＮＯ
            RDSrchNoF = 0;
            // 相手側明細検索ＮＯ
            DKmkCodeF = 0;
            // 科目コード
            DSubCodeF = 0;
            // 細目科目コード
            DBmnCodeF = 0;
            // 部門コード
            DSegCode1F = 0;
            // セグメントコード１
            DHojKbn1F = 0;
            // 第１補助区分
            DHojCode1F = 0;
            // 第１補助コード
            DHojKbn2F = 0;
            // 第２補助区分
            DHojCode2F = 0;
            // 第２補助コード
            DKojCodeF = 0;
            // 工事コード
            DKsyCodeF = 0;
            // 工種コード
            DBsBmnCdF = 0;
            // 仮受/仮払消費税部門コード
            DBankCodeF = 0;
            // 銀行コード
            DTaxKbnF = 0;
            // 消費税売上／仕入区分
            DTypeCdF = 0;
            // 業種コード
            DTaxIncF = 0;
            // 税抜／税込区分
            CKmkCodeF = 0;
            // 科目コード
            CSubCodeF = 0;
            // 細目科目コード
            CBmnCodeF = 0;
            // 部門コード
            CSegCode1F = 0;
            // セグメントコード１
            CHojKbn1F = 0;
            // 第１補助区分
            CHojCode1F = 0;
            // 第１補助コード
            CHojKbn2F = 0;
            // 第２補助区分
            CHojCode2F = 0;
            // 第２補助コード
            CKojCodeF = 0;
            // 工事コード
            CKsyCodeF = 0;
            // 工種コード
            CBsBmnCdF = 0;
            // 仮受/仮払消費税部門コード
            CBankCodeF = 0;
            // 銀行コード
            CTaxKbnF = 0;
            // 消費税売上／仕入区分
            CTypeCdF = 0;
            // 業種コード
            CTaxIncF = 0;
            // 税抜／税込区分
            CashKbnF = 0;
            // 資金繰入力区分
            CashCodeF = 0;
            // 資金繰コード
            TaxCodeF = 0;
            // 消費税コード
            TaxRateF = 0;
            // 消費税率区分
            ExcptRateF = 0;
            // 例外税率区分
            TaxInpKbnF = 0;
            // 外税同時入力区分
            InpSumF = 0;
            // 金額（入力金額）
            TaxSumF = 0;
            // 消費税額
            InpPoIntF = 0;
            // 金額小数点桁数
            TaxPoIntF = 0;
            // 消費税額小数点桁数
            LimitDateF = 0;
            // 期日
            TekiyoF = 0;
            // 摘要
            TekiCd1F = 0;
            // 固定摘要コード１
            TekiCd2F = 0;
            // 固定摘要コード２
            TekiCd3F = 0;
            // 固定摘要コード３
            TekiCd4F = 0;
            // 固定摘要コード４
            TekiCd5F = 0;
            // 固定摘要コード５
            NonAccF = 0;
            // 非会計データ区分
            ImgKbnF = 0;
            // ＯＣＲイメージ摘要区分
            SwkInpKbn2F = 0;
            // 仕訳発生区分(修正)
            FirstDateF = 0;
            // 初回入力日時
            FkSetKbnF = 0;
            // 複合セット処理区分
            BusCodeF = 0;
            // 入力部署コード
            BusDSrchNoF = 0;
            // 入力部署検索NO
            StaffKbn01F = 0;
            // 担当者区分
            StaffCode01F = 0;
            // 担当者コード
            StaffName01F = 0;
            // 担当者名
            UpdateTime01F = 0;
            // 入力／修正日時
            FusenKbnF = 0;
            // 付箋区分
            FusenCmntF = 0;
            // 付箋コメント
            SwkAIKbnF = 0;
            // 仕訳付加情報セットフラグ
            FKmkCodeF = 0;
            // 複合勘定科目コード
            FSubCodeF = 0;
            // 複合細目科目コード
            FBmnCodeF = 0;
            // 複合部門コード
            FSegCode1F = 0;
            // 複合セグメントコード
            FHojCode1F = 0;
            // 複合第1補助コード
            FHojCode2F = 0;
            // 複合第2補助コード
            FKojCodeF = 0;
            // 複合工事コード
            FKsyCodeF = 0;
            // 複合工種コード
            NumValue1F = 0;
            // 番号１（請求書ＮＯ）
            NumValue2F = 0;
            // 番号２（契約書ＮＯ）
            BillNumF = 0;
            // 手形番号
            BillCNumF = 0;
            // 手形管理番号
            BillClassF = 0;
            // 手形種別
            BillRankF = 0;
            // 手形信用度
            DateIssueF = 0;
            // 手形振出日
            DrawNameF = 0;
            // 手形振出人
            ExgPlaceF = 0;
            // 支払場所
            FinCodeF = 0;
            // 顛末コード
            FinBankF = 0;
            // 顛末銀行コード
            HndKmkCdF = 0;
            // 譲渡勘定科目コード
            HndSubCdF = 0;
            // 譲渡細目科目コード
            HndHojCdF = 0;
            // 譲渡先コード
            ChgComCdF = 0;
            // 付替先会社コード
            ChgBraCdF = 0;
            // 付替先本支店コード
            ChgDCKbnF = 0;
            // 貸借区分
            ChgKmkCdF = 0;
            // 相手科目コード
            ChgSubCdF = 0;
            // 相手細目科目コード
            ChgBmnCdF = 0;
            // 相手部門コード
            ChgHojCd1F = 0;
            // 相手第１補助コード
            ChgHojCd2F = 0;
            // 相手第２補助コード
            ChgKojCdF = 0;
            // 相手工事コード
            ChgKsyCdF = 0;
            // 相手工種コード
            ChgDateF = 0;
            // 期日
            ChgAitCdF = 0;
            // 本支店勘定コード
            ChgTaxCdF = 0;
            // 消費税コード
            ChgTaxRateF = 0;
            // 消費税率区分
            ChgTypeCdF = 0;
            // 業種区分
            ChgTaxSumF = 0;
            // 消費税額
            ChgNum1F = 0;
            // 番号１（請求書ＮＯ）
            ChgNum2F = 0;
            // 番号２（契約書ＮＯ）
            InpSum2F = 0;
            // 数量 (外貨金額)
            TaxSum2F = 0;
            // 単価 (外貨レート)
            InpPoInt2F = 0;
            // 数量小数点桁数
            TaxPoInt2F = 0;
            // 単価小数点桁数
            FinDateF = 0;
            // 受取手形顛末処理日
            SwkDicNoF = 0;
            // 仕訳辞書NO
            SaddKbn1F = 0;
            SaddKbn2F = 0;
            SaddKbn3F = 0;
            // 借方番号
            DNumValue1F = 0;
            // 番号１（請求書ＮＯ）
            DNumValue2F = 0;
            // 番号２（契約書ＮＯ）
            DNumValue3F = 0;
            // 番号３
            DNumValue4F = 0;
            // 番号４
            DNumValue5F = 0;
            // 番号５
            DNumValue6F = 0;
            // 番号６
            DNumValue7F = 0;
            // 番号７
            DNumValue8F = 0;
            // 番号８
            DNumValue9F = 0;
            // 番号９
            DNumValue10F = 0;
            // 番号１０
            // 貸方番号
            CNumValue1F = 0;
            // 番号１（請求書ＮＯ）
            CNumValue2F = 0;
            // 番号２（契約書ＮＯ）
            CNumValue3F = 0;
            // 番号３
            CNumValue4F = 0;
            // 番号４
            CNumValue5F = 0;
            // 番号５
            CNumValue6F = 0;
            // 番号６
            CNumValue7F = 0;
            // 番号７
            CNumValue8F = 0;
            // 番号８
            CNumValue9F = 0;
            // 番号９
            CNumValue10F = 0;
            // 番号１０
            // 借方可変区分
            DSubKbnF = 0;
            // 科目別補助科目コード区分
            DBmnKbnF = 0;
            // 部門コード区分
            DSeg1KbnF = 0;
            // セグメントコード１区分
            DHojyo1KbnF = 0;
            // 第１補助コード区分
            DHojyo2KbnF = 0;
            // 第２補助コード区分
            DKojKbnF = 0;
            // 工事コード区分
            DKsyKbnF = 0;
            // 工種コード区分
            // 貸方可変区分
            CSubKbnF = 0;
            // 科目別補助科目コード区分
            CBmnKbnF = 0;
            // 部門コード区分
            CSeg1KbnF = 0;
            // セグメントコード１区分
            CHojyo1KbnF = 0;
            // 第１補助コード区分
            CHojyo2KbnF = 0;
            // 第２補助コード区分
            CKojKbnF = 0;
            // 工事コード区分
            CKsyKbnF = 0;
            // 工種コード区分
            ChgSegCd1F = 0;
            // セグメントコード１
            ChgTaxKbnF = 0;
            // 消費税売上／仕入区分
            ChgExcptRateF = 0;
            // 例外税率区分
            ChgCashCdF = 0;
            // 資金繰コード
            ChgBillNumF = 0;
            // 手形番号
            ChgBillCNumF = 0;
            // 手形管理番号
            ExeCode00F = 0;
            // 特殊処理コード
            ExeKbn00F = 0;
            // 修正／削除不可区分
            ExeDTime00F = 0;
            // 実行日時
            ErrMess00F = 0;
            // エラーメッセージ
            ExeCode01F = 0;
            // 特殊処理コード
            ExeKbn01F = 0;
            // 修正／削除不可区分
            ExeDTime01F = 0;
            // 実行日時
            ErrMess01F = 0;
            // エラーメッセージ
            ExeCode03F = 0;
            // 特殊処理コード
            ExeKbn03F = 0;
            // 修正／削除不可区分
            ExeDTime03F = 0;
            // 実行日時
            ErrMess03F = 0;
            // エラーメッセージ
            // ----------------------------------------------------------
            // 部署入力受信
            // ----------------------------------------------------------
            ExeCode04F = 0;
            // 特殊処理コード
            ExeKbn04F = 0;
            // 修正／削除不可区分
            ExeDTime04F = 0;
            // 実行日時
            ErrMess04F = 0;
            // エラーメッセージ
            // ----------------------------------------------------------
            // 部署承認／保留
            // ----------------------------------------------------------
            ExeCode05F = 0;
            // 特殊処理コード
            ExeKbn05F = 0;
            // 修正／削除不可区分
            ExeDTime05F = 0;
            // 実行日時
            ErrMess05F = 0;
            // エラーメッセージ
            ExeCode11F = 0;
            // 特殊処理コード
            ExeKbn11F = 0;
            // 修正／削除不可区分
            ExeDTime11F = 0;
            // 実行日時
            ErrMess11F = 0;
            // エラーメッセージ
            ExeCode12F = 0;
            // 特殊処理コード
            ExeKbn12F = 0;
            // 修正／削除不可区分
            ExeDTime12F = 0;
            // 実行日時
            ErrMess12F = 0;
            // エラーメッセージ
            ExeCode13F = 0;
            // 特殊処理コード
            ExeKbn13F = 0;
            // 修正／削除不可区分
            ExeDTime13F = 0;
            // 実行日時
            ErrMess13F = 0;
            // エラーメッセージ
            ExeCode21F = 0;
            // 特殊処理コード
            ExeKbn21F = 0;
            // 修正／削除不可区分
            ExeDTime21F = 0;
            // 実行日時
            ErrMess21F = 0;
            // エラーメッセージ
            ExeCode22F = 0;
            // 特殊処理コード
            ExeKbn22F = 0;
            // 修正／削除不可区分
            ExeDTime22F = 0;
            // 実行日時
            ErrMess22F = 0;
            // エラーメッセージ
            ExeCode23F = 0;
            // 特殊処理コード
            ExeKbn23F = 0;
            // 修正／削除不可区分
            ExeDTime23F = 0;
            // 実行日時
            ErrMess23F = 0;
            // エラーメッセージ
            ExeCode24F = 0;
            // 特殊処理コード
            ExeKbn24F = 0;
            // 修正／削除不可区分
            ExeDTime24F = 0;
            // 実行日時
            ErrMess24F = 0;
            // エラーメッセージ
            ExeCode31F = 0;
            // 特殊処理コード
            ExeKbn31F = 0;
            // 修正／削除不可区分
            ExeDTime31F = 0;
            // 実行日時
            ErrMess31F = 0;
            // エラーメッセージ
            ExeCode32F = 0;
            // 特殊処理コード
            ExeKbn32F = 0;
            // 修正／削除不可区分
            ExeDTime32F = 0;
            // 実行日時
            ErrMess32F = 0;
            // エラーメッセージ
            ExeCode33F = 0;
            // 特殊処理コード
            ExeKbn33F = 0;
            // 修正／削除不可区分
            ExeDTime33F = 0;
            // 実行日時
            ErrMess33F = 0;
            // エラーメッセージ
            ExeCode34F = 0;
            ExeKbn34F = 0;
            ExeDTime34F = 0;
            ErrMess34F = 0;
            ExeCode35F = 0;
            // 特殊処理コード
            ExeKbn35F = 0;
            // 修正／削除不可区分
            ExeDTime35F = 0;
            // 実行日時
            ErrMess35F = 0;
            // エラーメッセージ
            ExeCode41F = 0;
            // 特殊処理コード
            ExeKbn41F = 0;
            // 修正／削除不可区分
            ExeDTime41F = 0;
            // 実行日時
            ErrMess41F = 0;
            // エラーメッセージ
            ExeCode42F = 0;
            // 特殊処理コード
            ExeKbn42F = 0;
            // 修正／削除不可区分
            ExeDTime42F = 0;
            // 実行日時
            ErrMess42F = 0;
            // エラーメッセージ
            ExeCode43F = 0;
            // 特殊処理コード
            ExeKbn43F = 0;
            // 修正／削除不可区分
            ExeDTime43F = 0;
            // 実行日時
            ErrMess43F = 0;
            // エラーメッセージ
            ExeCode44F = 0;
            // 特殊処理コード
            ExeKbn44F = 0;
            // 修正／削除不可区分
            ExeDTime44F = 0;
            // 実行日時
            ErrMess44F = 0;
            // エラーメッセージ
            // ----------------------------------------------------------
            // 仮払い精算済
            // ----------------------------------------------------------
            ExeCode51F = 0;
            ExeKbn51F = 0;
            ExeDTime51F = 0;
            ErrMess51F = 0;
            JNMonth21F = 0;
            // 自動仕訳内部月
            JSwkInpKbn21F = 0;
            // 自動仕訳発生区分
            JDSrchNo21F = 0;
            // 自動仕訳明細検索ＮＯ
            JNMonth22F = 0;
            // 自動仕訳内部月
            JSwkInpKbn22F = 0;
            // 自動仕訳発生区分
            JDSrchNo22F = 0;
            // 自動仕訳明細検索ＮＯ
            JNMonth23F = 0;
            // 自動仕訳内部月
            JSwkInpKbn23F = 0;
            // 自動仕訳発生区分
            JDSrchNo23F = 0;
            // 自動仕訳明細検索ＮＯ
            JNMonth24F = 0;
            // 自動仕訳内部月
            JSwkInpKbn24F = 0;
            // 自動仕訳発生区分
            JDSrchNo24F = 0;
            // 自動仕訳明細検索ＮＯ

        }

        public void Add(int iValue1)
        {
            Add(iValue1, 1);
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを終了
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Post()
        {
            TVKZL310TrnDRec pRec;
            if (RecList.Capacity <= RecList.Count)
            {
                RecList.Capacity = RecList.Capacity + FIncSize;
            }
            pRec = new TVKZL310TrnDRec();
            pRec.IUDKbn = IUDKbn;
            pRec.SwkDTKbn = SwkDTKbn;
            pRec.NMonth = FNMonth;
            pRec.NMonthF = NMonthF;
            pRec.SwkInpKbn = FSwkInpKbn;
            pRec.SwkInpKbnF = SwkInpKbnF;
            pRec.DSrchNo = FDSrchNo;
            pRec.DSrchNoF = DSrchNoF;
            pRec.BDSrchNo = FBDSrchNo;
            pRec.BDSrchNoF = BDSrchNoF;
            pRec.RowNo = FRowNo;
            pRec.RowNoF = RowNoF;
            pRec.HSrchNo = FHSrchNo;
            pRec.HSrchNoF = HSrchNoF;
            pRec.RDSrchNo = FRDSrchNo;
            pRec.RDSrchNoF = RDSrchNoF;
            pRec.DKmkCode = FDKmkCode;
            pRec.DKmkCodeF = DKmkCodeF;
            pRec.DSubCode = FDSubCode;
            pRec.DSubCodeF = DSubCodeF;
            pRec.DBmnCode = FDBmnCode;
            pRec.DBmnCodeF = DBmnCodeF;
            pRec.DSegCode1 = FDSegCode1;
            pRec.DSegCode1F = DSegCode1F;
            pRec.DHojKbn1 = FDHojKbn1;
            pRec.DHojKbn1F = DHojKbn1F;
            pRec.DHojCode1 = FDHojCode1;
            pRec.DHojCode1F = DHojCode1F;
            pRec.DHojKbn2 = FDHojKbn2;
            pRec.DHojKbn2F = DHojKbn2F;
            pRec.DHojCode2 = FDHojCode2;
            pRec.DHojCode2F = DHojCode2F;
            pRec.DKojCode = FDKojCode;
            pRec.DKojCodeF = DKojCodeF;
            pRec.DKsyCode = FDKsyCode;
            pRec.DKsyCodeF = DKsyCodeF;
            pRec.DBsBmnCd = FDBsBmnCd;
            pRec.DBsBmnCdF = DBsBmnCdF;
            pRec.DBankCode = FDBankCode;
            pRec.DBankCodeF = DBankCodeF;
            pRec.DTaxKbn = FDTaxKbn;
            pRec.DTaxKbnF = DTaxKbnF;
            pRec.DTypeCd = FDTypeCd;
            pRec.DTypeCdF = DTypeCdF;
            pRec.DTaxInc = FDTaxInc;
            pRec.DTaxIncF = DTaxIncF;
            pRec.CKmkCode = FCKmkCode;
            pRec.CKmkCodeF = CKmkCodeF;
            pRec.CSubCode = FCSubCode;
            pRec.CSubCodeF = CSubCodeF;
            pRec.CBmnCode = FCBmnCode;
            pRec.CBmnCodeF = CBmnCodeF;
            pRec.CSegCode1 = FCSegCode1;
            pRec.CSegCode1F = CSegCode1F;
            pRec.CHojKbn1 = FCHojKbn1;
            pRec.CHojKbn1F = CHojKbn1F;
            pRec.CHojCode1 = FCHojCode1;
            pRec.CHojCode1F = CHojCode1F;
            pRec.CHojKbn2 = FCHojKbn2;
            pRec.CHojKbn2F = CHojKbn2F;
            pRec.CHojCode2 = FCHojCode2;
            pRec.CHojCode2F = CHojCode2F;
            pRec.CKojCode = FCKojCode;
            pRec.CKojCodeF = CKojCodeF;
            pRec.CKsyCode = FCKsyCode;
            pRec.CKsyCodeF = CKsyCodeF;
            pRec.CBsBmnCd = FCBsBmnCd;
            pRec.CBsBmnCdF = CBsBmnCdF;
            pRec.CBankCode = FCBankCode;
            pRec.CBankCodeF = CBankCodeF;
            pRec.CTaxKbn = FCTaxKbn;
            pRec.CTaxKbnF = CTaxKbnF;
            pRec.CTypeCd = FCTypeCd;
            pRec.CTypeCdF = CTypeCdF;
            pRec.CTaxInc = FCTaxInc;
            pRec.CTaxIncF = CTaxIncF;
            pRec.CashKbn = FCashKbn;
            pRec.CashKbnF = CashKbnF;
            pRec.CashCode = FCashCode;
            pRec.CashCodeF = CashCodeF;
            pRec.TaxCode = FTaxCode;
            pRec.TaxCodeF = TaxCodeF;
            pRec.TaxRate = FTaxRate;
            pRec.TaxRateF = TaxRateF;
            pRec.ExcptRate = FExcptRate;
            pRec.ExcptRateF = ExcptRateF;
            pRec.TaxInpKbn = FTaxInpKbn;
            pRec.TaxInpKbnF = TaxInpKbnF;
            pRec.InpSum = FInpSum;
            pRec.InpSumF = InpSumF;
            pRec.TaxSum = FTaxSum;
            pRec.TaxSumF = TaxSumF;
            pRec.InpPoInt = FInpPoInt;
            pRec.InpPoIntF = InpPoIntF;
            pRec.TaxPoInt = FTaxPoInt;
            pRec.TaxPoIntF = TaxPoIntF;
            pRec.LimitDate = FLimitDate;
            pRec.LimitDateF = LimitDateF;
            pRec.Tekiyo = FTekiyo;
            pRec.TekiyoF = TekiyoF;
            pRec.TekiCd1 = FTekiCd1;
            pRec.TekiCd1F = TekiCd1F;
            pRec.TekiCd2 = FTekiCd2;
            pRec.TekiCd2F = TekiCd2F;
            pRec.TekiCd3 = FTekiCd3;
            pRec.TekiCd3F = TekiCd3F;
            pRec.TekiCd4 = FTekiCd4;
            pRec.TekiCd4F = TekiCd4F;
            pRec.TekiCd5 = FTekiCd5;
            pRec.TekiCd5F = TekiCd5F;
            pRec.NonAcc = FNonAcc;
            pRec.NonAccF = NonAccF;
            pRec.ImgKbn = FImgKbn;
            pRec.ImgKbnF = ImgKbnF;
            pRec.SwkInpKbn2 = FSwkInpKbn2;
            pRec.SwkInpKbn2F = SwkInpKbn2F;
            pRec.FirstDate = FFirstDate;
            pRec.FirstDateF = FirstDateF;
            pRec.FkSetKbn = FFkSetKbn;
            pRec.FkSetKbnF = FkSetKbnF;
            pRec.BusCode = FBusCode;
            pRec.BusCodeF = BusCodeF;
            pRec.BusDSrchNo = BusDSrchNo;
            pRec.BusDSrchNoF = BusDSrchNoF;
            pRec.StaffKbn01 = FStaffKbn01;
            pRec.StaffKbn01F = StaffKbn01F;
            pRec.StaffCode01 = FStaffCode01;
            pRec.StaffCode01F = StaffCode01F;
            pRec.StaffName01 = FStaffName01;
            pRec.StaffName01F = StaffName01F;
            pRec.UpdateTime01 = FUpdateTime01;
            pRec.UpdateTime01F = UpdateTime01F;
            pRec.FusenKbn = FFusenKbn;
            pRec.FusenKbnF = FusenKbnF;
            pRec.FusenCmnt = FFusenCmnt;
            pRec.FusenCmntF = FusenCmntF;
            pRec.SwkAIKbn = FSwkAIKbn;
            pRec.SwkAIKbnF = SwkAIKbnF;
            pRec.FKmkCode = FFKmkCode;
            pRec.FKmkCodeF = FKmkCodeF;
            pRec.FSubCode = FFSubCode;
            pRec.FSubCodeF = FSubCodeF;
            pRec.FBmnCode = FFBmnCode;
            pRec.FBmnCodeF = FBmnCodeF;
            pRec.FSegCode1 = FFSegCode1;
            pRec.FSegCode1F = FSegCode1F;
            pRec.FHojCode1 = FFHojCode1;
            pRec.FHojCode1F = FHojCode1F;
            pRec.FHojCode2 = FFHojCode2;
            pRec.FHojCode2F = FHojCode2F;
            pRec.FKojCode = FFKojCode;
            pRec.FKojCodeF = FKojCodeF;
            pRec.FKsyCode = FFKsyCode;
            pRec.FKsyCodeF = FKsyCodeF;
            pRec.NumValue1 = FNumValue1;
            pRec.NumValue1F = NumValue1F;
            pRec.NumValue2 = FNumValue2;
            pRec.NumValue2F = NumValue2F;
            pRec.BillNum = FBillNum;
            pRec.BillNumF = BillNumF;
            pRec.BillCNum = FBillCNum;
            pRec.BillCNumF = BillCNumF;
            pRec.BillClass = FBillClass;
            pRec.BillClassF = BillClassF;
            pRec.BillRank = FBillRank;
            pRec.BillRankF = BillRankF;
            pRec.DateIssue = FDateIssue;
            pRec.DateIssueF = DateIssueF;
            pRec.DrawName = FDrawName;
            pRec.DrawNameF = DrawNameF;
            pRec.ExgPlace = FExgPlace;
            pRec.ExgPlaceF = ExgPlaceF;
            pRec.FinCode = FFinCode;
            pRec.FinCodeF = FinCodeF;
            pRec.FinBank = FFinBank;
            pRec.FinBankF = FinBankF;
            pRec.HndKmkCd = FHndKmkCd;
            pRec.HndKmkCdF = HndKmkCdF;
            pRec.HndSubCd = FHndSubCd;
            pRec.HndSubCdF = HndSubCdF;
            pRec.HndHojCd = FHndHojCd;
            pRec.HndHojCdF = HndHojCdF;
            pRec.ChgComCd = FChgComCd;
            pRec.ChgComCdF = ChgComCdF;
            pRec.ChgBraCd = FChgBraCd;
            pRec.ChgBraCdF = ChgBraCdF;
            pRec.ChgDCKbn = FChgDCKbn;
            pRec.ChgDCKbnF = ChgDCKbnF;
            pRec.ChgKmkCd = FChgKmkCd;
            pRec.ChgKmkCdF = ChgKmkCdF;
            pRec.ChgSubCd = FChgSubCd;
            pRec.ChgSubCdF = ChgSubCdF;
            pRec.ChgBmnCd = FChgBmnCd;
            pRec.ChgBmnCdF = ChgBmnCdF;
            pRec.ChgHojCd1 = FChgHojCd1;
            pRec.ChgHojCd1F = ChgHojCd1F;
            pRec.ChgHojCd2 = FChgHojCd2;
            pRec.ChgHojCd2F = ChgHojCd2F;
            pRec.ChgKojCd = FChgKojCd;
            pRec.ChgKojCdF = ChgKojCdF;
            pRec.ChgKsyCd = FChgKsyCd;
            pRec.ChgKsyCdF = ChgKsyCdF;
            pRec.ChgDate = FChgDate;
            pRec.ChgDateF = ChgDateF;
            pRec.ChgAitCd = FChgAitCd;
            pRec.ChgAitCdF = ChgAitCdF;
            pRec.ChgTaxCd = FChgTaxCd;
            pRec.ChgTaxCdF = ChgTaxCdF;
            pRec.ChgTaxRate = FChgTaxRate;
            pRec.ChgTaxRateF = ChgTaxRateF;
            pRec.ChgTypeCd = FChgTypeCd;
            pRec.ChgTypeCdF = ChgTypeCdF;
            pRec.ChgTaxSum = FChgTaxSum;
            pRec.ChgTaxSumF = ChgTaxSumF;
            pRec.ChgNum1 = FChgNum1;
            pRec.ChgNum1F = ChgNum1F;
            pRec.ChgNum2 = FChgNum2;
            pRec.ChgNum2F = ChgNum2F;
            pRec.InpSum2 = FInpSum2;
            pRec.InpSum2F = InpSum2F;
            pRec.TaxSum2 = FTaxSum2;
            pRec.TaxSum2F = TaxSum2F;
            pRec.InpPoInt2 = FInpPoInt2;
            pRec.InpPoInt2F = InpPoInt2F;
            pRec.TaxPoInt2 = FTaxPoInt2;
            pRec.TaxPoInt2F = TaxPoInt2F;
            pRec.FinDate = FFinDate;
            pRec.FinDateF = FinDateF;
            pRec.SwkDicNo = FSwkDicNo;
            pRec.SwkDicNoF = SwkDicNoF;
            pRec.SaddKbn1 = FSaddKbn1;
            pRec.SaddKbn1F = SaddKbn1F;
            pRec.SaddKbn2 = FSaddKbn2;
            pRec.SaddKbn2F = SaddKbn2F;
            pRec.SaddKbn3 = FSaddKbn3;
            pRec.SaddKbn3F = SaddKbn3F;
            // 借方番号
            pRec.DNumValue1 = FDNumValue1;
            pRec.DNumValue1F = DNumValue1F;
            pRec.DNumValue2 = FDNumValue2;
            pRec.DNumValue2F = DNumValue2F;
            pRec.DNumValue3 = FDNumValue3;
            pRec.DNumValue3F = DNumValue3F;
            pRec.DNumValue4 = FDNumValue4;
            pRec.DNumValue4F = DNumValue4F;
            pRec.DNumValue5 = FDNumValue5;
            pRec.DNumValue5F = DNumValue5F;
            pRec.DNumValue6 = FDNumValue6;
            pRec.DNumValue6F = DNumValue6F;
            pRec.DNumValue7 = FDNumValue7;
            pRec.DNumValue7F = DNumValue7F;
            pRec.DNumValue8 = FDNumValue8;
            pRec.DNumValue8F = DNumValue8F;
            pRec.DNumValue9 = FDNumValue9;
            pRec.DNumValue9F = DNumValue9F;
            pRec.DNumValue10 = FDNumValue10;
            pRec.DNumValue10F = DNumValue10F;
            // 貸方番号
            pRec.CNumValue1 = FCNumValue1;
            pRec.CNumValue1F = CNumValue1F;
            pRec.CNumValue2 = FCNumValue2;
            pRec.CNumValue2F = CNumValue2F;
            pRec.CNumValue3 = FCNumValue3;
            pRec.CNumValue3F = CNumValue3F;
            pRec.CNumValue4 = FCNumValue4;
            pRec.CNumValue4F = CNumValue4F;
            pRec.CNumValue5 = FCNumValue5;
            pRec.CNumValue5F = CNumValue5F;
            pRec.CNumValue6 = FCNumValue6;
            pRec.CNumValue6F = CNumValue6F;
            pRec.CNumValue7 = FCNumValue7;
            pRec.CNumValue7F = CNumValue7F;
            pRec.CNumValue8 = FCNumValue8;
            pRec.CNumValue8F = CNumValue8F;
            pRec.CNumValue9 = FCNumValue9;
            pRec.CNumValue9F = CNumValue9F;
            pRec.CNumValue10 = FCNumValue10;
            pRec.CNumValue10F = CNumValue10F;
            // 借方可変区分
            pRec.DSubKbn = FDSubKbn;
            pRec.DSubKbnF = DSubKbnF;
            pRec.DBmnKbn = FDBmnKbn;
            pRec.DBmnKbnF = DBmnKbnF;
            pRec.DSeg1Kbn = FDSeg1Kbn;
            pRec.DSeg1KbnF = DSeg1KbnF;
            pRec.DHojyo1Kbn = FDHojyo1Kbn;
            pRec.DHojyo1KbnF = DHojyo1KbnF;
            pRec.DHojyo2Kbn = FDHojyo2Kbn;
            pRec.DHojyo2KbnF = DHojyo2KbnF;
            pRec.DKojKbn = FDKojKbn;
            pRec.DKojKbnF = DKojKbnF;
            pRec.DKsyKbn = FDKsyKbn;
            pRec.DKsyKbnF = DKsyKbnF;
            // 貸方可変区分
            pRec.CSubKbn = FCSubKbn;
            pRec.CSubKbnF = CSubKbnF;
            pRec.CBmnKbn = FCBmnKbn;
            pRec.CBmnKbnF = CBmnKbnF;
            pRec.CSeg1Kbn = FCSeg1Kbn;
            pRec.CSeg1KbnF = CSeg1KbnF;
            pRec.CHojyo1Kbn = FCHojyo1Kbn;
            pRec.CHojyo1KbnF = CHojyo1KbnF;
            pRec.CHojyo2Kbn = FCHojyo2Kbn;
            pRec.CHojyo2KbnF = CHojyo2KbnF;
            pRec.CKojKbn = FCKojKbn;
            pRec.CKojKbnF = CKojKbnF;
            pRec.CKsyKbn = FCKsyKbn;
            pRec.CKsyKbnF = CKsyKbnF;
            pRec.ChgSegCd1 = FChgSegCd1;
            pRec.ChgSegCd1F = ChgSegCd1F;
            pRec.ChgTaxKbn = FChgTaxKbn;
            pRec.ChgTaxKbnF = ChgTaxKbnF;
            pRec.ChgExcptRate = FChgExcptRate;
            pRec.ChgExcptRateF = ChgExcptRateF;
            pRec.ChgCashCd = FChgCashCd;
            pRec.ChgCashCdF = ChgCashCdF;
            pRec.ChgBillNum = FChgBillNum;
            pRec.ChgBillNumF = ChgBillNumF;
            pRec.ChgBillCNum = FChgBillCNum;
            pRec.ChgBillCNumF = ChgBillCNumF;
            pRec.ExeCode00 = FExeCode00;
            pRec.ExeCode00F = ExeCode00F;
            pRec.ExeKbn00 = FExeKbn00;
            pRec.ExeKbn00F = ExeKbn00F;
            pRec.ExeDTime00 = FExeDTime00;
            pRec.ExeDTime00F = ExeDTime00F;
            pRec.ErrMess00 = FErrMess00;
            pRec.ErrMess00F = ErrMess00F;
            pRec.ExeCode01 = FExeCode01;
            pRec.ExeCode01F = ExeCode01F;
            pRec.ExeKbn01 = FExeKbn01;
            pRec.ExeKbn01F = ExeKbn01F;
            pRec.ExeDTime01 = FExeDTime01;
            pRec.ExeDTime01F = ExeDTime01F;
            pRec.ErrMess01 = FErrMess01;
            pRec.ErrMess01F = ErrMess01F;
            pRec.ExeCode03 = FExeCode03;
            pRec.ExeCode03F = ExeCode03F;
            pRec.ExeKbn03 = FExeKbn03;
            pRec.ExeKbn03F = ExeKbn03F;
            pRec.ExeDTime03 = FExeDTime03;
            pRec.ExeDTime03F = ExeDTime03F;
            pRec.ErrMess03 = FErrMess03;
            pRec.ErrMess03F = ErrMess03F;
            // ----------------------------------------------------------
            // 部署入力受信
            // ----------------------------------------------------------
            pRec.ExeCode04 = FExeCode04;
            pRec.ExeCode04F = ExeCode04F;
            pRec.ExeKbn04 = FExeKbn04;
            pRec.ExeKbn04F = ExeKbn04F;
            pRec.ExeDTime04 = FExeDTime04;
            pRec.ExeDTime04F = ExeDTime04F;
            pRec.ErrMess04 = FErrMess04;
            pRec.ErrMess04F = ErrMess04F;
            // ----------------------------------------------------------
            // 部署承認／保留
            // ----------------------------------------------------------
            pRec.ExeCode05 = FExeCode05;
            pRec.ExeCode05F = ExeCode05F;
            pRec.ExeKbn05 = FExeKbn05;
            pRec.ExeKbn05F = ExeKbn05F;
            pRec.ExeDTime05 = FExeDTime05;
            pRec.ExeDTime05F = ExeDTime05F;
            pRec.ErrMess05 = FErrMess05;
            pRec.ErrMess05F = ErrMess05F;
            pRec.ExeCode11 = FExeCode11;
            pRec.ExeCode11F = ExeCode11F;
            pRec.ExeKbn11 = FExeKbn11;
            pRec.ExeKbn11F = ExeKbn11F;
            pRec.ExeDTime11 = FExeDTime11;
            pRec.ExeDTime11F = ExeDTime11F;
            pRec.ErrMess11 = FErrMess11;
            pRec.ErrMess11F = ErrMess11F;
            pRec.ExeCode12 = FExeCode12;
            pRec.ExeCode12F = ExeCode12F;
            pRec.ExeKbn12 = FExeKbn12;
            pRec.ExeKbn12F = ExeKbn12F;
            pRec.ExeDTime12 = FExeDTime12;
            pRec.ExeDTime12F = ExeDTime12F;
            pRec.ErrMess12 = FErrMess12;
            pRec.ErrMess12F = ErrMess12F;
            pRec.ExeCode13 = FExeCode13;
            pRec.ExeCode13F = ExeCode13F;
            pRec.ExeKbn13 = FExeKbn13;
            pRec.ExeKbn13F = ExeKbn13F;
            pRec.ExeDTime13 = FExeDTime13;
            pRec.ExeDTime13F = ExeDTime13F;
            pRec.ErrMess13 = FErrMess13;
            pRec.ErrMess13F = ErrMess13F;
            pRec.ExeCode21 = FExeCode21;
            pRec.ExeCode21F = ExeCode21F;
            pRec.ExeKbn21 = FExeKbn21;
            pRec.ExeKbn21F = ExeKbn21F;
            pRec.ExeDTime21 = FExeDTime21;
            pRec.ExeDTime21F = ExeDTime21F;
            pRec.ErrMess21 = FErrMess21;
            pRec.ErrMess21F = ErrMess21F;
            pRec.ExeCode22 = FExeCode22;
            pRec.ExeCode22F = ExeCode22F;
            pRec.ExeKbn22 = FExeKbn22;
            pRec.ExeKbn22F = ExeKbn22F;
            pRec.ExeDTime22 = FExeDTime22;
            pRec.ExeDTime22F = ExeDTime22F;
            pRec.ErrMess22 = FErrMess22;
            pRec.ErrMess22F = ErrMess22F;
            pRec.ExeCode23 = FExeCode23;
            pRec.ExeCode23F = ExeCode23F;
            pRec.ExeKbn23 = FExeKbn23;
            pRec.ExeKbn23F = ExeKbn23F;
            pRec.ExeDTime23 = FExeDTime23;
            pRec.ExeDTime23F = ExeDTime23F;
            pRec.ErrMess23 = FErrMess23;
            pRec.ErrMess23F = ErrMess23F;
            pRec.ExeCode24 = FExeCode24;
            pRec.ExeCode24F = ExeCode24F;
            pRec.ExeKbn24 = FExeKbn24;
            pRec.ExeKbn24F = ExeKbn24F;
            pRec.ExeDTime24 = FExeDTime24;
            pRec.ExeDTime24F = ExeDTime24F;
            pRec.ErrMess24 = FErrMess24;
            pRec.ErrMess24F = ErrMess24F;
            pRec.ExeCode31 = FExeCode31;
            pRec.ExeCode31F = ExeCode31F;
            pRec.ExeKbn31 = FExeKbn31;
            pRec.ExeKbn31F = ExeKbn31F;
            pRec.ExeDTime31 = FExeDTime31;
            pRec.ExeDTime31F = ExeDTime31F;
            pRec.ErrMess31 = FErrMess31;
            pRec.ErrMess31F = ErrMess31F;
            pRec.ExeCode32 = FExeCode32;
            pRec.ExeCode32F = ExeCode32F;
            pRec.ExeKbn32 = FExeKbn32;
            pRec.ExeKbn32F = ExeKbn32F;
            pRec.ExeDTime32 = FExeDTime32;
            pRec.ExeDTime32F = ExeDTime32F;
            pRec.ErrMess32 = FErrMess32;
            pRec.ErrMess32F = ErrMess32F;
            pRec.ExeCode33 = FExeCode33;
            pRec.ExeCode33F = ExeCode33F;
            pRec.ExeKbn33 = FExeKbn33;
            pRec.ExeKbn33F = ExeKbn33F;
            pRec.ExeDTime33 = FExeDTime33;
            pRec.ExeDTime33F = ExeDTime33F;
            pRec.ErrMess33 = FErrMess33;
            pRec.ErrMess33F = ErrMess33F;
            pRec.ExeCode34 = FExeCode34;
            pRec.ExeCode34F = ExeCode34F;
            pRec.ExeKbn34 = FExeKbn34;
            pRec.ExeKbn34F = ExeKbn34F;
            pRec.ExeDTime34 = FExeDTime34;
            pRec.ExeDTime34F = ExeDTime34F;
            pRec.ErrMess34 = FErrMess34;
            pRec.ErrMess34F = ErrMess34F;
            pRec.ExeCode35 = FExeCode35;
            pRec.ExeCode35F = ExeCode35F;
            pRec.ExeKbn35 = FExeKbn35;
            pRec.ExeKbn35F = ExeKbn35F;
            pRec.ExeDTime35 = FExeDTime35;
            pRec.ExeDTime35F = ExeDTime35F;
            pRec.ErrMess35 = FErrMess35;
            pRec.ErrMess35F = ErrMess35F;
            pRec.ExeCode41 = FExeCode41;
            pRec.ExeCode41F = ExeCode41F;
            pRec.ExeKbn41 = FExeKbn41;
            pRec.ExeKbn41F = ExeKbn41F;
            pRec.ExeDTime41 = FExeDTime41;
            pRec.ExeDTime41F = ExeDTime41F;
            pRec.ErrMess41 = FErrMess41;
            pRec.ErrMess41F = ErrMess41F;
            pRec.ExeCode42 = FExeCode42;
            pRec.ExeCode42F = ExeCode42F;
            pRec.ExeKbn42 = FExeKbn42;
            pRec.ExeKbn42F = ExeKbn42F;
            pRec.ExeDTime42 = FExeDTime42;
            pRec.ExeDTime42F = ExeDTime42F;
            pRec.ErrMess42 = FErrMess42;
            pRec.ErrMess42F = ErrMess42F;
            pRec.ExeCode43 = FExeCode43;
            pRec.ExeCode43F = ExeCode43F;
            pRec.ExeKbn43 = FExeKbn43;
            pRec.ExeKbn43F = ExeKbn43F;
            pRec.ExeDTime43 = FExeDTime43;
            pRec.ExeDTime43F = ExeDTime43F;
            pRec.ErrMess43 = FErrMess43;
            pRec.ErrMess43F = ErrMess43F;
            pRec.ExeCode44 = FExeCode44;
            pRec.ExeCode44F = ExeCode44F;
            pRec.ExeKbn44 = FExeKbn44;
            pRec.ExeKbn44F = ExeKbn44F;
            pRec.ExeDTime44 = FExeDTime44;
            pRec.ExeDTime44F = ExeDTime44F;
            pRec.ErrMess44 = FErrMess44;
            pRec.ErrMess44F = ErrMess44F;
            // ----------------------------------------------------------
            // 仮払い精算済
            // ----------------------------------------------------------
            pRec.ExeCode51 = FExeCode51;
            pRec.ExeCode51F = ExeCode51F;
            pRec.ExeKbn51 = FExeKbn51;
            pRec.ExeKbn51F = ExeKbn51F;
            pRec.ExeDTime51 = FExeDTime51;
            pRec.ExeDTime51F = ExeDTime51F;
            pRec.ErrMess51 = FErrMess51;
            pRec.ErrMess51F = ErrMess51F;
            pRec.JNMonth21 = FJNMonth21;
            pRec.JNMonth21F = JNMonth21F;
            pRec.JSwkInpKbn21 = FJSwkInpKbn21;
            pRec.JSwkInpKbn21F = JSwkInpKbn21F;
            pRec.JDSrchNo21 = FJDSrchNo21;
            pRec.JDSrchNo21F = JDSrchNo21F;
            pRec.JNMonth22 = FJNMonth22;
            pRec.JNMonth22F = JNMonth22F;
            pRec.JSwkInpKbn22 = FJSwkInpKbn22;
            pRec.JSwkInpKbn22F = JSwkInpKbn22F;
            pRec.JDSrchNo22 = FJDSrchNo22;
            pRec.JDSrchNo22F = JDSrchNo22F;
            pRec.JNMonth23 = FJNMonth23;
            pRec.JNMonth23F = JNMonth23F;
            pRec.JSwkInpKbn23 = FJSwkInpKbn23;
            pRec.JSwkInpKbn23F = JSwkInpKbn23F;
            pRec.JDSrchNo23 = FJDSrchNo23;
            pRec.JDSrchNo23F = JDSrchNo23F;
            pRec.JNMonth24 = FJNMonth24;
            pRec.JNMonth24F = JNMonth24F;
            pRec.JSwkInpKbn24 = FJSwkInpKbn24;
            pRec.JSwkInpKbn24F = JSwkInpKbn24F;
            pRec.JDSrchNo24 = FJDSrchNo24;
            pRec.JDSrchNo24F = JDSrchNo24F;
            RecList.Add(pRec);
        }

        // ******************************************************************************
        // Proccess	: レコードを取得
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: TVKZL310TrnDRecList
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public TVKZL310TrnDRec[] GetRecList()
        {
            TVKZL310TrnDRec[] result;
            int Index;
            result = new TVKZL310TrnDRec[RecList.Count];
            for (Index = 0; Index < RecList.Count; Index ++ )
            {
                result[Index] = ((RecList[Index]) as TVKZL310TrnDRec);
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: IncSizeをセット
        // Name		: Y.Sato
        // Date		: 2003/12/26
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetIncSize(int Value)
        {
            if ((FIncSize != Value) && (FIncSize > 0))
            {
                FIncSize = Value;
            }
        }

        // ******************************************************************************
        // Proccess	: フラグを立てる
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetNMonth(byte Value)
        {
            FNMonth = Value;
            NMonthF = 1;
        }

        private void SetSwkInpKbn(byte Value)
        {
            FSwkInpKbn = Value;
            SwkInpKbnF = 1;
        }

        private void SetDSrchNo(int Value)
        {
            FDSrchNo = Value;
            DSrchNoF = 1;
        }

        private void SetBDSrchNo(int Value)
        {
            FBDSrchNo = Value;
            BDSrchNoF = 1;
        }

        private void SetRowNo(int Value)
        {
            FRowNo = Value;
            RowNoF = 1;
        }

        private void SetHSrchNo(int Value)
        {
            FHSrchNo = Value;
            HSrchNoF = 1;
        }

        private void SetRDSrchNo(string Value)
        {
            FRDSrchNo = Value;
            RDSrchNoF = 1;
        }

        private void SetDKmkCode(int Value)
        {
            FDKmkCode = Value;
            DKmkCodeF = 1;
        }

        private void SetDSubCode(int Value)
        {
            FDSubCode = Value;
            DSubCodeF = 1;
        }

        private void SetDBmnCode(string Value)
        {
            FDBmnCode = Value;
            DBmnCodeF = 1;
        }

        private void SetDSegCode1(string Value)
        {
            FDSegCode1 = Value;
            DSegCode1F = 1;
        }

        private void SetDHojKbn1(byte Value)
        {
            FDHojKbn1 = Value;
            DHojKbn1F = 1;
        }

        private void SetDHojCode1(string Value)
        {
            FDHojCode1 = Value;
            DHojCode1F = 1;
        }

        private void SetDHojKbn2(byte Value)
        {
            FDHojKbn2 = Value;
            DHojKbn2F = 1;
        }

        private void SetDHojCode2(string Value)
        {
            FDHojCode2 = Value;
            DHojCode2F = 1;
        }

        private void SetDKojCode(string Value)
        {
            FDKojCode = Value;
            DKojCodeF = 1;
        }

        private void SetDKsyCode(string Value)
        {
            FDKsyCode = Value;
            DKsyCodeF = 1;
        }

        private void SetDBsBmnCd(string Value)
        {
            FDBsBmnCd = Value;
            DBsBmnCdF = 1;
        }

        private void SetDBankCode(string Value)
        {
            FDBankCode = Value;
            DBankCodeF = 1;
        }

        private void SetDTaxKbn(byte Value)
        {
            FDTaxKbn = Value;
            DTaxKbnF = 1;
        }

        private void SetDTypeCd(byte Value)
        {
            FDTypeCd = Value;
            DTypeCdF = 1;
        }

        private void SetDTaxInc(byte Value)
        {
            FDTaxInc = Value;
            DTaxIncF = 1;
        }

        private void SetCKmkCode(int Value)
        {
            FCKmkCode = Value;
            CKmkCodeF = 1;
        }

        private void SetCSubCode(int Value)
        {
            FCSubCode = Value;
            CSubCodeF = 1;
        }

        private void SetCBmnCode(string Value)
        {
            FCBmnCode = Value;
            CBmnCodeF = 1;
        }

        private void SetCSegCode1(string Value)
        {
            FCSegCode1 = Value;
            CSegCode1F = 1;
        }

        private void SetCHojKbn1(byte Value)
        {
            FCHojKbn1 = Value;
            CHojKbn1F = 1;
        }

        private void SetCHojCode1(string Value)
        {
            FCHojCode1 = Value;
            CHojCode1F = 1;
        }

        private void SetCHojKbn2(byte Value)
        {
            FCHojKbn2 = Value;
            CHojKbn2F = 1;
        }

        private void SetCHojCode2(string Value)
        {
            FCHojCode2 = Value;
            CHojCode2F = 1;
        }

        private void SetCKojCode(string Value)
        {
            FCKojCode = Value;
            CKojCodeF = 1;
        }

        private void SetCKsyCode(string Value)
        {
            FCKsyCode = Value;
            CKsyCodeF = 1;
        }

        private void SetCBsBmnCd(string Value)
        {
            FCBsBmnCd = Value;
            CBsBmnCdF = 1;
        }

        private void SetCBankCode(string Value)
        {
            FCBankCode = Value;
            CBankCodeF = 1;
        }

        private void SetCTaxKbn(byte Value)
        {
            FCTaxKbn = Value;
            CTaxKbnF = 1;
        }

        private void SetCTypeCd(byte Value)
        {
            FCTypeCd = Value;
            CTypeCdF = 1;
        }

        private void SetCTaxInc(byte Value)
        {
            FCTaxInc = Value;
            CTaxIncF = 1;
        }

        private void SetCashKbn(byte Value)
        {
            FCashKbn = Value;
            CashKbnF = 1;
        }

        private void SetCashCode(byte Value)
        {
            FCashCode = Value;
            CashCodeF = 1;
        }

        private void SetTaxCode(byte Value)
        {
            FTaxCode = Value;
            TaxCodeF = 1;
        }

        private void SetTaxRate(short Value)
        {
            FTaxRate = Value;
            TaxRateF = 1;
        }

        private void SetExcptRate(byte Value)
        {
            FExcptRate = Value;
            ExcptRateF = 1;
        }

        private void SetTaxInpKbn(byte Value)
        {
            FTaxInpKbn = Value;
            TaxInpKbnF = 1;
        }

        private void SetInpSum(decimal Value)
        {
            FInpSum = Value;
            InpSumF = 1;
        }

        private void SetTaxSum(decimal Value)
        {
            FTaxSum = Value;
            TaxSumF = 1;
        }

        private void SetInpPoInt(byte Value)
        {
            FInpPoInt = Value;
            InpPoIntF = 1;
        }

        private void SetTaxPoInt(byte Value)
        {
            FTaxPoInt = Value;
            TaxPoIntF = 1;
        }

        private void SetLimitDate(int Value)
        {
            FLimitDate = Value;
            LimitDateF = 1;
        }

        private void SetTekiyo(string Value)
        {
            FTekiyo = Value;
            TekiyoF = 1;
        }

        private void SetTekiCd1(int Value)
        {
            FTekiCd1 = Value;
            TekiCd1F = 1;
        }

        private void SetTekiCd2(int Value)
        {
            FTekiCd2 = Value;
            TekiCd2F = 1;
        }

        private void SetTekiCd3(int Value)
        {
            FTekiCd3 = Value;
            TekiCd3F = 1;
        }

        private void SetTekiCd4(int Value)
        {
            FTekiCd4 = Value;
            TekiCd4F = 1;
        }

        private void SetTekiCd5(int Value)
        {
            FTekiCd5 = Value;
            TekiCd5F = 1;
        }

        private void SetNonAcc(byte Value)
        {
            FNonAcc = Value;
            NonAccF = 1;
        }

        private void SetImgKbn(byte Value)
        {
            FImgKbn = Value;
            ImgKbnF = 1;
        }

        private void SetSwkInpKbn2(byte Value)
        {
            FSwkInpKbn2 = Value;
            SwkInpKbn2F = 1;
        }

        private void SetFirstDate(DateTime Value)
        {
            FFirstDate = Value;
            FirstDateF = 1;
        }

        private void SetFkSetKbn(byte Value)
        {
            FFkSetKbn = Value;
            FkSetKbnF = 1;
        }

        private void SetBusCode(string Value)
        {
            FBusCode = Value;
            BusCodeF = 1;
        }

        // 入力部署コード
        private void SetBusDSrchNo(int Value)
        {
            FBusDSrchNo = Value;
            BusDSrchNoF = 1;
        }

        // 入力部署検索NO
        private void SetStaffKbn01(byte Value)
        {
            FStaffKbn01 = Value;
            StaffKbn01F = 1;
        }

        private void SetStaffCode01(int Value)
        {
            FStaffCode01 = Value;
            StaffCode01F = 1;
        }

        private void SetStaffName01(string Value)
        {
            FStaffName01 = Value;
            StaffName01F = 1;
        }

        private void SetUpdateTime01(DateTime Value)
        {
            FUpdateTime01 = Value;
            UpdateTime01F = 1;
        }

        private void SetFusenKbn(byte Value)
        {
            FFusenKbn = Value;
            FusenKbnF = 1;
        }

        private void SetFusenCmnt(string Value)
        {
            FFusenCmnt = Value;
            FusenCmntF = 1;
        }

        private void SetSwkAIKbn(byte Value)
        {
            FSwkAIKbn = Value;
            SwkAIKbnF = 1;
        }

        private void SetFKmkCode(int Value)
        {
            FFKmkCode = Value;
            FKmkCodeF = 1;
        }

        private void SetFSubCode(int Value)
        {
            FFSubCode = Value;
            FSubCodeF = 1;
        }

        private void SetFBmnCode(string Value)
        {
            FFBmnCode = Value;
            FBmnCodeF = 1;
        }

        private void SetFSegCode1(string Value)
        {
            FFSegCode1 = Value;
            FSegCode1F = 1;
        }

        private void SetFHojCode1(string Value)
        {
            FFHojCode1 = Value;
            FHojCode1F = 1;
        }

        private void SetFHojCode2(string Value)
        {
            FFHojCode2 = Value;
            FHojCode2F = 1;
        }

        private void SetFKojCode(string Value)
        {
            FFKojCode = Value;
            FKojCodeF = 1;
        }

        private void SetFKsyCode(string Value)
        {
            FFKsyCode = Value;
            FKsyCodeF = 1;
        }

        private void SetNumValue1(string Value)
        {
            FNumValue1 = Value;
            NumValue1F = 1;
        }

        private void SetNumValue2(string Value)
        {
            FNumValue2 = Value;
            NumValue2F = 1;
        }

        private void SetBillNum(string Value)
        {
            FBillNum = Value;
            BillNumF = 1;
        }

        private void SetBillCNum(string Value)
        {
            FBillCNum = Value;
            BillCNumF = 1;
        }

        private void SetBillClass(byte Value)
        {
            FBillClass = Value;
            BillClassF = 1;
        }

        private void SetBillRank(string Value)
        {
            FBillRank = Value;
            BillRankF = 1;
        }

        private void SetDateIssue(int Value)
        {
            FDateIssue = Value;
            DateIssueF = 1;
        }

        private void SetDrawName(string Value)
        {
            FDrawName = Value;
            DrawNameF = 1;
        }

        private void SetExgPlace(string Value)
        {
            FExgPlace = Value;
            ExgPlaceF = 1;
        }

        private void SetFinCode(byte Value)
        {
            FFinCode = Value;
            FinCodeF = 1;
        }

        private void SetFinBank(string Value)
        {
            FFinBank = Value;
            FinBankF = 1;
        }

        private void SetHndKmkCd(int Value)
        {
            FHndKmkCd = Value;
            HndKmkCdF = 1;
        }

        private void SetHndSubCd(int Value)
        {
            FHndSubCd = Value;
            HndSubCdF = 1;
        }

        private void SetHndHojCd(string Value)
        {
            FHndHojCd = Value;
            HndHojCdF = 1;
        }

        private void SetChgComCd(int Value)
        {
            FChgComCd = Value;
            ChgComCdF = 1;
        }

        private void SetChgBraCd(short Value)
        {
            FChgBraCd = Value;
            ChgBraCdF = 1;
        }

        private void SetChgDCKbn(byte Value)
        {
            FChgDCKbn = Value;
            ChgDCKbnF = 1;
        }

        private void SetChgKmkCd(int Value)
        {
            FChgKmkCd = Value;
            ChgKmkCdF = 1;
        }

        private void SetChgSubCd(int Value)
        {
            FChgSubCd = Value;
            ChgSubCdF = 1;
        }

        private void SetChgBmnCd(string Value)
        {
            FChgBmnCd = Value;
            ChgBmnCdF = 1;
        }

        private void SetChgHojCd1(string Value)
        {
            FChgHojCd1 = Value;
            ChgHojCd1F = 1;
        }

        private void SetChgHojCd2(string Value)
        {
            FChgHojCd2 = Value;
            ChgHojCd2F = 1;
        }

        private void SetChgKojCd(string Value)
        {
            FChgKojCd = Value;
            ChgKojCdF = 1;
        }

        private void SetChgKsyCd(string Value)
        {
            FChgKsyCd = Value;
            ChgKsyCdF = 1;
        }

        private void SetChgDate(int Value)
        {
            FChgDate = Value;
            ChgDateF = 1;
        }

        private void SetChgAitCd(int Value)
        {
            FChgAitCd = Value;
            ChgAitCdF = 1;
        }

        private void SetChgTaxCd(byte Value)
        {
            FChgTaxCd = Value;
            ChgTaxCdF = 1;
        }

        private void SetChgTaxRate(short Value)
        {
            FChgTaxRate = Value;
            ChgTaxRateF = 1;
        }

        private void SetChgTypeCd(byte Value)
        {
            FChgTypeCd = Value;
            ChgTypeCdF = 1;
        }

        private void SetChgTaxSum(decimal Value)
        {
            FChgTaxSum = Value;
            ChgTaxSumF = 1;
        }

        private void SetChgNum1(string Value)
        {
            FChgNum1 = Value;
            ChgNum1F = 1;
        }

        private void SetChgNum2(string Value)
        {
            FChgNum2 = Value;
            ChgNum2F = 1;
        }

        private void SetInpSum2(decimal Value)
        {
            FInpSum2 = Value;
            InpSum2F = 1;
        }

        private void SetTaxSum2(decimal Value)
        {
            FTaxSum2 = Value;
            TaxSum2F = 1;
        }

        private void SetInpPoInt2(byte Value)
        {
            FInpPoInt2 = Value;
            InpPoInt2F = 1;
        }

        private void SetTaxPoInt2(byte Value)
        {
            FTaxPoInt2 = Value;
            TaxPoInt2F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/02/15
        // ******************************************************************************
        private void SetFinDate(int Value)
        {
            FFinDate = Value;
            FinDateF = 1;
        }

        private void SetSwkDicNo(int Value)
        {
            FSwkDicNo = Value;
            SwkDicNoF = 1;
        }

        private void SetSaddKbn1(byte Value)
        {
            FSaddKbn1 = Value;
            SaddKbn1F = 1;
        }

        private void SetSaddKbn2(short Value)
        {
            FSaddKbn2 = Value;
            SaddKbn2F = 1;
        }

        private void SetSaddKbn3(short Value)
        {
            FSaddKbn3 = Value;
            SaddKbn3F = 1;
        }

        private void SetDNumValue1(string Value)
        {
            FDNumValue1 = Value;
            DNumValue1F = 1;
        }

        private void SetDNumValue2(string Value)
        {
            FDNumValue2 = Value;
            DNumValue2F = 1;
        }

        private void SetDNumValue3(string Value)
        {
            FDNumValue3 = Value;
            DNumValue3F = 1;
        }

        private void SetDNumValue4(string Value)
        {
            FDNumValue4 = Value;
            DNumValue4F = 1;
        }

        private void SetDNumValue5(string Value)
        {
            FDNumValue5 = Value;
            DNumValue5F = 1;
        }

        private void SetDNumValue6(string Value)
        {
            FDNumValue6 = Value;
            DNumValue6F = 1;
        }

        private void SetDNumValue7(string Value)
        {
            FDNumValue7 = Value;
            DNumValue7F = 1;
        }

        private void SetDNumValue8(string Value)
        {
            FDNumValue8 = Value;
            DNumValue8F = 1;
        }

        private void SetDNumValue9(string Value)
        {
            FDNumValue9 = Value;
            DNumValue9F = 1;
        }

        private void SetDNumValue10(string Value)
        {
            FDNumValue10 = Value;
            DNumValue10F = 1;
        }

        private void SetCNumValue1(string Value)
        {
            FCNumValue1 = Value;
            CNumValue1F = 1;
        }

        private void SetCNumValue2(string Value)
        {
            FCNumValue2 = Value;
            CNumValue2F = 1;
        }

        private void SetCNumValue3(string Value)
        {
            FCNumValue3 = Value;
            CNumValue3F = 1;
        }

        private void SetCNumValue4(string Value)
        {
            FCNumValue4 = Value;
            CNumValue4F = 1;
        }

        private void SetCNumValue5(string Value)
        {
            FCNumValue5 = Value;
            CNumValue5F = 1;
        }

        private void SetCNumValue6(string Value)
        {
            FCNumValue6 = Value;
            CNumValue6F = 1;
        }

        private void SetCNumValue7(string Value)
        {
            FCNumValue7 = Value;
            CNumValue7F = 1;
        }

        private void SetCNumValue8(string Value)
        {
            FCNumValue8 = Value;
            CNumValue8F = 1;
        }

        private void SetCNumValue9(string Value)
        {
            FCNumValue9 = Value;
            CNumValue9F = 1;
        }

        private void SetCNumValue10(string Value)
        {
            FCNumValue10 = Value;
            CNumValue10F = 1;
        }

        private void SetDSubKbn(byte Value)
        {
            FDSubKbn = Value;
            DSubKbnF = 1;
        }

        private void SetDBmnKbn(byte Value)
        {
            FDBmnKbn = Value;
            DBmnKbnF = 1;
        }

        private void SetDSeg1Kbn(byte Value)
        {
            FDSeg1Kbn = Value;
            DSeg1KbnF = 1;
        }

        private void SetDHojyo1Kbn(byte Value)
        {
            FDHojyo1Kbn = Value;
            DHojyo1KbnF = 1;
        }

        private void SetDHojyo2Kbn(byte Value)
        {
            FDHojyo2Kbn = Value;
            DHojyo2KbnF = 1;
        }

        private void SetDKojKbn(byte Value)
        {
            FDKojKbn = Value;
            DKojKbnF = 1;
        }

        private void SetDKsyKbn(byte Value)
        {
            FDKsyKbn = Value;
            DKsyKbnF = 1;
        }

        private void SetCSubKbn(byte Value)
        {
            FCSubKbn = Value;
            CSubKbnF = 1;
        }

        private void SetCBmnKbn(byte Value)
        {
            FCBmnKbn = Value;
            CBmnKbnF = 1;
        }

        private void SetCSeg1Kbn(byte Value)
        {
            FCSeg1Kbn = Value;
            CSeg1KbnF = 1;
        }

        private void SetCHojyo1Kbn(byte Value)
        {
            FCHojyo1Kbn = Value;
            CHojyo1KbnF = 1;
        }

        private void SetCHojyo2Kbn(byte Value)
        {
            FCHojyo2Kbn = Value;
            CHojyo2KbnF = 1;
        }

        private void SetCKojKbn(byte Value)
        {
            FCKojKbn = Value;
            CKojKbnF = 1;
        }

        private void SetCKsyKbn(byte Value)
        {
            FCKsyKbn = Value;
            CKsyKbnF = 1;
        }

        private void SetChgSegCd1(string Value)
        {
            FChgSegCd1 = Value;
            ChgSegCd1F = 1;
        }

        private void SetChgTaxKbn(int Value)
        {
            FChgTaxKbn = Value;
            ChgTaxKbnF = 1;
        }

        private void SetChgExcptRate(int Value)
        {
            FChgExcptRate = Value;
            ChgExcptRateF = 1;
        }

        private void SetChgCashCd(int Value)
        {
            FChgCashCd = Value;
            ChgCashCdF = 1;
        }

        private void SetChgBillNum(string Value)
        {
            FChgBillNum = Value;
            ChgBillNumF = 1;
        }

        private void SetChgBillCNum(string Value)
        {
            FChgBillCNum = Value;
            ChgBillCNumF = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetExeCode00(byte Value)
        {
            FExeCode00 = Value;
            ExeCode00F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetExeKbn00(byte Value)
        {
            FExeKbn00 = Value;
            ExeKbn00F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetExeDTime00(DateTime Value)
        {
            FExeDTime00 = Value;
            ExeDTime00F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess00(string Value)
        {
            FErrMess00 = Value;
            ErrMess00F = 1;
        }

        private void SetExeCode01(byte Value)
        {
            FExeCode01 = Value;
            ExeCode01F = 1;
        }

        private void SetExeKbn01(byte Value)
        {
            FExeKbn01 = Value;
            ExeKbn01F = 1;
        }

        private void SetExeDTime01(DateTime Value)
        {
            FExeDTime01 = Value;
            ExeDTime01F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess01(string Value)
        {
            FErrMess01 = Value;
            ErrMess01F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/04/03
        // ******************************************************************************
        private void SetExeCode03(byte Value)
        {
            FExeCode03 = Value;
            ExeCode03F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/04/03
        // ******************************************************************************
        private void SetExeKbn03(byte Value)
        {
            FExeKbn03 = Value;
            ExeKbn03F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/04/03
        // ******************************************************************************
        private void SetExeDTime03(DateTime Value)
        {
            FExeDTime03 = Value;
            ExeDTime03F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/04/03
        // ******************************************************************************
        private void SetErrMess03(string Value)
        {
            FErrMess03 = Value;
            ErrMess03F = 1;
        }

        // ----------------------------------------------------------
        // 部署入力受信
        // ----------------------------------------------------------
        // ----------------------------------------------------------
        // 部署入力受信
        // ----------------------------------------------------------
        private void SetExeCode04(byte Value)
        {
            FExeCode04 = Value;
            ExeCode04F = 1;
        }

        private void SetExeKbn04(byte Value)
        {
            FExeKbn04 = Value;
            ExeKbn04F = 1;
        }

        private void SetExeDTime04(DateTime Value)
        {
            FExeDTime04 = Value;
            ExeDTime04F = 1;
        }

        private void SetErrMess04(string Value)
        {
            FErrMess04 = Value;
            ErrMess04F = 1;
        }

        // ----------------------------------------------------------
        // 部署承認／保留
        // ----------------------------------------------------------
        // ----------------------------------------------------------
        // 部署承認／保留
        // ----------------------------------------------------------
        private void SetExeCode05(byte Value)
        {
            FExeCode05 = Value;
            ExeCode05F = 1;
        }

        private void SetExeKbn05(byte Value)
        {
            FExeKbn05 = Value;
            ExeKbn05F = 1;
        }

        private void SetExeDTime05(DateTime Value)
        {
            FExeDTime05 = Value;
            ExeDTime05F = 1;
        }

        private void SetErrMess05(string Value)
        {
            FErrMess05 = Value;
            ErrMess05F = 1;
        }

        private void SetExeCode11(byte Value)
        {
            FExeCode11 = Value;
            ExeCode11F = 1;
        }

        private void SetExeKbn11(byte Value)
        {
            FExeKbn11 = Value;
            ExeKbn11F = 1;
        }

        private void SetExeDTime11(DateTime Value)
        {
            FExeDTime11 = Value;
            ExeDTime11F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess11(string Value)
        {
            FErrMess11 = Value;
            ErrMess11F = 1;
        }

        private void SetExeCode12(byte Value)
        {
            FExeCode12 = Value;
            ExeCode12F = 1;
        }

        private void SetExeKbn12(byte Value)
        {
            FExeKbn12 = Value;
            ExeKbn12F = 1;
        }

        private void SetExeDTime12(DateTime Value)
        {
            FExeDTime12 = Value;
            ExeDTime12F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess12(string Value)
        {
            FErrMess12 = Value;
            ErrMess12F = 1;
        }

        private void SetExeCode13(byte Value)
        {
            FExeCode13 = Value;
            ExeCode13F = 1;
        }

        private void SetExeKbn13(byte Value)
        {
            FExeKbn13 = Value;
            ExeKbn13F = 1;
        }

        private void SetExeDTime13(DateTime Value)
        {
            FExeDTime13 = Value;
            ExeDTime13F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess13(string Value)
        {
            FErrMess13 = Value;
            ErrMess13F = 1;
        }

        private void SetExeCode21(byte Value)
        {
            FExeCode21 = Value;
            ExeCode21F = 1;
        }

        private void SetExeKbn21(byte Value)
        {
            FExeKbn21 = Value;
            ExeKbn21F = 1;
        }

        private void SetExeDTime21(DateTime Value)
        {
            FExeDTime21 = Value;
            ExeDTime21F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess21(string Value)
        {
            FErrMess21 = Value;
            ErrMess21F = 1;
        }

        private void SetExeCode22(byte Value)
        {
            FExeCode22 = Value;
            ExeCode22F = 1;
        }

        private void SetExeKbn22(byte Value)
        {
            FExeKbn22 = Value;
            ExeKbn22F = 1;
        }

        private void SetExeDTime22(DateTime Value)
        {
            FExeDTime22 = Value;
            ExeDTime22F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess22(string Value)
        {
            FErrMess22 = Value;
            ErrMess22F = 1;
        }

        private void SetExeCode23(byte Value)
        {
            FExeCode23 = Value;
            ExeCode23F = 1;
        }

        private void SetExeKbn23(byte Value)
        {
            FExeKbn23 = Value;
            ExeKbn23F = 1;
        }

        private void SetExeDTime23(DateTime Value)
        {
            FExeDTime23 = Value;
            ExeDTime23F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess23(string Value)
        {
            FErrMess23 = Value;
            ErrMess23F = 1;
        }

        private void SetExeCode24(byte Value)
        {
            FExeCode24 = Value;
            ExeCode24F = 1;
        }

        private void SetExeKbn24(byte Value)
        {
            FExeKbn24 = Value;
            ExeKbn24F = 1;
        }

        private void SetExeDTime24(DateTime Value)
        {
            FExeDTime24 = Value;
            ExeDTime24F = 1;
        }

        private void SetErrMess24(string Value)
        {
            FErrMess24 = Value;
            ErrMess24F = 1;
        }

        private void SetExeCode31(byte Value)
        {
            FExeCode31 = Value;
            ExeCode31F = 1;
        }

        private void SetExeKbn31(byte Value)
        {
            FExeKbn31 = Value;
            ExeKbn31F = 1;
        }

        private void SetExeDTime31(DateTime Value)
        {
            FExeDTime31 = Value;
            ExeDTime31F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess31(string Value)
        {
            FErrMess31 = Value;
            ErrMess31F = 1;
        }

        private void SetExeCode32(byte Value)
        {
            FExeCode32 = Value;
            ExeCode32F = 1;
        }

        private void SetExeKbn32(byte Value)
        {
            FExeKbn32 = Value;
            ExeKbn32F = 1;
        }

        private void SetExeDTime32(DateTime Value)
        {
            FExeDTime32 = Value;
            ExeDTime32F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess32(string Value)
        {
            FErrMess32 = Value;
            ErrMess32F = 1;
        }

        private void SetExeCode33(byte Value)
        {
            FExeCode33 = Value;
            ExeCode33F = 1;
        }

        private void SetExeKbn33(byte Value)
        {
            FExeKbn33 = Value;
            ExeKbn33F = 1;
        }

        private void SetExeDTime33(DateTime Value)
        {
            FExeDTime33 = Value;
            ExeDTime33F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess33(string Value)
        {
            FErrMess33 = Value;
            ErrMess33F = 1;
        }

        private void SetExeCode34(byte Value)
        {
            FExeCode34 = Value;
            ExeCode34F = 1;
        }

        private void SetExeKbn34(byte Value)
        {
            FExeKbn34 = Value;
            ExeKbn34F = 1;
        }

        private void SetExeDTime34(DateTime Value)
        {
            FExeDTime34 = Value;
            ExeDTime34F = 1;
        }

        private void SetErrMess34(string Value)
        {
            FErrMess34 = Value;
            ErrMess34F = 1;
        }

        private void SetExeCode35(byte Value)
        {
            FExeCode35 = Value;
            ExeCode35F = 1;
        }

        private void SetExeKbn35(byte Value)
        {
            FExeKbn35 = Value;
            ExeKbn35F = 1;
        }

        private void SetExeDTime35(DateTime Value)
        {
            FExeDTime35 = Value;
            ExeDTime35F = 1;
        }

        private void SetErrMess35(string Value)
        {
            FErrMess35 = Value;
            ErrMess35F = 1;
        }

        private void SetExeCode41(byte Value)
        {
            FExeCode41 = Value;
            ExeCode41F = 1;
        }

        private void SetExeKbn41(byte Value)
        {
            FExeKbn41 = Value;
            ExeKbn41F = 1;
        }

        private void SetExeDTime41(DateTime Value)
        {
            FExeDTime41 = Value;
            ExeDTime41F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess41(string Value)
        {
            FErrMess41 = Value;
            ErrMess41F = 1;
        }

        private void SetExeCode42(byte Value)
        {
            FExeCode42 = Value;
            ExeCode42F = 1;
        }

        private void SetExeKbn42(byte Value)
        {
            FExeKbn42 = Value;
            ExeKbn42F = 1;
        }

        private void SetExeDTime42(DateTime Value)
        {
            FExeDTime42 = Value;
            ExeDTime42F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess42(string Value)
        {
            FErrMess42 = Value;
            ErrMess42F = 1;
        }

        private void SetExeCode43(byte Value)
        {
            FExeCode43 = Value;
            ExeCode43F = 1;
        }

        private void SetExeKbn43(byte Value)
        {
            FExeKbn43 = Value;
            ExeKbn43F = 1;
        }

        private void SetExeDTime43(DateTime Value)
        {
            FExeDTime43 = Value;
            ExeDTime43F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess43(string Value)
        {
            FErrMess43 = Value;
            ErrMess43F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetExeCode44(byte Value)
        {
            FExeCode44 = Value;
            ExeCode44F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetExeKbn44(byte Value)
        {
            FExeKbn44 = Value;
            ExeKbn44F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetExeDTime44(DateTime Value)
        {
            FExeDTime44 = Value;
            ExeDTime44F = 1;
        }

        // ******************************************************************************
        // Date		: 2002/03/25
        // ******************************************************************************
        private void SetErrMess44(string Value)
        {
            FErrMess44 = Value;
            ErrMess44F = 1;
        }

        // ----------------------------------------------------------
        // 仮払い精算済
        // ----------------------------------------------------------
        // ----------------------------------------------------------
        // 仮払い精算済
        // ----------------------------------------------------------
        private void SetExeCode51(byte Value)
        {
            FExeCode51 = Value;
            ExeCode51F = 1;
        }

        private void SetExeKbn51(byte Value)
        {
            FExeKbn51 = Value;
            ExeKbn51F = 1;
        }

        private void SetExeDTime51(DateTime Value)
        {
            FExeDTime51 = Value;
            ExeDTime51F = 1;
        }

        private void SetErrMess51(string Value)
        {
            FErrMess51 = Value;
            ErrMess51F = 1;
        }

        private void SetJNMonth21(byte Value)
        {
            FJNMonth21 = Value;
            JNMonth21F = 1;
        }

        private void SetJSwkInpKbn21(byte Value)
        {
            FJSwkInpKbn21 = Value;
            JSwkInpKbn21F = 1;
        }

        private void SetJDSrchNo21(int Value)
        {
            FJDSrchNo21 = Value;
            JDSrchNo21F = 1;
        }

        private void SetJNMonth22(byte Value)
        {
            FJNMonth22 = Value;
            JNMonth22F = 1;
        }

        private void SetJSwkInpKbn22(byte Value)
        {
            FJSwkInpKbn22 = Value;
            JSwkInpKbn22F = 1;
        }

        private void SetJDSrchNo22(int Value)
        {
            FJDSrchNo22 = Value;
            JDSrchNo22F = 1;
        }

        private void SetJNMonth23(byte Value)
        {
            FJNMonth23 = Value;
            JNMonth23F = 1;
        }

        private void SetJSwkInpKbn23(byte Value)
        {
            FJSwkInpKbn23 = Value;
            JSwkInpKbn23F = 1;
        }

        private void SetJDSrchNo23(int Value)
        {
            FJDSrchNo23 = Value;
            JDSrchNo23F = 1;
        }

        private void SetJNMonth24(byte Value)
        {
            FJNMonth24 = Value;
            JNMonth24F = 1;
        }

        private void SetJSwkInpKbn24(byte Value)
        {
            FJSwkInpKbn24 = Value;
            JSwkInpKbn24F = 1;
        }

        private void SetJDSrchNo24(int Value)
        {
            FJDSrchNo24 = Value;
            JDSrchNo24F = 1;
        }

#endif
    } // end TVKZL310Trn_SwkDetail

    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310TrnSwkImgTekiH
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // ******************************************************************************
    public class TVKZL310Trn_SwkImgTeki
    {
        public int IncSize
        {
          get {
            return FIncSize;
          }
          set {
            SetIncSize(value);
          }
        }
        public byte NMonth
        {
          get {
            return FNMonth;
          }
          set {
            SetNMonth(value);
          }
        }
        // 仕訳内部月
        public int DSrchNo
        {
          get {
            return FDSrchNo;
          }
          set {
            SetDSrchNo(value);
          }
        }
        // 明細検索ＮＯ
        public Bitmap ImgTeki
        {
          get {
            return FImgTeki;
          }
          set {
            SetImgTeki(value);
          }
        }
        private byte IUDKbn = 0;
        // 処理区分
        private int FIncSize = 0;
        private byte FNMonth = 0;
        private int FDSrchNo = 0;
        private object FImgTeki = null;
        private byte NMonthF = 0;
        private byte DSrchNoF = 0;
        private byte ImgTekiF = 0;
        private ArrayList RecList = null;
        // ******************************************************************************
        // System		: ACELINK Navi会計大将 VKシステム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310TrnSwkImgTekiB
        // Name		: Y.Sato
        // Create		: 2007/05/11
        // Comment		: 仕訳更新
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
#if !__VKZL310TrnSwkImgTekiB_INC__
#define __VKZL310TrnSwkImgTekiB_INC__
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2001/10/10
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TVKZL310Trn_SwkImgTeki()
        {
            FIncSize = 1;
            RecList = new ArrayList();
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2001/10/10
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TVKZL310Trn_SwkImgTeki()
        {
            Clear();
            //@ Unsupported property or method(C): 'Free'
            RecList.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: レコードをクリア
        // Name		: Y.Sato
        // Date		: 2001/10/10
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Clear()
        {
            int Index;
            TVKZL310TrnIRec pRec;
            for (Index = 0; Index < RecList.Count; Index ++ )
            {
                pRec = RecList[Index];
                if (pRec.ImgTeki != null)
                {
                    //@ Unsupported property or method(C): 'Free'
                    pRec.ImgTeki.Free;
                    pRec.ImgTeki = null;
                }
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
            }
            RecList.Clear();
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを開始
        // Name		: Y.Sato
        // Date		: 2001/10/10
        // Parameter	: iValue1	処理区分 0:追加 1:修正 2:削除
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Add(int iValue1)
        {
            IUDKbn = iValue1;
            FNMonth = 0;
            FDSrchNo = 0;
            FImgTeki = null;
            NMonthF = 0;
            DSrchNoF = 0;
            ImgTekiF = 0;
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを終了
        // Name		: Y.Sato
        // Date		: 2001/10/10
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Post()
        {
            TVKZL310TrnIRec pRec;
            if (RecList.Capacity <= RecList.Count)
            {
                RecList.Capacity = RecList.Capacity + FIncSize;
            }
            pRec = new TVKZL310TrnIRec();
            pRec.IUDKbn = IUDKbn;
            pRec.NMonth = FNMonth;
            pRec.NMonthF = NMonthF;
            pRec.DSrchNo = FDSrchNo;
            pRec.DSrchNoF = DSrchNoF;
            pRec.ImgTeki = null;
            pRec.ImgTekiF = ImgTekiF;
            if ((ImgTekiF == 1) && (ImgTeki != null))
            {
                pRec.ImgTeki = new Bitmap();
                //@ Unsupported property or method(A): 'Assign'
                pRec.ImgTeki.Assign(FImgTeki);
            }
            RecList.Add(pRec);
        }

        // ******************************************************************************
        // Proccess	: レコードを取得
        // Name		: Y.Sato
        // Date		: 2001/10/10
        // Parameter	: TVKZL310TrnIRecList
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public TVKZL310TrnIRec[] GetRecList()
        {
            TVKZL310TrnIRec[] result;
            int Index;
            result = new TVKZL310TrnIRec[RecList.Count];
            for (Index = 0; Index < RecList.Count; Index ++ )
            {
                result[Index] = ((RecList[Index]) as TVKZL310TrnIRec);
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: IncSizeをセット
        // Name		: Y.Sato
        // Date		: 2003/12/26
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetIncSize(int Value)
        {
            if ((FIncSize != Value) && (FIncSize > 0))
            {
                FIncSize = Value;
            }
        }

        // ******************************************************************************
        // Proccess	: フラグを立てる
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetNMonth(byte Value)
        {
            FNMonth = Value;
            NMonthF = 1;
        }

        private void SetDSrchNo(int Value)
        {
            FDSrchNo = Value;
            DSrchNoF = 1;
        }

        private void SetImgTeki(Bitmap Value)
        {
            FImgTeki = Value;
            ImgTekiF = 1;
        }

#endif
    } // end TVKZL310Trn_SwkImgTeki

    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310TrnSwkLeafImgH
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // : 2015/12/18	S.Arai		・<LEAF>  証憑OCRイメージ対応。
    // ******************************************************************************
    public class TVKZL310Trn_SwkLeafImg
    {
        public int IncSize
        {
          get {
            return FIncSize;
          }
          set {
            SetIncSize(value);
          }
        }
        public byte NMonth
        {
          get {
            return FNMonth;
          }
          set {
            SetNMonth(value);
          }
        }
        // 仕訳内部月
        public int DSrchNo
        {
          get {
            return FDSrchNo;
          }
          set {
            SetDSrchNo(value);
          }
        }
        // 明細検索ＮＯ
        public Object LeafImg
        {
          get {
            return FLeafImg;
          }
          set {
            SetLeafImg(value);
          }
        }
        // 証憑イメージデータ	//<LEAF>ADD
        // property LeafImg: TBitmap	read FLeafImg	write SetLeafImg;			//						//<LEAF>DEL
        public byte ImgKbn
        {
          get {
            return FImgKbn;
          }
          set {
            SetImgKbn(value);
          }
        }
        private byte IUDKbn = 0;
        // 処理区分
        private int FIncSize = 0;
        private byte FNMonth = 0;
        private int FDSrchNo = 0;
        // FLeafImg		: TBitmap;  //<LEAF>DEL
        private Object FLeafImg = null;
        // <LEAF>ADD
        private byte FImgKbn = 0;
        private byte NMonthF = 0;
        private byte DSrchNoF = 0;
        private byte LeafImgF = 0;
        private byte ImgKbnF = 0;
        private ArrayList RecList = null;
        // ******************************************************************************
        // System		: ACELINK Navi会計大将 VKシステム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310TrnSwkLeafImgB
        // Name		: Y.Sato
        // Create		: 2007/05/11
        // Comment		: 仕訳更新
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // : 2015/12/18	S.Arai		・<LEAF>  証憑OCRイメージ対応
        // ******************************************************************************
#if !__VKZL310TrnSwkLeafImgB_INC__
#define __VKZL310TrnSwkLeafImgB_INC__
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2003/11/19
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TVKZL310Trn_SwkLeafImg()
        {
            FIncSize = 1;
            RecList = new ArrayList();
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2003/11/19
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TVKZL310Trn_SwkLeafImg()
        {
            Clear();
            //@ Unsupported property or method(C): 'Free'
            RecList.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: レコードをクリア
        // Name		: Y.Sato
        // Date		: 2003/11/19
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Clear()
        {
            int Index;
            TVKZL310TrnLIRec pRec;
            for (Index = 0; Index < RecList.Count; Index ++ )
            {
                pRec = RecList[Index];
                if (pRec.LeafImg != null)
                {
                    //@ Unsupported property or method(C): 'Free'
                    pRec.LeafImg.Free;
                    pRec.LeafImg = null;
                }
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
            }
            RecList.Clear();
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを開始
        // Name		: Y.Sato
        // Date		: 2003/11/19
        // Parameter	: iValue1	処理区分 0:追加 1:修正 2:削除
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Add(int iValue1)
        {
            IUDKbn = iValue1;
            FNMonth = 0;
            FDSrchNo = 0;
            FLeafImg = null;
            FImgKbn = 0;
            NMonthF = 0;
            DSrchNoF = 0;
            LeafImgF = 0;
            ImgKbnF = 0;
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを終了
        // Name		: Y.Sato
        // Date		: 2003/11/19
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Post()
        {
            TVKZL310TrnLIRec pRec;
            if (RecList.Capacity <= RecList.Count)
            {
                RecList.Capacity = RecList.Capacity + FIncSize;
            }
            pRec = new TVKZL310TrnLIRec();
            pRec.IUDKbn = IUDKbn;
            pRec.NMonth = FNMonth;
            pRec.NMonthF = NMonthF;
            pRec.DSrchNo = FDSrchNo;
            pRec.DSrchNoF = DSrchNoF;
            pRec.LeafImg = null;
            pRec.LeafImgF = LeafImgF;
            pRec.ImgKbn = FImgKbn;
            pRec.ImgKbnF = ImgKbnF;
            if ((LeafImgF == 1) && (LeafImg != null))
            {
                // <LEAF>ADD ST
                pRec.LeafImg = new FLeafImg.ClassType();
                //@ Unsupported property or method(A): 'Assign'
                ((pRec.LeafImg) as Graphics).Assign(((FLeafImg) as Graphics));
            // <LEAF>ADD ED
            // pRec^.LeafImg	:= TBitmap.Create;					//<LEAF>DEL
            // pRec^.LeafImg.Assign(FLeafImg);						//<LEAF>DEL
            }
            RecList.Add(pRec);
        }

        // ******************************************************************************
        // Proccess	: レコードを取得
        // Name		: Y.Sato
        // Date		: 2003/11/19
        // Parameter	: TVKZL310TrnLIRecList
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public TVKZL310TrnLIRec[] GetRecList()
        {
            TVKZL310TrnLIRec[] result;
            int Index;
            result = new TVKZL310TrnLIRec[RecList.Count];
            for (Index = 0; Index < RecList.Count; Index ++ )
            {
                result[Index] = ((RecList[Index]) as TVKZL310TrnLIRec);
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: IncSizeをセット
        // Name		: Y.Sato
        // Date		: 2003/12/26
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetIncSize(int Value)
        {
            if ((FIncSize != Value) && (FIncSize > 0))
            {
                FIncSize = Value;
            }
        }

        // ******************************************************************************
        // Proccess	: フラグを立てる
        // Name		: Y.Sato
        // Date		: 2003/11/19
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetNMonth(byte Value)
        {
            FNMonth = Value;
            NMonthF = 1;
        }

        private void SetDSrchNo(int Value)
        {
            FDSrchNo = Value;
            DSrchNoF = 1;
        }

        // procedure SetLeafImg(Value: TBitmap);                                   // <LEAF>DEL
        private void SetLeafImg(Object Value)
        {
            // <LEAF>ADD
            // procedure TVKZL310Trn_SwkLeafImg.SetLeafImg(Value: TBitmap);	//<LEAF>DEL
            FLeafImg = Value;
            LeafImgF = 1;
        }

        // <LEAF>ADD
        private void SetImgKbn(byte Value)
        {
            FImgKbn = Value;
            ImgKbnF = 1;
        }

#endif
    } // end TVKZL310Trn_SwkLeafImg

    public class TVKZL310TrnIF
    {
        public int Interval
        {
          get {
            return FInterval;
          }
          set {
            SetInterval(value);
          }
        }
        // ロックリトライ間隔（単位はミリ秒）
        public int LockKbn
        {
          get {
            return FLockKbn;
          }
          set {
            SetLockKbn(value);
          }
        }
        // ロック区分 0:ロックなし 0以外:ロックあり
        public int NGNMonth
        {
          get {
            return FNGNMonth;
          }
        }
        // ロックエラー内部月
        public int RetryCount
        {
          get {
            return FRetryCount;
          }
          set {
            SetRetryCount(value);
          }
        }
        // ロックリトライカウント
        public int DenNoSet
        {
          get {
            return FDenNoSet;
          }
          set {
            SetDenNoSet(value);
          }
        }
        // 伝票NO自動付番区分
        // 0:伝票NO入力区分（KbnInfo.GnPuKbn12（RecKbn = 2））に従う
        // 1:伝票NO自動付番しない
        public int AccOKDel
        {
          get {
            return FAccOKDel;
          }
          set {
            SetAccOKDel(value);
          }
        }
        // 経理承認（上位承認）削除
        // 0:何もしない
        // 1:削除する
        public int TukeKbn
        {
          get {
            return FTukeKbn;
          }
          set {
            SetTukeKbn(value);
          }
        }
        private long m_hVKZL310Trn = 0;
        private object m_pVKZL310Trn = null;
        private bool InitFlg = false;
        public TVKZL310TrnCmnInfo TrnCmnInfo = null;
        // 共通情報
        public TVKZL310TrnSwkResult[] TrnSwkResults;
        // 仕訳更新結果
        public TVKZL310TrnSumResult[] TrnSumResults;
        // 実績更新結果
        public TVKZL310Trn_SwkHead SwkHead = null;
        // 仕訳ヘッダ
        public TVKZL310Trn_SwkDetail SwkDetail = null;
        // 仕訳明細データ
        public TVKZL310Trn_SwkImgTeki SwkImgTeki = null;
        // OCRイメージ摘要
        public TVKZL310Trn_SwkLeafImg SwkLeafImg = null;
        // 仕訳証憑イメージ摘要
        public int FInterval = 0;
        public int FLockKbn = 0;
        public int FNGNMonth = 0;
        public int FRetryCount = 0;
        public int FDenNoSet = 0;
        public int FAccOKDel = 0;
        public int FTukeKbn = 0;
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2001/03/27
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TVKZL310TrnIF() : base()
        {
            FInterval = 200;
            FLockKbn = 0;
            FNGNMonth = 0;
            FRetryCount = 25;
            FDenNoSet = 0;
            // 伝票NO自動付番区分
            FAccOKDel = 0;
            FTukeKbn = 0;
            SwkHead = new TVKZL310Trn_SwkHead();
            SwkDetail = new TVKZL310Trn_SwkDetail();
            SwkImgTeki = new TVKZL310Trn_SwkImgTeki();
            SwkLeafImg = new TVKZL310Trn_SwkLeafImg();
            InitFlg = false;
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2001/03/26
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TVKZL310TrnIF()
        {
            InitFlg = false;
            //@ Unsupported property or method(C): 'Free'
            SwkHead.Free;
            //@ Unsupported property or method(C): 'Free'
            SwkDetail.Free;
            //@ Unsupported property or method(C): 'Free'
            SwkImgTeki.Free;
            //@ Unsupported property or method(C): 'Free'
            SwkLeafImg.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: 初期処理
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: var TrnParam
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Init(ref TVKZL310TrnParam TrnParam)
        {
            int result;
            string sBplName;
            TVKZL310TrnInit VKZL310TrnInit;
            try {
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'SystemArea'
                //@ Unsupported property or method(D): 'SysPrefix'
                sBplName = ((TrnParam.ParamC.pMjsAppRecord.m_pCommonArea) as rcCOMMONAREA).SysRoot + '\\' + TMASCom(TrnParam.ParamC.pMjsAppRecord.m_pSystemArea).SystemArea.SysPrefix + "\\prg\\VKZL310Trn.Bpl";
                //@ Unsupported function or procedure: 'LoadPackage'
                m_hVKZL310Trn = LoadPackage(sBplName);
                if (m_hVKZL310Trn == 0)
                {
                    result = Units.MAS310000u.VKZL310Trn_Err_Load;
                    return result;
                }
            }
            catch {
                result = Units.MAS310000u.VKZL310Trn_Err_Load;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnInit = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnInit");
            // Export関数アドレスの取得
            if (VKZL310TrnInit == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnInit関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                //@ Unsupported function or procedure: 'UnloadPackage'
                UnloadPackage(m_hVKZL310Trn);
                return result;
            }
            result = VKZL310TrnInit(TrnParam, m_pVKZL310Trn, TrnCmnInfo);
            InitFlg = true;
            return result;
        }

        // ******************************************************************************
        // Proccess	: 仕訳更新処理
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: なし
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Swkup()
        {
            int result;
            TVKZL310TrnSwkup VKZL310TrnSwkup;
            TVKZL310TrnSwkRec SwkRec;
            TVKZL310TrnParamE ParamE;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnSwkup = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnSwkup");
            // Export関数アドレスの取得
            if (VKZL310TrnSwkup == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnSwkup関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            SwkRec.HRec = SwkHead.GetRecList();
            SwkRec.DRec = SwkDetail.GetRecList();
            SwkRec.IRec = SwkImgTeki.GetRecList();
            SwkRec.LIRec = SwkLeafImg.GetRecList();
            ParamE.Interval = FInterval;
            ParamE.LockKbn = FLockKbn;
            ParamE.RetryCount = FRetryCount;
            ParamE.DenNoSet = FDenNoSet;
            // 伝票NO自動付番区分
            ParamE.AccOKDel = FAccOKDel;
            ParamE.TukeKbn = FTukeKbn;
            result = VKZL310TrnSwkup(m_pVKZL310Trn, SwkRec, TrnSwkResults, ParamE);
            FNGNMonth = ParamE.NGNMonth;
            SwkHead.Clear();
            SwkDetail.Clear();
            SwkImgTeki.Clear();
            SwkLeafImg.Clear();
            return result;
        }

        // ******************************************************************************
        // Proccess	: 月情報を取得
        // Name		: Y.Sato
        // Date		: 2001/03/26
        // Parameter	: NMonth
        // : out MonthInfo
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int GetMonthInfo(int NMonth, out TVKZL310TrnMonthInfo MonthInfo)
        {
            int result;
            TVKZL310TrnGetMonthInfo VKZL310TrnGetMonthInfo;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnGetMonthInfo = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnGetMonthInfo");
            // Export関数アドレスの取得
            if (VKZL310TrnGetMonthInfo == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnGetMonthInfo関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            result = VKZL310TrnGetMonthInfo(m_pVKZL310Trn, NMonth, MonthInfo);
            return result;
        }

        // ******************************************************************************
        // Proccess	: 実績更新処理
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: なし
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Sumup()
        {
            int result;
            TVKZL310TrnSumup1 VKZL310TrnSumup;
            TVKZL310TrnParamE ParamE;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnSumup = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnSumup1");
            // Export関数アドレスの取得
            if (VKZL310TrnSumup == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnSumup関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            ParamE.Interval = FInterval;
            ParamE.LockKbn = FLockKbn;
            ParamE.RetryCount = FRetryCount;
            result = VKZL310TrnSumup(m_pVKZL310Trn, TrnSumResults, ParamE);
            FNGNMonth = ParamE.NGNMonth;
            return result;
        }

        // ******************************************************************************
        // Proccess	: 実績更新処理
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: var TrnMRecList
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Sumup(ref TVKZL310TrnMRec[] TrnMRecList)
        {
            int result;
            TVKZL310TrnSumup2 VKZL310TrnSumup;
            TVKZL310TrnParamE ParamE;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnSumup = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnSumup2");
            // Export関数アドレスの取得
            if (VKZL310TrnSumup == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnSumup関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            ParamE.Interval = FInterval;
            ParamE.LockKbn = FLockKbn;
            ParamE.RetryCount = FRetryCount;
            result = VKZL310TrnSumup(m_pVKZL310Trn, TrnMRecList, TrnSumResults, ParamE);
            FNGNMonth = ParamE.NGNMonth;
            return result;
        }

        // ******************************************************************************
        // Proccess	: 実績更新キャンセル
        // Name		: Y.Sato
        // Date		: 2002/03/25
        // Parameter	: なし
        // Return		: TVKZL310Trn_Err_None		エラーなし
        // : TVKZL310Trn_Err_Address	関数アドレス取得エラー
        // : TVKZL310Trn_Err_Init		初期処理がされていない
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int SumupCancel()
        {
            int result;
            TVKZL310TrnSumupCancel VKZL310TrnSumupCancel;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            // Export関数アドレスの取得
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnSumupCancel = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnSumupCancel");
            if (VKZL310TrnSumupCancel == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnSumupCancel関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            result = VKZL310TrnSumupCancel(m_pVKZL310Trn);
            return result;
        }

        // 実績更新キャンセル
        // ******************************************************************************
        // Proccess	: バランス更新
        // Name		: Y.Sato
        // Date		: 2001/03/13
        // Parameter	: NMonth
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Balance(int NMonth)
        {
            int result;
            TVKZL310TrnBalance VKZL310TrnBalance;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnBalance = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnBalance");
            // Export関数アドレスの取得
            if (VKZL310TrnBalance == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnBalance関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            result = VKZL310TrnBalance(m_pVKZL310Trn, NMonth);
            return result;
        }

        // ******************************************************************************
        // Proccess	: 実績更新レコード件数を取得
        // Name		: Y.Sato
        // Date		: 2001/03/26
        // Parameter	: なし
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int MRecCnt()
        {
            int result;
            TVKZL310TrnMRecCnt VKZL310TrnMRecCnt;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnMRecCnt = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnMRecCnt");
            // Export関数アドレスの取得
            if (VKZL310TrnMRecCnt == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnMRecCnt関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            result = VKZL310TrnMRecCnt(m_pVKZL310Trn);
            return result;
        }

        // ******************************************************************************
        // Proccess	: 終了処理
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: なし
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Term()
        {
            int result;
            TVKZL310TrnTerm VKZL310TrnTerm;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310TrnTerm = GetProcAddress(m_hVKZL310Trn, "VKZL310TrnTerm");
            // Export関数アドレスの取得
            if (VKZL310TrnTerm == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310TrnTerm関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            result = VKZL310TrnTerm(m_pVKZL310Trn);
            //@ Unsupported function or procedure: 'UnloadPackage'
            UnloadPackage(m_hVKZL310Trn);
            InitFlg = false;
            return result;
        }

        // ******************************************************************************
        // Proccess	: ロックリトライ間隔（単位はミリ秒）セット
        // Name		: Y.Sato
        // Date		: 2001/12/20
        // Parameter	: Value			ロックリトライ間隔（単位はミリ秒）
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetInterval(int Value)
        {
            if (Value != FInterval)
            {
                if (Value >= 0)
                {
                    FInterval = Value;
                }
            }
        }

        // ******************************************************************************
        // Proccess	: ロック区分セット
        // Name		: Y.Sato
        // Date		: 2001/12/20
        // Parameter	: Value			ロック区分 0:ロックなし 0以外:ロックあり
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetLockKbn(int Value)
        {
            if (Value != FLockKbn)
            {
                FLockKbn = Value;
            }
        }

        // ******************************************************************************
        // Proccess	: ロックリトライカウントセット
        // Name		: Y.Sato
        // Date		: 2001/12/20
        // Parameter	: Value			ロックリトライカウント
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetRetryCount(int Value)
        {
            if (Value != FRetryCount)
            {
                if (Value >= 0)
                {
                    FRetryCount = Value;
                }
            }
        }

        // ******************************************************************************
        // Proccess	: 伝票NO自動付番区分セット
        // Name		: Y.Sato
        // Date		: 2002/08/02
        // Parameter	: Value			伝票NO自動付番区分
        // 0:伝票NO入力区分（KbnInfo.GnPuKbn12（RecKbn = 2））に従う
        // 1:伝票NO自動付番しない
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetDenNoSet(int Value)
        {
            if (Value != FDenNoSet)
            {
                FDenNoSet = Value;
            }
        }

        // ******************************************************************************
        // Proccess	: 経理承認（上位承認）削除セット
        // Name		: Y.Sato
        // Date		: 2002/11/11
        // Parameter	: Value			経理承認（上位承認）削除
        // 0:何もしない
        // 1:削除する
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetAccOKDel(int Value)
        {
            if (Value != FAccOKDel)
            {
                FAccOKDel = Value;
            }
        }

        // ******************************************************************************
        // Proccess	: 仕訳特殊処理区分（本支店付替自動仕訳）の自動仕訳発生区分メンテ
        // Name		: Y.Sato
        // Date		: 2004/04/22
        // Parameter	: Value			0:デフォルト（9自動セットあり）
        // 1:呼び元の設定に任せる。
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void SetTukeKbn(int Value)
        {
            if (Value != FTukeKbn)
            {
                FTukeKbn = Value;
            }
        }

#endif
    } // end TVKZL310TrnIF

    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310FixIFH
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // ******************************************************************************
    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310FixSwkHeadH
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // ******************************************************************************
    public class TVKZL310Fix_SwkHead: TVKZL310Trn_SwkHead
    {
        public int GCode
        {
          get {
            return FGCode;
          }
          set {
            SetGCode(value);
          }
        }
        // 定型NO
        public string LongName
        {
          get {
            return FLongName;
          }
          set {
            SetLongName(value);
          }
        }
        // 定型仕訳名称
        public string RenChar
        {
          get {
            return FRenChar;
          }
          set {
            SetRenChar(value);
          }
        }
        // 連想シンボル
        public int TeikeiClass
        {
          get {
            return FTeikeiClass;
          }
          set {
            SetTeikeiClass(value);
          }
        }
        private int FGCode = 0;
        // 定型NO
        private string FLongName = String.Empty;
        // 定型仕訳名称
        private string FRenChar = String.Empty;
        // 連想シンボル
        private int FTeikeiClass = 0;
        // 出納帳定型種別
        private byte GCodeF = 0;
        // 定型NO
        private byte LongNameF = 0;
        // 定型仕訳名称
        private byte RenCharF = 0;
        // 連想シンボル
        private byte TeikeiClassF = 0;
        // 出納帳定型種別
        private ArrayList FixHRecList = null;
        // ******************************************************************************
        // System		: ACELINK Navi会計大将 VKシステム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310FixIFB
        // Name		: Y.Sato
        // Create		: 2007/05/11
        // Comment		: 仕訳更新
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
#if !__VKZL310FixIFB_INC__
#define __VKZL310FixIFB_INC__
        // ******************************************************************************
        // System		: ACELINK Navi会計大将 VKシステム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310FixSwkHeadB
        // Name		: Y.Sato
        // Create		: 2007/05/11
        // Comment		: 仕訳更新
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
#if !__VKZL310FixSwkHeadB_INC__
#define __VKZL310FixSwkHeadB_INC__
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TVKZL310Fix_SwkHead() : base()
        {
            FixHRecList = new ArrayList();
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2004/09/27
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TVKZL310Fix_SwkHead()
        {
            Clear();
            //@ Unsupported property or method(C): 'Free'
            FixHRecList.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: レコードをクリア
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Clear()
        {
            int Index;
            TVKZL310FixHRec pRec;
            base.Clear();
            for (Index = 0; Index < FixHRecList.Count; Index ++ )
            {
                pRec = FixHRecList[Index];
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
            }
            FixHRecList.Clear();
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを開始
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: iValue1	処理区分 0:追加 1:修正 2:削除
        // : iValue2	データセットフラグ（修正のときのみ） 0:変更なし 1:変更あり
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Add(int iValue1, int iValue2)
        {
            base.Add();
            FGCode = 0;
            FLongName = "";
            FRenChar = "";
            FTeikeiClass = 0;
            GCodeF = 0;
            LongNameF = 0;
            RenCharF = 0;
            TeikeiClassF = 0;
        }

        public void Add(int iValue1)
        {
            Add(iValue1, 1);
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを終了
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Post()
        {
            TVKZL310FixHRec pRec;
            base.Post();
            if (FixHRecList.Capacity <= FixHRecList.Count)
            {
                FixHRecList.Capacity = FixHRecList.Capacity + this.FIncSize;
            }
            pRec = new TVKZL310FixHRec();
            pRec.HRec = ((this.RecList[FixHRecList.Count]) as TVKZL310TrnHRec);
            pRec.GCode = FGCode;
            pRec.LongName = FLongName;
            pRec.RenChar = FRenChar;
            pRec.TeikeiClass = FTeikeiClass;
            pRec.GCodeF = GCodeF;
            pRec.LongNameF = LongNameF;
            pRec.RenCharF = RenCharF;
            pRec.TeikeiClassF = TeikeiClassF;
            FixHRecList.Add(pRec);
        }

        // ******************************************************************************
        // Proccess	: レコードを取得
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: TVKZL310FixHRecList
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public TVKZL310FixHRec[] GetRecList()
        {
            TVKZL310FixHRec[] result;
            int Index;
            result = new TVKZL310FixHRec[FixHRecList.Count];
            for (Index = 0; Index < FixHRecList.Count; Index ++ )
            {
                result[Index] = ((FixHRecList[Index]) as TVKZL310FixHRec);
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: フラグを立てる
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetGCode(int Value)
        {
            FGCode = Value;
            GCodeF = 1;
        }

        private void SetLongName(string Value)
        {
            FLongName = Value;
            LongNameF = 1;
        }

        private void SetRenChar(string Value)
        {
            FRenChar = Value;
            RenCharF = 1;
        }

        private void SetTeikeiClass(int Value)
        {
            FTeikeiClass = Value;
            TeikeiClassF = 1;
        }

#endif
    } // end TVKZL310Fix_SwkHead

    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310FixSwkDetailH
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // ******************************************************************************
    public class TVKZL310Fix_SwkDetail: TVKZL310Trn_SwkDetail
    {
        public byte DCKbn
        {
          get {
            return FDCKbn;
          }
          set {
            SetDCKbn(value);
          }
        }
        // 当該科目貸借区分
        public byte TekiInpKbn
        {
          get {
            return FTekiInpKbn;
          }
          set {
            SetTekiInpKbn(value);
          }
        }
        // 摘要入力区分
        public string DenNo
        {
          get {
            return FDenNo;
          }
          set {
            SetDenNo(value);
          }
        }
        // 伝票ＮＯ
        public byte FxKbn1
        {
          get {
            return FFxKbn1;
          }
          set {
            SetFxKbn1(value);
          }
        }
        // 定型用フリー区分
        public byte FxKbn2
        {
          get {
            return FFxKbn2;
          }
          set {
            SetFxKbn2(value);
          }
        }
        // 定型用フリー区分
        public byte FxKbn3
        {
          get {
            return FFxKbn3;
          }
          set {
            SetFxKbn3(value);
          }
        }
        // 定型用フリー区分
        public byte FxKbn4
        {
          get {
            return FFxKbn4;
          }
          set {
            SetFxKbn4(value);
          }
        }
        // 定型用フリー区分
        public byte FxKbn5
        {
          get {
            return FFxKbn5;
          }
          set {
            SetFxKbn5(value);
          }
        }
        // 定型用フリー区分
        public byte DBmnTou
        {
          get {
            return FDBmnTou;
          }
          set {
            SetDBmnTou(value);
          }
        }
        // 借方部門当該区分
        public byte DShaTou
        {
          get {
            return FDShaTou;
          }
          set {
            SetDShaTou(value);
          }
        }
        // 借方社員当該区分
        public byte CBmnTou
        {
          get {
            return FCBmnTou;
          }
          set {
            SetCBmnTou(value);
          }
        }
        // 貸方部門当該区分
        public byte CShaTou
        {
          get {
            return FCShaTou;
          }
          set {
            SetCShaTou(value);
          }
        }
        private byte FDCKbn = 0;
        // 当該科目貸借区分
        private byte FTekiInpKbn = 0;
        // 摘要入力区分
        private string FDenNo = String.Empty;
        // 伝票ＮＯ
        private byte FFxKbn1 = 0;
        // 定型用フリー区分
        private byte FFxKbn2 = 0;
        // 定型用フリー区分
        private byte FFxKbn3 = 0;
        // 定型用フリー区分
        private byte FFxKbn4 = 0;
        // 定型用フリー区分
        private byte FFxKbn5 = 0;
        // 定型用フリー区分
        private byte FDBmnTou = 0;
        // 借方部門当該区分
        private byte FDShaTou = 0;
        // 借方社員当該区分
        private byte FCBmnTou = 0;
        // 貸方部門当該区分
        private byte FCShaTou = 0;
        // 貸方社員当該区分
        private byte DCKbnF = 0;
        // 当該科目貸借区分
        private byte TekiInpKbnF = 0;
        // 摘要入力区分
        private byte DenNoF = 0;
        // 伝票ＮＯ
        private byte FxKbn1F = 0;
        // 定型用フリー区分
        private byte FxKbn2F = 0;
        // 定型用フリー区分
        private byte FxKbn3F = 0;
        // 定型用フリー区分
        private byte FxKbn4F = 0;
        // 定型用フリー区分
        private byte FxKbn5F = 0;
        // 定型用フリー区分
        private byte DBmnTouF = 0;
        // 借方部門当該区分
        private byte DShaTouF = 0;
        // 借方社員当該区分
        private byte CBmnTouF = 0;
        // 貸方部門当該区分
        private byte CShaTouF = 0;
        // 貸方社員当該区分
        private ArrayList FixDRecList = null;
        // ******************************************************************************
        // System		: ACELINK Navi会計大将 VKシステム
        // Program		: 仕訳更新
        // ProgramID	: VKZL310FixSwkDetailB
        // Name		: Y.Sato
        // Create		: 2007/05/11
        // Comment		: 仕訳更新
        // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
#if !__VKZL310FixSwkDetailB_INC__
#define __VKZL310FixSwkDetailB_INC__
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TVKZL310Fix_SwkDetail() : base()
        {
            FixDRecList = new ArrayList();
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2004/09/27
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TVKZL310Fix_SwkDetail()
        {
            Clear();
            //@ Unsupported property or method(C): 'Free'
            FixDRecList.Free;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: レコードをクリア
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Clear()
        {
            int Index;
            TVKZL310FixDRec pRec;
            base.Clear();
            for (Index = 0; Index < FixDRecList.Count; Index ++ )
            {
                pRec = FixDRecList[Index];
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
            }
            FixDRecList.Clear();
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを開始
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: iValue1	処理区分 0:追加 1:修正 2:削除
        // : iValue2	データセットフラグ（修正のときのみ） 0:変更なし 1:変更あり
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Add(int iValue1, int iValue2)
        {
            base.Add();
            FDCKbn = 0;
            FTekiInpKbn = 0;
            FDenNo = "";
            // 伝票ＮＯ
            FFxKbn1 = 0;
            // 定型用フリー区分
            FFxKbn2 = 0;
            // 定型用フリー区分
            FFxKbn3 = 0;
            // 定型用フリー区分
            FFxKbn4 = 0;
            // 定型用フリー区分
            FFxKbn5 = 0;
            // 定型用フリー区分
            FDBmnTou = 0;
            // 借方部門当該区分
            FDShaTou = 0;
            // 借方社員当該区分
            FCBmnTou = 0;
            // 貸方部門当該区分
            FCShaTou = 0;
            // 貸方社員当該区分
            DCKbnF = 0;
            TekiInpKbnF = 0;
            DenNoF = 0;
            // 伝票ＮＯ
            FxKbn1F = 0;
            // 定型用フリー区分
            FxKbn2F = 0;
            // 定型用フリー区分
            FxKbn3F = 0;
            // 定型用フリー区分
            FxKbn4F = 0;
            // 定型用フリー区分
            FxKbn5F = 0;
            // 定型用フリー区分
            DBmnTouF = 0;
            // 借方部門当該区分
            DShaTouF = 0;
            // 借方社員当該区分
            CBmnTouF = 0;
            // 貸方部門当該区分
            CShaTouF = 0;
            // 貸方社員当該区分

        }

        public void Add(int iValue1)
        {
            Add(iValue1, 1);
        }

        // ******************************************************************************
        // Proccess	: レコードのセットを終了
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public void Post()
        {
            TVKZL310FixDRec pRec;
            base.Post();
            if (FixDRecList.Capacity <= FixDRecList.Count)
            {
                FixDRecList.Capacity = FixDRecList.Capacity + this.FIncSize;
            }
            pRec = new TVKZL310FixDRec();
            pRec.DRec = ((this.RecList[FixDRecList.Count]) as TVKZL310TrnDRec);
            pRec.DCKbn = FDCKbn;
            pRec.DCKbnF = DCKbnF;
            pRec.TekiInpKbn = FTekiInpKbn;
            pRec.TekiInpKbnF = TekiInpKbnF;
            pRec.DenNo = FDenNo;
            pRec.DenNoF = DenNoF;
            pRec.FxKbn1 = FFxKbn1;
            pRec.FxKbn1F = FxKbn1F;
            pRec.FxKbn2 = FFxKbn2;
            pRec.FxKbn2F = FxKbn2F;
            pRec.FxKbn3 = FFxKbn3;
            pRec.FxKbn3F = FxKbn3F;
            pRec.FxKbn4 = FFxKbn4;
            pRec.FxKbn4F = FxKbn4F;
            pRec.FxKbn5 = FFxKbn5;
            pRec.FxKbn5F = FxKbn5F;
            pRec.DBmnTou = FDBmnTou;
            pRec.DBmnTouF = DBmnTouF;
            pRec.DShaTou = FDShaTou;
            pRec.DShaTouF = DShaTouF;
            pRec.CBmnTou = FCBmnTou;
            pRec.CBmnTouF = CBmnTouF;
            pRec.CShaTou = FCShaTou;
            pRec.CShaTouF = CShaTouF;
            FixDRecList.Add(pRec);
        }

        // ******************************************************************************
        // Proccess	: レコードを取得
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: なし
        // Return		: TVKZL310FixDRecList
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public TVKZL310FixDRec[] GetRecList()
        {
            TVKZL310FixDRec[] result;
            int Index;
            result = new TVKZL310FixDRec[FixDRecList.Count];
            for (Index = 0; Index < FixDRecList.Count; Index ++ )
            {
                result[Index] = ((FixDRecList[Index]) as TVKZL310FixDRec);
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	: フラグを立てる
        // Name		: Y.Sato
        // Date		: 2001/03/12
        // Parameter	: Value
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        private void SetDCKbn(byte Value)
        {
            FDCKbn = Value;
            DCKbnF = 1;
        }

        // 当該科目貸借区分
        private void SetTekiInpKbn(byte Value)
        {
            FTekiInpKbn = Value;
            TekiInpKbnF = 1;
        }

        // 摘要入力区分
        private void SetDenNo(string Value)
        {
            FDenNo = Value;
            DenNoF = 1;
        }

        // 伝票ＮＯ
        private void SetFxKbn1(byte Value)
        {
            FFxKbn1 = Value;
            FxKbn1F = 1;
        }

        // 定型用フリー区分
        private void SetFxKbn2(byte Value)
        {
            FFxKbn2 = Value;
            FxKbn2F = 1;
        }

        // 定型用フリー区分
        private void SetFxKbn3(byte Value)
        {
            FFxKbn3 = Value;
            FxKbn3F = 1;
        }

        // 定型用フリー区分
        private void SetFxKbn4(byte Value)
        {
            FFxKbn4 = Value;
            FxKbn4F = 1;
        }

        // 定型用フリー区分
        private void SetFxKbn5(byte Value)
        {
            FFxKbn5 = Value;
            FxKbn5F = 1;
        }

        // 定型用フリー区分
        private void SetDBmnTou(byte Value)
        {
            FDBmnTou = Value;
            DBmnTouF = 1;
        }

        // 借方部門当該区分
        private void SetDShaTou(byte Value)
        {
            FDShaTou = Value;
            DShaTouF = 1;
        }

        // 借方社員当該区分
        private void SetCBmnTou(byte Value)
        {
            FCBmnTou = Value;
            CBmnTouF = 1;
        }

        // 貸方部門当該区分
        private void SetCShaTou(byte Value)
        {
            FCShaTou = Value;
            CShaTouF = 1;
        }

#endif
    } // end TVKZL310Fix_SwkDetail

    public class TVKZL310FixIF
    {
        private long m_hVKZL310Fix = 0;
        private object m_pVKZL310Fix = null;
        private bool InitFlg = false;
        public TVKZL310TrnCmnInfo TrnCmnInfo = null;
        // 共通情報
        public TVKZL310TrnSwkResult[] TrnSwkResults;
        // 仕訳更新結果
        public TVKZL310Fix_SwkHead SwkHead = null;
        // 仕訳ヘッダレコード
        public TVKZL310Fix_SwkDetail SwkDetail = null;
        // 仕訳明細
        // ******************************************************************************
        // Proccess	: constructor
        // Name		: Y.Sato
        // Date		: 2001/03/27
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //Constructor  Create()
        public TVKZL310FixIF() : base()
        {
            InitFlg = false;
        }
        // ******************************************************************************
        // Proccess	: destructor
        // Name		: Y.Sato
        // Date		: 2001/03/26
        // Parameter	: なし
        // Return		: なし
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TVKZL310FixIF()
        {
            InitFlg = false;
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess	: 初期処理
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: var TrnParam
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Init(ref TVKZL310TrnParam TrnParam)
        {
            int result;
            string sBplName;
            TVKZL310FixInit VKZL310FixInit;
            SwkHead = new TVKZL310Fix_SwkHead();
            SwkDetail = new TVKZL310Fix_SwkDetail();
            try {
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'SystemArea'
                //@ Unsupported property or method(D): 'SysPrefix'
                sBplName = ((TrnParam.ParamC.pMjsAppRecord.m_pCommonArea) as rcCOMMONAREA).SysRoot + '\\' + TMASCom(TrnParam.ParamC.pMjsAppRecord.m_pSystemArea).SystemArea.SysPrefix + "\\prg\\VKZL310Fix.Bpl";
                //@ Unsupported function or procedure: 'LoadPackage'
                m_hVKZL310Fix = LoadPackage(sBplName);
                if (m_hVKZL310Fix == 0)
                {
                    result = Units.MAS310000u.VKZL310Trn_Err_Load;
                    return result;
                }
            }
            catch {
                result = Units.MAS310000u.VKZL310Trn_Err_Load;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310FixInit = GetProcAddress(m_hVKZL310Fix, "VKZL310FixInit");
            // Export関数アドレスの取得
            if (VKZL310FixInit == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310FixInit関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                //@ Unsupported function or procedure: 'UnloadPackage'
                UnloadPackage(m_hVKZL310Fix);
                return result;
            }
            result = VKZL310FixInit(TrnParam, m_pVKZL310Fix, TrnCmnInfo);
            InitFlg = true;
            return result;
        }

        // ******************************************************************************
        // Proccess	: 仕訳更新処理
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: なし
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Swkup()
        {
            int result;
            TVKZL310FixSwkup VKZL310FixSwkup;
            TVKZL310FixSwkRec SwkRec;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310FixSwkup = GetProcAddress(m_hVKZL310Fix, "VKZL310FixSwkup");
            // Export関数アドレスの取得
            if (VKZL310FixSwkup == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310FixSwkup関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            SwkRec.HRec = SwkHead.GetRecList();
            SwkRec.DRec = SwkDetail.GetRecList();
            SwkHead.Clear();
            SwkDetail.Clear();
            result = VKZL310FixSwkup(m_pVKZL310Fix, SwkRec, TrnSwkResults);
            return result;
        }

        // ******************************************************************************
        // Proccess	: 終了処理
        // Name		: Y.Sato
        // Date		: 2001/03/09
        // Parameter	: なし
        // Return		: Integer
        // History		: 9999/99/99	X.Xxxx		・XXXXXXXXXXXXXXXXXX
        // ******************************************************************************
        public int Term()
        {
            int result;
            TVKZL310FixTerm VKZL310FixTerm;
            // 初期処理がされていない
            if (!InitFlg)
            {
                result = Units.MAS310000u.VKZL310Trn_Err_Init;
                return result;
            }
            //@ Unsupported property or method(C): 'Free'
            SwkHead.Free;
            //@ Unsupported property or method(C): 'Free'
            SwkDetail.Free;
            //@ Unsupported function or procedure: 'GetProcAddress'
            VKZL310FixTerm = GetProcAddress(m_hVKZL310Fix, "VKZL310FixTerm");
            // Export関数アドレスの取得
            if (VKZL310FixTerm == null)
            {
                //@ Undeclared identifier(3): 'mjError'
                //@ Undeclared identifier(3): 'mjOk'
                //@ Undeclared identifier(3): 'mjDefOk'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("VKZL310FixTerm関数アドレスの取得に失敗しました。", "エラー", mjError, mjOk, mjDefOk, false);
                result = Units.MAS310000u.VKZL310Trn_Err_Address;
                return result;
            }
            result = VKZL310FixTerm(m_pVKZL310Fix);
            //@ Unsupported function or procedure: 'UnloadPackage'
            UnloadPackage(m_hVKZL310Fix);
            InitFlg = false;
            return result;
        }

        // {$I VKZL311TrnIF_VK07B.inc}	//	分散更新
#endif
    } // end TVKZL310FixIF

    // {$I VKZL311TrnIF_VK07H.inc}	//	分散更新
    // {$I MASL310EntryIFH.inc}			(*H0004 20010921 tyamaguchi 定型仕訳対応*)
    // ******************************************************************************
    // Proccess	:	TMASL310Root
    // Name		:	K.Hattori(MJS)
    // Date		:	2000/12/08
    // Parameter	:
    // Return		:
    // ******************************************************************************
    public class TMASL310Root
    {
    // ------------------------------------------------------------------<HIS-007>---
    // Protected 宣言
    // Public 宣言
    // ドリルダウン構造体
    // ドリルダウン構造体
    // ドリルダウンレベル
    // バランスドリルダウン中＝１
    //@ Unsupported function: 'Low'
    //@ Unsupported function: 'High'
        // Private 宣言
        protected Form Form = null;
        protected object PMPanelHd = null;
        protected TMPanel PMPanelWd = null;
        protected TMPanel PMPanelAp = null;
        protected TMComboBox PMComboBox2 = null;
        // 月選択
        protected TMComboBox PMComboBox3 = null;
        // 第１指示
        protected TMComboBox PMComboBox4 = null;
        // 第２指示
        protected TMNumEdit EMNumInp = null;
        protected TMNumEdit EMNumBal = null;
        protected object TMBtnFusen = null;
        // 付箋ボタン  			2001/07/25 Ins
        protected object TMBtnOpen = null;
        // コード拡大ボタン  	2001/08/20 Ins
        // (*H0047 20050418 khattori	一括置換*)
        protected object TMBtnLump = null;
        protected TMASL310HeadAc Rd01 = null;
        protected TMASL310HeadOt Rd02 = null;
        protected TMASL310HeadOt Rd03 = null;
        protected TMASL310HeadOt Rd04 = null;
        protected TMASL310SelMonth Sm = null;
        protected TMASL310Item Itm = null;
        // 指示項目操作クラス
        protected TMASL310Func Fnc = null;
        protected TMASL310Ind Ind = null;
        protected TMASL310StatusBar Stb = null;
        protected TMASL310GetTaxRate TaxRate = null;
        protected TWParam rParam = null;
        protected TMAS310SelWndDB SelWnd = null;
        protected TMDataModulef m_cMDModule = null;
        protected object m_FCopDB = null;
        // (*db*)
        protected TMASL310IFunc m_rFunc = null;
        // ReadFromPID のみで使用
        protected TMASL310IFunc m_rDefaultFunc = null;
        // DoAction のみで使用
        protected TMLabel LMLabelSelMonthVF = null;
        protected TMLabel LMLabelSelMonthVN = null;
        protected TMPanel PMPanelSelMonth = null;
        protected TMLabel LMLabelHd2 = null;
        protected TMNumEdit EMNumEditFx_No = null;
        // (*Ver A123 M102*)
        // (*H0026 20020328 khattori	第１指示のＣａｐｔｉｏｎ切替*)
        protected TMPanel PMPanelHdSjFst = null;
        protected ArrayList TblList = null;
        // IniFile				:	TIniFile;
        protected int iSijiProcCode = 0;
        // 指示処理ｺｰﾄﾞ
        protected int iSijiProcType = 0;
        // 指示処理ﾓｰﾄﾞ（単一／出納帳／etc.）
        protected int iFirstCode = 0;
        // 第１指示処理ｺｰﾄﾞ
        protected int iSecondCode = 0;
        // 第２指示処理ｺｰﾄﾞ
        protected int iFirstNumb = 0;
        // 第１指示番号
        protected int iSecondNumb = 0;
        // 第２指示番号
        protected int iCurrentProcCode = 0;
        // カレント処理ｺｰﾄﾞ
        protected int iCurrentProcType = 0;
        // カレント処理ﾓｰﾄﾞ（単一／出納帳／etc.）
        protected int iCurrentProcKind = 0;
        // カレント処理種別
        protected int iCurrentProcMode = 0;
        // カレント処理動作（入力／修正／etc.）
        protected int iCurrentProcStyl = 0;
        // カレント処理形態（入力順／日付順／etc.）
        protected int iCurrentProcStl2 = 0;
        // カレント処理形態２
        protected decimal iBalanceAmount = 0;
        // バランス金額
        protected int iBalanceColor = 0;
        // バランス色
        protected int iInputCount = 0;
        // 入力件数
        protected decimal iNowBalanceAmount = 0;
        // 今回バランス金額
        protected int iNowInputCount = 0;
        // 今回入力件数
        protected bool bDateFixed = false;
        // 日固定
        protected bool bDebitFixed = false;
        // 借方固定
        protected bool bCreditFixed = false;
        // 貸方固定
        protected bool bOtherFixed = false;
        // 相手方固定
        // (*H0045 20050303 khattori	項目修正*)
        protected bool bChangeOwner = false;
        // 切り出し／埋め込み中はtrue
        protected Control cActiveControl = null;
        protected int iWndReturn = 0;
        // 選択ウィンドウ戻り値用
        protected bool bWndReturn = false;
        // 選択ウィンドウ戻り値用
        protected TWWndPattern stWndPattern = null;
        // 選択ウィンドウ戻り値用
        protected int iFixNo = 0;
        // 定型仕訳：定型仕訳ＮＯ
        protected string sFixName = String.Empty;
        // 定型仕訳：定型仕訳名称
        protected string sFixRen = String.Empty;
        // 定型仕訳；連想シンボル
        protected int iFixDate = 0;
        // 定型仕訳：日付
        protected int iFixDen = 0;
        // 定型仕訳：伝票ＮＯ
        protected int iFixTClass = 0;
        // 定型仕訳：出納帳定型種別
        protected int iFixInpKbn = 0;
        // 定型仕訳：発生区分
        protected int iFixHNo = 0;
        // 定型仕訳：ヘッダ検索ＮＯ
        protected int iFixAction = 0;
        // 定型仕訳：動作区分　０＝修正、−１＝新規、−２＝エラー
        protected bool bFixUpdate = false;
        // ヘッダ情報変更フラグ	True:　変更あり　False:　変更なし
        protected bool bSelMode = false;
        // ウィンドウ内部コード選択フラグ
        // (*Ver A123 M102*)
        // (*H0027 20020328 khattori	連想入力モード*)
        protected int m_iRensouMode = 0;
        // 連想入力モード　０＝ローマ字ー＞カナ、１＝英数、２＝かなー＞カナ
        // ---<HIS-044>------------------------------------------------------------------
        protected ISwkExclusive m_cSwkExc = null;
        // 仕訳排他クラス(インターフェース)
        // ------------------------------------------------------------------<HIS-044>---
        protected ArrayList ComponentList = null;
        protected TVKZL310FixIF m_cFixIF = null;
        // 定型仕訳更新ｸﾗｽ
        // m_cFixIF			: 	TMASL310FixIF;	//	定型仕訳更新ｸﾗｽ		(*H0004 20010921 tyamaguchi 定型仕訳対応*)
        // m_FFixDB			:	TDataBase;		(*db*)
        // (*verx*)
        // (*H0012 20011213 khattori	マルチ入力！*)
        protected object m_FTrnDB = null;
        // Public 宣言
        public object m_pDrillRoot = null;
        // ドリルダウン構造体
        public ArrayList m_pDrillChild = null;
        // ドリルダウン構造体
        public int m_pDrillLevel = 0;
        // ドリルダウンレベル
        public int m_DrillBalance = 0;
        // バランスドリルダウン中＝１
        public TMASL310IDrParam rParaNew = null;
        public ArrayList BplList = null;
        public object rp_DialogRec;
        public TMjsAppRecord m_pRec = null;
        // Bpl管理構造体
        // (*20010926 khattori tuika*)
        public bool m_bFixLock = false;
        // true=トランザクション中
        // (*20011009 khattori tuika*)
        public int m_iHassei = 0;
        public int m_iComKbn3 = 0;
        public int m_iEComKbn5 = 0;
        public int m_iBusyoNrk = 0;
        // ---<HIS-014>------------------------------------------------------------------
        public int[] m_iSeparate;
        // 貸借別々 ﾌﾗｸﾞ	配列[0:標準 1〜99:ｶｽﾀﾏｲｽﾞ伝票 100:初期化ﾌﾗｸﾞ]
        // ------------------------------------------------------------------<HIS-014>---
        // {$I MASL310EntryIFB.inc}														(*H0015 20010921 tyamaguchi 定型仕訳対応*)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //Constructor  Create( arPrm01)
        public TMASL310Root(object[] arPrm01) : base()
        {
            int iIndex;
            TVKZL310TrnParam TrnPrm;
            HIMC IMC;
            int dwConv;
            int dwSent;
            Form = ((arPrm01[0]) as Form);
            //@ Undeclared identifier(3): 'TMPanel'
            PMPanelHd = TMPanel(arPrm01[1]);
            //@ Undeclared identifier(3): 'TMPanel'
            PMPanelWd = TMPanel(arPrm01[2]);
            //@ Undeclared identifier(3): 'TMPanel'
            PMPanelAp = TMPanel(arPrm01[3]);
            //@ Undeclared identifier(3): 'TMComboBox'
            PMComboBox2 = TMComboBox(arPrm01[4]);
            //@ Undeclared identifier(3): 'TMComboBox'
            PMComboBox3 = TMComboBox(arPrm01[5]);
            //@ Undeclared identifier(3): 'TMComboBox'
            PMComboBox4 = TMComboBox(arPrm01[6]);
            //@ Undeclared identifier(3): 'TMNumEdit'
            EMNumInp = TMNumEdit(arPrm01[7]);
            //@ Undeclared identifier(3): 'TMNumEdit'
            EMNumBal = TMNumEdit(arPrm01[8]);
            Rd01 = ((arPrm01[9]) as TMASL310HeadAc);
            Rd02 = ((arPrm01[10]) as TMASL310HeadOt);
            Rd03 = ((arPrm01[11]) as TMASL310HeadOt);
            Rd04 = ((arPrm01[12]) as TMASL310HeadOt);
            Sm = ((arPrm01[13]) as TMASL310SelMonth);
            Itm = ((arPrm01[14]) as TMASL310Item);
            Fnc = ((arPrm01[15]) as TMASL310Func);
            Ind = ((arPrm01[16]) as TMASL310Ind);
            Stb = ((arPrm01[17]) as TMASL310StatusBar);
            rParam = ((TWParam)(arPrm01[18]));
            SelWnd = ((arPrm01[19]) as TMAS310SelWndDB);
            //@ Undeclared identifier(3): 'TMDataModulef'
            m_cMDModule = TMDataModulef(arPrm01[20]);
            m_pRec = ((arPrm01[21]) as TMjsAppRecord);
            //@ Undeclared identifier(3): 'TMLabel'
            LMLabelSelMonthVF = TMLabel(arPrm01[22]);
            //@ Undeclared identifier(3): 'TMLabel'
            LMLabelSelMonthVN = TMLabel(arPrm01[23]);
            //@ Undeclared identifier(3): 'TMPanel'
            PMPanelSelMonth = TMPanel(arPrm01[24]);
            //@ Undeclared identifier(3): 'TMLabel'
            LMLabelHd2 = TMLabel(arPrm01[25]);
            // ---<HIS-044>------------------------------------------------------------------
            m_cSwkExc = ((ISwkExclusive)(arPrm01[26]));
            // ------------------------------------------------------------------<HIS-044>---
            TMBtnFusen = ((arPrm01[27]) as ToolBarButton);
            // (*H0004 20010725 tyamaguchi 付箋ボタン対応*)
            TMBtnOpen = ((arPrm01[28]) as ToolBarButton);
            // (*H0006 20010820 tyamaguchi コード拡大ボタン対応*)
            // (*H0047 20050418 khattori	一括置換*)
            TMBtnLump = ((arPrm01[29]) as ToolBarButton);
            //@ Undeclared identifier(3): 'TMNumEdit'
            EMNumEditFx_No = TMNumEdit(arPrm01[30]);
            // (*Ver A123 M102*)
            // (*H0014 20020328 khattori	第１指示のＣａｐｔｉｏｎ切替*)
            //@ Undeclared identifier(3): 'TMPanel'
            PMPanelHdSjFst = TMPanel(arPrm01[31]);
            if ((m_cMDModule != null))
            {
                //@ Unsupported property or method(A): 'COPDBOpen'
                m_FCopDB = m_cMDModule.COPDBOpen(0, m_pRec.m_iCorpID);
            }
            // if	(m_cMDModule<>nil)	then	m_FFixDB:=m_cMDModule.COPDBOpen( 1, m_pRec^.m_iCorpID );
            // (*verx*)
            // (*H0012 20011213 khattori	マルチ入力！*)
            if ((m_cMDModule != null))
            {
                //@ Unsupported property or method(A): 'COPDBOpen'
                m_FTrnDB = m_cMDModule.COPDBOpen(1, m_pRec.m_iCorpID);
            }
            // IniFile		:=	TIniFile.Create( ExtractFileDir( Application.ExeName ) + '\MASL310Func.ini' );
            // 基本情報を一元管理する為、全ての基本情報テーブルのＱｕｅｒｙを保管するリストを初期化する
            TblList = new ArrayList();
            //@ Unsupported function: 'Low'
            //@ Unsupported function: 'High'
            for (iIndex = (int)(Low(enTblList)); iIndex <= (int)(High(enTblList)); iIndex ++ )
            {
                TblList.Add(null);
            }
            // 消費税計算クラス生成
            TaxRate = new TMASL310GetTaxRate();
            TaxRate.Init(this, m_pRec);
            ComponentList = new ArrayList();
            m_cFixIF = new TVKZL310FixIF();
            // 定型仕訳更新ｸﾗｽ
            // 定型仕訳更新ｸﾗｽの初期ﾊﾟﾗﾒｰﾀ設定
            TrnPrm.ParamC.pMjsAppRecord = (m_pRec as object);
            TrnPrm.ParamC.CopDB = m_FCopDB;
            TrnPrm.ParamI.tniSwkCKbn = 3;
            // 1:仕訳入力, 2:分散入力, 3:定型仕訳
            TrnPrm.ParamI.iTantoCode = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).TantoNCD;
            TrnPrm.ParamI.strTantoName = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).TantoName;
            TrnPrm.ParamI.tniMailKbn = 0;
            // 0:DBのﾃﾞﾌｫﾙﾄ
            TrnPrm.ParamI.tniHisKbn = 0;
            // 修正履歴区分
            TrnPrm.ParamI.tniJoinHisKbn = 0;
            // 連結履歴区分
            TrnPrm.ParamI.iProcCode = 310000;
            // 処理ｺｰﾄﾞ
            TrnPrm.ParamI.iSystemCode = 0;
            // ｼｽﾃﾑｺｰﾄﾞ（予備）
            TrnPrm.ParamI.iJidoFuban = 0;
            // 検索No自動付番ﾌﾗｸﾞ	0:する, 1:しない
            m_cFixIF.Init(ref TrnPrm);
            // (*H0008 20010926 khattori 定型仕訳 排他対応*)
            // m_bFixLock := False;
            // (*H0015 20020328 khattori	連想入力モード*)
            // http://www.kumei.ne.jp/c_lang/sdk3/sdk_279.htm
            // http://vbvbvb.com/jp/gtips/0101/gImmGetConversionStatusConversionStatus.html
            // 0	:	連想Rｶ
            // 1	:	連想 A
            // 2	:	連想 ｶ
            m_iRensouMode = 0;
            // ---<HIS-055>------------------------------------------------------------------
            Win32NLSEnableIME(Form.Handle, true);
            //@ Undeclared identifier(3): 'ImmGetContext'
            IMC = ImmGetContext(Form.Handle);
            //@ Undeclared identifier(3): 'ImmGetConversionStatus'
            ImmGetConversionStatus(IMC, dwConv, dwSent);
            if (IMC != 0)
            {
                //@ Undeclared identifier(3): 'IME_CMODE_JAPANESE'
                //@ Undeclared identifier(3): 'IME_CMODE_JAPANESE'
                if (dwConv && IME_CMODE_JAPANESE == IME_CMODE_JAPANESE)
                {
                    //@ Undeclared identifier(3): 'IME_CMODE_ROMAN'
                    //@ Undeclared identifier(3): 'IME_CMODE_ROMAN'
                    if (dwConv && IME_CMODE_ROMAN == IME_CMODE_ROMAN)
                    {
                        // ローマ字入力
                        m_iRensouMode = 0;
                    }
                    else
                    {
                        // かな入力
                        m_iRensouMode = 2;
                    }
                }
                else
                {
                    m_iRensouMode = 1;
                }
                // 直接入力
                //@ Undeclared identifier(3): 'ImmReleaseContext'
                ImmReleaseContext(Form.Handle, IMC);
            }
            // IMC := ImmCreateContext;
            // if	IMC <> 0 then
            // begin
            // ImmGetConversionStatus(IMC, dwConv, dwSent);
            // if	(dwConv and IME_CMODE_JAPANESE		)=IME_CMODE_JAPANESE		then
            // begin
            // if	(dwConv and IME_CMODE_ROMAN		)=0							then	m_iRensouMode:=2
            // end
            // else	m_iRensouMode:=1;
            // ImmDestroyContext(IMC);
            // end;
            // ------------------------------------------------------------------<HIS-055>---

        }
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 初期化処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void Init()
        {
            enTblList tlTblList;
            object pQuery;
            m_iHassei = 0;
            m_iComKbn3 = 0;
            m_iEComKbn5 = 0;
            m_iBusyoNrk = 0;
            // 仕訳発生区分
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_DTMAIN;
            pQuery = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
            if (pQuery != null)
            {
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                m_iHassei = TMQuery(pQuery).GetFld("DataKbn").AsInteger;
                // 発生区分
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                m_iComKbn3 = TMQuery(pQuery).GetFld("ComKbn3").AsInteger;
                // メール会計区分
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                m_iEComKbn5 = TMQuery(pQuery).GetFld("EComKbn5").AsInteger;
            // 翌期更新
            }
            // 部署入力採用
            tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
            pQuery = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
            if (pQuery != null)
            {
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'Locate'
                if ((TMQuery(pQuery).Locate("RecKbn", 9, new object[] {})))
                {
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_iBusyoNrk = TMQuery(pQuery).GetFld("GnPuKbn1").AsInteger;
                }
            // 採用区分
            }
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 終了処理
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        //@ Destructor  Destroy()
        ~TMASL310Root()
        {
            TMASL310IDrill cDrill;
            int iIndex;
            for (iIndex = 1; iIndex <= BplList.Count; iIndex ++ )
            {
                cDrill = ((TMASL310IDrill)(GetDrillParam(iIndex)));
                if (cDrill.Mine.bCall)
                {
                    cDrill.Mine.TCall;
                }
            // 仕訳更新
            }
            BplUnLoad;
            // Bpl解放
            BplListUpdate();
            // Bplﾘｽﾄの整理
            //@ Unsupported property or method(C): 'Free'
            TaxRate.Free;
            // 消費税計算クラス破棄
            for (iIndex = 0; iIndex < TblList.Count; iIndex ++ )
            {
                if (TblList[iIndex] != null)
                {
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(D): 'Close'
                    TMQuery(TblList[iIndex]).Close;
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(D): 'Free'
                    TMQuery(TblList[iIndex]).Free;
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(TblList[iIndex]);
                }
            }
            TblList.Clear();
            DeleteDrillParam();
            // ドリルダウンパラメーター破棄
            ComponentList.Clear();
            m_cFixIF.Term();
            // 定型仕訳更新クラス
            //@ Unsupported property or method(A): 'Free'
            m_cFixIF.Free();
            // 定型仕訳更新クラス
            // (*H0008 20010926 khattori 定型仕訳 排他対応*)
            if (m_FTrnDB != null)
            {
                // if	m_FFixDB<>nil	then
                // (*verx*)
                // (*H0012 20011213 khattori	マルチ入力！*)
                //@ Unsupported property or method(A): 'Rollback'
                m_cMDModule.Rollback(m_FTrnDB);
                if ((m_cMDModule != null))
                {
                    //@ Unsupported property or method(A): 'COPDBClose'
                    m_cMDModule.COPDBClose(m_FTrnDB);
                }
                // m_cMDModule.Rollback( m_FFixDB );
                if ((m_cMDModule != null))
                {
                    //@ Unsupported property or method(A): 'COPDBClose'
                    m_cMDModule.COPDBClose(m_FCopDB);
                }
            // if	(m_cMDModule<>nil)	then	m_cMDModule.COPDBClose(m_FFixDB);
            }
            // IniFile.Free;
            base.Destroy();
        }
        // 戻り値なし
        // <HIS-031> 2008/02/21 T.Yamaguchi	ファンクションマウスクリックでエラーが発生することがある(M2で発生)
        // <HIS-044> 2008/08/20 T.Yamaguchi	仕訳排他 対応
        // ******************************************************************************
        // Proccess  :	指示処理ｺｰﾄﾞ
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_SIJI_CODE()
        {
            iSijiProcCode = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	指示形式（MASL_PROC_TYPE_xxxx)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_SIJI_TYPE()
        {
            iSijiProcType = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	第１指示処理ｺｰﾄﾞ
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FST_CODE()
        {
            iFirstCode = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	第２指示処理ｺｰﾄﾞ
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_SND_CODE()
        {
            iSecondCode = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	第１指示番号
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FST_NUMB()
        {
            iFirstNumb = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	第２指示番号
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_SND_NUMB()
        {
            iSecondNumb = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝ一括ｾｯﾄ (ｾｯﾄのみ)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FNC_ITEMS()
        {
            if (pPar2 != null)
            {
                Fnc.SetFuncItems(pPar1, (int)pPar2);
            }
            else
            {
                Fnc.SetFuncItems(pPar1);
            }
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝ一件ｾｯﾄ (ｾｯﾄのみ)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FNC_ITEM()
        {
            object pParam;
            int iParam;
            ArrayList _wvar1 = ((pPar1) as ArrayList);
            pParam = _wvar1[0];
            iParam = ((int)_wvar1[1]);
            Fnc.SetFuncItem(pParam, iParam);
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝEnable 設定 (ｾｯﾄのみ)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FNC_ENABL()
        {
            bool bParam;
            int iParam;
            ArrayList _wvar1 = ((pPar1) as ArrayList);
            bParam = ((bool)_wvar1[0]);
            iParam = ((int)_wvar1[1]);
            Fnc.SetFuncEnable(bParam, iParam);
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝEnable 設定 (指定個所の切替)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FNC_CHGENABL()
        {
            bool bFunc;
            int iFuncId;
            bFunc = (bool)pPar1;
            iFuncId = (int)pPar2;
            Fnc.ChgFuncEnable(bFunc, iFuncId);
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝ頁ｾｯﾄ（次頁）
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FNC_NEXT()
        {
            Fnc.IncPage();
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝ頁ｾｯﾄ（頁省略時、現在頁更新）
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FNC_PAGE()
        {
            int iPage;
            if (pPar1 == null)
            {
                iPage =  -1;
            }
            else
            {
                iPage = (int)pPar1;
            }
            Fnc.SetFuncPage(iPage, true);
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝ初期化
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VINI_FNC_ITEM()
        {
            Fnc.DeleteItem();
        }

        // ******************************************************************************
        // Proccess  :	ﾊﾞﾗﾝｽ金額
        // Parameter : pPar1			~Currency		ﾊﾞﾗﾝｽ金額
        // pPar2			^TColor			ﾊﾞﾗﾝｽ文字色
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_BAL_AMONT()
        {
            // ﾊﾞﾗﾝｽ金額
            if (pPar1 != null)
            {
                //@ Unsupported property or method(C): 'Value'
                EMNumBal.Value = (decimal)pPar1;
            }
            // ﾊﾞﾗﾝｽ文字色
            if (pPar2 != null)
            {
                //@ Unsupported property or method(C): 'Font'
                //@ Unsupported property or method(D): 'Color'
                EMNumBal.Font.Color = (int)pPar2;
            }
            //@ Unsupported property or method(A): 'Refresh'
            EMNumBal.Refresh();
        }

        // ******************************************************************************
        // Proccess  :	ﾊﾞﾗﾝｽ色
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_BAL_COLOR()
        {
            iBalanceColor = (int)pPar1;
            //@ Unsupported property or method(C): 'Font'
            //@ Unsupported property or method(D): 'Color'
            EMNumBal.Font.Color = iBalanceColor;
            //@ Unsupported property or method(A): 'Refresh'
            EMNumBal.Refresh();
        }

        // ******************************************************************************
        // Proccess  :	入力件数(ﾊﾞﾗﾝｽ金額)
        // Parameter : pPar1			^Integer		入力件数
        // pPar2			~Currency		ﾊﾞﾗﾝｽ金額
        // pPar3			^TColor			ﾊﾞﾗﾝｽ文字色
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_INP_COUNT()
        {
            // 入力件数
            if (pPar1 != null)
            {
                iInputCount = (int)pPar1;
                //@ Unsupported property or method(C): 'Value'
                EMNumInp.Value = iInputCount;
                //@ Unsupported property or method(A): 'Refresh'
                EMNumInp.Refresh();
            }
            // ﾊﾞﾗﾝｽ金額
            if (pPar2 != null)
            {
                iBalanceAmount = (decimal)pPar2;
                //@ Unsupported property or method(C): 'Value'
                EMNumBal.Value = iBalanceAmount;
            }
            // ﾊﾞﾗﾝｽ文字色
            if (pPar3 != null)
            {
                iBalanceColor = (int)pPar3;
                //@ Unsupported property or method(C): 'Font'
                //@ Unsupported property or method(D): 'Color'
                EMNumBal.Font.Color = iBalanceColor;
            }
            if ((pPar2 != null) || (pPar3 != null))
            {
                //@ Unsupported property or method(A): 'Refresh'
                EMNumBal.Refresh();
            }
        }

        // ******************************************************************************
        // Proccess  :	今回ﾊﾞﾗﾝｽ金額
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_NBL_AMONT()
        {
            iNowBalanceAmount = (decimal)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	今回入力件数
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_NIP_COUNT()
        {
            iNowInputCount = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	第１指示へ戻る
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FCS_FSIJI()
        {
            TMASL310IFunc rFunc;
            // ﾀﾞﾐｰ
            DoAction(rFunc, VKZ310Cmnu.enDrillStatus.MASL_DRILL_END);
            // ﾊﾞﾗﾝｽ金額、色、入力件数ｾｯﾄ
            SetBalance();
        }

        // ******************************************************************************
        // Proccess  :	ｱｸﾃｨﾌﾞｺﾝﾄﾛｰﾙ
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_ACTV_CTRL()
        {
            if (pPar1 == null)
            {
                cActiveControl = null;
            }
            else
            {
                cActiveControl = ((pPar1) as Control);
            }
            // ---<HIS-031> SetComponentInfo は使用しない------------------------------------
            // //	ｱｸﾃｨﾌﾞｺﾝﾄﾛｰﾙ と ﾌｧﾝｸｼｮﾝ をﾘﾝｸ
            // Fnc.GetFuncControl.SetComponentInfo(cActiveControl);
            // ------------------------------------------------------------------<HIS-031>---

        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ｺｰﾄﾞ	(入力:310101 修正・削除：310201 etc)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PROC_CODE()
        {
            iCurrentProcCode = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ﾀｲﾌﾟ	(単一:1 出納帳:2 etc)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PROC_TYPE()
        {
            iCurrentProcType = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理種別	(MASL_PROC_KIND_xxxx)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PROC_KIND()
        {
            iCurrentProcKind = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ﾓｰﾄﾞ	(入力:1 修正:2 etc)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PROC_MODE()
        {
            iCurrentProcMode = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ｽﾀｲﾙ	(日付順:1 入力順:2 etc)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PROC_STYL()
        {
            iCurrentProcStyl = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ｽﾀｲﾙ2	(MASL_PROC_STYL_xxxx)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PROC_STL2()
        {
            iCurrentProcStl2 = (int)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	他ﾓｰﾄﾞ設定
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_BROTHER()
        {
            Ind.SetBrother((int)pPar1);
        }

        // ******************************************************************************
        // Proccess  :	日固定
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_DAT_FIXED()
        {
            bDateFixed = (bool)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	借方固定
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_DEB_FIXED()
        {
            bDebitFixed = (bool)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	貸方固定
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_CRE_FIXED()
        {
            bCreditFixed = (bool)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	相手固定
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_OTR_FIXED()
        {
            bOtherFixed = (bool)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	ｽﾃｰﾀｽﾊﾞｰに文字列を表示
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_STATUSBAR()
        {
            Stb.SetStatusBarText((pPar1 as string));
        }

        // ******************************************************************************
        // Proccess  :	選択ｳｨﾝﾄﾞｳﾊﾟﾈﾙ 表示／非表示
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_WND_VSBLE()
        {
            bool bVisible;
            bVisible = (bool)pPar1;
            //@ Unsupported property or method(C): 'Visible'
            if (PMPanelWd.Visible != bVisible)
            {
                //@ Unsupported property or method(C): 'Visible'
                PMPanelWd.Visible = bVisible;
            }
        }

        // ******************************************************************************
        // Proccess  :	ﾊﾞﾗﾝｽ金額、色、入力件数 ｾｯﾄ
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_BAL_AMCL()
        {
            SetBalance();
        }

        // ******************************************************************************
        // Proccess  :	ﾄﾞﾘﾙﾀﾞｳﾝﾊﾟﾗﾒｰﾀ ｾｯﾄ
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_DRL_PARM()
        {
            SetDrillParam(pPar1);
        }

        // ******************************************************************************
        // Proccess  :	ﾄﾞﾘﾙﾀﾞｳﾝﾊﾟﾗﾒｰﾀ作成
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VINI_DRL_PARM()
        {
            CreateDrillParam(pPar1);
        }

        // ******************************************************************************
        // Proccess  :	内部月からｶﾚﾝﾄ月 設定
        // Parameter : pPar1			~Integer		内部月
        // pPar2			^Integer		排他実行＆結果
        // pPar3			Pointer			ｴﾗｰﾒｯｾｰｼﾞ出力判定
        // Comment	  :
        // pPar2　nilではないとき排他制御を行い、結果を返す
        // pPar3　nilではなくｴﾗｰのときｴﾗｰﾒｯｾｰｼﾞを表示
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_CUR_MNTH()
        {
            int iExcl;
            TMjsMsgRec rcMsg;
            iExcl = 0;
            // 排他制御
            if (pPar2 != null)
            {
                m_cSwkExc.TermExc();
                iExcl = m_cSwkExc.InitExc();
                if (iExcl == 0)
                {
                    iExcl = m_cSwkExc.SetExc((int)pPar1);
                }
                // 非表示要求していなければ、ｴﾗｰﾒｯｾｰｼﾞを表示
                if (pPar3 != null)
                {
                    //@ Undeclared identifier(3): 'TMASCom'
                    //@ Unsupported property or method(D): 'm_MsgStd'
                     _wvar1 = TMASCom(m_pRec.m_pSystemArea).m_MsgStd;
                    // '排他用テーブルがありません。@_@を実行してください。'
                    if (iExcl == 1)
                    {
                        //@ Unsupported property or method(A): 'GetMSG'
                        rcMsg.GetMSG(rcMsg, 20, 12);
                        //@ Unsupported property or method(C): 'sMsg'
                        //@ Unsupported property or method(A): 'MsgChange'
                        rcMsg.MsgChange(rcMsg.sMsg, "@_@", "分散仕訳データチェック");
                    // '他の端末で@_@更新処理が実行されているため処理できません。'
                    }
                    else if (iExcl ==  -1)
                    {
                        //@ Unsupported property or method(A): 'GetMSG'
                        rcMsg.GetMSG(rcMsg, 20, 11);
                        if ((m_pRec.m_iProgramCode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU_BUN) || (m_pRec.m_iProgramCode / 1000 == 313))
                        {
                            //@ Unsupported property or method(C): 'sMsg'
                            //@ Unsupported property or method(A): 'MsgChange'
                            rcMsg.MsgChange(rcMsg.sMsg, "@_@", "分散仕訳");
                        }
                        else
                        {
                            //@ Unsupported property or method(C): 'sMsg'
                            //@ Unsupported property or method(A): 'MsgChange'
                            rcMsg.MsgChange(rcMsg.sMsg, "@_@", "仕訳データ");
                        }
                    // '排他制御エラーが発生しました。'
                    }
                    else if (iExcl != 0)
                    {
                        //@ Unsupported property or method(A): 'GetMSG'
                        rcMsg.GetMSG(rcMsg, 20, 6);
                    }
                    if (iExcl != 0)
                    {
                        //@ Unsupported property or method(C): 'sMsg'
                        //@ Unsupported property or method(C): 'sTitle'
                        //@ Unsupported property or method(C): 'icontype'
                        //@ Unsupported property or method(C): 'btntype'
                        //@ Unsupported property or method(C): 'btndef'
                        VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(rcMsg.sMsg, rcMsg.sTitle, rcMsg.icontype, rcMsg.btntype, rcMsg.btndef);
                    }
                }
                // 結果を返す
                (int)pPar2 = iExcl;
            // 排他なし ＆ 既にｶﾚﾝﾄ月
            }
            else if (Sm.CurMonth.iInner == (int)pPar1)
            {
                iExcl = 1;
            }
            // 月変更可能？
            if (iExcl == 0)
            {
                Sm.CurMonth = ((TMASL310IMonth)(Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, pPar1)));
                //@ Unsupported property or method(C): 'Caption'
                LMLabelSelMonthVF.Caption = Sm.CurMonth.sViewFix;
                //@ Unsupported property or method(C): 'Caption'
                LMLabelSelMonthVN.Caption = Sm.CurMonth.sViewNext;
                //@ Unsupported property or method(C): 'Caption'
                PMPanelSelMonth.Caption = Sm.CurMonth.sViewMonth;
                //@ Unsupported property or method(C): 'Caption'
                LMLabelHd2.Caption = Sm.CurMonth.sViewTerm;
                SetBalance();
            }
        }

        // ******************************************************************************
        // Proccess  :	未使用(ﾃﾞﾊﾞｯｸﾞで使用)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_DEF_FUNC()
        {
            if (pPar1 == null)
            {
                m_rDefaultFunc.iOpCode = 0;
            }
            else
            {
                m_rDefaultFunc = ((TMASL310IFunc)(pPar1));
            }
        }

        // ******************************************************************************
        // Proccess  :	未使用
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_TRN_CALL()
        {
        }

        // ******************************************************************************
        // Proccess  :	定型仕訳ﾍｯﾀﾞ情報 設定
        // Parameter : pPar1			~Integer		設定対象ﾌｨｰﾙﾄﾞ
        // pPar2			^Integer		値
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FIX_HEAD()
        {
            SetSwkFxHead((int)pPar1, pPar2);
        }

        // ******************************************************************************
        // Proccess  :	ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_WND_SELMODE()
        {
            bSelMode = (bool)pPar1;
        }

        // ******************************************************************************
        // Proccess  :	第１指示のｷｬﾌﾟｼｮﾝ 設定
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_FST_CAPTION()
        {
            int iNo;
            string sCap;
            //@ Unsupported property or method(C): 'ItemIndex'
            iNo = PMComboBox3.ItemIndex + 1;
            sCap = (pPar1 as string);
            //@ Unsupported function or procedure: 'Format'
            //@ Unsupported property or method(C): 'Caption'
            PMPanelHdSjFst.Caption = Format("  %2d %s", new string[] {iNo, sCap});
        }

        // ******************************************************************************
        // Proccess  :	手形番号 更新	(銀行別手形番号更新ｸﾗｽ)
        // Parameter : pPar1			~String			銀行ｺｰﾄﾞ
        // pPar2			^String			手形番号
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PAY_BILNUM()
        {
            // Navi では、手形はなし

        }

        // ******************************************************************************
        // Proccess  :	ﾄﾗﾝ開始	(銀行別手形番号更新ｸﾗｽ)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PAY_BEGINTRN()
        {
            // Navi では、手形はなし

        }

        // ******************************************************************************
        // Proccess  :	ｺﾐｯﾄ	(銀行別手形番号更新ｸﾗｽ)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PAY_COMMIT()
        {
            // Navi では、手形はなし

        }

        // ******************************************************************************
        // Proccess  :	ﾛｰﾙﾊﾞｯｸ	(銀行別手形番号更新ｸﾗｽ)
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_PAY_ROLLBACK()
        {
            // Navi では、手形はなし

        }

        // ******************************************************************************
        // Proccess  :	ｺｸﾖ伝票 入力ﾓｰﾄﾞ(通常／貸借別々)
        // Comment	  : 0:通常 1:貸借別々
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_SLIP_INPMODE()
        {
            // 先に初期化しておく
            Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_SLIP_INPMODE);
            if (pPar1 != null)
            {
                m_iSeparate[fnGetClass()] = (int)pPar1;
            }
        }

        // ******************************************************************************
        // Proccess  :	選択ｳｨﾝﾄﾞｳﾊﾟﾈﾙ 表示位置
        // Parameter : pPar1			~Boolean		底部配置ﾌﾗｸﾞ
        // pPar2			^Integer		高さ
        // ******************************************************************************
        public void Vfnc_RVf_MASL_VSET_WND_BOTTOM()
        {
            //@ Unsupported property or method(C): 'Align'
            if (((bool)pPar1 == true) && (PMPanelWd.Align == System.Windows.Forms.DockStyle.Top))
            {
                //@ Unsupported property or method(C): 'Height'
                PMPanelWd.Height = (int)pPar2;
                // PMPanelWd.height+20;
                //@ Unsupported property or method(C): 'Align'
                PMPanelWd.Align = System.Windows.Forms.DockStyle.Bottom;
            }
            else
            {
                //@ Unsupported property or method(C): 'Align'
                PMPanelWd.Align = System.Windows.Forms.DockStyle.Top;
                //@ Unsupported property or method(C): 'Height'
                PMPanelWd.Height = (int)pPar2;
            // PMPanelWd.height-20;
            }
        }

        // 発生区分等セット
        // 日常処理共通関数
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 日常処理共通関数(Void型)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual void Vfnc(enVfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            switch(enPar)
            {
                case VKZ310Cmnu.enVfunc.MASL_VSET_SIJI_CODE:
                    Vfnc_RVf_MASL_VSET_SIJI_CODE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_SIJI_TYPE:
                    // 指示処理ｺｰﾄﾞ
                    Vfnc_RVf_MASL_VSET_SIJI_TYPE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FST_CODE:
                    // 指示形式（MASL_PROC_TYPE_xxxx)
                    Vfnc_RVf_MASL_VSET_FST_CODE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_SND_CODE:
                    // 第１指示処理ｺｰﾄﾞ
                    Vfnc_RVf_MASL_VSET_SND_CODE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FST_NUMB:
                    // 第２指示処理ｺｰﾄﾞ
                    Vfnc_RVf_MASL_VSET_FST_NUMB();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_SND_NUMB:
                    // 第１指示番号
                    Vfnc_RVf_MASL_VSET_SND_NUMB();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FNC_ITEMS:
                    // 第２指示番号
                    Vfnc_RVf_MASL_VSET_FNC_ITEMS();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FNC_ITEM:
                    // ﾌｧﾝｸｼｮﾝ一括ｾｯﾄ(ｾｯﾄのみ)
                    Vfnc_RVf_MASL_VSET_FNC_ITEM();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FNC_ENABL:
                    // ﾌｧﾝｸｼｮﾝ一件ｾｯﾄ(ｾｯﾄのみ)
                    Vfnc_RVf_MASL_VSET_FNC_ENABL();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FNC_CHGENABL:
                    // ﾌｧﾝｸｼｮﾝEnable設定(ｾｯﾄのみ)
                    Vfnc_RVf_MASL_VSET_FNC_CHGENABL();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FNC_NEXT:
                    // ﾌｧﾝｸｼｮﾝEnable設定(指定個所の切替)
                    Vfnc_RVf_MASL_VSET_FNC_NEXT();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FNC_PAGE:
                    // ﾌｧﾝｸｼｮﾝ頁ｾｯﾄ（次頁）
                    Vfnc_RVf_MASL_VSET_FNC_PAGE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VINI_FNC_ITEM:
                    // ﾌｧﾝｸｼｮﾝ頁ｾｯﾄ（頁省略時、現在頁更新）
                    Vfnc_RVf_MASL_VINI_FNC_ITEM();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_BAL_AMONT:
                    // ﾌｧﾝｸｼｮﾝ初期化
                    Vfnc_RVf_MASL_VSET_BAL_AMONT();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_BAL_COLOR:
                    // ﾊﾞﾗﾝｽ金額
                    Vfnc_RVf_MASL_VSET_BAL_COLOR();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_INP_COUNT:
                    // ﾊﾞﾗﾝｽ色
                    Vfnc_RVf_MASL_VSET_INP_COUNT();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_NBL_AMONT:
                    // 入力件数
                    Vfnc_RVf_MASL_VSET_NBL_AMONT();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_NIP_COUNT:
                    // 今回ﾊﾞﾗﾝｽ金額
                    Vfnc_RVf_MASL_VSET_NIP_COUNT();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FCS_FSIJI:
                    // 今回入力件数
                    Vfnc_RVf_MASL_VSET_FCS_FSIJI();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_ACTV_CTRL:
                    // 第１指示へ戻る
                    Vfnc_RVf_MASL_VSET_ACTV_CTRL();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PROC_CODE:
                    // ｱｸﾃｨﾌﾞｺﾝﾄﾛｰﾙ ｾｯﾄ
                    Vfnc_RVf_MASL_VSET_PROC_CODE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PROC_TYPE:
                    // ｶﾚﾝﾄ処理ｺｰﾄﾞ	(入力:310101 修正・削除：310201 etc)
                    Vfnc_RVf_MASL_VSET_PROC_TYPE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PROC_KIND:
                    // ｶﾚﾝﾄ処理ﾀｲﾌﾟ	(MASL_PROC_TYPE_xxxx)
                    Vfnc_RVf_MASL_VSET_PROC_KIND();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PROC_MODE:
                    // ｶﾚﾝﾄ処理種別	(MASL_PROC_KIND_xxxx)
                    Vfnc_RVf_MASL_VSET_PROC_MODE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PROC_STYL:
                    // ｶﾚﾝﾄ処理ﾓｰﾄﾞ	(MASL_PROC_MODE_xxxx)
                    Vfnc_RVf_MASL_VSET_PROC_STYL();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PROC_STL2:
                    // ｶﾚﾝﾄ処理ｽﾀｲﾙ	(MASL_PROC_STYL_xxxx)
                    Vfnc_RVf_MASL_VSET_PROC_STL2();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_BROTHER:
                    // ｶﾚﾝﾄ処理ｽﾀｲﾙ2	(MASL_PROC_STYL_xxxx)
                    Vfnc_RVf_MASL_VSET_BROTHER();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_DAT_FIXED:
                    // 他モード設定
                    Vfnc_RVf_MASL_VSET_DAT_FIXED();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_DEB_FIXED:
                    // 日固定
                    Vfnc_RVf_MASL_VSET_DEB_FIXED();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_CRE_FIXED:
                    // 借方固定
                    Vfnc_RVf_MASL_VSET_CRE_FIXED();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_OTR_FIXED:
                    // 貸方固定
                    Vfnc_RVf_MASL_VSET_OTR_FIXED();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_STATUSBAR:
                    // 相手固定
                    Vfnc_RVf_MASL_VSET_STATUSBAR();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_WND_VSBLE:
                    // ｽﾃｰﾀｽﾊﾞｰに文字列を表示
                    Vfnc_RVf_MASL_VSET_WND_VSBLE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_BAL_AMCL:
                    // 選択ｳｨﾝﾄﾞｳﾊﾟﾈﾙ表示／非表示
                    Vfnc_RVf_MASL_VSET_BAL_AMCL();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_DRL_PARM:
                    // ﾊﾞﾗﾝｽ金額、色、入力件数ｾｯﾄ
                    Vfnc_RVf_MASL_VSET_DRL_PARM();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VINI_DRL_PARM:
                    // ﾄﾞﾘﾙﾀﾞｳﾝﾊﾟﾗﾒｰﾀｾｯﾄ
                    Vfnc_RVf_MASL_VINI_DRL_PARM();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_CUR_MNTH:
                    // ﾄﾞﾘﾙﾀﾞｳﾝﾊﾟﾗﾒｰﾀ作成
                    Vfnc_RVf_MASL_VSET_CUR_MNTH();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_DEF_FUNC:
                    // 内部月→ｶﾚﾝﾄ月ｾｯﾄ
                    Vfnc_RVf_MASL_VSET_DEF_FUNC();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_TRN_CALL:
                    // (ﾃﾞﾊﾞｯｸﾞで使用)
                    Vfnc_RVf_MASL_VSET_TRN_CALL();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FIX_HEAD:
                    // (未使用)
                    Vfnc_RVf_MASL_VSET_FIX_HEAD();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_WND_SELMODE:
                    // 定型仕訳ﾍｯﾀﾞ情報ｾｯﾄ
                    Vfnc_RVf_MASL_VSET_WND_SELMODE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_FST_CAPTION:
                    // ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択
                    Vfnc_RVf_MASL_VSET_FST_CAPTION();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PAY_BILNUM:
                    // 第１指示のｷｬﾌﾟｼｮﾝ設定
                    // ---<HIS-013> ML版から移植-----------------------------------------------------
                    Vfnc_RVf_MASL_VSET_PAY_BILNUM();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PAY_BEGINTRN:
                    // 手形番号 更新
                    Vfnc_RVf_MASL_VSET_PAY_BEGINTRN();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PAY_COMMIT:
                    // ﾄﾗﾝ開始	(銀行別手形番号更新ｸﾗｽ)
                    Vfnc_RVf_MASL_VSET_PAY_COMMIT();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_PAY_ROLLBACK:
                    // ｺﾐｯﾄ	(銀行別手形番号更新ｸﾗｽ)
                    Vfnc_RVf_MASL_VSET_PAY_ROLLBACK();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_SLIP_INPMODE:
                    // ﾛｰﾙﾊﾞｯｸ	(銀行別手形番号更新ｸﾗｽ)
                    Vfnc_RVf_MASL_VSET_SLIP_INPMODE();
                    break;
                case VKZ310Cmnu.enVfunc.MASL_VSET_WND_BOTTOM:
                    // ｺｸﾖ伝票 入力ﾓｰﾄ
                    // ------------------------------------------------------------------<HIS-013>---
                    Vfnc_RVf_MASL_VSET_WND_BOTTOM();
                    break;
                default:
                    // 選択ｳｨﾝﾄﾞｳﾊﾟﾈﾙ 表示位置
                    MessageBox.Show("日常処理共通関数(Void型)の呼び出しに無効な処理識別が使用されました。");
                    break;
            }
        }

        public virtual void Vfnc(enVfunc enPar)
        {
            Vfnc(enPar, null);
        }

        public virtual void Vfnc(enVfunc enPar, object pPar1)
        {
            Vfnc(enPar, pPar1, null);
        }

        public virtual void Vfnc(enVfunc enPar, object pPar1, object pPar2)
        {
            Vfnc(enPar, pPar1, pPar2, null);
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝ一件取得
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_FNC_ITEM()
        {
            object result;
            result = Fnc.GetFuncItem((int)pPar1);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｱｸﾃｨﾌﾞｺﾝﾄﾛｰﾙ取得
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_ACTV_CTRL()
        {
            object result;
            result = cActiveControl;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	他ﾓｰﾄﾞ取得
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_BROTHER()
        {
            object result;
            result = Ind.GetBrother((int)pPar1);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	内部月から月情報を取得
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_NM_RECSET()
        {
            object result;
            int iNMonth;
            int idx;
            result = null;
            iNMonth = (int)pPar1;
            for (idx = 0; idx < Sm.Count; idx ++ )
            {
                if (((TMASL310IMonth)(Sm[idx])).iInner == iNMonth)
                {
                    result = Sm[idx];
                    break;
                }
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	外部月から月情報を取得(当期)
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_GM_RECSET()
        {
            object result;
            int iGMonth;
            int idx;
            result = null;
            iGMonth = (int)pPar1;
            for (idx = 0; idx < Sm.Count; idx ++ )
            {
                TMASL310IMonth _wvar1 = ((TMASL310IMonth)(Sm[idx]));
                if ((_wvar1.iOuter == iGMonth) && (_wvar1.iNextTerm == 0))
                {
                    // 当期
                    result = Sm[idx];
                    break;
                }
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	外部月から月情報を取得(翌期)
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_YM_RECSET()
        {
            object result;
            int iGMonth;
            int idx;
            result = null;
            iGMonth = (int)pPar1;
            for (idx = 0; idx < Sm.Count; idx ++ )
            {
                TMASL310IMonth _wvar1 = ((TMASL310IMonth)(Sm[idx]));
                if ((_wvar1.iOuter == iGMonth) && (_wvar1.iNextTerm == 1))
                {
                    // 翌期
                    result = Sm[idx];
                    break;
                }
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ取得
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_WND_PARAM()
        {
            object result;
            result = rParam;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ﾃｰﾌﾞﾙ取得
        // Parameter : pPar1			~enTblList		ﾃｰﾌﾞﾙID
        // pPar2			^String			Where条件
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_TBL_LIST()
        {
            object result;
            result = GetTableList(pPar1, pPar2);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ﾃｰﾌﾞﾙ取得(再読込)
        // Parameter : pPar1			~enTblList		ﾃｰﾌﾞﾙID
        // pPar2			^String			Where条件
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PREF_TBL_LIST()
        {
            object result;
            result = RefTableList(pPar1, pPar2);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ﾄﾞﾘﾙﾀﾞｳﾝﾊﾟﾗﾒｰﾀ取得
        // Parameter : pPar1			~Integer		ﾄﾞﾘﾙﾀﾞｳﾝ階層
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_DRL_PARM()
        {
            object result;
            result = GetDrillParam(pPar1);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	指示項目取得(PrgIDから)
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_INI_REC()
        {
            object result;
            result = ReadFromPID(pPar1);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	未使用(ﾃﾞﾊﾞｯｸﾞで使用)
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_DEF_FUNC()
        {
            object result;
            result = m_rDefaultFunc;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ﾊﾞﾗﾝｽ金額取得(ﾎﾟｲﾝﾀ)
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_BAL_AMONT()
        {
            object result;
            result = iBalanceAmount;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	今回ﾊﾞﾗﾝｽ金額取得(ﾎﾟｲﾝﾀ)
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_NBL_AMONT()
        {
            object result;
            result = iNowBalanceAmount;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｺﾝﾎﾟｰﾈﾝﾄ取得
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_COMPONENT()
        {
            object result;
            result = SetComponent();
            return result;
        }

        // ******************************************************************************
        // Proccess  :	定型仕訳ﾍｯﾀﾞ情報 取得
        // Parameter : pPar1			~Integer		取得対象ﾌｨｰﾙﾄﾞ
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_FIX_HEAD()
        {
            object result;
            result = GetSwkFxHead((int)pPar1);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	指示の TMjsAppRecord 取得
        // ******************************************************************************
        public object Pfnc_RPf_MASL_PGET_ROOT_PREC()
        {
            object result;
            result = m_pRec;
            return result;
        }

        // Void型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 日常処理共通関数(Pointer型)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual object Pfnc(enPfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            object result;
            object pRet;
            pRet = null;
            switch(enPar)
            {
                case VKZ310Cmnu.enPfunc.MASL_PGET_FNC_ITEM:
                    pRet = Pfnc_RPf_MASL_PGET_FNC_ITEM();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_ACTV_CTRL:
                    // ﾌｧﾝｸｼｮﾝ一件取得
                    pRet = Pfnc_RPf_MASL_PGET_ACTV_CTRL();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_BROTHER:
                    // ｱｸﾃｨﾌﾞｺﾝﾄﾛｰﾙ取得
                    pRet = Pfnc_RPf_MASL_PGET_BROTHER();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET:
                    // 他モード取得
                    pRet = Pfnc_RPf_MASL_PGET_NM_RECSET();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_GM_RECSET:
                    // 内部月から月情報取得
                    pRet = Pfnc_RPf_MASL_PGET_GM_RECSET();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_YM_RECSET:
                    // 外部月から月情報を取得（当期）
                    pRet = Pfnc_RPf_MASL_PGET_YM_RECSET();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_WND_PARAM:
                    // 外部月から月情報を取得（翌期）
                    pRet = Pfnc_RPf_MASL_PGET_WND_PARAM();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST:
                    // ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ取得
                    pRet = Pfnc_RPf_MASL_PGET_TBL_LIST();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PREF_TBL_LIST:
                    // ﾃｰﾌﾞﾙ取得
                    pRet = Pfnc_RPf_MASL_PREF_TBL_LIST();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_DRL_PARM:
                    // ﾃｰﾌﾞﾙ取得(再読込)
                    pRet = Pfnc_RPf_MASL_PGET_DRL_PARM();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_INI_REC:
                    // ﾄﾞﾘﾙﾀﾞｳﾝﾊﾟﾗﾒｰﾀ取得
                    pRet = Pfnc_RPf_MASL_PGET_INI_REC();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_DEF_FUNC:
                    // 指示項目取得(PrgIDから)
                    pRet = Pfnc_RPf_MASL_PGET_DEF_FUNC();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_BAL_AMONT:
                    // (ﾃﾞﾊﾞｯｸﾞで使用)
                    pRet = Pfnc_RPf_MASL_PGET_BAL_AMONT();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_NBL_AMONT:
                    // ﾊﾞﾗﾝｽ金額取得
                    pRet = Pfnc_RPf_MASL_PGET_NBL_AMONT();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_COMPONENT:
                    // 今回ﾊﾞﾗﾝｽ金額取得
                    pRet = Pfnc_RPf_MASL_PGET_COMPONENT();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_FIX_HEAD:
                    // ｺﾝﾎﾟｰﾈﾝﾄ取得
                    pRet = Pfnc_RPf_MASL_PGET_FIX_HEAD();
                    break;
                case VKZ310Cmnu.enPfunc.MASL_PGET_ROOT_PREC:
                    // 定型仕訳ﾍｯﾀﾞ情報取得
                    // 指示の TMjsAppRecord 取得
                    pRet = Pfnc_RPf_MASL_PGET_ROOT_PREC();
                    break;
                default:
                    MessageBox.Show("日常処理共通関数(Pointer型)の呼び出しに無効な処理識別が使用されました。");
                    break;
            }
            result = pRet;
            return result;
        }

        public virtual object Pfnc(enPfunc enPar)
        {
            return Pfnc(enPar, null);
        }

        public virtual object Pfnc(enPfunc enPar, object pPar1)
        {
            return Pfnc(enPar, pPar1, null);
        }

        public virtual object Pfnc(enPfunc enPar, object pPar1, object pPar2)
        {
            return Pfnc(enPar, pPar1, pPar2, null);
        }

        // ******************************************************************************
        // Proccess  :	ﾀﾞﾐｰ
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_xxxxxxxx1()
        {
            bool result;
            result = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_RET_FALSE;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	指示にﾌｫｰｶｽがあるか
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_SIJI_FOCUS()
        {
            bool result;
            //@ Unsupported property or method(C): 'ActiveControl'
            //@ Unsupported property or method(A): 'ContainsControl'
            result = PMPanelHd.ContainsControl(Screen.PrimaryScreen.ActiveControl);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	日固定か
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_DAT_FIXED()
        {
            bool result;
            result = bDateFixed;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	借方固定か
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_DEB_FIXED()
        {
            bool result;
            result = bDebitFixed;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	貸方固定か
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_CRE_FIXED()
        {
            bool result;
            result = bCreditFixed;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	相手固定か(出納帳)
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_OTR_FIXED()
        {
            bool result;
            result = bOtherFixed;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ﾄﾞﾘﾙﾀﾞｳﾝ実行
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_DO_DRILL()
        {
            bool result;
            result = DoAction(Itm.ReadIniRec((int)pPar1), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	日記帳表示
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_DO_DIARY()
        {
            bool result;
            result = DoAction(Itm.ReadIniRec((int)pPar1), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, pPar2);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	元帳表示
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_DO_LEDGER()
        {
            bool result;
            result = DoAction(Itm.ReadIniRec((int)pPar1), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, pPar2);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_WND_SELMODE()
        {
            bool result;
            result = bSelMode;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	伝票表示
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_DO_SLIP()
        {
            bool result;
            result = DoAction(Itm.ReadIniRec((int)pPar1), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, pPar2);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	伝票印刷
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_DO_SLIP_PRN()
        {
            bool result;
            result = DoAction(Itm.ReadIniRec((int)pPar1), VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT, pPar2);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	切出／埋込 ﾌﾗｸﾞ
        // Comment	  :	切出／埋込中は True
        // ******************************************************************************
        public bool Bfnc_RBf_MASL_BGET_CHG_OWNER()
        {
            bool result;
            if (pPar1 != null)
            {
                bChangeOwner = (bool)pPar1;
            }
            result = bChangeOwner;
            return result;
        }

        // Pointer型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 日常処理共通関数(Boolean型)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual bool Bfnc(enBfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            bool result;
            bool bRet;
            bRet = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_RET_FALSE;
            switch(enPar)
            {
                case VKZ310Cmnu.enBfunc.MASL_BGET_xxxxxxxx1:
                    bRet = Bfnc_RBf_MASL_BGET_xxxxxxxx1();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_SIJI_FOCUS:
                    // ﾀﾞﾐｰ
                    bRet = Bfnc_RBf_MASL_BGET_SIJI_FOCUS();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_DAT_FIXED:
                    // 指示にﾌｫｰｶｽがあるか
                    bRet = Bfnc_RBf_MASL_BGET_DAT_FIXED();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_DEB_FIXED:
                    // 日固定
                    bRet = Bfnc_RBf_MASL_BGET_DEB_FIXED();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_CRE_FIXED:
                    // 借方固定
                    bRet = Bfnc_RBf_MASL_BGET_CRE_FIXED();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_OTR_FIXED:
                    // 貸方固定
                    bRet = Bfnc_RBf_MASL_BGET_OTR_FIXED();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_DO_DRILL:
                    // 相手方固定
                    bRet = Bfnc_RBf_MASL_BGET_DO_DRILL();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_DO_DIARY:
                    // ﾄﾞﾘﾙﾀﾞｳﾝ実行
                    bRet = Bfnc_RBf_MASL_BGET_DO_DIARY();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_DO_LEDGER:
                    // 日記帳表示
                    bRet = Bfnc_RBf_MASL_BGET_DO_LEDGER();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_WND_SELMODE:
                    // 元帳表示
                    bRet = Bfnc_RBf_MASL_BGET_WND_SELMODE();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_DO_SLIP:
                    // ｳｨﾝﾄﾞｳ内部ｺｰﾄﾞ選択ﾌﾗｸﾞ
                    bRet = Bfnc_RBf_MASL_BGET_DO_SLIP();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_DO_SLIP_PRN:
                    // 伝票表示
                    bRet = Bfnc_RBf_MASL_BGET_DO_SLIP_PRN();
                    break;
                case VKZ310Cmnu.enBfunc.MASL_BGET_CHG_OWNER:
                    // 伝票印刷
                    bRet = Bfnc_RBf_MASL_BGET_CHG_OWNER();
                    break;
                default:
                    // 切出／埋込 ﾌﾗｸﾞ
                    MessageBox.Show("日常処理共通関数(Boolean型)の呼び出しに無効な処理識別が使用されました。");
                    break;
            }
            result = bRet;
            return result;
        }

        public virtual bool Bfnc(enBfunc enPar)
        {
            return Bfnc(enPar, null);
        }

        public virtual bool Bfnc(enBfunc enPar, object pPar1)
        {
            return Bfnc(enPar, pPar1, null);
        }

        public virtual bool Bfnc(enBfunc enPar, object pPar1, object pPar2)
        {
            return Bfnc(enPar, pPar1, pPar2, null);
        }

        // <HIS-051> 2008/11/17 T.Yamaguchi	GetFixLock() 変更
        // ******************************************************************************
        // Proccess  :	指示処理ｺｰﾄﾞ
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_SIJI_CODE()
        {
            int result;
            result = iSijiProcCode;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	指示処理ﾀｲﾌﾟ
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_SIJI_TYPE()
        {
            int result;
            result = iSijiProcType;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	選択中の内部月
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_INN_MONTH()
        {
            int result;
            result = Sm.CurMonth.iInner;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	選択中の外部月
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_OUT_MONTH()
        {
            int result;
            result = Sm.CurMonth.iOuter;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	選択中の月の開始日
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_STR_DATE()
        {
            int result;
            result = Sm.CurMonth.iStartDate;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	選択中の月の終了日
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_END_DATE()
        {
            int result;
            result = Sm.CurMonth.iEndDate;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	第１指示処理ｺｰﾄﾞ(仕訳帳:310500 etc)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_FST_CODE()
        {
            int result;
            result = iFirstCode;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	第２指示処理ｺｰﾄﾞ(仕訳帳-日付順:310501 etc)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_SND_CODE()
        {
            int result;
            result = iSecondCode;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	第１指示番号
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_FST_NUMB()
        {
            int result;
            result = iFirstNumb;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	第２指示番号
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_SND_NUMB()
        {
            int result;
            result = iSecondNumb;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	現在のﾌｧﾝｸｼｮﾝ頁取得
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_FNC_PAGE()
        {
            int result;
            result = Fnc.GetFuncPage();
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ﾊﾞﾗﾝｽ状態取得
        // Return    : Integer			0: ﾊﾞﾗﾝｽ一致
        // 1: ﾊﾞﾗﾝｽ不一致
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_BAL_AMONT()
        {
            int result;
            bool bRet;
            bRet = (iBalanceAmount != 0) || (iBalanceColor == System.Drawing.Color.Red);
            result = (int)(bRet);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ﾊﾞﾗﾝｽ色取得
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_BAL_COLOR()
        {
            int result;
            result = iBalanceColor;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	入力件数取得
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_INP_COUNT()
        {
            int result;
            result = iInputCount;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	今回ﾊﾞﾗﾝｽ状態取得
        // Return    : Integer			0: ﾊﾞﾗﾝｽ一致
        // 1: ﾊﾞﾗﾝｽ不一致
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_NBL_AMONT()
        {
            int result;
            bool bRet;
            bRet = iNowBalanceAmount != 0;
            result = (int)(bRet);
            return result;
        }

        // ******************************************************************************
        // Proccess  今回入力件数取得:
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_NIP_COUNT()
        {
            int result;
            result = iNowInputCount;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ｺｰﾄﾞ	(入力:310101 修正・削除：310201 etc)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_PROC_CODE()
        {
            int result;
            result = iCurrentProcCode;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ﾀｲﾌﾟ	(単一:1 出納帳:2 etc)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_PROC_TYPE()
        {
            int result;
            result = iCurrentProcType;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理種別	(MASL_PROC_KIND_xxxx)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_PROC_KIND()
        {
            int result;
            result = iCurrentProcKind;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ﾓｰﾄﾞ	(入力:1 修正:2 etc)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_PROC_MODE()
        {
            int result;
            result = iCurrentProcMode;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ｽﾀｲﾙ	(日付順:1 入力順:2 etc)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_PROC_STYL()
        {
            int result;
            result = iCurrentProcStyl;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｶﾚﾝﾄ処理ｽﾀｲﾙ2	(MASL_PROC_STYL_xxxx)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_PROC_STL2()
        {
            int result;
            result = iCurrentProcStl2;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	消費税計算
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_TAX_RATE()
        {
            int result;
            result = TaxRate.GetTaxRate(pPar1);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	日付処理
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_DATE_CHECK()
        {
            int result;
            result = DateCheck(pPar1, ref pPar2, ref pPar3);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	月固定
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_MONTH_FIXED()
        {
            int result;
            result = Sm.Kotei;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	入力・修正・削除可能の状態を取得
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_CHANGEABLE()
        {
            int result;
            result = GetChangeable(pPar1, ref pPar2, ref pPar3);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ﾌｧﾝｸｼｮﾝのｵｰﾅｰを取得
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_FNC_OWNER()
        {
            int result;
            result = Fnc.m_iOwner;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	担当者処理区分	(MOS_OFFICE_STAFF.SyoriKbn)
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_SYORIKBN()
        {
            int result;
            result = Itm.m_iSyoriKbn;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	定型仕訳 排他処理
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_FIX_LOCK()
        {
            int result;
            bool bMsg;
            if (pPar2 != null)
            {
                bMsg = (bool)pPar2;
            }
            else
            {
                bMsg = false;
            }
            result = GetFixLock(pPar1, bMsg);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	仕訳修正・削除可能状態取得
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_TRAN_LOCK()
        {
            int result;
            result = GetTranRockable(pPar1, pPar2);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	仮想ｷｰｺｰﾄﾞ を ASCIIｺｰﾄﾞ に変換
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_ASCII_CODE()
        {
            int result;
            const int VK_OEM_COMMA = 188;
            // 「,」
            int iKey;
            iKey = (int)pPar1;
            switch(iKey)
            {
                //@ Undeclared identifier(3): 'VK_TAB'
                case VK_TAB:
                    //@ Undeclared identifier(3): 'VK_TAB'
                    result = VK_TAB;
                    break;
                //@ Undeclared identifier(3): 'VK_MULTIPLY'
                //@ Undeclared identifier(3): 'VK_DIVIDE'
                // Modify the A .. B: VK_MULTIPLY .. VK_DIVIDE
                case VK_MULTIPLY:
                    //@ Undeclared identifier(3): 'VK_MULTIPLY'
                    result = (int)('*') + iKey - VK_MULTIPLY;
                    break;
                case VK_OEM_COMMA:
                    result = (int)(',');
                    break;
                default:
                    result =  -1;
                    break;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	連想ﾓｰﾄﾞ 設定／取得
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_RENSOU_MODE()
        {
            int result;
            int iMode;
            if (pPar1 != null)
            {
                iMode = (int)pPar1;
                switch(iMode)
                {
                    case  -1:
                        m_iRensouMode = (m_iRensouMode + 1) % 3;
                        break;
                    // ﾄｸﾞﾙ
                    // Modify the A .. B: 0 .. 2
                    case 0:
                        m_iRensouMode = iMode;
                        break;
                    default:
                        // 指定
                        m_iRensouMode = 0;
                        break;
                }
            }
            result = m_iRensouMode;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｺｸﾖ伝票 入力ﾓｰﾄﾞ(通常／貸借別々)
        // Comment	  : 0:通常 1:貸借別々
        // ******************************************************************************
        public int Ifnc_RIf_MASL_IGET_SLIP_INPMODE()
        {
            int result;
            enTblList tlTbl;
            string sWhere;
            object pQue;
            int idx;
            // 初期処理(初回のみ)
            if (m_iSeparate[100] == 0)
            {
                m_iSeparate[100] = 1;
                tlTbl = VKZ310Cmnu.enTblList.MASL_TLST_DenInfo;
                sWhere = " where SwkForm=4";
                // 仕訳入力形式 4:ｺｸﾖ伝票
                pQue = Pfnc(VKZ310Cmnu.enPfunc.MASL_PREF_TBL_LIST, tlTbl, sWhere);
                if (pQue != null)
                {
                    //@ Undeclared identifier(3): 'TMQuery'
                     _wvar1 = TMQuery(pQue);
                    //@ Unsupported function or procedure: 'Eof'
                    while (!Eof)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        idx = _wvar1.GetFld("DenClass").AsInteger;
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        m_iSeparate[idx] = _wvar1.GetFld("DenKbn1").AsInteger;
                        // 入力方法初期値
                        //@ Unsupported property or method(B): 'Next'
                        _wvar1.Next();
                    }
                }
            }
            // 貸借別々 ﾌﾗｸﾞ
            result = m_iSeparate[fnGetClass()];
            return result;
        }

        // Boolean型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 日常処理共通関数(Integer型)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual int Ifnc(enIfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            int result;
            int iRet;
            iRet = VKZ310Cmnu.Units.VKZ310Cmnu.MASL_RET_ERROR;
            switch(enPar)
            {
                case VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_CODE:
                    iRet = Ifnc_RIf_MASL_IGET_SIJI_CODE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_SIJI_TYPE:
                    // 指示処理ｺｰﾄﾞ
                    iRet = Ifnc_RIf_MASL_IGET_SIJI_TYPE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_INN_MONTH:
                    // 指示形式（MASL_PROC_TYPE_xxxx)
                    iRet = Ifnc_RIf_MASL_IGET_INN_MONTH();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_OUT_MONTH:
                    // 選択中の内部月
                    iRet = Ifnc_RIf_MASL_IGET_OUT_MONTH();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_STR_DATE:
                    // 選択中の外部月
                    iRet = Ifnc_RIf_MASL_IGET_STR_DATE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_END_DATE:
                    // 選択中の月の開始日
                    iRet = Ifnc_RIf_MASL_IGET_END_DATE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_FST_CODE:
                    // 選択中の月の終了日
                    iRet = Ifnc_RIf_MASL_IGET_FST_CODE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_SND_CODE:
                    // 第１指示処理ｺｰﾄﾞ(仕訳帳:310500 etc)
                    iRet = Ifnc_RIf_MASL_IGET_SND_CODE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_FST_NUMB:
                    // 第２指示処理ｺｰﾄﾞ(仕訳帳-日付順:310501 etc)
                    iRet = Ifnc_RIf_MASL_IGET_FST_NUMB();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_SND_NUMB:
                    // 第１指示番号
                    iRet = Ifnc_RIf_MASL_IGET_SND_NUMB();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_FNC_PAGE:
                    // 第２指示番号
                    iRet = Ifnc_RIf_MASL_IGET_FNC_PAGE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_BAL_AMONT:
                    // 現在のﾌｧﾝｸｼｮﾝ頁取得
                    iRet = Ifnc_RIf_MASL_IGET_BAL_AMONT();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_BAL_COLOR:
                    // ﾊﾞﾗﾝｽ状態取得
                    iRet = Ifnc_RIf_MASL_IGET_BAL_COLOR();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_INP_COUNT:
                    // ﾊﾞﾗﾝｽ色取得
                    iRet = Ifnc_RIf_MASL_IGET_INP_COUNT();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_NBL_AMONT:
                    // 入力件数取得
                    iRet = Ifnc_RIf_MASL_IGET_NBL_AMONT();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_NIP_COUNT:
                    // 今回ﾊﾞﾗﾝｽ状態取得
                    iRet = Ifnc_RIf_MASL_IGET_NIP_COUNT();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_PROC_CODE:
                    // 今回入力件数取得
                    iRet = Ifnc_RIf_MASL_IGET_PROC_CODE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_PROC_TYPE:
                    // ｶﾚﾝﾄ処理ｺｰﾄﾞ	(入力:310101 修正・削除：310201 etc)
                    iRet = Ifnc_RIf_MASL_IGET_PROC_TYPE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_PROC_KIND:
                    // ｶﾚﾝﾄ処理ﾀｲﾌﾟ	(MASL_PROC_TYPE_xxxx)
                    iRet = Ifnc_RIf_MASL_IGET_PROC_KIND();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_PROC_MODE:
                    // ｶﾚﾝﾄ処理種別	(MASL_PROC_KIND_xxxx)
                    iRet = Ifnc_RIf_MASL_IGET_PROC_MODE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_PROC_STYL:
                    // ｶﾚﾝﾄ処理ﾓｰﾄﾞ	(MASL_PROC_MODE_xxxx)
                    iRet = Ifnc_RIf_MASL_IGET_PROC_STYL();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_PROC_STL2:
                    // ｶﾚﾝﾄ処理ｽﾀｲﾙ	(MASL_PROC_STYL_xxxx)
                    iRet = Ifnc_RIf_MASL_IGET_PROC_STL2();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_TAX_RATE:
                    // ｶﾚﾝﾄ処理ｽﾀｲﾙ2	(MASL_PROC_STYL_xxxx)
                    iRet = Ifnc_RIf_MASL_IGET_TAX_RATE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_DATE_CHECK:
                    // 消費税計算
                    iRet = Ifnc_RIf_MASL_IGET_DATE_CHECK();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_MONTH_FIXED:
                    // 日付処理
                    iRet = Ifnc_RIf_MASL_IGET_MONTH_FIXED();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_CHANGEABLE:
                    // 月固定
                    iRet = Ifnc_RIf_MASL_IGET_CHANGEABLE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_FNC_OWNER:
                    // 入力・修正・削除可能の状態を取得
                    iRet = Ifnc_RIf_MASL_IGET_FNC_OWNER();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_SYORIKBN:
                    // ﾌｧﾝｸｼｮﾝのｵｰﾅｰを取得
                    iRet = Ifnc_RIf_MASL_IGET_SYORIKBN();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_FIX_LOCK:
                    // 担当者処理区分を返す
                    iRet = Ifnc_RIf_MASL_IGET_FIX_LOCK();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_TRAN_LOCK:
                    // 定型仕訳排他処理
                    iRet = Ifnc_RIf_MASL_IGET_TRAN_LOCK();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_ASCII_CODE:
                    // 仕訳修正・削除可能状態取得
                    iRet = Ifnc_RIf_MASL_IGET_ASCII_CODE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_RENSOU_MODE:
                    // 仮想ｷｰｺｰﾄﾞ を ASCIIｺｰﾄﾞ に変換
                    iRet = Ifnc_RIf_MASL_IGET_RENSOU_MODE();
                    break;
                case VKZ310Cmnu.enIfunc.MASL_IGET_SLIP_INPMODE:
                    // ---<HIS-013> ML版から移植-----------------------------------------------------
                    iRet = Ifnc_RIf_MASL_IGET_SLIP_INPMODE();
                    break;
                default:
                    // ｺｸﾖ伝票 入力ﾓｰﾄ	0:通常入力　1:貸借別々入力
                    // ------------------------------------------------------------------<HIS-013>---
                    MessageBox.Show("日常処理共通関数(Integer型)の呼び出しに無効な処理識別が使用されました。");
                    break;
            }
            result = iRet;
            return result;
        }

        public virtual int Ifnc(enIfunc enPar)
        {
            return Ifnc(enPar, null);
        }

        public virtual int Ifnc(enIfunc enPar, object pPar1)
        {
            return Ifnc(enPar, pPar1, null);
        }

        public virtual int Ifnc(enIfunc enPar, object pPar1, object pPar2)
        {
            return Ifnc(enPar, pPar1, pPar2, null);
        }

        // ******************************************************************************
        // Proccess  :	ﾀﾞﾐｰ
        // ******************************************************************************
        public string Sfnc_RSf_MASL_SGET_xxxxxxxx1()
        {
            string result;
            result = "MASL_SGET_xxxxxxxx1";
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｽﾃｰﾀｽﾊﾞｰ文字列
        // ******************************************************************************
        public string Sfnc_RSf_MASL_SGET_STATUSBAR()
        {
            string result;
            result = Stb.GetStatusBarText();
            return result;
        }

        // ******************************************************************************
        // Proccess  :	BplPath	(〜\MJSFX\MAS\PRG)
        // ******************************************************************************
        public string Sfnc_RSf_MASL_SGET_BPLPATH()
        {
            string result;
            result = Itm.m_sBplPath;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	連想ﾓｰﾄﾞ(ｷｬﾌﾟｼｮﾝ)
        // ******************************************************************************
        public string Sfnc_RSf_MASL_SGET_RENSOU_MODE()
        {
            string result;
            switch(m_iRensouMode)
            {
                case 1:
                    result = "連想 A";
                    break;
                case 2:
                    result = "連想 ｶ";
                    break;
                default:
                    result = "連想Rｶ";
                    break;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :
        // ******************************************************************************
        public string Sfnc_RSf_MASL_SGET_PAY_BILNUM()
        {
            string result;
            result = "";
            return result;
        }

        // Integer型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 日常処理共通関数(String型)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual string Sfnc(enSfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            string result;
            string sRet;
            sRet = "error";
            switch(enPar)
            {
                case VKZ310Cmnu.enSfunc.MASL_SGET_xxxxxxxx1:
                    sRet = Sfnc_RSf_MASL_SGET_xxxxxxxx1();
                    break;
                case VKZ310Cmnu.enSfunc.MASL_SGET_STATUSBAR:
                    // ﾀﾞﾐｰ
                    sRet = Sfnc_RSf_MASL_SGET_STATUSBAR();
                    break;
                case VKZ310Cmnu.enSfunc.MASL_SGET_BPLPATH:
                    // ｽﾃｰﾀｽﾊﾞｰ文字列
                    sRet = Sfnc_RSf_MASL_SGET_BPLPATH();
                    break;
                case VKZ310Cmnu.enSfunc.MASL_SGET_RENSOU_MODE:
                    // BplPath	(〜\MJSFX\MAS\PRG)
                    sRet = Sfnc_RSf_MASL_SGET_RENSOU_MODE();
                    break;
                case VKZ310Cmnu.enSfunc.MASL_SGET_PAY_BILNUM:
                    // 連想ﾓｰﾄﾞ(ｷｬﾌﾟｼｮﾝ)
                    // ---<HIS-013> ML版から移植-----------------------------------------------------
                    sRet = Sfnc_RSf_MASL_SGET_PAY_BILNUM();
                    break;
                default:
                    // ------------------------------------------------------------------<HIS-013>---
                    MessageBox.Show("日常処理共通関数(String型)の呼び出しに無効な処理識別が使用されました。");
                    break;
            }
            result = sRet;
            return result;
        }

        public virtual string Sfnc(enSfunc enPar)
        {
            return Sfnc(enPar, null);
        }

        public virtual string Sfnc(enSfunc enPar, object pPar1)
        {
            return Sfnc(enPar, pPar1, null);
        }

        public virtual string Sfnc(enSfunc enPar, object pPar1, object pPar2)
        {
            return Sfnc(enPar, pPar1, pPar2, null);
        }

        // <HIS-021> 2007/10/10 T.Yamaguchi	自作ウィンドウでの ウィンドウ内部コード表示 機能を追加
        // <HIS-060> 2009/09/07 T.Yamaguchi	ウィンドウ コードによる絞り込み機能を追加
        // ******************************************************************************
        // Proccess  :	表示ｸﾘｱ
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_Clear()
        {
            object result;
            result = null;
            SelWnd.Clear();
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ 設定
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_ParamSet()
        {
            object result;
            result = null;
            SelWnd.ParamSet(pPar1);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｳｨﾝﾄﾞｳ表示
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_Dsp()
        {
            object result;
            result = null;
            SelWnd.Dsp(ref ((TWDspParamTbl)(pPar1)));
            return result;
        }

        // ******************************************************************************
        // Proccess  :	KeyDown ｲﾍﾞﾝﾄ通知
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_KeyDown()
        {
            object result;
            ushort Key;
            Keys Shift;
            result = null;
            Key = (ushort)pPar1;
            Shift = ((pPar2) as Keys);
            SelWnd.KeyDown(ref Key, Shift);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	検索
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_SearchData()
        {
            object result;
            result = null;
            if (pPar2 == null)
            {
                SelWnd.SearchData((pPar1 as string));
            }
            else
            {
                SelWnd.SearchData((pPar1 as string), ((TWDspParamTbl)(pPar2)));
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	DB再読込
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_WndUpDate()
        {
            object result;
            result = null;
            SelWnd.WndUpdate(((TWTableID)(pPar1)));
            return result;
        }

        // ******************************************************************************
        // Proccess  :	表示中のﾍﾟｰｼﾞ 取得
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_GetDspPage()
        {
            object result;
            iWndReturn = SelWnd.GetDspPage();
            result = iWndReturn;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	表示(自作ｳｨﾝﾄﾞｳ)
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_Private_Dsp()
        {
            object result;
            // ---<HIS-021>------------------------------------------------------------------
            bool bInner;
            // ------------------------------------------------------------------<HIS-021>---
            result = null;
            // ---<HIS-021>------------------------------------------------------------------
            bInner = (pPar3 != null) && (bool)pPar3;
            SelWnd.InnerCode = bInner;
            SelWnd.Dsp(ref ((TWRecData[])(pPar1)), ((TWDspParam)(pPar2)), bInner);
            // SelWnd.Dsp(TWRecList(pPar1^), TWDspParam(pPar2^));
            // ------------------------------------------------------------------<HIS-021>---
            SelWnd.SetRecListSrc(((TWRecData[])(pPar1)), ((TWDspParam)(pPar2)));
            return result;
        }

        // ******************************************************************************
        // Proccess  :	消費税ｳｨﾝﾄﾞｳ表示ﾊﾟﾀｰﾝ 取得
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_GetWndPattern()
        {
            object result;
            stWndPattern = SelWnd.GetWndPattern(((TWDspParamTbl)(pPar1)));
            result = stWndPattern;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	検索
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_SearchDataB()
        {
            object result;
            result = null;
            if (pPar2 == null)
            {
                SelWnd.SearchData((pPar1 as string));
            }
            else
            {
                SelWnd.SearchData((pPar1 as string), (bool)pPar2);
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	連想絞込
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_RenChange()
        {
            object result;
            // ---<HIS-060>------------------------------------------------------------------
            TextBox cObj;
            int iFld;
            // 絞込対象	0:連想  1:コード
            string sRen;
            // 連想文字列
            result = null;
            cObj = ((pPar1) as TextBox);
            if (pPar2 == null)
            {
                iFld = 0;
            }
            else
            {
                iFld = (int)pPar2;
            }
            if (pPar3 == null)
            {
                sRen = "";
            }
            else
            {
                sRen = (pPar3 as string);
            }
            SelWnd.RenChange(cObj, iFld, sRen);
            return result;
        }

        // begin
        // result := nil;
        // SelWnd.RenChange(TCustomEdit(pPar1^));
        // end;
        // ------------------------------------------------------------------<HIS-060>---
        // ******************************************************************************
        // Proccess  :	適用範囲 設定
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_SetDate()
        {
            object result;
            result = null;
            SelWnd.SetDate((int)pPar1, (int)pPar2);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	固定摘要ﾁｪｯｸ
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_CheckTeki()
        {
            object result;
            bWndReturn = SelWnd.CheckTeki(((TWCTParam)(pPar1)));
            result = bWndReturn;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	ｳｨﾝﾄﾞｳﾌﾟﾛﾊﾟﾃｨ 設定
        // ******************************************************************************
        public object Wfnc_RWf_MASL_WND_PropertySet()
        {
            object result;
            result = null;
            SelWnd.PropertySet(((TWProperty)(pPar1)));
            return result;
        }

        // String型
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 日常処理共通関数(選択ウィンドウ用)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual object Wfnc(enWfunc enPar, object pPar1, object pPar2, object pPar3)
        {
            object result;
            object pRet;
            pRet = null;
            switch(enPar)
            {
                case VKZ310Cmnu.enWfunc.MASL_WND_Clear:
                    pRet = Wfnc_RWf_MASL_WND_Clear();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_ParamSet:
                    // 表示ｸﾘｱ
                    pRet = Wfnc_RWf_MASL_WND_ParamSet();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_Dsp:
                    // ｳｨﾝﾄﾞｳﾊﾟﾗﾒｰﾀ設定
                    pRet = Wfnc_RWf_MASL_WND_Dsp();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_KeyDown:
                    // ｳｨﾝﾄﾞｳ表示
                    pRet = Wfnc_RWf_MASL_WND_KeyDown();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_SearchData:
                    // Keydownｲﾍﾞﾝﾄ
                    pRet = Wfnc_RWf_MASL_WND_SearchData();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_WndUpDate:
                    // 検索
                    pRet = Wfnc_RWf_MASL_WND_WndUpDate();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_GetDspPage:
                    // DB再読込
                    pRet = Wfnc_RWf_MASL_WND_GetDspPage();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_Private_Dsp:
                    // 表示中のﾍﾟｰｼﾞ 取得
                    pRet = Wfnc_RWf_MASL_WND_Private_Dsp();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_GetWndPattern:
                    // 表示（自作）
                    pRet = Wfnc_RWf_MASL_WND_GetWndPattern();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_SearchDataB:
                    // 消費税ｳｨﾝﾄﾞｳ表示ﾊﾟﾀｰﾝ取得
                    pRet = Wfnc_RWf_MASL_WND_SearchDataB();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_RenChange:
                    // 検索
                    pRet = Wfnc_RWf_MASL_WND_RenChange();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_SetDate:
                    // 連想絞込
                    pRet = Wfnc_RWf_MASL_WND_SetDate();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_CheckTeki:
                    // 適用範囲設定
                    pRet = Wfnc_RWf_MASL_WND_CheckTeki();
                    break;
                case VKZ310Cmnu.enWfunc.MASL_WND_PropertySet:
                    // 固定摘要ﾁｪｯｸ
                    pRet = Wfnc_RWf_MASL_WND_PropertySet();
                    break;
                default:
                    // ｳｨﾝﾄﾞｳﾌﾟﾛﾊﾟﾃｨ設定
                    MessageBox.Show("日常処理共通関数(選択ウィンドウ型)の呼び出しに無効な処理識別が使用されました。");
                    break;
            }
            result = pRet;
            return result;
        }

        public virtual object Wfnc(enWfunc enPar)
        {
            return Wfnc(enPar, null);
        }

        public virtual object Wfnc(enWfunc enPar, object pPar1)
        {
            return Wfnc(enPar, pPar1, null);
        }

        public virtual object Wfnc(enWfunc enPar, object pPar1, object pPar2)
        {
            return Wfnc(enPar, pPar1, pPar2, null);
        }

        // 基本情報ゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 基本情報ゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public object GetTableList(object pPar, object pPar2)
        {
            object result;
            // HIS-IWA-0001　引数追加
            object pRetn;
            TMQuery m_FdqInfo;
            // (*db*)
            string sSel;
            string sUni;
            string sTtl;
            pRetn = null;
            if (TblList[(int)(((enTblList)(pPar)))] == null)
            {
                // 未検索
                // (* 指定されたテーブルを検索 *)
                m_FdqInfo = new TMQuery();
                m_FdqInfo = new TMQuery(PMPanelHd);
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                m_cMDModule.SetDBInfoToQuery(m_FCopDB, m_FdqInfo);
                //@ Unsupported function or procedure: 'Close'
                Close;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(D): 'Clear'
                m_FdqInfo.SQL.Clear;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                m_FdqInfo.SQL.Add("select * from");
                switch(((enTblList)(pPar)))
                {
                    case VKZ310Cmnu.enTblList.MASL_TLST_MasInfo:
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("MasInfo");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_DTMAIN:
                        // システム基本情報
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("DTMAIN");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_KmkInfo:
                        // 会社基本情報
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("KmkInfo");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_MasterInfo:
                        // 特定科目情報
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("MasterInfo");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo:
                        // マスタ基本情報
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("KbnInfo");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_TaxInfo:
                        // 区分情報
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("TaxInfo");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_KmkWinDsp:
                        // 消費税基本情報
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("KmkWinDsp");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_CashPara:
                        // 仕訳入力ｳｨﾝﾄﾞｳ表示区分
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("CashPara");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_HojyoMa:
                        // 出納帳基本パラメーター
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("HojyoMa");
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_DenInfo:
                        // 補助マスタ　HIS-IWA-0001
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("DenInfo");
                        break;
                // 伝票情報
                }
                switch(((enTblList)(pPar)))
                {
                    case VKZ310Cmnu.enTblList.MASL_TLST_CashPara:
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqInfo.SQL.Add("where BookNo=" + m_pRec.m_sParameter);
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_HojyoMa:
                        // 出納帳基本パラメーター
                        if (pPar2 != null)
                        {
                            // 補助マスタ　HIS-IWA-0001
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            m_FdqInfo.SQL.Add((pPar2 as string));
                        }
                        break;
                    case VKZ310Cmnu.enTblList.MASL_TLST_DenInfo:
                        if (pPar2 != null)
                        {
                            // 伝票種別
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            m_FdqInfo.SQL.Add((pPar2 as string));
                        }
                        break;
                }
                // テーブルすらない
                //@ Unsupported property or method(D): 'Open'
                if (!m_FdqInfo.Open)
                {
                    //@ Unsupported function or procedure: 'Close'
                    Close;
                    //@ Unsupported property or method(C): 'Free'
                    this.Free;
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(m_FdqInfo);
                    return result;
                }
                // レコード有り
                //@ Unsupported function or procedure: 'eof'
                if (!eof)
                {
                    TblList[(int)(((enTblList)(pPar)))] = m_FdqInfo;
                    pRetn = m_FdqInfo;
                }
                else
                {
                    switch(((enTblList)(pPar)))
                    {
                        case VKZ310Cmnu.enTblList.MASL_TLST_CashPara:
                            // 出納帳基本パラメーター
                            //@ Unsupported function or procedure: 'Close'
                            Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            m_FdqInfo.SQL.Clear;
                            sSel = "select " + m_pRec.m_sParameter + " as BookNo,";
                            sUni = " as TitleName union all";
                            sTtl = " as TitleName";
                            if (m_pRec.m_sParameter == '2')
                            {
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 1 as ParaKbn, 0 as AnalyzeCode,\'現金出納帳\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 2 as ParaKbn, 0 as AnalyzeCode,\'入金額\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 3 as ParaKbn, 0 as AnalyzeCode,\'出金額\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 4 as ParaKbn, 0 as AnalyzeCode,\'残　高\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 1 as AnalyzeCode,\'\'" + sTtl);
                            }
                            else if (m_pRec.m_sParameter == '3')
                            {
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 1 as ParaKbn, 0 as AnalyzeCode,\'預金出納帳\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 2 as ParaKbn, 0 as AnalyzeCode,\'預入金額\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 3 as ParaKbn, 0 as AnalyzeCode,\'引出金額\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 4 as ParaKbn, 0 as AnalyzeCode,\'残　高\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 2 as AnalyzeCode,\'\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 3 as AnalyzeCode,\'\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 4 as AnalyzeCode,\'\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 5 as AnalyzeCode,\'\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 6 as AnalyzeCode,\'\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 7 as AnalyzeCode,\'\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 8 as AnalyzeCode,\'\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn, 9 as AnalyzeCode,\'\'" + sTtl);
                            }
                            else if (m_pRec.m_sParameter == "11")
                            {
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 1 as ParaKbn, 0 as AnalyzeCode,\'売掛帳\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 2 as ParaKbn, 0 as AnalyzeCode,\'売上金額\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 3 as ParaKbn, 0 as AnalyzeCode,\'回収金額\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 4 as ParaKbn, 0 as AnalyzeCode,\'残　高\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn,12 as AnalyzeCode,\'\'" + sTtl);
                            }
                            else if (m_pRec.m_sParameter == "12")
                            {
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 1 as ParaKbn, 0 as AnalyzeCode,\'買掛帳\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 2 as ParaKbn, 0 as AnalyzeCode,\'支払金額\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 3 as ParaKbn, 0 as AnalyzeCode,\'仕入金額\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + " 4 as ParaKbn, 0 as AnalyzeCode,\'残　高\'" + sUni);
                                //@ Unsupported property or method(D): 'SQL'
                                //@ Unsupported property or method(B): 'Add'
                                m_FdqInfo.SQL.Add(sSel + "11 as ParaKbn,39 as AnalyzeCode,\'\'" + sTtl);
                            }
                            //@ Unsupported property or method(D): 'Open'
                            m_FdqInfo.Open;
                            TblList[(int)(((enTblList)(pPar)))] = m_FdqInfo;
                            pRetn = m_FdqInfo;
                            break;
                        default:
                            //@ Unsupported function or procedure: 'Close'
                            Close;
                            //@ Unsupported property or method(C): 'Free'
                            this.Free;
                            break;
                    }
                }
            }
            else
            {
                // (* 指定されたテーブルを保管されたリストから取得 *)
                pRetn = TblList[(int)(((enTblList)(pPar)))];
            }
            result = pRetn;
            return result;
        }

        // HIS-IWA-0001　引数追加
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 基本情報ゲット（再読み込み）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public object RefTableList(object pPar, object pPar2)
        {
            object result;
            int iIndex;
            switch(((enTblList)(pPar)))
            {
                //@ Unsupported function: 'Low'
                //@ Unsupported function: 'High'
                // Modify the A .. B: Low(enTblList) .. High(enTblList)
                case Low(enTblList):
                    iIndex = (int)(((enTblList)(pPar)));
                    if (TblList[iIndex] != null)
                    {
                        //@ Undeclared identifier(3): 'TMQuery'
                        //@ Unsupported property or method(D): 'Close'
                        TMQuery(TblList[iIndex]).Close;
                        //@ Undeclared identifier(3): 'TMQuery'
                        //@ Unsupported property or method(D): 'Free'
                        TMQuery(TblList[iIndex]).Free;
                        //@ Unsupported function or procedure: 'Dispose'
                        Dispose(TblList[iIndex]);
                        TblList[iIndex] = null;
                    }
                    break;
            }
            result = GetTableList(pPar, pPar2);
            return result;
        }

        // （再読み込み）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 科目１件ゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void GetKamokuMaster(int iKmkGCode, object pFdqKmk)
        {
            string sTNo;
            if ((m_cMDModule != null) && (m_FCopDB != null))
            {
                if (pFdqKmk != null)
                {
                    sTNo = (iKmkGCode).ToString();
                    //@ Undeclared identifier(3): 'TMQuery'
                    TMQuery(pFdqKmk) = new TMQuery(PMPanelHd);
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FCopDB, TMQuery(pFdqKmk));
                    //@ Undeclared identifier(3): 'TMQuery'
                     _wvar1 = TMQuery(pFdqKmk);
                    //@ Unsupported function or procedure: 'Close'
                    Close;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    _wvar1.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.SQL.Add("select * from KmkMA");
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.SQL.Add("where ((MasterKbn=1)and(SumKbn=0)and(RecordKbn=0)and (GCode=" + sTNo + "))");
                    //@ Unsupported property or method(D): 'Open'
                    _wvar1.Open;
                }
            }
        }

        // 選択ウィンドウカバー関数
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // バランス金額,色,入力件数セット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetBalance()
        {
            TMQuery m_FdqSwk;
            // (*db*)
            int iSwkInpKensu;
            decimal cSwkSum;
            int iInMonth;
            int iBalColor;
            int iTanGCode;
            string sTableCode;
            // ♪♪♪♪♪
            sTableCode = "";
            switch(m_pRec.m_iProgramCode)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                    // (*H0038 20030904 khattori	分散入力<単一入力>*)
                    // 単一入力分散仕訳指示
                    // ミロク型指示
                    // コクヨ型指示
                    // 入金伝票指示
                    // 出金伝票指示
                    // 仮払精算指示
                    iTanGCode = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).TantoGCD;
                    if (iTanGCode ==  -1)
                    {
                        iTanGCode = 0;
                    }
                    //@ Unsupported function or procedure: 'Format'
                    sTableCode = "BUN" + Format("%0.8d", new int[] {iTanGCode});
                    break;
            }
            // ♪♪♪♪♪
            iInMonth = Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_INN_MONTH);
            if ((m_cMDModule != null) && (m_FCopDB != null))
            {
                m_FdqSwk = new TMQuery(PMPanelHd);
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                m_cMDModule.SetDBInfoToQuery(m_FCopDB, m_FdqSwk);
                cSwkSum = 0;
                iSwkInpKensu = 0;
                iBalColor = System.Drawing.Color.Black;
                //@ Unsupported function or procedure: 'Close'
                Close;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(D): 'Clear'
                m_FdqSwk.SQL.Clear;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                m_FdqSwk.SQL.Add("select SwkENum from SwkCInfo" + sTableCode);
                // SQL.Add('select SwkENum from SwkCInfo');
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                m_FdqSwk.SQL.Add("where ((SwkCKbn=1) and (" + (iInMonth).ToString() + "=nmonth))");
                //@ Unsupported property or method(D): 'Open'
                m_FdqSwk.Open;
                //@ Unsupported function or procedure: 'eof'
                if (!eof)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iSwkInpKensu = m_FdqSwk.GetFld("SwkENum").AsInteger;
                    //@ Unsupported function or procedure: 'Close'
                    Close;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    m_FdqSwk.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    m_FdqSwk.SQL.Add("select sum(DebitSum-CreditSum) SSum from SwkBalance" + sTableCode);
                    // SQL.Add('select sum(DebitSum-CreditSum) SSum from SwkBalance');
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    m_FdqSwk.SQL.Add("where ((SwkCKbn=1) and (" + (iInMonth).ToString() + "=nmonth))");
                    //@ Unsupported property or method(D): 'Open'
                    m_FdqSwk.Open;
                    //@ Unsupported function or procedure: 'eof'
                    if (!eof)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsCurrency'
                        cSwkSum = m_FdqSwk.GetFld("SSum").AsCurrency;
                        if (cSwkSum == 0)
                        {
                            //@ Unsupported function or procedure: 'Close'
                            Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            m_FdqSwk.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            m_FdqSwk.SQL.Add("select count(*) DailyBal from SwkBalance" + sTableCode);
                            // SQL.Add('select count(*) DailyBal from SwkBalance');
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            m_FdqSwk.SQL.Add("where ((SwkCKbn=1) and (" + (iInMonth).ToString() + "=nmonth))");
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            m_FdqSwk.SQL.Add("and (DebitSum<>CreditSum)");
                            //@ Unsupported property or method(D): 'Open'
                            m_FdqSwk.Open;
                            //@ Unsupported function or procedure: 'eof'
                            if (!eof)
                            {
                                //@ Unsupported property or method(B): 'GetFld'
                                //@ Unsupported property or method(D): 'AsInteger'
                                if (m_FdqSwk.GetFld("DailyBal").AsInteger != 0)
                                {
                                    iBalColor = System.Drawing.Color.Red;
                                }
                            }
                        }
                    }
                }
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_INP_COUNT, iSwkInpKensu, cSwkSum, iBalColor);
                // Vfnc(MASL_VSET_BAL_AMONT,@cSwkSum);
                // Vfnc(MASL_VSET_INP_COUNT,@iSwkInpKensu);
                // Vfnc(MASL_VSET_BAL_COLOR,@iBalColor);
                //@ Unsupported function or procedure: 'Close'
                Close;
                //@ Unsupported property or method(D): 'Free'
                m_FdqSwk.Free;
            }
        }

        // 科目１件ゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 定型仕訳　パラメータ　ゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public virtual void GetFxPara(out string sTForm, out string sTClass)
        {
            TMASL310IFunc rFunc;
            // SwkForm
            sTForm = m_pRec.m_sParameter;
            // ---<HIS-046>------------------------------------------------------------------
            if ((sTForm == "") || (sTForm == "300"))
            {
                sTForm = '1';
            }
            // if		sTForm = ''				then sTForm := '1';
            // ------------------------------------------------------------------<HIS-046>---
            if (Convert.ToInt32(sTForm) > 100)
            {
                // if		strtoint(sTForm)>100	then sTForm := inttostr(strtoint(sTForm)-100)
                sTForm = (Convert.ToInt32(sTForm) % 100).ToString();
            }
            else if (Convert.ToInt32(sTForm) > 1)
            {
                sTForm = '2';
            }
            // TeikeiClass
            sTClass = '0';
            // 伝票か？
            if (Convert.ToInt32('0' + m_pRec.m_sParameter) > 100)
            {
                // 第１指示取得
                rFunc = Itm.ReadIniRec(iFirstCode);
                // 第１指示取得が定型登録でも定型入力でもない
                if ((rFunc.iMode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU) && (rFunc.iMode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU))
                {
                    // 第２指示取得
                    rFunc = Itm.ReadIniRec(iSecondCode);
                }
                sTClass = (rFunc.iNumb).ToString();
            // 出納帳か？
            }
            else if (Convert.ToInt32('0' + m_pRec.m_sParameter) > 1)
            {
                sTClass = m_pRec.m_sParameter;
            }
        }

        // 定型仕訳　パラメータ　ゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 定型仕訳ゲット	(*H0007 20010921 tyamaguchi 定型仕訳対応*)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void GetFxHead(object pFdqFx, int iTeikeiNo, int iInpKbn)
        {
            string sTNo;
            string sInpKbn;
            string sTForm;
            string sTClass;
            if ((m_cMDModule != null) && (m_FCopDB != null))
            {
                if (pFdqFx != null)
                {
                    sTNo = (iTeikeiNo).ToString();
                    sInpKbn = (iInpKbn).ToString();
                    // 定型仕訳　パラメータ　ゲット
                    GetFxPara(out sTForm, out sTClass);
                    //@ Undeclared identifier(3): 'TMQuery'
                    TMQuery(pFdqFx) = new TMQuery(null);
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FCopDB, TMQuery(pFdqFx));
                    //@ Undeclared identifier(3): 'TMQuery'
                     _wvar1 = TMQuery(pFdqFx);
                    //@ Unsupported function or procedure: 'Close'
                    Close;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    _wvar1.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.SQL.Add("select * from SwkFxHead Where SwkForm=" + sTForm + " and TeikeiClass=" + sTClass);
                    if (iTeikeiNo < 0)
                    {
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        _wvar1.SQL.Add(" Order By GCode");
                    }
                    else
                    {
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        _wvar1.SQL.Add(" and GCode=" + sTNo);
                    }
                    if (iInpKbn < 0)
                    {
                        if (iTeikeiNo < 0)
                        {
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            _wvar1.SQL.Add(" ,SwkInpKbn");
                        }
                        else
                        {
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            _wvar1.SQL.Add(" Order By SwkInpKbn");
                        }
                    }
                    else
                    {
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        _wvar1.SQL.Add(" and SwkInpKbn=" + sInpKbn);
                    }
                    //@ Unsupported property or method(D): 'Open'
                    _wvar1.Open;
                    if (iTeikeiNo > 0)
                    {
                        //@ Unsupported property or method(B): 'GetFld'
                        //@ Unsupported property or method(D): 'AsInteger'
                        iFixHNo = _wvar1.GetFld("HSrchNo").AsInteger;
                    }
                }
            }
        }

        // 定型仕訳ゲット	2001/09/21 Ins
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 定型仕訳明細１件ゲット	(*H0007 20010921 tyamaguchi 定型仕訳対応*)
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void GetFxDetail(object pFdqFx)
        {
            string sTNo;
            if ((m_cMDModule != null) && (m_FCopDB != null))
            {
                if (pFdqFx != null)
                {
                    sTNo = (iFixHNo).ToString();
                    //@ Undeclared identifier(3): 'TMQuery'
                    TMQuery(pFdqFx) = new TMQuery(null);
                    //@ Undeclared identifier(3): 'TMQuery'
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FCopDB, TMQuery(pFdqFx));
                    //@ Undeclared identifier(3): 'TMQuery'
                     _wvar1 = TMQuery(pFdqFx);
                    //@ Unsupported function or procedure: 'Close'
                    Close;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    _wvar1.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    _wvar1.SQL.Add("select first * from SwkFxDetail where HSrchNo=" + sTNo);
                    //@ Unsupported property or method(D): 'Open'
                    _wvar1.Open;
                }
            }
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ドリルダウンパラメーターセット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void SetDrillParam(object pPar)
        {
            enDrillStatus Status;
            TMASL310IDrill pDrilFr;
            TMASL310IDrill pDrilTo;
            // iLevel:=m_pDrillLevel;
            Status = ((enDrillStatus)(pPar));
            if (Status == VKZ310Cmnu.enDrillStatus.MASL_DRILL_END)
            {
                Status = VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_CHILD;
            }
            switch(Status)
            {
                case VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_CHILD:
                    if (m_pDrillLevel > 0)
                    {
                        pDrilFr = m_pDrillChild[m_pDrillLevel];
                        m_pDrillLevel = m_pDrillLevel - 1;
                        pDrilTo = m_pDrillChild[m_pDrillLevel];
                        pDrilTo.FrCld = pDrilFr.ToPar;
                        pDrilTo.Status = Status;
                    }
                    break;
                case VKZ310Cmnu.enDrillStatus.MASL_DRILL_BASE:
                    m_pDrillLevel = 0;
                    pDrilTo = m_pDrillChild[m_pDrillLevel];
                    pDrilTo.ToCld = rParaNew;
                    pDrilTo.FrCld = rParaNew;
                    break;
                case VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT:
                    pDrilFr = m_pDrillChild[m_pDrillLevel];
                    m_pDrillLevel = m_pDrillLevel + 1;
                    pDrilTo = m_pDrillChild[m_pDrillLevel];
                    pDrilTo.FrPar = pDrilFr.ToCld;
                    pDrilTo.ToCld = rParaNew;
                    pDrilTo.Mine = rParaNew;
                    pDrilTo.FrCld = rParaNew;
                    pDrilTo.ToPar = rParaNew;
                    pDrilTo.Status = Status;
                    break;
            }
            // Stb.SetStatusBarText(IntToStr(iLevel)+' <-> '+IntToStr(m_pDrillLevel));

        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ドリルダウンパラメーターゲット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public object GetDrillParam(object pPar)
        {
            object result;
            object pRetn;
            int index;
            pRetn = null;
            if (pPar == null)
            {
                index = m_pDrillLevel;
            }
            else
            {
                index = (int)pPar;
            }
            if ((index >= 0) && (index <= (m_pDrillChild.Count - 1)))
            {
                pRetn = m_pDrillChild[index];
            }
            result = pRetn;
            return result;
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ドリルダウンパラメーターセット
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void CreateDrillParam(object pPar)
        {
            int iLoop;
            TMASL310IDrill pDrilNew;
            TMASL310IDrParam pParaNew;
            // 最初の時のみ
            if (m_pDrillChild == null)
            {
                rParaNew.Efct = false;
                m_pDrillLevel = 0;
                m_pDrillChild = new ArrayList();
                for (iLoop = 0; iLoop <= 4; iLoop ++ )
                {
                    pDrilNew = new TMASL310IDrill();
                    pDrilNew.ProcCd = 0;
                    pDrilNew.Status = VKZ310Cmnu.enDrillStatus.MASL_DRILL_NORMAL;
                    pDrilNew.Root = ((TMASL310IParam)(pPar));
                    pParaNew = new TMASL310IDrParam();
                    pDrilNew.FrPar = (pParaNew as object);
                    pDrilNew.FrPar = rParaNew;
                    pParaNew = new TMASL310IDrParam();
                    pDrilNew.ToCld = (pParaNew as object);
                    pDrilNew.ToCld = rParaNew;
                    pParaNew = new TMASL310IDrParam();
                    pDrilNew.Mine = (pParaNew as object);
                    pDrilNew.Mine = rParaNew;
                    pParaNew = new TMASL310IDrParam();
                    pDrilNew.FrCld = (pParaNew as object);
                    pDrilNew.FrCld = rParaNew;
                    pParaNew = new TMASL310IDrParam();
                    pDrilNew.ToPar = (pParaNew as object);
                    pDrilNew.ToPar = rParaNew;
                    m_pDrillChild.Add(pDrilNew);
                }
            }
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ドリルダウンパラメーター破棄
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public void DeleteDrillParam()
        {
            int iLoop;
            TMASL310IDrill pDrilNew;
            if (m_pDrillChild != null)
            {
                for (iLoop = 0; iLoop <= 4; iLoop ++ )
                {
                    pDrilNew = m_pDrillChild[iLoop];
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pDrilNew.FrPar);
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pDrilNew.ToCld);
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pDrilNew.Mine);
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pDrilNew.FrCld);
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pDrilNew.ToPar);
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pDrilNew);
                }
                m_pDrillChild.Clear();
                //@ Unsupported property or method(C): 'Free'
                m_pDrillChild.Free;
            }
        }

        // 定型仕訳ゲット	2001/09/21 Ins
        // インクリメント
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // インクリメント
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public int Rinc(ref int iNum)
        {
            int result;
            iNum = iNum + 1;
            result = iNum;
            return result;
        }

        // デクリメント
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // デクリメント
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public int Rdec(ref int iNum)
        {
            int result;
            iNum = iNum - 1;
            result = iNum;
            return result;
        }

        // カンマ削除
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // カンマ削除
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public string RCnm(ref string sCnm)
        {
            string result;
            if ((sCnm.Substring(sCnm.Length - 1 ,1) == ','))
            {
                sCnm = sCnm.Substring(1 - 1 ,sCnm.Length - 1);
            }
            result = sCnm;
            return result;
        }

        // 不正文字検索
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // 不正文字検索
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public int RChk(string sCnm)
        {
            int result;
            int index;
            string sChar;
            int iReturn;
            iReturn = 1;
            for (index = 1; index <= sCnm.Length; index ++ )
            {
                sChar = sCnm.Substring(index - 1 ,1);
                if ((sChar < '0') || (sChar > '9'))
                {
                    iReturn = 0;
                }
                if ((sChar == '-'))
                {
                    iReturn = 2;
                }
                if (iReturn != 1)
                {
                    break;
                }
            }
            result = iReturn;
            return result;
        }

        // (*H0048 20050516 khattori	操作ガイド番号通知*)
        // ******************************************************************************
        // Function	:	fnHelpIndexSet												<HELP>
        // ******************************************************************************
        public void DoAction_fnHelpIndexSet()
        {
            TAppParam AppPara;
            rcHELPINFO rcHLP;
            // ＡＬUのみ動作
#if _WANTYPE_NEW_
            rcHLP.Code1 = m_pRec.m_iProgramCode;
            rcHLP.Code2 = 0;
            AppPara.iAction = Units.MAS310000u.ACTID_HELPINDEXSET;
            AppPara.pRecord = (m_pRec as object);
            AppPara.pActionParam = rcHLP;
            ((m_pRec) as TMjsAppRecord).m_pOwnerEntry(AppPara);
#endif

        }

        // バランス金額,色,入力件数セット
        // ******************************************************************************
        // Proccess	:	DoAction処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	rFunc	:	TMASL310IFunc
        // Return		:	Nothing
        // ******************************************************************************
        public virtual bool DoAction(TMASL310IFunc rFunc, enDrillStatus Status, object pParam)
        {
            bool result;
            int iPage;
            TMjsAppRecord pRec;
            string sProgNew;
            string sProgOld;
            string sProgDrl;
            bool bVal1;
            bool bRetn;
            int iProc;
            DialogResult tResult;
            TMASL310IDrill cDrill;
            int idx;
            bRetn = false;
            // if	rFunc=nil	then	rFunc:=m_rDefaultFunc^;
            // (*　指示ヘッダーパネル上のパーツをクリックされたとき　*)
            // (*　（自分のみ残す）　*)
            if (Status == VKZ310Cmnu.enDrillStatus.MASL_DRILL_BASE)
            {
                for (idx = 1; idx <= BplList.Count; idx ++ )
                {
                    cDrill = ((TMASL310IDrill)(GetDrillParam(idx)));
                    // (*H0010 20010928 khattori	更新確認のＣａｎｃｅｌボタン*)
                    if (cDrill.Mine.bCall)
                    {
                        if (cDrill.Mine.TCall == System.Windows.Forms.DialogResult.Cancel)
                        {
                            // 仕訳更新
                            result = false;
                            return result;
                        }
                    }
                }
                //@ Undeclared identifier(3): 'MASSetCaption'
                MASSetCaption(m_pRec);
                // (*H0048 20050516 khattori	操作ガイド番号通知*)
                DoAction_fnHelpIndexSet();
                m_DrillBalance = 0;
                if (m_pDrillLevel > 0)
                {
                    BplUnLoad(2);
                    // Bpl解放
                    BplListUpdate();
                // Bplﾘｽﾄの整理
                }
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DRL_PARM, Status);
            // (*　集計か？　*)
            }
            else if (Itm.ReadIniInt(rFunc.iOpCode, "Levl") == 800)
            {
                // (*Ver Axxx Mxxx*)
                // (*H0031 20020501 khattori 分散入力*)
                if (LogWrite("CheckIsDpsMode"))
                {
                    if (pParam != null)
                    {
                        ((MAS320100DSIParam)(pParam)).Jnl1[5] = (m_pRec.m_iProgramCode);
                    }
                }
                // ロードされていない
                pRec = (((rp_DialogRec[Itm.ReadIniInt(rFunc.iOpCode, "Numb")]) as TMjsAppRecord));
                if (pRec == null)
                {
                    pRec = BplLoad(rFunc, pParam);
                    if (pRec == null)
                    {
                        result = bRetn;
                        return result;
                    }
                    rp_DialogRec[Itm.ReadIniInt(rFunc.iOpCode, "Numb")] = (pRec as object);
                }
                pRec.m_iProgramCode = rFunc.iOpCode;
                // 20001107
                BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec, pParam);
            // (*　ダイアログか？　*)
            }
            else if (Itm.ReadIniInt(rFunc.iOpCode, "Levl") == 900)
            {
                // ロードされていない
                pRec = (((rp_DialogRec[Itm.ReadIniInt(rFunc.iOpCode, "Numb")]) as TMjsAppRecord));
                if (pRec == null)
                {
                    // ---<HIS-004>------------------------------------------------------------------
                    if (rFunc.iNumb == (int)(((enDialogID)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld))))
                    {
                        pRec = CreateCldFormDLg(rFunc);
                    }
                    else
                    {
                        pRec = BplLoad(rFunc);
                    }
                    // pRec:=BplLoad(rFunc);
                    // ------------------------------------------------------------------<HIS-004>---
                    if (pRec == null)
                    {
                        result = bRetn;
                        return result;
                    }
                    rp_DialogRec[Itm.ReadIniInt(rFunc.iOpCode, "Numb")] = (pRec as object);
                }
                pRec.m_iProgramCode = rFunc.iOpCode;
                // 20001107
                // バランスの時
                // 0
                if (Itm.ReadIniInt(rFunc.iOpCode, "Numb") == (int)(((enDialogID)(VKZ310Cmnu.enDialogID.MASL_Dlg_Bal))))
                {
                    m_DrillBalance = 1;
                    tResult = (((pRec.m_pChildForm)) as Form).ShowDialog();
                    if (tResult != System.Windows.Forms.DialogResult.OK)
                    {
                        m_DrillBalance = 0;
                    }
                    if (tResult == System.Windows.Forms.DialogResult.Retry)
                    {
                        BplAction(Units.MAS310000u.ACTID_FREESTART + 1, pRec);
                    }
                // ---<HIS-001><HIS-007>---------------------------------------------------------
                // Excel取込の時
                }
                // 0
                else if (Itm.ReadIniInt(rFunc.iOpCode, "Numb") == (int)(((enDialogID)(VKZ310Cmnu.enDialogID.MASL_Dlg_Exc))))
                {
                    try {
                        if (SetExceptSubPrg(0))
                        {
                            // 排他(会社別処理単独)
                            tResult = (((pRec.m_pChildForm)) as Form).ShowDialog();
                        }
                    } finally {
                        SetExceptSubPrg(1);
                    // 排他(会社別処理単独)
                    }
                // ---------------------------------------------------------<HIS-001><HIS-007>---
                // ---<HIS-004><HIS-007>---------------------------------------------------------
                // 子フォーム表示用ダイアログの時
                }
                else if (rFunc.iNumb == (int)(((enDialogID)(VKZ310Cmnu.enDialogID.MASL_Dlg_Cld))))
                {
                    try {
                        if (SetExceptSubPrg(0))
                        {
                            // 排他(会社別処理単独)
                            pRec.m_pMARData[0] = rFunc;
                            BplAction(Units.MAS310000u.ACTID_SHOWMODAL, pRec);
                        }
                    } finally {
                        SetExceptSubPrg(1);
                    // 排他(会社別処理単独)
                    }
                // ---------------------------------------------------------<HIS-004><HIS-007>---
                }
                else
                {
                    Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DRL_PARM, Status);
                    (((pRec.m_pChildForm)) as Form).ShowDialog();
                    Status = VKZ310Cmnu.enDrillStatus.MASL_DRILL_END;
                    Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DRL_PARM, Status);
                    ProcSelect();
                }
            // (*　キーオペレーションで終了されたとき　*)
            // (*　（自分以降のみ終了する）　*)
            }
            else if (Status == VKZ310Cmnu.enDrillStatus.MASL_DRILL_END)
            {
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_ACTV_CTRL, null);
                // (*ver5*)
                // (*H0011 20011116 khattori	ドリルダウンがマスタ更新してくれない？*)
                // なぜかコメントになっていたので復活！
                cDrill = ((TMASL310IDrill)(GetDrillParam(m_pDrillLevel)));
                if (cDrill.Mine.bCall)
                {
                    cDrill.Mine.TCall;
                }
                // 仕訳更新
                // cDrill	:=	TMASL310IDrill(GetDrillParam(@m_pDrillLevel)^);
                // if	cDrill.Mine^.bCall	then	cDrill.Mine^.TCall;	//	仕訳更新
                BplUnLoad(1);
                // Bpl解放
                BplListUpdate();
                // Bplﾘｽﾄの整理
                Status = VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_CHILD;
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DRL_PARM, Status);
                if (m_pDrillLevel > 0)
                {
                    rFunc = Itm.ReadIniRec(((BplList[m_pDrillLevel - 1]) as TMjsAppRecord).m_iProgramCode);
                }
                else
                {
                    rFunc = Itm.ReadIniRec(((BplList[0]) as TMjsAppRecord).m_iProgramCode);
                }
                Ind.SetBrother(rFunc.iOpCode);
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_CODE, rFunc.iOpCode);
                // カレント処理ｺｰﾄﾞ
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_TYPE, rFunc.iType);
                // カレント処理モード
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_MODE, rFunc.iMode);
                // カレント処理動作
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_STYL, rFunc.iStyl);
                // カレント処理形態
                if (m_pDrillLevel > 0)
                {
                    bVal1 = false;
                    if (rFunc.bWndUV)
                    {
                        Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_WND_VSBLE, bVal1);
                    }
                    ProcSelect();
                }
                else
                {
                    if (m_DrillBalance == 1)
                    {
                        DoAction(Itm.ReadIniRec(VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_BALANCE));
                    }
                    if (m_DrillBalance == 0)
                    {
                        //@ Undeclared identifier(3): 'MASSetCaption'
                        MASSetCaption(m_pRec);
                        // (*H0048 20050516 khattori	操作ガイド番号通知*)
                        DoAction_fnHelpIndexSet();
                        // (*H0009 20010926 khattori 定型仕訳 戻り場所を定型ＮＯに*)
                        // MASL_PROC_MODE_TEIKEITOUROKU	=	7;	//	定型仕訳登録
                        // MASL_PROC_MODE_TEIKEINYUURYOKU	=	71;	//	定型仕訳入力
                        // MASL_PROC_MODE_TEIKEISYUUSEI	=	72;	//	定型仕訳登録[修正・表示修正型]
                        // MASL_PROC_MODE_TEIKEISYUUSEI2	=	73;	//	定型仕訳登録[修正・行ＮＯ指定型]
                        // if	(rFunc.iMode in [	MASL_PROC_MODE_TEIKEITOUROKU,
                        // MASL_PROC_MODE_TEIKEINYUURYOKU,
                        // MASL_PROC_MODE_TEIKEISYUUSEI,
                        // MASL_PROC_MODE_TEIKEISYUUSEI2	])//	and
                        // (EMNumEditFx_No.CanFocus)
                        //@ Unsupported property or method(C): 'Value'
                        //@ Unsupported property or method(C): 'Parent'
                        //@ Unsupported property or method(D): 'Parent'
                        //@ Unsupported property or method(D): 'Visible'
                        if ((EMNumEditFx_No.Value > 0) && (EMNumEditFx_No.Parent.Parent.Visible == true))
                        {
                            //@ Unsupported property or method(C): 'Parent'
                            //@ Unsupported property or method(D): 'Parent'
                            //@ Unsupported property or method(D): 'Enabled'
                            EMNumEditFx_No.Parent.Parent.Enabled = true;
                            //@ Unsupported property or method(C): 'Parent'
                            //@ Unsupported property or method(D): 'Enabled'
                            EMNumEditFx_No.Parent.Enabled = true;
                            //@ Unsupported property or method(C): 'Enabled'
                            EMNumEditFx_No.Enabled = true;
                            // EMNumEditFx_No.ParentColor := false;
                            // EMNumEditFx_No.Color := clWindow;
                            //@ Unsupported property or method(C): 'Value'
                            EMNumEditFx_No.Value = 0;
                            //@ Unsupported property or method(C): 'InputFlag'
                            EMNumEditFx_No.InputFlag = true;
                            //@ Unsupported property or method(C): 'SetFocus'
                            EMNumEditFx_No.SetFocus;
                        }
                        // if		PMComboBox3.CanFocus
                        //@ Unsupported property or method(C): 'CanFocus'
                        else if (PMComboBox3.CanFocus)
                        {
                            // 第一指示へ戻る
                            //@ Unsupported property or method(C): 'SetFocus'
                            PMComboBox3.SetFocus;
                        }
                        else
                        {
                            //@ Unsupported property or method(C): 'SetFocus'
                            PMComboBox2.SetFocus;
                        }
                    // 月入力へ戻る
                    }
                }
            // (*　プログラムを呼び出すとき　*)
            }
            else
            {
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_ACTV_CTRL, null);
                sProgNew = rFunc.sProg;
                sProgOld = (Itm.ReadIniRec(Ifnc(VKZ310Cmnu.enIfunc.MASL_IGET_PROC_CODE))).sProg;
                sProgDrl = "";
                if ((BplList.Count > m_pDrillLevel) && (m_pDrillLevel > 0))
                {
                    sProgDrl = Itm.ReadIniRec(((BplList[m_pDrillLevel]) as TMjsAppRecord).m_iProgramCode).sProg;
                }
                // ロードされていない
                if ((sProgNew != sProgOld) && (sProgNew != sProgDrl))
                {
                    // ---<HIS-036>------------------------------------------------------------------
                    // 伝票へのドリルダウンで、ミロク＜−＞コクヨ等でおかしくなる
                    if ((m_pDrillLevel > 0))
                    {
                        BplUnLoad(1);
                    // Bpl解放
                    }
                    // ------------------------------------------------------------------<HIS-036>---
                    // 第１レベル
                    else if ((Status != VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT) || ((m_DrillBalance == 1) && (m_pDrillLevel == 0)))
                    {
                        BplUnLoad;
                    // Bpl解放
                    }
                    BplListUpdate();
                    // Bplﾘｽﾄの整理
                    bVal1 = false;
                    pRec = BplLoad(rFunc);
                    if (pRec == null)
                    {
                        if (m_pDrillLevel == 0)
                        {
                            iProc = 0;
                            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_CODE, iProc);
                            // カレント処理ｺｰﾄﾞ
                            m_DrillBalance = 0;
                        }
                        result = bRetn;
                        return result;
                    }
                    BplList.Add(pRec);
                // Bplﾘｽﾄに追加
                }
                else
                {
                    Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_CODE, rFunc.iOpCode);
                    // カレント処理ｺｰﾄﾞ
                    Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_TYPE, rFunc.iType);
                    // カレント処理モード
                    Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_MODE, rFunc.iMode);
                    // カレント処理動作
                    Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_STYL, rFunc.iStyl);
                    // カレント処理形態
                    pRec = BplList[m_pDrillLevel];
                    //@ Unsupported property or method(D): 'm_iProgramCode'
                    pRec.m_iProgramCode = rFunc.iOpCode;
                }
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VINI_FNC_ITEM);
                iPage = 0;
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_FNC_PAGE, iPage);
                Status = VKZ310Cmnu.enDrillStatus.MASL_DRILL_FRM_PARENT;
                Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_DRL_PARM, Status);
                if (rFunc.bWndUV)
                {
                    Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_WND_VSBLE, bVal1);
                }
                ProcSelect();
            }
            bRetn = true;
            result = bRetn;
            return result;
        }

        public virtual bool DoAction(TMASL310IFunc rFunc)
        {
            return DoAction(rFunc, VKZ310Cmnu.enDrillStatus.MASL_DRILL_NORMAL);
        }

        public virtual bool DoAction(TMASL310IFunc rFunc, enDrillStatus Status)
        {
            return DoAction(rFunc, Status, null);
        }

        // ******************************************************************************
        // Proccess	:	BplLoad処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	rFunc	:	TMASL310IFunc
        // Return		:	Nothing
        // ******************************************************************************
        public object BplLoad(TMASL310IFunc rFunc, object pParam)
        {
            object result;
            TMjsAppRecord pRec;
            TMjsMsgRec inforec;
            pRec = new TMjsAppRecord();
            // ﾊﾟﾗﾒｰﾀ作成
            pRec = m_pRec;
            pRec.m_iProgramCode = rFunc.iOpCode;
            // iApNo;
            pRec.m_iDelete = 0;
            // 削除ﾌﾗｸﾞ		設定
            result = null;
            try {
                //@ Unsupported function or procedure: 'LoadPackage'
                pRec.m_hChildBpl = LoadPackage(rFunc.sProg);
            }
            catch {
                LogWrite(rFunc.sProg);
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMSG'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(inforec, 20, 3);
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'MsgChange'
                //@ Unsupported property or method(D): 'sMsg'
                inforec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "@_@", "\r\n" + "\r\n" + '[' + (rFunc.iOpCode).ToString() + "] " + rFunc.sCaption);
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef);
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
                return result;
            }
            //@ Unsupported function or procedure: 'GetProcAddress'
            pRec.m_pChildEntry = GetProcAddress(pRec.m_hChildBpl, "AppEntry");
            // Export関数ｱﾄﾞﾚｽの取得
            if (pRec.m_pChildEntry == null)
            {
                // (*H0001	20010522 khattori 初期処理失敗時のメッセージに出す処理名*)
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMSG'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(inforec, 20, 3);
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'MsgChange'
                //@ Unsupported property or method(D): 'sMsg'
                inforec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "@_@", "\r\n" + "\r\n" + '[' + (rFunc.iOpCode).ToString() + "] " + rFunc.sCaption);
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef);
                // Application.MessageBox( 'AppEntry() 関数アドレスの取得に失敗しました。', 'エラー', MB_OK + MB_ICONERROR );
                //@ Unsupported function or procedure: 'UnLoadPackage'
                UnLoadPackage(pRec.m_hChildBpl);
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
                return result;
            }
            pRec.m_pChildForm = null;
            // 子BplFormのﾎﾟｲﾝﾀ
            pRec.m_pOwnerEntry = MAS310000CldFormDlgu.Units.MAS310000CldFormDlgu.AppEntry();
            // 親BplのAppEntry
            // pRec^.m_pOwnerForm		:= @Form;				//	親bplFormのﾎﾟｲﾝﾀ
            pRec.m_pOwnerForm = m_pRec.m_pChildForm;
            // 親bplFormのﾎﾟｲﾝﾀ
            pRec.m_pOwnerPanel = PMPanelAp;
            // 親BplのPanelﾎﾟｲﾝﾀ
            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_CODE, rFunc.iOpCode);
            // カレント処理ｺｰﾄﾞ
            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_TYPE, rFunc.iType);
            // カレント処理モード
            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_MODE, rFunc.iMode);
            // カレント処理動作
            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_STYL, rFunc.iStyl);
            // カレント処理形態
            if (BplAction(Units.MAS310000u.ACTID_FORMCREATESTART, pRec, pParam) != Units.MAS310000u.ACTID_RET_OK)
            {
                // Create
                // (*H0001	20010522 khattori 初期処理失敗時のメッセージに出す処理名*)
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMSG'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(inforec, 20, 3);
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'MsgChange'
                //@ Unsupported property or method(D): 'sMsg'
                inforec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "@_@", "\r\n" + "\r\n" + '[' + (rFunc.iOpCode).ToString() + "] " + rFunc.sCaption);
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef);
                // Application.MessageBox( '「ACTID_FORMCREATESTART」に失敗しました。', 'エラー', MB_OK + MB_ICONERROR );
                //@ Unsupported function or procedure: 'UnLoadPackage'
                UnLoadPackage(pRec.m_hChildBpl);
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
                return result;
            }
            result = pRec;
            return result;
        }

        public object BplLoad(TMASL310IFunc rFunc)
        {
            return BplLoad(rFunc, null);
        }

        // ******************************************************************************
        // Proccess	:	Bplへの処理実行
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	iAction
        // pRec
        // Return		:	Integer
        // ******************************************************************************
        public int BplAction(int iAction, object pRec, object pParam)
        {
            int result;
            TAppParam AppPrm;
            AppPrm.iAction = iAction;
            // 呼び出し区分設定
            AppPrm.pRecord = (pRec as object);
            // 管理構造体ﾎﾟｲﾝﾀ設定
            if (pParam == null)
            {
                // 予備ﾎﾟｲﾝﾀ設定
                AppPrm.pActionParam = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_DRL_PARM);
            }
            else
            {
                AppPrm.pActionParam = pParam;
            }
            // 予備ﾎﾟｲﾝﾀ設定
            result = ((pRec) as TMjsAppRecord).m_pChildEntry(AppPrm);
            return result;
        }

        public int BplAction(int iAction, object pRec)
        {
            return BplAction(iAction, pRec, null);
        }

        // ******************************************************************************
        // Proccess	:	処理リスト選択
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	idx
        // Return		:	Nothing
        // ******************************************************************************
        public void ProcSelect()
        {
            TMjsAppRecord pRec;
            int idx;
            //@ Unsupported property or method(C): 'Enabled'
            PMPanelAp.Enabled = true;
            for (idx = BplList.Count - 1; idx >= 0; idx-- )
            {
                pRec = BplList[idx];
                if (idx == (m_pDrillLevel - 1))
                {
                    BplAction(Units.MAS310000u.ACTID_SHOWSTART, pRec);
                    Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_BROTHER, (pRec.m_iProgramCode));
                }
                else
                {
                    ((pRec.m_pChildForm) as Form).Hide();
                }
            }
        }

        // ******************************************************************************
        // Proccess	:	BplUnLoad処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	iApNo
        // sPrcName
        // sBplFile
        // Return		:	Nothing
        // ******************************************************************************
        public void BplUnLoad(int iApNo)
        {
            int idx;
            int idxStr;
            int idxEnd;
            int idxExc;
            int iRet;
            TMjsAppRecord pRec;
            // 全てのＢｐｌ
            if (iApNo == 0)
            {
                idxStr = 0;
                idxEnd = BplList.Count - 1;
                idxExc =  -1;
            }
            // 自分以降のＢｐｌ
            else if (iApNo == 1)
            {
                idxStr = m_pDrillLevel;
                idxEnd = BplList.Count - 1;
                idxExc =  -1;
            }
            else
            {
                // 自分以外のＢｐｌ
                idxStr = 0;
                idxEnd = BplList.Count - 1;
                idxExc = m_pDrillLevel - 1;
            }
            for (idx = idxStr; idx <= idxEnd; idx ++ )
            {
                pRec = BplList[idx];
                if ((idx != idxExc) && (pRec.m_hChildBpl != 0))
                {
                    // Load済？
                    iRet = BplAction(Units.MAS310000u.ACTID_FORMCANCLOSESTART, pRec);
                    if (iRet != Units.MAS310000u.ACTID_RET_OK)
                    {
                        return;
                    }
                    // 要求拒否？	以降処理しない
                    iRet = BplAction(Units.MAS310000u.ACTID_FORMCLOSESTART, pRec);
                    if (iRet != Units.MAS310000u.ACTID_RET_OK)
                    {
                        return;
                    }
                // 要求拒否？	以降処理しない
                }
            }
        }

        // ******************************************************************************
        // Proccess	:	BplCanClose処理
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	iApNo
        // sPrcName
        // sBplFile
        // Return		:	Nothing
        // ******************************************************************************
        public bool BplCanClose(int iApNo)
        {
            bool result;
            int idx;
            int idxStr;
            int idxEnd;
            int idxExc;
            int iRet;
            TMjsAppRecord pRec;
            bool bRetn;
            bRetn = true;
            // 全てのＢｐｌ
            if (iApNo == 0)
            {
                idxStr = 0;
                idxEnd = BplList.Count - 1;
                idxExc =  -1;
            }
            // 自分以降のＢｐｌ
            else if (iApNo == 1)
            {
                idxStr = m_pDrillLevel;
                idxEnd = BplList.Count - 1;
                idxExc =  -1;
            }
            else
            {
                // 自分以外のＢｐｌ
                idxStr = 0;
                idxEnd = BplList.Count - 1;
                idxExc = m_pDrillLevel - 1;
            }
            for (idx = idxStr; idx <= idxEnd; idx ++ )
            {
                pRec = BplList[idx];
                if ((idx != idxExc) && (pRec.m_hChildBpl != 0))
                {
                    // Load済？
                    // 要求拒否？	以降処理しない
                    iRet = BplAction(Units.MAS310000u.ACTID_FORMCANCLOSESTART, pRec);
                    if (iRet != Units.MAS310000u.ACTID_RET_OK)
                    {
                        bRetn = false;
                        break;
                    }
                }
            }
            result = bRetn;
            return result;
        }

        // ******************************************************************************
        // Proccess	:	Bplリストの整理（削除指定されているBplをFree）
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Nothing
        // Return		:	Nothing
        // ******************************************************************************
        public void BplListUpdate()
        {
            int idx;
            TMjsAppRecord pRec;
            idx = BplList.Count - 1;
            while (idx >= 0)
            {
                pRec = BplList[idx];
                if ((pRec.m_hChildBpl != 0) && (pRec.m_iDelete == 1))
                {
                    //@ Unsupported function or procedure: 'UnloadPackage'
                    UnloadPackage(pRec.m_hChildBpl);
                    BplList.RemoveAt(idx);
                    //@ Unsupported function or procedure: 'Dispose'
                    Dispose(pRec);
                }
                idx = idx - 1;
            }
        }

        // //////////////////////////////////////////////////////////////////////////////////////////////////
        // ファンクション一件ゲット（ＰｒｇＩＤから）
        // //////////////////////////////////////////////////////////////////////////////////////////////////
        public object ReadFromPID(object pPar)
        {
            object result;
            m_rFunc = Itm.ReadIniRec((int)pPar);
            result = m_rFunc;
            // ファンクション一件ゲット（ＰｒｇＩＤから）

            return result;
        }

        public object ReadFromPID()
        {
            return ReadFromPID(null);
        }

        // procedure	LogWrite(const Text1: string; Text2: string=''; Text3: string='');
        // ******************************************************************************
        // Proccess	:	LogWrite（指定したテキストをログファイル中に１レコード書き込む）
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	Text1: string --- ログファイル中に書き込みたいテキスト
        // Return		:	Nothing
        // ******************************************************************************
        public bool LogWrite(string Text1)
        {
            bool result;
            string pathName;
            string fileName;
            System.IO.Stream MyTextFile;
            result = false;
            // ♪♪♪♪♪　LogWriteを使いたい時は MASL310Root_LogWrite.inc を空にする。
            // ******************************************************************************
            // Proccess	:	MASL310Root_LogWrite
            // Name		:	K.Hattori(MJS)
            // Date		:	2003/06/16
            // Parameter	:
            // Return		:
            // ******************************************************************************
            // LogWriteを使いたい時は空にする。
#endif
            // __MASL310ROOT_LOGWRITE_NOUSE_INC__
            return result;
#endif
            // __MASL310ROOT_LOGWRITE_NOUSE_INC__
            // ♪♪♪♪♪
            // パス名取得
            pathName = "c:\\temp\\MjsLog";
            if (Directory.Exists(pathName))
            {
                // ファイルオープン
                if (File.Exists(pathName + "\\TestMode.txt"))
                {
                    if (Text1.Substring(1 - 1 ,5) == "Check")
                    {
                        if (File.Exists(pathName + '\\' + Text1 + ".txt"))
                        {
                            result = true;
                        }
                        return result;
                    }
                    if (Text1 != "")
                    {
                        // ファイル名作成
                        //@ Unsupported function or procedure: 'FormatDateTime'
                        fileName = "\\MASLog " + FormatDateTime("yyyy_mm_dd", DateTime.Now) + " 削除しても安全です。.txt";
                        // ファイルオープン
                        fileName = pathName + fileName;
                        MyTextFile = new FileInfo(fileName);
                        if (File.Exists(fileName))
                        {
                            StreamWriter _W_0 = MyTextFile.AppendText();
                        }
                        else
                        {
                            _W_0 = MyTextFile.CreateText();
                        }
                        // データ書き込み
                        try {
                            //@ Unsupported function or procedure: 'FormatDateTime'
                            _W_0.WriteLine(FormatDateTime("hh:mm:ss", DateTime.Now) + " calc " + Text1);
                        } finally {
                            _W_0.Close();
                        }
                    }
                    result = true;
                }
            }
            return result;
        }

        public bool LogWrite()
        {
            return LogWrite("");
        }

        // **************************************************************************
        // Proccess  :	iChkMode に含まれているか判定
        // Parameter : iValue		Integer			判定対象
        // Return    : Boolean
        // **************************************************************************
        public bool DateCheck_IsChkMode(int iValue)
        {
            bool result;
            result = (iChkMode & iValue) == iValue;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	日付チェック、補完
        // Parameter : pPar1		^Integer			チェック対象(西暦8桁 yyyymmdd)
        // pPar2		^Integer			引数：チェックモード
        // 戻り：補完後の日付
        // pPar3		^TMASL310IMonth		戻り：補完後の月情報
        // Return    : Integer		チェック結果
        // Comment	  : 当期⇔翌期の入力不可チェック(月可変時)はオプション機能
        // History	  :	<HIS-052>
        // ******************************************************************************
        public int DateCheck(object pPar1, ref object pPar2, ref object pPar3)
        {
            int result;
            TIntDate rcParam;
            int iRetDate;
            TMASL310IMonth pMonth;
            int iChkMode;
            bool bKotei;
            bool bNextTerm;
            int iCurNMonth;
            int iSta;
            int iEnd;
            int idx;
            int iWork;
            bool bWork;
            result = 0;
            iRetDate = 0;
            pMonth = null;
            bKotei = Sm.Kotei == 0;
            // True: 月固定  False: 月可変
            bNextTerm = Sm.CurMonth.iNextTerm != 0;
            // True: 翌期    False: 当期
            iCurNMonth = Sm.CurMonth.iInner;
            // 現在の指示内部月
            rcParam.YMD = (int)pPar1;
            rcParam.Y = rcParam.YMD / 10000;
            rcParam.M = rcParam.YMD / 100 % 100;
            rcParam.D = rcParam.YMD % 100;
            if (pPar2 == null)
            {
                iChkMode = 0;
            }
            else
            {
                iChkMode = (int)pPar2;
            }
            // 年のみ
            if ((rcParam.Y != 0) && (rcParam.M == 0) && (rcParam.D == 0))
            {
                // 月固定 or ０月
                if (bKotei || (iCurNMonth == 0))
                {
                    // 指示月の範囲
                    pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, iCurNMonth);
                    iSta = pMonth.iStartDate / 10000;
                    iEnd = pMonth.iEndDate / 10000;
                // 月可変
                }
                else
                {
                    // 当期〜翌期
                    iWork = Sm.EntStr;
                    pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, iWork);
                    iSta = pMonth.iStartDate / 10000;
                    iWork = ((TMASL310IMonth)(Sm[Sm.Count - 1])).iInner;
                    pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, iWork);
                    iEnd = pMonth.iEndDate / 10000;
                    // 戻りの月情報は指示月にしておく
                    pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, iCurNMonth);
                }
                if ((rcParam.Y < iSta) || (rcParam.Y > iEnd))
                {
                    pMonth = null;
                }
            // -4: ０月開始日  -3: ０月終了日  -2:当期(翌期)開始日  -1:当期(翌期)終了日
            }
            else if ((rcParam.YMD >=  -4) && (rcParam.YMD <=  -1))
            {
                switch(rcParam.YMD)
                {
                    case  -1:
                        if (bNextTerm)
                        {
                            iWork = ((TMASL310IMonth)(Sm[Sm.Count - 1])).iInner;
                        }
                        else
                        {
                            iWork = 37;
                        }
                        break;
                    case  -2:
                        if (bNextTerm)
                        {
                            iWork = 41;
                        }
                        else
                        {
                            iWork = Sm.EntStr;
                        }
                        break;
                    default:
                        iWork = 0;
                        break;
                }
                pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, iWork);
                if ((rcParam.YMD ==  -4) || (rcParam.YMD ==  -2))
                {
                    iRetDate = pMonth.iStartDate;
                }
                else
                {
                    iRetDate = pMonth.iEndDate;
                }
                // 月固定チェック
                if ((rcParam.YMD ==  -2) || (rcParam.YMD ==  -1))
                {
                    if (bKotei && (iWork != iCurNMonth))
                    {
                        result = 1;
                    }
                }
            // 日のみ(0: 当月開始日  99: 当月終了日)
            }
            else if ((rcParam.YMD >= 0) && (rcParam.YMD <= 99))
            {
                pMonth = Sm.CurMonth;
                switch(rcParam.D)
                {
                    case 0:
                        iRetDate = pMonth.iStartDate;
                        break;
                    case 99:
                        iRetDate = pMonth.iEndDate;
                        break;
                    default:
                        // 補完(年月)
                        iSta = pMonth.iStartDate % 100;
                        iEnd = pMonth.iEndDate % 100;
                        if (rcParam.D >= iSta)
                        {
                            iRetDate = pMonth.iStartDate / 100 * 100 + rcParam.D;
                        }
                        else if (rcParam.D <= iEnd)
                        {
                            iRetDate = pMonth.iEndDate / 100 * 100 + rcParam.D;
                        }
                        if ((iRetDate < pMonth.iStartDate) || (iRetDate > pMonth.iEndDate))
                        {
                            pMonth = null;
                        }
                        break;
                }
            // 月日、月のみ
            }
            else if ((rcParam.YMD >= 100) && (rcParam.YMD <= 9999))
            {
                // 外部月で検索(月のみ、特殊月)
                if ((rcParam.D == 0) || (rcParam.M > 12))
                {
                    if (bNextTerm)
                    {
                        pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_YM_RECSET, rcParam.M);
                    }
                    // 翌期
                    if (pMonth == null)
                    {
                        pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_GM_RECSET, rcParam.M);
                    }
                    // 当期
                    // ---<VK03201>------------------------------------------------------------------
                    if (pMonth != null)
                    {
                        // ＶＫは仕訳入力開始月より前も取得できるのでチェックする必要がある
                        if (pMonth.iInner < Sm.EntStr)
                        {
                            pMonth = null;
                        }
                    }
                    // ------------------------------------------------------------------<VK03201>---
                    if (pMonth != null)
                    {
                        iWork = pMonth.iInner;
                        // 当期⇔翌期チェック あり
                        if (DateCheck_IsChkMode(2) && (Sm.CurMonth.iNextTerm != pMonth.iNextTerm))
                        {
                            result = 2;
                        }
                        // 月日
                        if (rcParam.D != 0)
                        {
                            // 補完(年月)
                            iSta = pMonth.iStartDate % 100;
                            iEnd = pMonth.iEndDate % 100;
                            if (rcParam.D >= iSta)
                            {
                                iRetDate = pMonth.iStartDate / 100 * 100 + rcParam.D;
                            }
                            else if (rcParam.D <= iEnd)
                            {
                                iRetDate = pMonth.iEndDate / 100 * 100 + rcParam.D;
                            }
                            if ((iRetDate < pMonth.iStartDate) || (iRetDate > pMonth.iEndDate))
                            {
                                pMonth = null;
                            }
                        }
                        // 月固定チェック
                        if ((result == 0) && bKotei && (iWork != iCurNMonth))
                        {
                            result = 1;
                        }
                    }
                // 暦月で検索(月日)
                }
                else
                {
                    // ---<HIS-057>------------------------------------------------------------------
                    // 補完(年)
                    // idx=0 翌期かどうか
                    // idx=1 当期かどうか
                    for (idx = 0; idx <= 1; idx ++ )
                    {
                        // 指示が当期なら翌期はない
                        if ((idx == 0) && !bNextTerm)
                        {
                            continue;
                        }
                        if (idx == 0)
                        {
                            iWork = 41;
                        }
                        else
                        {
                            iWork = Sm.EntStr;
                        }
                        pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, iWork);
                        iSta = pMonth.iStartDate;
                        if (idx == 0)
                        {
                            iWork = ((TMASL310IMonth)(Sm[Sm.Count - 1])).iInner;
                        }
                        else
                        {
                            iWork = 37;
                        }
                        pMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, iWork);
                        iEnd = pMonth.iEndDate;
                        if (rcParam.YMD >= (iSta % 10000))
                        {
                            iRetDate = iSta / 10000 * 10000 + rcParam.YMD;
                        }
                        else if (rcParam.YMD <= (iEnd % 10000))
                        {
                            iRetDate = iEnd / 10000 * 10000 + rcParam.YMD;
                        }
                        pMonth = null;
                        if ((iRetDate >= iSta) && (iRetDate <= iEnd))
                        {
                            break;
                        }
                        // ---<HIS-072> 期間チェックでＮＧなら補完値はクリア-----------------------------
                        iRetDate = 0;
                    // ------------------------------------------------------------------<HIS-072>---
                    }
                    // //  対象の月は翌期に存在するか？
                    // pMonth	:= Pfnc(MASL_PGET_YM_RECSET, @rcParam.M);
                    // bWork	:= pMonth <> nil;	//	True: 翌期にある  False: 翌期にない
                    // //	補完(年)
                    // if bNextTerm and bWork then	iWork := 41
                    // else						iWork := Sm.EntStr;
                    // pMonth	:= Pfnc(MASL_PGET_NM_RECSET, @iWork);
                    // iSta	:= pMonth^.iStartDate;
                    // if bNextTerm and bWork then	iWork := TMASL310IMonth(Sm.Items[Sm.Count-1]^).iInner
                    // else						iWork := 37;
                    // pMonth	:= Pfnc(MASL_PGET_NM_RECSET, @iWork);
                    // iEnd	:= pMonth^.iEndDate;
                    // if		rcParam.YMD >= (iSta mod 10000) then	iRetDate := iSta div 10000 * 10000 + rcParam.YMD
                    // else if	rcParam.YMD <= (iEnd mod 10000) then	iRetDate := iEnd div 10000 * 10000 + rcParam.YMD;
                    // pMonth	:= nil;
                    // ------------------------------------------------------------------<HIS-057>---
                    // 月固定で入力で通常月日の場合 検索省略
                    if (DateCheck_IsChkMode(1) && bKotei)
                    {
                        if ((iRetDate >= Sm.CurMonth.iStartDate) && (iRetDate <= Sm.CurMonth.iEndDate))
                        {
                            pMonth = Sm.CurMonth;
                        }
                    }
                    if (pMonth == null)
                    {
                        for (idx = 0; idx < Sm.Count; idx ++ )
                        {
                            iSta = ((TMASL310IMonth)(Sm[idx])).iStartDate;
                            iEnd = ((TMASL310IMonth)(Sm[idx])).iEndDate;
                            if ((iRetDate >= iSta) && (iRetDate <= iEnd))
                            {
                                pMonth = Sm[idx];
                                iWork = pMonth.iInner;
                                // 当期⇔翌期チェック
                                if (DateCheck_IsChkMode(2) && (Sm.CurMonth.iNextTerm != pMonth.iNextTerm))
                                {
                                    result = 2;
                                }
                                // 月固定チェック
                                if ((result == 0) && bKotei && (iWork != iCurNMonth))
                                {
                                    result = 1;
                                }
                                break;
                            }
                        }
                    }
                }
            // 年月日
            }
            else
            {
                // 月固定で入力で通常月日の場合 検索省略
                if (DateCheck_IsChkMode(1) && bKotei)
                {
                    bWork = true;
                    iSta = Sm.CurMonth.iStartDate;
                    iEnd = Sm.CurMonth.iEndDate;
                    iWork = Sm.CurMonth.iOuter;
                    // 月が特殊月
                    if (rcParam.M > 12)
                    {
                        if (rcParam.M == iWork)
                        {
                            // 補完(月)
                            if (rcParam.D >= (iSta % 100))
                            {
                                iRetDate = rcParam.Y * 10000 + iSta / 100 % 100 * 100 + rcParam.D;
                            }
                            else if (rcParam.D <= (iEnd % 100))
                            {
                                iRetDate = rcParam.Y * 10000 + iEnd / 100 % 100 * 100 + rcParam.D;
                            }
                        }
                        else
                        {
                            bWork = false;
                        }
                    }
                    else
                    {
                        iRetDate = rcParam.YMD;
                    }
                    if (bWork)
                    {
                        if ((iRetDate >= Sm.CurMonth.iStartDate) && (iRetDate <= Sm.CurMonth.iEndDate))
                        {
                            pMonth = Sm.CurMonth;
                        }
                    }
                }
                if (pMonth == null)
                {
                    for (idx = 0; idx < Sm.Count; idx ++ )
                    {
                        iRetDate = rcParam.YMD;
                        pMonth = Sm[idx];
                        // ---<VK03201>------------------------------------------------------------------
                        // ＶＫは仕訳入力開始月より前も取得できるのでチェックする必要がある
                        if (pMonth.iInner < Sm.EntStr)
                        {
                            pMonth = null;
                            continue;
                        }
                        // ------------------------------------------------------------------<VK03201>---
                        iSta = pMonth.iStartDate;
                        iEnd = pMonth.iEndDate;
                        iWork = pMonth.iOuter;
                        // 月が特殊月
                        if (rcParam.M > 12)
                        {
                            if (rcParam.M != iWork)
                            {
                                pMonth = null;
                                continue;
                            }
                            // 補完(月)
                            if (rcParam.D >= (iSta % 100))
                            {
                                iRetDate = rcParam.Y * 10000 + iSta / 100 % 100 * 100 + rcParam.D;
                            }
                            else if (rcParam.D <= (iEnd % 100))
                            {
                                iRetDate = rcParam.Y * 10000 + iEnd / 100 % 100 * 100 + rcParam.D;
                            }
                        }
                        if ((iRetDate >= iSta) && (iRetDate <= iEnd))
                        {
                            iWork = pMonth.iInner;
                            // ０月⇔当期(翌期)チェック
                            if (!bKotei && ((iWork == 0) && (iCurNMonth != 0) || (iWork != 0) && (iCurNMonth == 0)))
                            {
                                result = 2;
                            }
                            // 当期⇔翌期チェック
                            if ((result == 0) && DateCheck_IsChkMode(2) && (Sm.CurMonth.iNextTerm != pMonth.iNextTerm))
                            {
                                result = 2;
                            }
                            // 月固定チェック
                            if ((result == 0) && bKotei && (iWork != iCurNMonth))
                            {
                                result = 1;
                            }
                            break;
                        }
                        pMonth = null;
                    }
                }
            }
        }
        //@ Undeclared identifier(3): 'MjsIntYMDChk'
        if ((iRetDate != 0) && !MjsIntYMDChk(iRetDate))
        {
            pMonth = null;
        }
        if (pMonth == null)
        {
            result = 3;
            iRetDate = 0;
        }
        if ((pPar2 != null))
        {
            (int)pPar2 = iRetDate;
        }
        if ((pPar3 != null) && (pMonth != null))
        {
            ((TMASL310IMonth)(pPar3)) = pMonth;
        }
            return result;
        }

        // 日付処理
        // ---<HIS-052> 削除-------------------------------------------------------------
        // //******************************************************************************
        // //	Proccess	:	DateCheck（日付処理）
        // //	Name		:	K.Hattori(MJS)
        // //	Date		:	2000/12/08
        // //	Parameter	:	pPar1: Pointer --- チェックｏｒ取得する日付
        // //					pPar2: Pointer --- 変換後日付
        // //	Return		:	チェック結果
        // //******************************************************************************
        // function	TMASL310Root.DateCheck(pPar1: Pointer;var pPar2: Pointer;var pPar3: Pointer):Integer;
        // var
        // iParDate	:	Integer;
        // iRetDate	:	Integer;
        // pRetMonth	:	Pointer;
        // iInner		:	Integer;
        // iYear,iMonth,iDay	:	Integer;
        // iIndex		:	Integer;
        // iCheckMode	:	Integer;	//	＝０：表示、＝１：入力
        // begin
        // result:=0;
        // iRetDate:=0;
        // //	pPar3:=nil;
        // pRetMonth:=nil;
        // iParDate	:=	Integer(pPar1^);
        // iCheckMode:=0;
        // if	pPar2<>nil	then	iCheckMode:=Integer(pPar2^);
        // iYear		:=	iParDate div 10000;
        // iMonth		:=	(iParDate div 100) mod 100;
        // iDay		:=	iParDate mod 100;
        // //	1999年、2000年、2001年等
        // if	(iYear<>0) and (iMonth=0) and (iDay=0)	then
        // begin
        // iInner:=0;
        // pRetMonth:=Pfnc( MASL_PGET_NM_RECSET,@iInner);
        // if	((TMASL310IMonth(pRetMonth^).iStartDate	div 10000)	> iYear)	or
        // ((TMASL310IMonth(pRetMonth^).iEndDate	div 10000)	< iYear)	then	pRetMonth:=nil;
        // end
        // else
        // begin
        // case	iParDate	of
        // //	-4:０月開始日、-3:０月終了日、-2:当期（翌期）開始日、-1:当期（翌期）終了日
        // -4..-1:
        // begin
        // if	(iParDate=-3) or (iParDate=-4)				then	iInner:=0;
        // if	(iParDate=-2) and (Sm.CurMonth.iNextTerm=0)	then	iInner:=Sm.EntStr;
        // if	(iParDate=-2) and (Sm.CurMonth.iNextTerm=1)	then	iInner:=41;
        // if	(iParDate=-1) and (Sm.CurMonth.iNextTerm=0)	then	iInner:=37;
        // if	(iParDate=-1) and (Sm.CurMonth.iNextTerm=1)	then	iInner:=TMASL310IMonth(Sm.Items[Sm.Count-1]^).iInner;
        // pRetMonth:=Pfnc( MASL_PGET_NM_RECSET,@iInner);
        // if	(iParDate=-2) or (iParDate=-4)				then	iRetDate:=TMASL310IMonth(pRetMonth^).iStartDate;
        // if	(iParDate=-1) or (iParDate=-3)				then	iRetDate:=TMASL310IMonth(pRetMonth^).iEndDate;
        // if	(iParDate=-1) or (iParDate=-2)				then
        // if	(Sm.Kotei=0) and (iInner<>Sm.CurMonth.iInner)	then	result:=1;
        // end;
        // //	0:当月開始日、1..98:当月、99:当月終了日
        // 0..99:
        // begin
        // pRetMonth:=@(Sm.CurMonth);
        // if	(iParDate=0)	then	iRetDate:=TMASL310IMonth(pRetMonth^).iStartDate;
        // if	(iParDate=99)	then	iRetDate:=TMASL310IMonth(pRetMonth^).iEndDate;
        // if	(iParDate>=1) and (iParDate<=98)	then
        // begin
        // if	((Sm.CurMonth.iStartDate mod 100) <= iParDate)	then
        // iRetDate:=(Sm.CurMonth.iStartDate div 100) * 100 + iParDate
        // else if	((Sm.CurMonth.iEndDate mod 100) >= iParDate)	then
        // iRetDate:=(Sm.CurMonth.iEndDate div 100) * 100 + iParDate;
        // if	(((TMASL310IMonth(pRetMonth^).iStartDate)>iRetDate) or
        // ((TMASL310IMonth(pRetMonth^).iEndDate	)<iRetDate))	then	pRetMonth:=nil
        // else if	not MjsIntYMDChk(iRetDate)	then	pRetMonth:=nil;
        // end;
        // end;
        // //	月日、月のみ
        // 100..9999:
        // begin
        // //	月のみ、月日（決算月）−＞外部月
        // if	(iDay=0) or (iMonth >12)	then
        // begin
        // if	Sm.CurMonth.iNextTerm=0
        // then	pRetMonth:=Pfnc( MASL_PGET_GM_RECSET,@iMonth)	//	当期
        // else	pRetMonth:=Pfnc( MASL_PGET_YM_RECSET,@iMonth);	//	翌期
        // if	pRetMonth<>nil	then			//	存在する月
        // begin
        // iInner:=TMASL310IMonth(pRetMonth^).iInner;
        // //	月日
        // if	(iDay<>0)
        // then
        // begin
        // //								iRetDate:=TMASL310IMonth(pRetMonth^).iStartDate;
        // if		(iParDate mod 100)>=(TMASL310IMonth(pRetMonth^).iStartDate mod 100)
        // then	iRetDate:=(iParDate mod 100)+((TMASL310IMonth(pRetMonth^).iStartDate div 100) * 100)
        // else	iRetDate:=(iParDate mod 100)+((TMASL310IMonth(Pfnc( MASL_PGET_NM_RECSET,@iInner)^).iEndDate div 100) * 100);
        // //	存在しない外部月日
        // if	(((TMASL310IMonth(pRetMonth^).iStartDate	mod 100)>iDay) or
        // ((TMASL310IMonth(pRetMonth^).iEndDate		mod 100)<iDay))	then	pRetMonth:=nil;
        // end;
        // //	月固定で当月以外＝入力不可
        // if	(Sm.Kotei=0) and (Sm.CurMonth.iInner<>iInner)		then	result:=1;
        // end;
        // end
        // //	月日（通常月、締後）−＞暦月
        // else
        // begin
        // if	(Sm.CurMonth.iNextTerm=0)	then	iInner:=Sm.EntStr
        // else									iInner:=41;
        // pRetMonth:=Pfnc( MASL_PGET_NM_RECSET,@iInner);
        // if	(Sm.CurMonth.iNextTerm=0)	then	iInner:=37
        // (*H0018 20030124 khattori 翌期表示*)
        // //	四半期決算有りの時
        // else if	sm.Kessan=2				then	iInner:=47
        // else									iInner:=43;
        // //						else									iInner:=47;
        // if		iParDate>=(TMASL310IMonth(pRetMonth^).iStartDate mod 10000)
        // then	iRetDate:=iParDate+((TMASL310IMonth(pRetMonth^).iStartDate div 10000) * 10000)
        // else	iRetDate:=iParDate+((TMASL310IMonth(Pfnc( MASL_PGET_NM_RECSET,@iInner)^).iEndDate div 10000) * 10000);
        // pRetMonth:=nil;
        // //	月固定で入力で通常月日の時
        // if	(iCheckMode=1) and (Sm.Kotei=0)	then
        // begin
        // if	(Sm.CurMonth.iStartDate<=iRetDate) and (Sm.CurMonth.iEndDate>=iRetDate)	then	pRetMonth:=@(Sm.CurMonth);
        // end;
        // if	pRetMonth=nil	then
        // begin
        // for iIndex := 0 to Sm.Count-1 do
        // begin
        // if		(iRetDate>=TMASL310IMonth(Sm.Items[iIndex]^).iStartDate) and
        // (iRetDate<=TMASL310IMonth(Sm.Items[iIndex]^).iEndDate)
        // then
        // begin
        // pRetMonth:=Sm.Items[iIndex];
        // (*H0003	20010619 khattori 月可変の時、翌期の日付が入ってしまう*)
        // if		(Sm.CurMonth.iNextTerm<>TMASL310IMonth(pRetMonth^).iNextTerm)				then	result:=2	//	当期−翌期＝入力不可
        // else if	(Sm.Kotei=0) and (Sm.CurMonth.iInner<>TMASL310IMonth(pRetMonth^).iInner)	then	result:=1;	//	月固定で当月以外＝入力不可
        // //									if	(Sm.Kotei=0) and (Sm.CurMonth.iInner<>TMASL310IMonth(pRetMonth^).iInner)	then	result:=1;	//	月固定で当月以外＝入力不可
        // break;
        // end;
        // end;
        // end;
        // end;
        // end;
        // //	年月日
        // else
        // begin
        // iRetDate:=iParDate;
        // for iIndex := 0 to Sm.Count-1 do
        // begin
        // if		(iRetDate>=TMASL310IMonth(Sm.Items[iIndex]^).iStartDate) and
        // (iRetDate<=TMASL310IMonth(Sm.Items[iIndex]^).iEndDate)
        // then
        // begin
        // pRetMonth:=Sm.Items[iIndex];
        // if		(Sm.CurMonth.iNextTerm<>TMASL310IMonth(pRetMonth^).iNextTerm)				then	result:=2	//	当期−翌期＝入力不可
        // else if	(Sm.Kotei=0) and (Sm.CurMonth.iInner<>TMASL310IMonth(pRetMonth^).iInner)	then	result:=1;	//	月固定で当月以外＝入力不可
        // break;
        // end;
        // end;
        // end;
        // end;
        // end;
        // if	iRetDate<>0	then	if	MjsIntYMDChk(iRetDate) = False then	pRetMonth:=nil;
        // if	pRetMonth=nil	then
        // begin
        // result:=3;	//	存在しない外部月日
        // iRetDate:=0;
        // end;
        // if	pPar2<>nil	then	Integer(pPar2^):=iRetDate;
        // //	if	pRetMonth<>nil	then	pPar3:=pRetMonth;
        // if	(pPar3<>nil) and (pRetMonth<>nil)
        // then	TMASL310IMonth(pPar3^):=TMASL310IMonth(pRetMonth^);
        // end;
        // ------------------------------------------------------------------<HIS-052>---
        // ******************************************************************************
        // Proccess	:	GetChangeable
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Parameter	:	pPar1: Pointer --- チェックｏｒ取得する日付
        // pPar2: Pointer --- 変換後日付
        // Return		:	チェック結果
        // ******************************************************************************
        // 入力権利の状態
        // MASL_RET_MAIL_ERROR		,	//	パラメーターエラー
        // MASL_RET_MAIL_OK		,	//	入力､修正､削除可能
        // (*未使用*)	MASL_RET_MAIL_NORIGHT	,	//	入力権利なし
        // MASL_RET_MAIL_FIXED		,	//	月次確定済み
        // (*未使用*)	MASL_RET_MAIL_SENT		,	//	送付時確定済み
        // MASL_RET_MAIL_UPPER		,	//	上位発生区分
        // MASL_RET_MAIL_LOWER			//	下位発生区分月次未確定
        public int GetChangeable(object pPar1, ref object pPar2, ref object pPar3)
        {
            int result;
            int nInMonth;
            int nHassei;
            int nKensaku;
            object pRetMonth;
            enTblList tlTblList;
            object pQuery;
            // iHassei		:	Integer;
            // iComKbn3	:	Integer;
            // iEComKbn5	:	Integer;
            int iGnPuKbn22;
            int iGnPuKbn23;
            result = (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_OK);
            // //////////////////////////////////////////////
            // 入力・修正・削除可能の状態を返す
            // //////////////////////////////////////////////
            nInMonth = 0;
            nHassei = 0;
            nKensaku = 0;
            if (pPar1 != null)
            {
                nInMonth = (int)pPar1;
            }
            if (pPar2 != null)
            {
                nHassei = (int)pPar2;
            }
            if (pPar3 != null)
            {
                nKensaku = (int)pPar3;
            }
            pRetMonth = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_NM_RECSET, nInMonth);
            // ---<HIS-025>------------------------------------------------------------------
            // メール会計あり ＆ 部署データ ＆ 自身:本店(支店)
            if ((m_iComKbn3 == 1) && (nHassei == 3) && (m_iHassei < 2))
            {
                // 部署の発生区分を属する上位に振り替えてチェック
                // 部署の採用がない場合は、相手(自身:本店なら支店)とする
                tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
                pQuery = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'Locate'
                //@ Undeclared identifier(3): 'TMQuery'
                //@ Unsupported property or method(B): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                if ((pQuery != null) && (TMQuery(pQuery).Locate("RecKbn", 9, new object[] {}) == true) && (TMQuery(pQuery).GetFld("GnPuKbn1").AsInteger == m_iHassei))
                {
                    nHassei = m_iHassei;
                }
                else
                {
                    nHassei = 1 - m_iHassei;
                }
            }
            // (*H0019 20030718 khattori	syuusei 20030220 ni tsuika sita ronnri ga nuketa*)
            // if	(nHassei=3)and(m_iHassei=1)	then	nHassei		:=	m_iHassei;
            // ------------------------------------------------------------------<HIS-025>---
            if (pRetMonth == null)
            {
                // 月が不正
                result = (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_ERROR);
            }
            else
            {
                if (((TMASL310IMonth)(pRetMonth)).iFixMonth == 1)
                {
                    result = (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_FIXED);
                }
                // 月次確定済み（自分）
                // 翌期で、翌期更新済みのとき、入力／修正／削除不可
                if (((nInMonth / 40 as object) == 1) && (m_iEComKbn5 == 1))
                {
                    result = (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_NEXT);
                }
                // 翌期更新済み
                // メール会計採用有り？
                if (m_iComKbn3 == 1)
                {
                    if (m_iHassei > nHassei)
                    {
                        // 上位発生区分
                        result = (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_UPPER);
                    }
                    else if (result == (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_OK))
                    {
                        // 入力時
                        if (nKensaku == 0)
                        {
                            if (m_iHassei == 0)
                            {
                                tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
                                pQuery = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                                if (pQuery != null)
                                {
                                    iGnPuKbn22 = 0;
                                    // 顧問先確定までは入力不可
                                    //@ Undeclared identifier(3): 'TMQuery'
                                    //@ Unsupported property or method(B): 'Locate'
                                    if ((TMQuery(pQuery).Locate("RecKbn", 4, new object[] {})) == true)
                                    {
                                        //@ Undeclared identifier(3): 'TMQuery'
                                        //@ Unsupported property or method(B): 'GetFld'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        iGnPuKbn22 = TMQuery(pQuery).GetFld("GnPuKbn22").AsInteger;
                                    }
                                    // 事務所仕訳入力制御
                                    if ((iGnPuKbn22 == 0) && (((TMASL310IMonth)(pRetMonth)).iFixMonth == 0))
                                    {
                                        result = (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_LOWER);
                                    }
                                // 下位発生区分月次未確定
                                }
                            }
                        // 修正・削除時
                        }
                        else
                        {
                            if ((m_iHassei < nHassei) && (((TMASL310IMonth)(pRetMonth)).iFixMonth == 0))
                            {
                                // 下位で未確定
                                tlTblList = VKZ310Cmnu.enTblList.MASL_TLST_KbnInfo;
                                pQuery = Pfnc(VKZ310Cmnu.enPfunc.MASL_PGET_TBL_LIST, tlTblList);
                                if (pQuery != null)
                                {
                                    iGnPuKbn23 = 0;
                                    // 差分データ送信後修正可
                                    // (*H0002	20010601 khattori 送付時確定がだめ*)
                                    //@ Undeclared identifier(3): 'TMQuery'
                                    //@ Unsupported property or method(B): 'Locate'
                                    if ((TMQuery(pQuery).Locate("RecKbn", m_iHassei + 5, new object[] {})) == true)
                                    {
                                        // if	(TMQuery(pQuery^).Locate('RecKbn',iHassei+1,[]))=true	then
                                        //@ Undeclared identifier(3): 'TMQuery'
                                        //@ Unsupported property or method(B): 'GetFld'
                                        //@ Unsupported property or method(D): 'AsInteger'
                                        iGnPuKbn23 = TMQuery(pQuery).GetFld("GnPuKbn23").AsInteger;
                                    }
                                    // 差分データ送信区分
                                    if ((iGnPuKbn23 == 0))
                                    {
                                        result = (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_LOWER);
                                    }
                                // 下位発生区分月次未確定
                                }
                            }
                        }
                    }
                }
            }
            if (result != (int)(VKZ310Cmnu.enRetChangeable.MASL_RET_MAIL_OK))
            {
                LogWrite("InMonth " + (nInMonth).ToString() + " Hassei " + (nHassei).ToString() + " Kensaku " + (nKensaku).ToString() + " result " + (result).ToString() + " 仕訳発生区分 " + (m_iHassei).ToString() + " メール会計区分 " + (m_iComKbn3).ToString() + " 翌期更新 " + (m_iEComKbn5).ToString());
            }
            return result;
        }

        // (*verx*)
        // (*H0012 20011213 khattori	マルチ入力！*)
        // (*verx*)
        // (*H0012 20011213 khattori	マルチ入力！*)
        // ******************************************************************************
        // Proccess	:	GetTranRockable
        // Name		:	K.Hattori(MJS)
        // Date		:	2000/12/08
        // Return		:	チェック結果
        // ******************************************************************************
        public int GetTranRockable(object pPar1, object pPar2)
        {
            int result;
            TMQuery m_FdqSwk;
            // (*db*)
            int nInMonth;
            int nKensaku;
            string sSql;
            int iRetry;
            bool bSqlRetn;
            int iTanGCode;
            string sTableCode;
            result = 0;
            if ((m_cMDModule != null) && (m_FTrnDB != null))
            {
                nInMonth =  -1;
                if (pPar1 != null)
                {
                    nInMonth = (int)pPar1;
                }
                nKensaku =  -1;
                if (pPar2 != null)
                {
                    nKensaku = (int)pPar2;
                }
                if ((nKensaku ==  -1))
                {
                    // ＲｏｌｌＢａｃｋ
                    //@ Unsupported property or method(A): 'Rollback'
                    m_cMDModule.Rollback(m_FTrnDB);
                    // パラメータなしのときはＲｏｌｌＢａｃｋのみ
                    if ((nInMonth !=  -1))
                    {
                        //@ Unsupported property or method(A): 'BeginTran'
                        m_cMDModule.BeginTran(m_FTrnDB);
                    }
                    return result;
                }
                m_FdqSwk = new TMQuery(PMPanelHd);
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                m_cMDModule.SetDBInfoToQuery(m_FTrnDB, m_FdqSwk);
                // ♪♪♪♪♪
                sTableCode = "";
                switch(m_pRec.m_iProgramCode)
                {
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_TAXITU_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_MIROKU_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KOKUYO_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_NYUUKIN_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_SYUKKIN_BUN:
                    case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_CODE_KARISSN_BUN:
                        // (*H0038 20030904 khattori	分散入力<単一入力>*)
                        // 単一入力分散仕訳指示
                        // ミロク型指示
                        // コクヨ型指示
                        // 入金伝票指示
                        // 出金伝票指示
                        // 仮払精算指示
                        iTanGCode = ((m_pRec.m_pCommonArea) as rcCOMMONAREA).TantoGCD;
                        if (iTanGCode ==  -1)
                        {
                            iTanGCode = 0;
                        }
                        //@ Unsupported function or procedure: 'Format'
                        sTableCode = "BUN" + Format("%0.8d", new int[] {iTanGCode});
                        break;
                }
                // ヘッダ検索ＮＯを追加（他で使用中は失敗）
                sSql = "INSERT INTO SwkExclusive2" + sTableCode + " (NMonth,HSrchNo)" + " VALUES(" + (nInMonth).ToString() + ',' + (nKensaku).ToString() + ");";
                sSql = sSql + "DELETE SwkExclusive2" + sTableCode + " WHERE NMonth=" + (nInMonth).ToString() + " AND	HSrchNo=0";
                // ♪♪♪♪♪
                // //	自定型ＮＯを追加（他で使用中は失敗）
                // sSql	:=
                // 'INSERT INTO SwkExclusive2 (NMonth,HSrchNo)'
                // +	' VALUES('+IntToStr(nInMonth)+','+IntToStr(nKensaku)+');';
                //@ Unsupported function or procedure: 'Close'
                Close;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(D): 'Clear'
                m_FdqSwk.SQL.Clear;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                m_FdqSwk.SQL.Add(sSql);
                // ＳＱＬ実行
                //@ Unsupported property or method(D): 'ExecSQL'
                bSqlRetn = m_FdqSwk.ExecSQL;
                // 排他成功	排他解除ｏｒ処理終了までトランザクション継続
                if (bSqlRetn)
                {
                // 排他失敗	ＲｏｌｌＢａｃｋ
                }
                else
                {
                    //@ Unsupported property or method(A): 'Rollback'
                    m_cMDModule.Rollback(m_FTrnDB);
                    result =  -1;
                }
                //@ Unsupported property or method(C): 'Free'
                this.Free;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess	:	コンポーネントをポインタとしてセット
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2000/07/25
        // Parameter	:	Nothing
        // Return		:	Pointer
        // ******************************************************************************
        public object SetComponent()
        {
            object result;
            ComponentList.Add(TMBtnFusen);
            // Items[0]	(*H0004 20010725 tyamaguchi 付箋ボタン対応*)
            ComponentList.Add(TMBtnOpen);
            // Items[1]	(*H0006 20010820 tyamaguchi コード拡大ボタン対応*)
            // (*H0047 20050418 khattori	一括置換*)
            ComponentList.Add(TMBtnLump);
            // Items[2]
            // Result := Pointer( @TMBtnFusen );
            result = (ComponentList as object);
            return result;
        }

        // 2001/07/25 Ins
        // ******************************************************************************
        // Proccess	:	定型仕訳ヘッダセット
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/09/21
        // Parameter	:	Integer		 ｾｯﾄﾌｨｰﾙﾄﾞ
        // Pointer			値
        // Return		:	Nothing
        // ******************************************************************************
        public void SetSwkFxHead(int iMode, object pValue)
        {
            try {
                switch(iMode)
                {
                    case 1:
                        iFixNo = (int)pValue;
                        break;
                    case 2:
                        // 定型ＮＯ
                        sFixName = (pValue as string);
                        break;
                    case 3:
                        // 定型仕訳名称
                        sFixRen = (pValue as string);
                        break;
                    case 4:
                        // 連想シンボル
                        iFixDate = (int)pValue;
                        break;
                    case 5:
                        // 日付
                        iFixDen = (int)pValue;
                        break;
                    case 6:
                        // 伝票ＮＯ
                        iFixTClass = (int)pValue;
                        break;
                    case 7:
                        // 出納帳定型種別
                        iFixHNo = (int)pValue;
                        break;
                    case 8:
                        // ヘッダ検索ＮＯ
                        bFixUpdate = (bool)pValue;
                        break;
                    case 9:
                        // ヘッダ情報変更フラグ
                        iFixInpKbn = (int)pValue;
                        break;
                    case 10:
                        // 発生区分
                        iFixAction = (int)pValue;
                        break;
                    default:
                        // 動作区分
                        MessageBox.Show("ﾊﾟﾗﾒｰﾀｴﾗｰ1 [SwkFxHead]");
                        break;
                }
            }
            catch {
                MessageBox.Show("ﾊﾟﾗﾒｰﾀｴﾗｰ2 [SwkFxHead]");
            }
        }

        // 2001/09/21 Ins
        // ******************************************************************************
        // Proccess	:	定型仕訳ヘッダゲット
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/09/21
        // Parameter	:	Integer		 取得するﾌｨｰﾙﾄﾞ
        // Return		:	Nothing
        // ******************************************************************************
        public object GetSwkFxHead(int iMode)
        {
            object result;
            try {
                switch(iMode)
                {
                    case 1:
                        result = iFixNo;
                        break;
                    case 2:
                        // 定型ＮＯ
                        result = sFixName;
                        break;
                    case 3:
                        // 定型仕訳名称
                        result = sFixRen;
                        break;
                    case 4:
                        // 連想シンボル
                        result = iFixDate;
                        break;
                    case 5:
                        // 日付
                        result = iFixDen;
                        break;
                    case 6:
                        // 伝票ＮＯ
                        result = iFixTClass;
                        break;
                    case 7:
                        // 出納帳定型種別
                        result = iFixHNo;
                        break;
                    case 8:
                        // ヘッダ検索ＮＯ
                        result = bFixUpdate;
                        break;
                    case 9:
                        // ヘッダ情報変更フラグ
                        result = iFixInpKbn;
                        break;
                    case 10:
                        // 発生区分
                        result = iFixAction;
                        break;
                    case 101:
                        // 動作区分
                        GetFxHead(result);
                        break;
                    default:
                        // 定型ヘッダレコード読込済Query
                        MessageBox.Show("ﾊﾟﾗﾒｰﾀｴﾗｰ3 [SwkFxHead]");
                        break;
                }
            }
            catch {
                MessageBox.Show("例外ｴﾗｰ [SwkFxHead]");
            }
            return result;
        }

        // 2001/09/21 Ins
        // ******************************************************************************
        // Proccess	:	定型仕訳：定型単位削除
        // Name		:	T.Yamaguchi(MJS)
        // Date		:	2001/09/21
        // Parameter	:	Integer			定型ＮＯ
        // Return		:	Nothing
        // ******************************************************************************
        public void FxHeadDel()
        {
            // ﾍｯﾀﾞ情報ｾｯﾄ
            TVKZL310Fix_SwkHead _wvar1 = m_cFixIF.SwkHead;
            _wvar1.Add(2, 0);
            // DenDate		:= 0;								//	伝票日付
            _wvar1.NMonth = 0;
            // 内部月
            _wvar1.SwkInpKbn = iFixInpKbn;
            // 仕訳発生区分
            _wvar1.DataClass = 0;
            // ﾃﾞｰﾀ種別
            // SwkForm		:= ;								//	仕訳入力形式
            _wvar1.HSrchNo = iFixHNo;
            // ﾍｯﾀﾞ検索No
            _wvar1.Post();
            m_cFixIF.Swkup();
        }

        // function	GetFixLock(pPar1: Pointer):Integer;
        // ------------------------------------------------------------------<HIS-051>---
        // ******************************************************************************
        // Proccess	:	定型仕訳：全件削除
        // Name		:	K.Hattori(MJS)
        // Date		:	2001/09/26
        // Parameter	:	Integer			仕訳発生区分
        // Return		:	Nothing
        // ******************************************************************************
        public void FxHeadAllDel(int iInpKbn)
        {
            TMQuery cFdqInfo;
            // (*db*)
            string s_String;
            ushort mrBtn;
            TMjsMsgRec inforec;
            string sTForm;
            string sTClass;
            //@ Unsupported property or method(A): 'BeginTran'
            m_cMDModule.BeginTran(m_FCopDB);
            cFdqInfo = new TMQuery(PMPanelHd);
            //@ Unsupported property or method(A): 'SetDBInfoToQuery'
            m_cMDModule.SetDBInfoToQuery(m_FCopDB, cFdqInfo);
            // 定型仕訳　パラメータ　ゲット
            GetFxPara(out sTForm, out sTClass);
            s_String = "select * from SwkFxHead where Swkform=" + sTForm + " and TeikeiClass=" + sTClass;
            // メール会計有り
            if ((m_iComKbn3 == 1) || (m_iBusyoNrk != 0))
            {
                // if	(m_iComKbn3=1)		then
                s_String = s_String + " and SwkInpKbn=" + (m_iHassei).ToString();
            }
            //@ Unsupported function or procedure: 'Close'
            Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            cFdqInfo.SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            cFdqInfo.SQL.Add(s_String);
            //@ Unsupported property or method(D): 'Open'
            cFdqInfo.Open;
            //@ Unsupported function or procedure: 'eof'
            while (!eof)
            {
                // ﾍｯﾀﾞ情報ｾｯﾄ
                TVKZL310Fix_SwkHead _wvar1 = m_cFixIF.SwkHead;
                _wvar1.Add(2, 0);
                // DenDate		:= 0;								//	伝票日付
                _wvar1.NMonth = 0;
                // 内部月
                //@ Unsupported property or method(A): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                _wvar1.SwkInpKbn = _wvar1.GetFld("SwkInpKbn").AsInteger;
                // 仕訳発生区分
                _wvar1.DataClass = 0;
                // ﾃﾞｰﾀ種別
                //@ Unsupported property or method(A): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                _wvar1.SwkForm = _wvar1.GetFld("SwkForm").AsInteger;
                // 仕訳入力形式
                //@ Unsupported property or method(A): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                _wvar1.TeikeiClass = _wvar1.GetFld("TeikeiClass").AsInteger;
                // 仕訳入力形式
                //@ Unsupported property or method(A): 'GetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                _wvar1.HSrchNo = _wvar1.GetFld("HSrchNo").AsInteger;
                // ﾍｯﾀﾞ検索No
                _wvar1.Post();
                //@ Unsupported property or method(D): 'NEXT'
                7.NEXT;
                //@ Unsupported function or procedure: 'eof'
                if (eof)
                {
                    m_cFixIF.Swkup();
                }
            }
            //@ Unsupported function or procedure: 'Close'
            Close;
            //@ Unsupported property or method(C): 'Free'
            this.Free;
            //@ Undeclared identifier(3): 'TMASCom'
            //@ Unsupported property or method(D): 'm_MsgStd'
            //@ Unsupported property or method(B): 'GetMsg'
            TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMsg(inforec, 20, 103);
            // ﾒｯｾｰｼﾞ文字列の置換え
            //@ Unsupported property or method(B): 'TMASCom'
            //@ Unsupported property or method(D): 'sMsg'
            //@ Unsupported property or method(D): 'm_MsgStd'
            //@ Unsupported property or method(B): 'MsgChange'
            //@ Unsupported property or method(D): 'sMsg'
            inforec.sMsg = inforec.TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "一括@_@", "定型仕訳一括削除");
            // ﾀｲﾄﾙ文字列の置換え
            //@ Unsupported property or method(B): 'TMASCom'
            //@ Unsupported property or method(D): 'sTitle'
            //@ Unsupported property or method(D): 'm_MsgStd'
            //@ Unsupported property or method(B): 'MsgChange'
            //@ Unsupported property or method(D): 'sTitle'
            inforec.sTitle = inforec.TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sTitle, "一括@_@", "定型仕訳一括削除");
            //@ Unsupported property or method(D): 'sMsg'
            //@ Unsupported property or method(D): 'sTitle'
            //@ Unsupported property or method(D): 'icontype'
            //@ Unsupported property or method(D): 'btntype'
            //@ Unsupported property or method(D): 'btndef'
            //@ Unsupported property or method(D): 'LogType'
            mrBtn = VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef, inforec.LogType);
            if (mrBtn == System.Windows.Forms.DialogResult.Yes)
            {
                //@ Unsupported property or method(A): 'Commit'
                m_cMDModule.Commit(m_FCopDB);
            }
            else
            {
                //@ Unsupported property or method(A): 'Rollback'
                m_cMDModule.Rollback(m_FCopDB);
            }
        }

        // ******************************************************************************
        // Proccess	:	定型仕訳：コード変更
        // Name		:	K.Hattori(MJS)
        // Date		:	2001/09/26
        // Parameter	:	Integer			仕訳発生区分
        // Return		:	Nothing
        // ******************************************************************************
        public int FxHeadCodeChange(int iInpKbn, int iGCodeF, int iGCodeT)
        {
            int result;
            TMQuery cFdqInfo;
            // (*db*)
            string s_String;
            string sTForm;
            string sTClass;
            result = 0;
            cFdqInfo = new TMQuery(PMPanelHd);
            //@ Unsupported property or method(A): 'SetDBInfoToQuery'
            m_cMDModule.SetDBInfoToQuery(m_FCopDB, cFdqInfo);
            // 定型仕訳　パラメータ　ゲット
            GetFxPara(out sTForm, out sTClass);
            s_String = "select * from SwkFxHead where Swkform=" + sTForm + " and TeikeiClass=" + sTClass;
            s_String = s_String + " and SwkInpKbn=" + (iInpKbn).ToString() + " and GCode=" + (iGCodeT).ToString();
            //@ Unsupported function or procedure: 'Close'
            Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            cFdqInfo.SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            cFdqInfo.SQL.Add(s_String);
            //@ Unsupported property or method(D): 'Open'
            cFdqInfo.Open;
            //@ Unsupported function or procedure: 'eof'
            if (eof)
            {
                // ﾍｯﾀﾞ情報ｾｯﾄ
                TVKZL310Fix_SwkHead _wvar1 = m_cFixIF.SwkHead;
                _wvar1.Add(1);
                // DenDate		:= 0;								//	伝票日付
                _wvar1.NMonth = 0;
                // 内部月
                _wvar1.SwkInpKbn = iInpKbn;
                // 仕訳発生区分
                _wvar1.DataClass = 0;
                // ﾃﾞｰﾀ種別
                _wvar1.SwkForm = Convert.ToInt32(sTForm);
                _wvar1.TeikeiClass = Convert.ToInt32(sTClass);
                _wvar1.HSrchNo = iFixHNo;
                // ﾍｯﾀﾞ検索No
                _wvar1.GCode = iGCodeT;
                // 定型No
                _wvar1.Post();
                m_cFixIF.Swkup();
            }
            else
            {
                result = 1;
            }
            //@ Unsupported function or procedure: 'Close'
            Close;
            //@ Unsupported property or method(C): 'Free'
            this.Free;
            return result;
        }

        // ******************************************************************************
        // Proccess	:	定型仕訳：ヘッダ変更
        // Name		:	K.Hattori(MJS)
        // Date		:	2001/09/26
        // Parameter	:	Integer			仕訳発生区分
        // Return		:	Nothing
        // ******************************************************************************
        public int FxHeadChange(int iInpKbn, int iGCode, string sLName, string sRenso)
        {
            int result;
            TMQuery cFdqInfo;
            // (*db*)
            string s_String;
            string sTForm;
            string sTClass;
            result = 0;
            cFdqInfo = new TMQuery(PMPanelHd);
            //@ Unsupported property or method(A): 'SetDBInfoToQuery'
            m_cMDModule.SetDBInfoToQuery(m_FCopDB, cFdqInfo);
            // 定型仕訳　パラメータ　ゲット
            GetFxPara(out sTForm, out sTClass);
            s_String = "select * from SwkFxHead where Swkform=" + sTForm + " and TeikeiClass=" + sTClass;
            s_String = s_String + " and SwkInpKbn=" + (iFixInpKbn).ToString() + " and GCode=" + (iFixNo).ToString();
            s_String = s_String + " and GCode=" + (iFixNo).ToString();
            //@ Unsupported function or procedure: 'Close'
            Close;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(D): 'Clear'
            cFdqInfo.SQL.Clear;
            //@ Unsupported property or method(D): 'SQL'
            //@ Unsupported property or method(B): 'Add'
            cFdqInfo.SQL.Add(s_String);
            //@ Unsupported property or method(D): 'Open'
            cFdqInfo.Open;
            //@ Unsupported function or procedure: 'eof'
            if (eof)
            {
                result = 1;
            // ---<VK04001> 比較はパラメータを見る-------------------------------------------
            }
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsString'
            //@ Unsupported property or method(B): 'GetFld'
            //@ Unsupported property or method(D): 'AsString'
            else if ((cFdqInfo.GetFld("LongName").AsString == sLName) && (cFdqInfo.GetFld("RenChar").AsString == sRenso))
            {
                // else if	(GetFld('LongName').AsString=sFixName)and
                // (GetFld('RenChar').AsString=sFixRen)	then
                // ------------------------------------------------------------------<VK04001>---
                result = 2;
            }
            else
            {
                // ﾍｯﾀﾞ情報ｾｯﾄ
                TVKZL310Fix_SwkHead _wvar1 = m_cFixIF.SwkHead;
                _wvar1.Add(1);
                _wvar1.NMonth = 0;
                // 内部月
                _wvar1.SwkInpKbn = iFixInpKbn;
                // 仕訳発生区分
                _wvar1.DataClass = 0;
                // ﾃﾞｰﾀ種別
                _wvar1.SwkForm = Convert.ToInt32(sTForm);
                _wvar1.TeikeiClass = Convert.ToInt32(sTClass);
                _wvar1.HSrchNo = iFixHNo;
                // ﾍｯﾀﾞ検索No
                // ---<VK04001>------------------------------------------------------------------
                _wvar1.LongName = sLName;
                // 定型名称
                _wvar1.RenChar = sRenso;
                // 連想
                // LongName	:=	sFixName;				//	定型名称
                // RenChar		:=	sFixRen;				//	連想
                // ------------------------------------------------------------------<VK04001>---
                _wvar1.Post();
                m_cFixIF.Swkup();
            }
            //@ Unsupported function or procedure: 'Close'
            Close;
            //@ Unsupported property or method(C): 'Free'
            this.Free;
            return result;
        }

        // 2001/09/21 Ins
        // (*20010906 khattori tuika*)
        // ---<HIS-051>------------------------------------------------------------------
        // (*H0008 20010926 khattori 定型仕訳 排他対応*)
        // ******************************************************************************
        // Proccess	:	GetFixLock	定型仕訳排他処理
        // Parameter	:	pPar1	: Pointer 		仕訳排他処理構造体 TMASL310IFixLock
        // bMsg	: Boolean		メッセージ出力フラグ
        // TMASL310IFixLock = record
        // iAction	:	Integer;	//	要求動作
        // iInpKbn	:	Integer;	//	発生区分
        // iForm	:	Integer;	//	入力形式
        // iClass	:	Integer;	//	定型種別
        // iGCodeF	:	Integer;	//	定型ＮＯ
        // iGCodeT	:	Integer;	//	定型ＮＯ
        // end;
        // Return		:	排他結果	0=正常、0<>異常
        // History		:	<HIS-044>
        // ******************************************************************************
        public int GetFixLock(object pPar1, bool bMsg)
        {
            int result;
            TMQuery m_FdqSwk;
            // (*db*)
            TMASL310IFixLock cFixLock;
            string sSql;
            int iRetry;
            bool bSqlRetn;
            TMASL310IFunc rFunc;
            result = 0;
            // if	(m_cMDModule<>nil) and (m_FFixDB<>nil)
            if ((m_cMDModule != null) && (m_FTrnDB != null))
            {
                // ＲｏｌｌＢａｃｋ
                //@ Unsupported property or method(A): 'Rollback'
                m_cMDModule.Rollback(m_FTrnDB);
                // m_cMDModule.Rollback( m_FFixDB );
                cFixLock = ((TMASL310IFixLock)(pPar1));
                // 第１指示取得
                rFunc = Itm.ReadIniRec(iFirstCode);
                // 第１指示取得が定型登録でも定型入力でもない
                if ((rFunc.iMode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU) && (rFunc.iMode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_NYUURYOKU))
                {
                    // 第２指示取得
                    rFunc = Itm.ReadIniRec(iSecondCode);
                }
                // //////////////////////////////////
                // 修正モード排他開始
                // //////////////////////////////////
                if (cFixLock.iAction == 0)
                {
                    //@ Unsupported property or method(A): 'BeginTran'
                    m_cMDModule.BeginTran(m_FTrnDB);
                    // m_cMDModule.BeginTran( m_FFixDB );
                    m_FdqSwk = new TMQuery(PMPanelHd);
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FTrnDB, m_FdqSwk);
                    // m_cMDModule.SetDBInfoToQuery(m_FFixDB,m_FdqSwk);
                    if (cFixLock.iInpKbn ==  -1)
                    {
                        // 全発生区分対象→一括削除で使用（他で使用中は失敗）
                        sSql = "INSERT INTO SwkFxExclusive" + " (SwkInpKbn,SwkForm,TeikeiClass,GCode,RecordKbn)" + " VALUES (" + '0' + ',' + (cFixLock.iForm).ToString() + ',' + (cFixLock.iClass).ToString() + ",0,0);";
                        sSql = sSql + "INSERT INTO SwkFxExclusive" + " (SwkInpKbn,SwkForm,TeikeiClass,GCode,RecordKbn)" + " VALUES (" + '1' + ',' + (cFixLock.iForm).ToString() + ',' + (cFixLock.iClass).ToString() + ",0,0);";
                    }
                    else
                    {
                        // 自定型ＮＯを追加（他で使用中は失敗）
                        sSql = "INSERT INTO SwkFxExclusive" + " (SwkInpKbn,SwkForm,TeikeiClass,GCode,RecordKbn)" + " VALUES (" + (cFixLock.iInpKbn).ToString() + ',' + (cFixLock.iForm).ToString() + ',' + (cFixLock.iClass).ToString() + ',' + (cFixLock.iGCodeF).ToString() + ",0);";
                        if (cFixLock.iGCodeT != 0)
                        {
                            sSql = sSql + "INSERT INTO SwkFxExclusive" + " (SwkInpKbn,SwkForm,TeikeiClass,GCode,RecordKbn)" + " VALUES (" + (cFixLock.iInpKbn).ToString() + ',' + (cFixLock.iForm).ToString() + ',' + (cFixLock.iClass).ToString() + ',' + (cFixLock.iGCodeT).ToString() + ",0);";
                        }
                    }
                    //@ Unsupported function or procedure: 'Close'
                    Close;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(D): 'Clear'
                    m_FdqSwk.SQL.Clear;
                    //@ Unsupported property or method(D): 'SQL'
                    //@ Unsupported property or method(B): 'Add'
                    m_FdqSwk.SQL.Add(sSql);
                    // ＳＱＬ実行
                    //@ Unsupported property or method(D): 'ExecSQL'
                    bSqlRetn = m_FdqSwk.ExecSQL;
                    if (bSqlRetn)
                    {
                        // 全発生区分対象→一括削除で使用
                        if (cFixLock.iInpKbn ==  -1)
                        {
                            // 個別すべてを削除（他で使用中は失敗）
                            sSql = "DELETE SwkFxExclusive" + " WHERE	SwkForm=" + (cFixLock.iForm).ToString() + " AND	TeikeiClass=" + (cFixLock.iClass).ToString() + " AND GCode<>0";
                        // +		' AND	RecordKbn=0 AND GCode<>0';
                        }
                        else
                        {
                            // 他定型ＮＯを削除（他で使用中は失敗）
                            // 個別なら自分の入力モードと一括を、一括なら個別すべてを削除
                            sSql = "DELETE SwkFxExclusive" + " WHERE SwkInpKbn=" + (cFixLock.iInpKbn).ToString() + " AND	SwkForm=" + (cFixLock.iForm).ToString() + " AND	TeikeiClass=" + (cFixLock.iClass).ToString() + "";
                            if (cFixLock.iGCodeF == 0)
                            {
                                sSql = sSql + " AND GCode<>0;";
                            }
                            else
                            {
                                sSql = sSql + " AND((RecordKbn<>0 AND GCode=" + (cFixLock.iGCodeF).ToString() + ")or(GCode=0));";
                            }
                        }
                        //@ Unsupported function or procedure: 'Close'
                        Close;
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(D): 'Clear'
                        m_FdqSwk.SQL.Clear;
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqSwk.SQL.Add(sSql);
                        // LogWrite(SQL.Text);
                        // ＳＱＬ実行	リトライはしない
                        //@ Unsupported property or method(D): 'ExecSQL'
                        bSqlRetn = m_FdqSwk.ExecSQL;
                    }
                    // 排他成功	排他解除ｏｒ処理終了までトランザクション継続
                    if (bSqlRetn)
                    {
                    // 排他失敗	ＲｏｌｌＢａｃｋ
                    }
                    else
                    {
                        //@ Unsupported property or method(A): 'Rollback'
                        m_cMDModule.Rollback(m_FTrnDB);
                        // m_cMDModule.Rollback( m_FFixDB );
                        result =  -1;
                    }
                    //@ Unsupported property or method(C): 'Free'
                    this.Free;
                }
                // //////////////////////////////////
                // 入力モード排他開始
                // //////////////////////////////////
                if (cFixLock.iAction == 1)
                {
                    //@ Unsupported property or method(A): 'BeginTran'
                    m_cMDModule.BeginTran(m_FTrnDB);
                    // m_cMDModule.BeginTran( m_FFixDB );
                    m_FdqSwk = new TMQuery(PMPanelHd);
                    //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                    m_cMDModule.SetDBInfoToQuery(m_FTrnDB, m_FdqSwk);
                    // m_cMDModule.SetDBInfoToQuery(m_FFixDB,m_FdqSwk);
                    // 自定型ＮＯを追加（１〜２５５でリトライ）
                    sSql = "INSERT INTO SwkFxExclusive" + " (SwkInpKbn,SwkForm,TeikeiClass,GCode,RecordKbn)" + " VALUES (" + (cFixLock.iInpKbn).ToString() + ',' + (cFixLock.iForm).ToString() + ',' + (cFixLock.iClass).ToString() + ',' + (cFixLock.iGCodeF).ToString() + ',';
                    // for iRetry := 254 to 255 do
                    for (iRetry = 1; iRetry <= 255; iRetry ++ )
                    {
                        //@ Unsupported function or procedure: 'Close'
                        Close;
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(D): 'Clear'
                        m_FdqSwk.SQL.Clear;
                        //@ Unsupported property or method(D): 'SQL'
                        //@ Unsupported property or method(B): 'Add'
                        m_FdqSwk.SQL.Add(sSql + (iRetry).ToString() + ");");
                        // LogWrite(SQL.Text);
                        // ＳＱＬ実行
                        //@ Unsupported property or method(D): 'ExecSQL'
                        bSqlRetn = m_FdqSwk.ExecSQL;
                        if (bSqlRetn)
                        {
                            // 他定型ＮＯを削除（他で使用中は失敗）
                            sSql = "DELETE SwkFxExclusive" + " WHERE SwkInpKbn=" + (cFixLock.iInpKbn).ToString() + " AND	SwkForm=" + (cFixLock.iForm).ToString() + " AND	TeikeiClass=" + (cFixLock.iClass).ToString() + " AND	RecordKbn=0" + " AND ((GCode=0)or(GCode=" + (cFixLock.iGCodeF).ToString() + "));";
                            //@ Unsupported function or procedure: 'Close'
                            Close;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(D): 'Clear'
                            m_FdqSwk.SQL.Clear;
                            //@ Unsupported property or method(D): 'SQL'
                            //@ Unsupported property or method(B): 'Add'
                            m_FdqSwk.SQL.Add(sSql);
                            // LogWrite(SQL.Text);
                            // ＳＱＬ実行	リトライはしない
                            //@ Unsupported property or method(D): 'ExecSQL'
                            bSqlRetn = m_FdqSwk.ExecSQL;
                            break;
                        }
                    }
                    // 排他成功	排他解除ｏｒ処理終了までトランザクション継続
                    if (bSqlRetn)
                    {
                    // 排他失敗	ＲｏｌｌＢａｃｋ
                    }
                    else
                    {
                        //@ Unsupported property or method(A): 'Rollback'
                        m_cMDModule.Rollback(m_FTrnDB);
                        // m_cMDModule.Rollback( m_FFixDB );
                        result =  -1;
                    }
                    //@ Unsupported property or method(C): 'Free'
                    this.Free;
                }
                if (result ==  -1)
                {
                    // ---<HIS-051>------------------------------------------------------------------
                    if (bMsg)
                    {
                        Console.Beep();
                        if ((rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU))
                        {
                            // 定型仕訳登録
                            //@ Undeclared identifier(3): 'mjError'
                            //@ Undeclared identifier(3): 'mjOk'
                            //@ Undeclared identifier(3): 'mjDefOk'
                            VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("他の端末で使用されています。", "定型仕訳登録", mjError, mjOk, mjDefOk);
                        }
                        else
                        {
                            //@ Undeclared identifier(3): 'mjError'
                            //@ Undeclared identifier(3): 'mjOk'
                            //@ Undeclared identifier(3): 'mjDefOk'
                            VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx("他の端末で使用されています。", "定型仕訳入力", mjError, mjOk, mjDefOk);
                        }
                    }
                // ------------------------------------------------------------------<HIS-051>---
                }
            }
            return result;
        }

        public int GetFixLock(object pPar1)
        {
            return GetFixLock(pPar1, false);
        }

        // (*db*)
        // ---<HIS-004>------------------------------------------------------------------
        // ---<HIS-004>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	子フォーム表示用ダイアログ 生成
        // Parameter : rFunc			TMASL310IFunc
        // Return    : Pointer			^TMjsAppRecord
        // ******************************************************************************
        protected object CreateCldFormDLg(TMASL310IFunc rFunc)
        {
            object result;
            TMjsAppRecord pRec;
            TMjsMsgRec inforec;
            pRec = new TMjsAppRecord();
            // ﾊﾟﾗﾒｰﾀ作成
            pRec = m_pRec;
            pRec.m_hChildBpl = 0;
            pRec.m_iProgramCode = rFunc.iOpCode;
            // iApNo;
            pRec.m_iDelete = 0;
            // 削除ﾌﾗｸﾞ		設定
            result = null;
            pRec.m_pChildEntry = MAS310000CldFormDlgu.GetAppEntry();
            pRec.m_pChildForm = null;
            // 子BplFormのﾎﾟｲﾝﾀ
            pRec.m_pOwnerEntry = MAS310000CldFormDlgu.Units.MAS310000CldFormDlgu.AppEntry();
            // 親BplのAppEntry
            pRec.m_pOwnerForm = m_pRec.m_pChildForm;
            // 親bplFormのﾎﾟｲﾝﾀ
            pRec.m_pOwnerPanel = PMPanelAp;
            // 親BplのPanelﾎﾟｲﾝﾀ
            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_CODE, rFunc.iOpCode);
            // カレント処理ｺｰﾄﾞ
            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_TYPE, rFunc.iType);
            // カレント処理モード
            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_MODE, rFunc.iMode);
            // カレント処理動作
            Vfnc(VKZ310Cmnu.enVfunc.MASL_VSET_PROC_STYL, rFunc.iStyl);
            // カレント処理形態
            if (BplAction(Units.MAS310000u.ACTID_FORMCREATESTART, pRec) != Units.MAS310000u.ACTID_RET_OK)
            {
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'GetMSG'
                TMASCom(m_pRec.m_pSystemArea).m_MsgStd.GetMSG(inforec, 20, 3);
                //@ Undeclared identifier(3): 'TMASCom'
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'm_MsgStd'
                //@ Unsupported property or method(B): 'MsgChange'
                //@ Unsupported property or method(D): 'sMsg'
                inforec.sMsg = TMASCom(m_pRec.m_pSystemArea).m_MsgStd.MsgChange(inforec.sMsg, "@_@", "\r\n" + "\r\n" + '[' + (rFunc.iOpCode).ToString() + "] " + rFunc.sCaption);
                //@ Unsupported property or method(D): 'sMsg'
                //@ Unsupported property or method(D): 'sTitle'
                //@ Unsupported property or method(D): 'icontype'
                //@ Unsupported property or method(D): 'btntype'
                //@ Unsupported property or method(D): 'btndef'
                VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(inforec.sMsg, inforec.sTitle, inforec.icontype, inforec.btntype, inforec.btndef);
                //@ Unsupported function or procedure: 'UnLoadPackage'
                UnLoadPackage(pRec.m_hChildBpl);
                //@ Unsupported function or procedure: 'Dispose'
                Dispose(pRec);
                return result;
            }
            result = pRec;
            return result;
        }

        // ******************************************************************************
        // Proccess  :	排他制御エラーチェック
        // Parameter : Status		Integer		エラーステータス
        // Return    : None
        // Comment	  :	システムメニュー(TMASSystemMenuF)より
        // ******************************************************************************
        public void SetExceptSubPrg_ExceptErrorCheck(int Status)
        {
            string sMessage;
            string sCorp;
            if (((m_pRec.m_pCommonArea) as rcCOMMONAREA).ObjectFlg == 1)
            {
                sCorp = "共通会社";
            }
            else
            {
                sCorp = "顧問先";
            }
            sMessage = "";
            switch(Status)
            {
                case  -1:
                    // 0:		sMessage := '正常';												// 正常
                    sMessage = "その他のエラーです。";
                    break;
                case  -2:
                    // その他エラー
                    sMessage = "他でロック中です。";
                    break;
                case  -3:
                    // ロック中
                    sMessage = "端末情報がありません。";
                    break;
                case  -4:
                    // 端末情報なし
                    sMessage = "ﾚｺｰﾄﾞ追加のエラーです。";
                    break;
                case  -5:
                    // ﾚｺｰﾄﾞ追加エラー
                    sMessage = "レベルの取得に失敗しました。";
                    break;
                case  -6:
                    // レベル取得失敗
                    sMessage = "他の端末で会社単独が実行中です。";
                    break;
                case  -7:
                    // 端末会社単独実行中
                    sMessage = "端末会社単独設定ができません。";
                    break;
                case  -8:
                    // 端末会社単独設定不可
                    sMessage = "会社別処理が単独実行中です。";
                    break;
                case  -9:
                    // 会社別処理単独実行中
                    sMessage = "会社別処理単独設定ができません。";
                    break;
                case  -10:
                    // 会社別処理単独設定不可
                    sMessage = "会社更新ﾓｰﾄﾞで実行中です。";
                    break;
                case  -11:
                    // 会社更新ﾓｰﾄﾞ実行中
                    sMessage = "会社更新ﾓｰﾄﾞ設定ができません。";
                    break;
                case  -12:
                    // 会社更新ﾓｰﾄﾞ設定不可
                    sMessage = "会社単独が実行中です。";
                    break;
                case  -13:
                    // 会社単独実行中
                    sMessage = "会社単独設定ができません。";
                    break;
                case  -14:
                    // 会社単独設定不可
                    sMessage = sCorp + "単独が実行中です。";
                    break;
                case  -15:
                    // 顧問先単独実行中
                    sMessage = sCorp + "単独設定ができません。";
                    break;
                case  -16:
                    // 顧問先単独設定不可
                    sMessage = "ｼｽﾃﾑ別処理で単独実行中です。";
                    break;
                case  -17:
                    // ｼｽﾃﾑ別処理単独実行中
                    sMessage = "ｼｽﾃﾑ別処理単独設定ができません。";
                    break;
                case  -18:
                    // ｼｽﾃﾑ別処理単独設定不可
                    sMessage = "ｼｽﾃﾑ単独が実行中です。";
                    break;
                case  -19:
                    // ｼｽﾃﾑ単独実行中
                    sMessage = "ｼｽﾃﾑ単独設定ができません。";
                    break;
                case  -20:
                    // ｼｽﾃﾑ単独設定不可
                    sMessage = "MJS単独が実行中です。";
                    break;
                case  -21:
                    // MJS単独実行中
                    sMessage = "MJS単独設定ができません。";
                    break;
                case  -25:
                    // MJS単独設定不可
                    // -24:	sMessage := '既に解放済み';										// 既に解放済み
                    sMessage = "ｵﾌﾟｼｮﾝ単独が実行中です。";
                    break;
                case  -26:
                    // ｵﾌﾟｼｮﾝ単独実行中
                    sMessage = "ｵﾌﾟｼｮﾝ単独設定ができません。";
                    break;
                default:
                    // ｵﾌﾟｼｮﾝ単独設定不可
                    sMessage = "排他情報の操作に失敗しました。[" + (Status).ToString() + ']';
                    break;
            // その他操作失敗
            }
            if (Status < 0)
            {
                if (Status !=  -24)
                {
                    //@ Undeclared identifier(3): 'mjWarning'
                    //@ Undeclared identifier(3): 'mjOk'
                    //@ Undeclared identifier(3): 'mjDefOk'
                    VKZ310Cmnu.Units.VKZ310Cmnu.MjsMessageBoxEx(sMessage, "排他制御エラー", mjWarning, mjOk, mjDefOk);
                }
            }
        }

        // ------------------------------------------------------------------<HIS-004>---
        // ---<HIS-007>------------------------------------------------------------------
        // ------------------------------------------------------------------<HIS-004>---
        // ---<HIS-007>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	サブプログラムに対して会社別処理単独の排他をかける
        // Parameter : iMode		Integer			処理モード
        // 0:	排他設定
        // 1:	排他解除
        // Return    : Boolean
        // ******************************************************************************
        protected bool SetExceptSubPrg(int iMode)
        {
            bool result;
            int iSys;
            int iOpt;
            int iCop;
            int iSub;
            int iPrg;
            TMjsExceptDbmF pExcept;
            gtExcLevel iLvl;
            int iRet;
            result = false;
            iSys = m_pRec.m_iSystemCode;
            iOpt = m_pRec.m_iOptionCode;
            iCop = m_pRec.m_iCorpCode;
            iSub = m_pRec.m_iCorpSubCode;
            iPrg = 391000;
            // 取込処理
            pExcept = m_pRec.m_pExpModule;
            //@ Undeclared identifier(3): 'ueCopPrg'
            iLvl = ueCopPrg;
            switch(iMode)
            {
                case 0:
                    // 排他設定
                    //@ Unsupported property or method(B): 'SetExcept'
                    iRet = pExcept.SetExcept(iLvl, iSys, iOpt, iCop, iSub, iPrg, 0);
                    if (iRet < 0)
                    {
                        SetExceptSubPrg_ExceptErrorCheck(iRet);
                        return result;
                    }
                    break;
                case 1:
                    // 排他解除
                    try {
                        //@ Unsupported property or method(B): 'ResetExcept'
                        pExcept.ResetExcept(iLvl, iSys, iOpt, iCop, iSub, iPrg, 0);
                    }
                    catch {
                        return result;
                    }
                    break;
                default:
                    return result;
                    break;
            // パラメータエラー
            }
            result = true;
            return result;
        }

        // ---<HIS-014>------------------------------------------------------------------
        // ------------------------------------------------------------------<HIS-007>---
        // ---<HIS-014>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	伝票種別No 取得
        // Parameter : None
        // Return    : Integer
        // ******************************************************************************
        public int fnGetClass()
        {
            int result;
            int iClass;
            TMASL310IDrParam cFrPar;
            // 親−＞自分		×	○
            string sTForm;
            string sTClass;
            TMASL310IFunc rFunc;
            // 第１指示取得
            rFunc = Itm.ReadIniRec(iFirstCode);
            // 第１指示が定型登録ではない
            if (rFunc.iMode != VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU)
            {
                // 第２指示取得
                rFunc = Itm.ReadIniRec(iSecondCode);
            }
            if (rFunc.iMode == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_MODE_TEIKEITOUROKU)
            {
                GetFxPara(out sTForm, out sTClass);
                if (sTClass != "")
                {
                    iClass = Convert.ToInt32('0' + sTClass);
                }
            }
            else
            {
                if (iCurrentProcCode > 999999)
                {
                    iClass = iCurrentProcCode % 100;
                }
                else
                {
                    cFrPar = ((TMASL310IDrill)(GetDrillParam(null))).FrPar;
                    if (cFrPar.Efct)
                    {
                        iClass = cFrPar.Shkg;
                    }
                    else
                    {
                        iClass = 0;
                    }
                }
            }
            result = iClass;
            return result;
        }

        // ------------------------------------------------------------------<HIS-014>---
#endif
    } // end TMASL310Root

    // -------------------------------------------------------------------------------------------
    // ID				 		値				内容						UPDATE
    // ------------------------------------------------------------------------------------------
    // ≪ステータス≫
    // 正常
    // 失敗
    // ≪処理ID≫
    // 初期処理
    // 終了処理
    // 排他情報 セット
    // 排他情報 リセット
    // 自端末の排他情報 リセット
    // 全端末の排他情報 リセット
    // ≪排他ID≫
    // 部署抽出
    // 部署連結
    // その他DB更新処理
    // 〜排他用マスタNO〜
    // 科目マスタ・実績更新
    // 科目別補助マスタ・実績更新
    // 資金繰マスタ・実績更新
    // 要約B/Sマスタ・実績更新
    // 要約P/Lマスタ・実績更新
    // 固定変動マスタ・実績更新
    // タイトル科目マスタ・実績更新
    // 工事合計科目マスタ・実績更新
    // 工事集計科目マスタ・実績更新
    // 分析科目マスタ・実績更新
    // 部門元帳合計科目マスタ・実績更新
    // 補助元帳合計科目マスタ・実績更新
    // 銀行マスタ・実績更新
    // 取引先マスタ・実績更新
    // 社員マスタ・実績更新
    // 汎用補助1銀行マスタ・実績更新
    // 汎用補助2銀行マスタ・実績更新
    // 汎用補助3銀行マスタ・実績更新
    // 汎用補助4銀行マスタ・実績更新
    // 汎用補助5銀行マスタ・実績更新
    // 部門マスタ・実績更新
    // セグメントマスタ・実績更新
    // 工事マスタ・実績更新
    // 摘要マスタ・実績更新
    // その他
    // 〜チェック用マスタNO〜
    // 仕訳
    // 科目マスタ・実績更新
    // 科目別補助マスタ・実績更新
    // 資金繰マスタ・実績更新
    // 要約B/Sマスタ・実績更新
    // 要約P/Lマスタ・実績更新
    // 固定変動マスタ・実績更新
    // タイトル科目マスタ・実績更新
    // 工事合計科目マスタ・実績更新
    // 工事集計科目マスタ・実績更新
    // 分析科目マスタ・実績更新
    // 部門元帳合計科目マスタ・実績更新
    // 補助元帳合計科目マスタ・実績更新
    // 銀行マスタ・実績更新
    // 取引先マスタ・実績更新
    // 社員マスタ・実績更新
    // 汎用補助1銀行マスタ・実績更新
    // 汎用補助2銀行マスタ・実績更新
    // 汎用補助3銀行マスタ・実績更新
    // 汎用補助4銀行マスタ・実績更新
    // 汎用補助5銀行マスタ・実績更新
    // 部門マスタ・実績更新
    // セグメントマスタ・実績更新
    // 工事マスタ・実績更新
    // 摘要マスタ・実績更新
    // その他
    // ≪ミューテックス名称≫
    // MUTEXｵﾌﾞｼﾞｪｸﾄ名称
    // End of File
    // ************************************************************************
    // System      :  新会計システム
    // Program		:  排他制御モジュール 呼び出しClass
    // ProgramID	:  MasExceptIFH
    // Name		:  S.Ogawa ( MJS AP開発 )
    // Create		:  2003/05/15
    // Comment		:
    // History		:
    // 番号		修正者		修正レポート番号		修正内容
    // *************************************************************************
    // *************************************************************
    // 排他制御モジュール インターフェース用 ID 定義ファイル
    // *************************************************************
    public struct TExcRecordPara
    {
    } // end TExcRecordPara

    // -------------------------------------------------------------------------------------------
    // ID				 		値				内容						UPDATE
    // ------------------------------------------------------------------------------------------
    // ≪ステータス≫
    // 正常
    // 失敗
    // ≪処理ID≫
    // 初期処理
    // 終了処理
    // 排他情報 セット
    // 排他情報 リセット
    // 自端末の排他情報 リセット
    // 全端末の排他情報 リセット
    // ≪排他ID≫
    // 部署抽出
    // 部署連結
    // その他DB更新処理
    // 〜排他用マスタNO〜
    // 科目マスタ・実績更新
    // 科目別補助マスタ・実績更新
    // 資金繰マスタ・実績更新
    // 要約B/Sマスタ・実績更新
    // 要約P/Lマスタ・実績更新
    // 固定変動マスタ・実績更新
    // タイトル科目マスタ・実績更新
    // 工事合計科目マスタ・実績更新
    // 工事集計科目マスタ・実績更新
    // 分析科目マスタ・実績更新
    // 部門元帳合計科目マスタ・実績更新
    // 補助元帳合計科目マスタ・実績更新
    // 銀行マスタ・実績更新
    // 取引先マスタ・実績更新
    // 社員マスタ・実績更新
    // 汎用補助1銀行マスタ・実績更新
    // 汎用補助2銀行マスタ・実績更新
    // 汎用補助3銀行マスタ・実績更新
    // 汎用補助4銀行マスタ・実績更新
    // 汎用補助5銀行マスタ・実績更新
    // 部門マスタ・実績更新
    // セグメントマスタ・実績更新
    // 工事マスタ・実績更新
    // 摘要マスタ・実績更新
    // その他
    // 〜チェック用マスタNO〜
    // 仕訳
    // 科目マスタ・実績更新
    // 科目別補助マスタ・実績更新
    // 資金繰マスタ・実績更新
    // 要約B/Sマスタ・実績更新
    // 要約P/Lマスタ・実績更新
    // 固定変動マスタ・実績更新
    // タイトル科目マスタ・実績更新
    // 工事合計科目マスタ・実績更新
    // 工事集計科目マスタ・実績更新
    // 分析科目マスタ・実績更新
    // 部門元帳合計科目マスタ・実績更新
    // 補助元帳合計科目マスタ・実績更新
    // 銀行マスタ・実績更新
    // 取引先マスタ・実績更新
    // 社員マスタ・実績更新
    // 汎用補助1銀行マスタ・実績更新
    // 汎用補助2銀行マスタ・実績更新
    // 汎用補助3銀行マスタ・実績更新
    // 汎用補助4銀行マスタ・実績更新
    // 汎用補助5銀行マスタ・実績更新
    // 部門マスタ・実績更新
    // セグメントマスタ・実績更新
    // 工事マスタ・実績更新
    // 摘要マスタ・実績更新
    // その他
    // ≪ミューテックス名称≫
    // MUTEXｵﾌﾞｼﾞｪｸﾄ名称
    // End of File
    // ************************************************************************
    // System      :  新会計システム
    // Program		:  排他制御モジュール 呼び出しClass
    // ProgramID	:  MasExceptIFH
    // Name		:  S.Ogawa ( MJS AP開発 )
    // Create		:  2003/05/15
    // Comment		:
    // History		:
    // 番号		修正者		修正レポート番号		修正内容
    // *************************************************************************
    // *************************************************************
    // 排他制御モジュール インターフェース用 ID 定義ファイル
    // *************************************************************
    public struct TExcRecordPara
    {
        // 排他制御モジュールﾊﾟﾗﾒｰﾀ 構造体
        public byte iMode;
        // 処理コード
        public object pRec;
        // MjsAppRecordのポインタ
        public object pModule;
        // モジュールクラスのポインタ
        public int iPrgID;
        // プログラムID
        public int iExceptID;
        // 排他ID
        public byte iStatus100;
        // 100番台排他フラグ
        public byte iStatus200;
        // 200番台排他フラグ
        public byte iStatus300;
        // 300番台排他フラグ
        public byte iStatus400;
        // 400番台排他フラグ
        public byte iStatus500;
    } // end TExcRecordPara

    public class TMasExceptIF
    {
        private TMjsAppRecord m_pRec = null;
        private rcCOMMONAREA m_ComArea = null;
        private TMASCom m_SysArea = null;
        private long m_hBpl = 0;
        private TExcRecordPara m_pPara = null;
        private TDbVerExceptApp m_pExcept = null;
        private TMDataModulef m_MDataModule = null;
        public byte Status100 = 0;
        public byte Status200 = 0;
        public byte Status300 = 0;
        public byte Status400 = 0;
        public byte Status500 = 0;
        // (*H0036 20030825 khattori	syuusei 会社単独廃止対応*)
        // ************************************************************************
        // System      :  新会計システム
        // Program		:  排他制御モジュール 呼び出しClass
        // ProgramID	:  MasExceptIFB
        // Name		:  S.Ogawa ( MJS AP開発 )
        // Create		:  2003/05/15
        // Comment		:
        // History		:
        // 番号		修正者		修正レポート番号		修正内容
        // *************************************************************************
        // **************************************************************************
        // Proccess  	:  	初期処理 ＆ 呼び出し
        // Name	  	:  	S.Ogawa ( MJS 開発 )
        // Date		:  	2003/05/15
        // Parameter  	:  	pRec	：ﾊﾟﾗﾒｰﾀ構造体
        // :  	iPrgID	：プログラムID
        // Retrun	  	:
        // History	　	:
        // **************************************************************************
        //Constructor  Init( pRec,  iPrgID)
        public TMasExceptIF(object pRec, int iPrgID)
        {
            int iRet;
            m_hBpl = 0;
            m_pRec = pRec;
            // メンバの初期化
            m_pPara.iMode = 0;
            m_pPara.pRec = null;
            m_pPara.pModule = null;
            m_pPara.iPrgID = 0;
            m_pPara.iExceptID = 0;
            m_pPara.iStatus100 = 0;
            m_pPara.iStatus200 = 0;
            m_pPara.iStatus300 = 0;
            m_pPara.iStatus400 = 0;
            m_pPara.iStatus500 = 0;
            //@ Undeclared identifier(3): 'TMDataModulef'
            m_MDataModule = TMDataModulef(m_pRec.m_pDBModule);
            // DBModule 取得
            m_ComArea = ((m_pRec.m_pCommonArea) as rcCOMMONAREA);
            // 共通ﾒﾓﾘ  取得
            //@ Undeclared identifier(3): 'TMASCom'
            m_SysArea = TMASCom(m_pRec.m_pSystemArea);
            // ｼｽﾃﾑﾒﾓﾘ  取得
            if (iPrgID == 0)
            {
                iPrgID = m_pRec.m_iProgramCode;
            }
            // MasExcept.BplのLoadPackage
            //@ Unsupported property or method(C): 'SystemArea'
            //@ Unsupported property or method(D): 'SysPrefix'
            //@ Unsupported function or procedure: 'LoadPackage'
            m_hBpl = LoadPackage(m_ComArea.SysRoot + '\\' + m_SysArea.SystemArea.SysPrefix + "\\PRG\\MASEXCEPT.BPL");
            if (m_hBpl == 0)
            {
                throw new Exception("MasExcept.BplのLoadPackageに失敗しました。");
            }
            // MasExcept.Bplの初期化
            //@ Unsupported function or procedure: 'GetProcAddress'
            m_pExcept = GetProcAddress(m_hBpl, "ExceptApp");
            if (m_pExcept == null)
            {
                throw new Exception("財務排他制御関数のExportアドレスの取得に失敗しました。");
            }
            m_pPara.iMode = Units.MAS310000u.MODE_INIT;
            m_pPara.pRec = pRec;
            m_pPara.iPrgID = iPrgID;
            iRet = m_pExcept(m_pPara);
            if (iRet != Units.MAS310000u.EXCEPT_RET_OK)
            {
                throw new Exception("財務排他制御関数の初期処理に失敗しました。");
            }
        }
        // **************************************************************************
        // Proccess  	:  	終了処理
        // Name	  	:  	S.Ogawa ( MJS 開発 )
        // Date		:  	2003/05/15
        // Parameter  	:
        // Retrun	  	:
        // History	　	:
        // **************************************************************************
        //@ Destructor  Destroy()
        ~TMasExceptIF()
        {
            // MasExcept.Bplの解放
            if (m_pExcept != null)
            {
                m_pPara.iMode = Units.MAS310000u.MODE_TERM;
                m_pExcept(m_pPara);
            }
            // MasExcept.BplをUnloadPackage
            if (m_hBpl != 0)
            {
                //@ Unsupported function or procedure: 'UnloadPackage'
                UnloadPackage(m_hBpl);
            }
        }
        // **************************************************************************
        // Proccess  	:  	排他情報セット
        // Name	  	:  	S.Ogawa ( MJS 開発 )
        // Date		:  	2003/05/15
        // Parameter  	:  	iExceptID	：排他ID
        // Retrun	  	:  	0:正常 ／ -1:失敗
        // History	　	:
        // **************************************************************************
        public int SetExcept(int iExceptID)
        {
            int result;
            // 与えられた排他IDをMasExcept.bplに引き渡す
            m_pPara.iMode = Units.MAS310000u.MODE_SETEXCEPT;
            m_pPara.iExceptID = iExceptID;
            result = m_pExcept(m_pPara);
            if (result == 0)
            {
                Status100 = m_pPara.iStatus100;
                Status200 = m_pPara.iStatus200;
                Status300 = m_pPara.iStatus300;
                Status400 = m_pPara.iStatus400;
                Status500 = m_pPara.iStatus500;
            }
            return result;
        }

        // **************************************************************************
        // Proccess  	:  	排他情報リセット
        // Name	  	:  	S.Ogawa ( MJS 開発 )
        // Date		:  	2003/05/15
        // Parameter  	:  	iExceptID	：排他ID
        // Retrun	  	:  	0:正常 ／ -1:失敗
        // History	　	:
        // **************************************************************************
        public int ResetExcept(int iExceptID)
        {
            int result;
            // 与えられた排他IDをMasExcept.bplに引き渡す
            m_pPara.iMode = Units.MAS310000u.MODE_RESETEXCEPT;
            m_pPara.iExceptID = iExceptID;
            result = m_pExcept(m_pPara);
            return result;
        }

        // **************************************************************************
        // Proccess  	:  自端末の処理IDの排他情報リセット
        // Name	  	:  	S.Ogawa ( MJS 開発 )
        // Date		:  	2003/05/15
        // Parameter  	:
        // Retrun	  	:  	0:正常 ／ -1:失敗
        // History	　	:
        // **************************************************************************
        public int ResetTerm()
        {
            int result;
            // 与えられた排他IDをMasExcept.bplに引き渡す
            m_pPara.iMode = Units.MAS310000u.MODE_RESETTERM;
            result = m_pExcept(m_pPara);
            return result;
        }

        // **************************************************************************
        // Proccess  	:  全端末の排他情報リセット
        // Name	  	:  	S.Ogawa ( MJS 開発 )
        // Date		:  	2003/05/15
        // Parameter  	:
        // Retrun	  	:  	0:正常 ／ -1:失敗
        // History	　	:
        // **************************************************************************
        public int ReleaseTerm()
        {
            int result;
            // 与えられた排他IDをMasExcept.bplに引き渡す
            m_pPara.iMode = Units.MAS310000u.MODE_RELEASETERM;
            result = m_pExcept(m_pPara);
            return result;
        }

#endif
    } // end TMasExceptIF

    // ---<HIS-002>------------------------------------------------------------------
    // ******************************************************************************
    // Program		:	オプション採用管理クラス
    // ProgramID	:	MASL310SysOption
    // Name	 	:	TYamaguchi
    // Create	 	:	2006/04/06
    // Comment	 	:	MJSCOMMON.DB の MENU_SYSINFO テーブルから
    // オプション情報を取得して採用有無を判断する。
    // ******************************************************************************
    // <HIS-002> 2006/04/06 T.Yamaguchi	オプション採用有無チェックの機能追加
    // <HIS-004> 2006/10/17 T.Yamaguchi	サブプログラム メニュー追加(他社データ取込 他)
    // <HIS-016> 2007/08/24 T.Yamaguchi	サブプログラム メニュー追加(記帳くん07)
    // <HIS-032> 2008/03/19 T.Yamaguchi	取込処理 メール会計オフライン 対応
    // <HIS-059> 2009/08/19 T.Yamaguchi	取込処理 ＰＣＡ会計９対応
    // <HIS-064> 2010/04/01 T.Yamaguchi	取込処理 会計王11、勘定奉行i 対応
    public class TMASL310SysOption
    {
        protected TMjsAppRecord m_pRec = null;
        protected int m_iSysCd = 0;
        protected ArrayList m_cItem = null;
        // ---<HIS-002>------------------------------------------------------------------
        // ******************************************************************************
        // Program		:	オプション採用管理クラス
        // ProgramID	:	TMASL310SysOption
        // Name	 	:	TYamaguchi
        // Create	 	:	2006/04/06
        // Comment	 	:	MJSCOMMON.DB の MENU_SYSINFO テーブルから
        // オプション情報を取得して採用有無を判断する。
        // ******************************************************************************
        // <HIS-002> 2006/04/06 T.Yamaguchi	オプション採用有無チェックの機能追加
        // <HIS-004> 2006/10/17 T.Yamaguchi	サブプログラム メニュー追加(他社データ取込 他) (コメント省略)
        // <HIS-006> 2006/12/27 T.Yamaguchi	サブプログラム メニュー追加
        // <HIS-011> 2007/03/06 T.Yamaguchi	サブプログラム メニュー追加
        // <HIS-016> 2007/08/24 T.Yamaguchi	サブプログラム メニュー追加(記帳くん07)
        // <HIS-032> 2008/03/19 T.Yamaguchi	取込処理 メール会計オフライン 対応
        // <HIS-059> 2009/08/19 T.Yamaguchi	取込処理 ＰＣＡ会計９対応
        // <HIS-064> 2010/04/01 T.Yamaguchi	取込処理 会計王11、勘定奉行i 対応
        // TMASL310SysOption
        // ******************************************************************************
        // Proccess  :	Constructor
        // Parameter : pRec		^TMjsAppRecord
        // Return    : None
        // ******************************************************************************
        //Constructor  Create( pRec)
        public TMASL310SysOption(object pRec)
        {
            m_pRec = pRec;
            m_iSysCd = m_pRec.m_iSystemCode;
            m_cItem = new ArrayList();
            GetOptCd();
        }
        // ******************************************************************************
        // Proccess  :	Destructor
        // Parameter : pRec		^TMjsAppRecord
        // Return    : None
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TMASL310SysOption()
        {
            m_cItem.Clear();
            //@ Unsupported property or method(A): 'Free'
            m_cItem.Free();
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess  :	オプションコードが存在するかチェック
        // Parameter : iOptCd			Integer			オプションコード
        // Return    : Boolean
        // ******************************************************************************
        public bool IsExist(int iOptCd)
        {
            bool result;
            int idx;
            idx = m_cItem.IndexOf((iOptCd as object));
            result = (idx >  -1);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	オプションコード取得
        // Parameter : None
        // Return    : None
        // ******************************************************************************
        protected void GetOptCd()
        {
            TMDataModulef cModule;
            TDataBase cCmnDb;
            TMQuery cQue;
            int iOptCd;
            //@ Undeclared identifier(3): 'TMDataModulef'
            cModule = TMDataModulef(m_pRec.m_pDBModule);
            //@ Unsupported property or method(A): 'CTLDBOpen'
            cCmnDb = cModule.CTLDBOpen();
            cQue = new TMQuery(null);
            try {
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                cModule.SetDBInfoToQuery(cCmnDb, cQue);
                //@ Unsupported property or method(D): 'UniDirectional'
                cQue.UniDirectional = true;
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                cQue.SQL.Add("SELECT OptCD FROM MENU_SYSINFO WHERE SysCD=:SYSCD");
                //@ Unsupported property or method(B): 'SetFld'
                //@ Unsupported property or method(D): 'AsInteger'
                cQue.SetFld("SYSCD").AsInteger = m_iSysCd;
                //@ Unsupported property or method(B): 'Open'
                cQue.Open();
                // データ格納
                //@ Unsupported property or method(D): 'Eof'
                while (!cQue.Eof)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iOptCd = cQue.GetFld("OptCD").AsInteger;
                    m_cItem.Add((iOptCd as object));
                    //@ Unsupported property or method(B): 'Next'
                    cQue.Next();
                }
            } finally {
                //@ Unsupported property or method(B): 'Free'
                cQue.Free();
                //@ Unsupported property or method(A): 'CTLDBClose'
                cModule.CTLDBClose(cCmnDb);
            }
        }

    } // end TMASL310SysOption

    public class TMASL310OptUse: TMASL310SysOption
    {
        public TMASL310SysOption(object pRec) : base(pRec)
        {
        }
        // ---<HIS-006>------------------------------------------------------------------
        // TMASL310OptUse
        // ******************************************************************************
        // Proccess  :	オプション検索	データ交換
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseDataExchange()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(2);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_CE:
                    // ---<HIS-032>------------------------------------------------------------------
                    // 会計大将（オフライン）
                    // ------------------------------------------------------------------<HIS-032>---
                    // 会計大将（Navi CE）
                    result = true;
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ------------------------------------------------------------------<HIS-006>---
        // ******************************************************************************
        // Proccess  :	オプション検索	Excel取込
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseExcel()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将
                    // 会計大将（オフライン）
                    result = this.IsExist(15);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ---<HIS-004>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	オプション検索	弥生会計02-04
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseYayoi02()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(9);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(6);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	オプション検索	弥生会計05-
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseYayoi05()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(13);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(10);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	オプション検索	勘定奉行
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseKanjyo()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(10);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(7);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ---<HIS-064>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	オプション検索	勘定奉行i
        // Parameter : None
        // Return    : Boolean
        // History	  :	<HIS-064>
        // ******************************************************************************
        public bool IsUseKanjyoi()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(87);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(87);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ------------------------------------------------------------------<HIS-064>---
        // ******************************************************************************
        // Proccess  :	オプション検索	PCA会計
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUsePca()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(12);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(9);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ---<HIS-059>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	オプション検索	PCA会計9
        // Parameter : None
        // Return    : Boolean
        // History	  : <HIS-059>
        // ******************************************************************************
        public bool IsUsePca09()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(85);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(85);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ------------------------------------------------------------------<HIS-059>---
        // ******************************************************************************
        // Proccess  :	オプション検索	会計王
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseKaikeiou()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(11);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(8);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ---<HIS-064>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	オプション検索	会計王11
        // Parameter : None
        // Return    : Boolean
        // History	  :	<HIS-064>
        // ******************************************************************************
        public bool IsUseKaikeiou11()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(86);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(86);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ------------------------------------------------------------------<HIS-064>---
        // ******************************************************************************
        // Proccess  :	オプション検索	JDL IBEX出納帳
        // Parameter : None
        // Return    : Boolean
        // History	  : <HIS-011>
        // ******************************************************************************
        public bool IsUseIbex()
        {
            bool result;
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                    // 会計大将
                    result = this.IsExist(14);
                    break;
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // 会計大将（オフライン）
                    result = this.IsExist(11);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

    } // end TMASL310OptUse

    public class TMASL310SubPrgUse: TMASL310OptUse
    {
        private ArrayList m_cItem_Use = null;
        private int m_iInstSys = 0;
        // 顧問先採用システム
        private bool m_bMailUse = false;
        // メール会計採用フラグ
        private bool m_bCE = false;
        // ＣＥ会計フラグ
        // ---<HIS-032>------------------------------------------------------------------
        private bool m_bOfflineUse = false;
        // TMASL310SubPrgUse
        // ******************************************************************************
        // Proccess  :	Constructor
        // Parameter : pRec		^TMjsAppRecord
        // Return    : None
        // ******************************************************************************
        //Constructor  Create( pRec)
        public TMASL310SubPrgUse(object pRec) : base()
        {
            m_cItem_Use = new ArrayList();
            m_iInstSys = 0;
            m_bMailUse = false;
            m_bCE = false;
            Init();
        }
        // ******************************************************************************
        // Proccess  :	Destructor
        // Parameter : pRec		^TMjsAppRecord
        // Return    : None
        // ******************************************************************************
        //@ Destructor  Destroy()
        ~TMASL310SubPrgUse()
        {
            m_cItem_Use.Clear();
            //@ Unsupported property or method(A): 'Free'
            m_cItem_Use.Free();
            base.Destroy();
        }
        // ******************************************************************************
        // Proccess  :	採用判定	iCompass会計／会計太郎
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseKaikei()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            // ---<HIS-016>------------------------------------------------------------------
            result = this.IsUseDataExchange() && m_bMailUse && !m_bCE && (m_iInstSys != 15);
            // result := IsUseDataExchange() and m_bMailUse and not m_bCE;
            // ------------------------------------------------------------------<HIS-016>---

            return result;
        }

        // ******************************************************************************
        // Proccess  :	採用判定	ＣＥ会計
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseZaimu()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            // ---<HIS-016>------------------------------------------------------------------
            result = this.IsUseDataExchange() && m_bMailUse && m_bCE && (m_iInstSys != 15);
            // result := IsUseDataExchange() and m_bMailUse and m_bCE;
            // ------------------------------------------------------------------<HIS-016>---

            return result;
        }

        // ******************************************************************************
        // Proccess  :	採用判定	ミロク法人会計
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseHoujin()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // ------------------------------------------------------------------<HIS-032>---
                    // 会計大将
                    // 会計大将（オフライン）
                    result = m_iInstSys == 44;
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	採用判定	ミロクのかんたん！会計
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseKantan()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            switch(this.m_iSysCd)
            {
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI:
                case VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE:
                    // ------------------------------------------------------------------<HIS-032>---
                    // 会計大将
                    // 会計大将（オフライン）
                    result = IsExist_Use(17);
                    break;
                default:
                    result = false;
                    break;
            }
            return result;
        }

        // ******************************************************************************
        // Proccess  :	採用判定	Excel取込
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseExcel()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            result = base.IsUseExcel();
            return result;
        }

        // ******************************************************************************
        // Proccess  :	採用判定	弥生会計02-04
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseYayoi02()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            result = base.IsUseYayoi02() && IsExist_Use(51);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	採用判定	弥生会計05-
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseYayoi05()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            result = base.IsUseYayoi05() && IsExist_Use(60);
            return result;
        }

        // ******************************************************************************
        // Proccess  :	採用判定	勘定奉行
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseKanjyo()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            result = base.IsUseKanjyo() && IsExist_Use(52);
            return result;
        }

        // ---<HIS-064>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	採用判定	勘定奉行i
        // Parameter : None
        // Return    : Boolean
        // History	  :	<HIS-064>
        // ******************************************************************************
        public bool IsUseKanjyoi()
        {
            bool result;
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            result = base.IsUseKanjyoi() && IsExist_Use(68);
            return result;
        }

        // ------------------------------------------------------------------<HIS-064>---
        // ******************************************************************************
        // Proccess  :	採用判定	PCA会計
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUsePca()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            result = base.IsUsePca() && IsExist_Use(54);
            return result;
        }

        // ---<HIS-059>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	採用判定	PCA会計9
        // Parameter : None
        // Return    : Boolean
        // History	  : <HIS-059>
        // ******************************************************************************
        public bool IsUsePca09()
        {
            bool result;
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            result = base.IsUsePca() && IsExist_Use(66);
            return result;
        }

        // ------------------------------------------------------------------<HIS-059>---
        // ******************************************************************************
        // Proccess  :	採用判定	会計王
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseKaikeiou()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            result = base.IsUseKaikeiou() && IsExist_Use(55);
            return result;
        }

        // ---<HIS-064>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	採用判定	会計王１１
        // Parameter : None
        // Return    : Boolean
        // History	  :	<HIS-064>
        // ******************************************************************************
        public bool IsUseKaikeiou11()
        {
            bool result;
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            result = base.IsUseKaikeiou11() && IsExist_Use(67);
            return result;
        }

        // ------------------------------------------------------------------<HIS-064>---
        // ******************************************************************************
        // Proccess  :	採用判定	JDL IBEX出納帳
        // Parameter : None
        // Return    : Boolean
        // ******************************************************************************
        public bool IsUseIbex()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            result = base.IsUseIbex() && IsExist_Use(65);
            return result;
        }

        // ---<HIS-016>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	採用判定	記帳くん(VK)
        // Parameter : None
        // Return    : Boolean
        // History	  : <HIS-016>
        // ******************************************************************************
        public bool IsUseVK()
        {
            bool result;
            // ---<HIS-032>------------------------------------------------------------------
            // 入力可能な会社データかチェック
            result = CanInputCorp();
            if (!result)
            {
                return result;
            }
            // ------------------------------------------------------------------<HIS-032>---
            result = m_bMailUse && (m_iInstSys == 15);
            return result;
        }

        // オフライン(入力用)フラグ
        // ------------------------------------------------------------------<HIS-032>---
        // ******************************************************************************
        // Proccess  :	初期処理
        // Parameter : None
        // Return    : None
        // ******************************************************************************
        private void Init()
        {
            TMDataModulef cModule;
            TDataBase cCopDb;
            TMQuery cQue;
            int iUseKbn;
            //@ Undeclared identifier(3): 'TMDataModulef'
            cModule = TMDataModulef(this.m_pRec.m_pDBModule);
            //@ Unsupported property or method(A): 'COPDBOpen'
            cCopDb = cModule.COPDBOpen(0, this.m_pRec.m_iCorpID);
            cQue = new TMQuery(null);
            try {
                //@ Unsupported property or method(A): 'SetDBInfoToQuery'
                cModule.SetDBInfoToQuery(cCopDb, cQue);
                //@ Unsupported property or method(D): 'UniDirectional'
                cQue.UniDirectional = true;
                // **********//
                // DTMAIN  //
                // **********//
                //@ Unsupported property or method(B): 'Close'
                cQue.Close();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Clear'
                cQue.SQL.Clear();
                // ---<HIS-032>------------------------------------------------------------------
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                cQue.SQL.Add("SELECT ComKbn3,DTName1 FROM DTMAIN");
                // cQue.SQL.Add('SELECT ComKbn3 FROM DTMAIN');
                // ------------------------------------------------------------------<HIS-032>---
                //@ Unsupported property or method(B): 'Open'
                cQue.Open();
                //@ Unsupported property or method(D): 'Eof'
                if (!cQue.Eof)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_bMailUse = ((bool)cQue.GetFld("ComKbn3").AsInteger);
                    // ---<HIS-032>------------------------------------------------------------------
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsString'
                    m_bOfflineUse = (this.m_iSysCd == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE) && (cQue.GetFld("DTName1").AsString != "");
                // ------------------------------------------------------------------<HIS-032>---
                }
                // ***********//
                // KbnInfo  //
                // ***********//
                //@ Unsupported property or method(B): 'Close'
                cQue.Close();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Clear'
                cQue.SQL.Clear();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                cQue.SQL.Add("SELECT GnPuKbn1,GnPuKbn34 FROM KbnInfo WHERE RecKbn=4");
                //@ Unsupported property or method(B): 'Open'
                cQue.Open();
                //@ Unsupported property or method(D): 'Eof'
                if (!cQue.Eof)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_iInstSys = cQue.GetFld("GnPuKbn1").AsInteger;
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    m_bCE = ((bool)cQue.GetFld("GnPuKbn34").AsInteger);
                }
                // ************//
                // ExchgOpe  //
                // ************//
                //@ Unsupported property or method(B): 'Close'
                cQue.Close();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Clear'
                cQue.SQL.Clear();
                //@ Unsupported property or method(D): 'SQL'
                //@ Unsupported property or method(B): 'Add'
                cQue.SQL.Add("SELECT UseKbn FROM ExchgOpe WHERE InitKbn=1 AND LastRunDate IS NOT NULL");
                //@ Unsupported property or method(B): 'Open'
                cQue.Open();
                // データ格納
                //@ Unsupported property or method(D): 'Eof'
                while (!cQue.Eof)
                {
                    //@ Unsupported property or method(B): 'GetFld'
                    //@ Unsupported property or method(D): 'AsInteger'
                    iUseKbn = cQue.GetFld("UseKbn").AsInteger;
                    m_cItem_Use.Add((iUseKbn as object));
                    //@ Unsupported property or method(B): 'Next'
                    cQue.Next();
                }
            } finally {
                //@ Unsupported property or method(B): 'Free'
                cQue.Free();
                //@ Unsupported property or method(A): 'COPDBClose'
                cModule.COPDBClose(cCopDb);
            }
        }

        // ******************************************************************************
        // Proccess  :	オプションコードが存在するかチェック
        // Parameter : iUseKbn			Integer			処理区分(ExchgOpe.UseKbn)
        // Return    : Boolean
        // ******************************************************************************
        private bool IsExist_Use(int iUseKbn)
        {
            bool result;
            int idx;
            idx = m_cItem_Use.IndexOf((iUseKbn as object));
            result = (idx >  -1);
            return result;
        }

        // ---<HIS-032>------------------------------------------------------------------
        // ******************************************************************************
        // Proccess  :	入力可能な会社データかチェック
        // Parameter : None
        // Return    : Boolean
        // History	  : <HIS-032>
        // ******************************************************************************
        private bool CanInputCorp()
        {
            bool result;
            result = false;
            // オフラインで参照用データなら入力不可
            if ((this.m_iSysCd == VKZ310Cmnu.Units.VKZ310Cmnu.MASL_PROC_SYS_KAIKEI_OFFLINE) && !m_bOfflineUse)
            {
                return result;
            }
            result = true;
            return result;
        }

#endif
    } // end TMASL310SubPrgUse

    // __MASL310SYSOPTIONH_INC__
    // ------------------------------------------------------------------<HIS-002>---
    // (*H0048 20050516 khattori	操作ガイド番号通知*)
    public struct rcHELPINFO
    {
        public int Code1;
        public int Code2;
        public string Chm;
        public string Html;
    } // end rcHELPINFO

    public struct TIntDate
    {
        public int Y;
        public int M;
        public int D;
        public int YMD;
    } // end TIntDate

    public delegate int TAppEntry(object pPar);
    // ==============================================================================
    // ActionID	APPEntry関数で使用する処理番号
    // 2000 /  7 / xx	( xxx )		新規作成
    // 2000 /  7 / 12	( Wed )		ACTID_FROMCREATESHOWSTART 追加
    // ACTID_FROMCREATESHOWEND 追加
    // 2000 /  8 / 21	( Mon )		ACTID_CAPTIONCHANGESTART 追加
    // 2000 /  8 / 23	( Wed )		ACTID_ACTIVESTART 追加
    // ACTID_ACTIVEEND 追加
    // 2000 /  9 / 28	( Thu )		ACTID_HIDESTART 追加
    // ACTID_HIDEEND 追加
    // ACTID_HIDESTARTDRILL 追加
    // ACTID_HIDEENDDRILL 追加
    // ACTID_DOCKINGINSTART 追加
    // ACTID_DOCKINGINEND 追加
    // ACTID_DOCKINGOUTSTART 追加
    // ACTID_DOCKINGOUTEND 追加
    // 2000 / 11 /  9	( Thu )		ACTID_APPxxxxxxxx 追加
    // 2001 /  1 / 29	( Mon )		ACTID_COMMONDBOPEN 追加
    // ACTID_COMMONDBCLOSE 追加
    // 2001 /  3 /  1	( Thu )		ACTID_CORPUPDATESTART 追加
    // ACTID_CORPUPDATEEND 追加
    // 2001 /  6 / 26	( Tue )		ACTID_YEARCHANGEEND 追加
    // 2005 /  2 / 22	( Tue )		ACTID_HELPCALL 追加
    // 2005 /  3 / 10	( Tue )		ACTID_HELPINDEXSET 追加
    // 2005 /  5 /  2	( Mon )		ACTID_HELPINDEXGET 追加
    // 2005 /  5 /  9	( Mon )		ACTID_CAPTIONTEXTGET 追加
    // ACTID_COMBOTEXTGET 追加
    // 2005 /  5 / 27	( Fri )		ACTID_USERUPDATESTART 追加
    // ACTID_USERUPDATEEND   追加
    // 2005 /  8 /  4	( Thu )		ACTID_SHOWCALENDAR		追加
    // ACTID_HIDECALENDAR		追加
    // ACTID_STCUT_SELECTAP	追加
    // ACTID_STCUT_MENUDISP	追加
    // ACTID_STCUT_HELP		追加
    // 2006 /  2 / 21  ( Tue )		ACTID_MOSDBOPEN 追加
    // ACTID_MOSDBCLOSE 追加
    // ACTID_MOSANOTHERSTART 追加
    // ACTID_MOSANOTHEREND 追加
    // 2006 /  3 /  6  ( Mon )		ACTID_MOSCHANGECOLOR 追加
    // ACTID_MOSCHANGESTAFF 追加
    // 2006 /  3 /  9  ( Thu )     ACTID_MOSDIALOGSHOW 追加
    // 2006 /  3 / 15  ( Wed )     ACTID_MOSCHANGESCALE 追加
    // ACTID_MOSFORMRESIZE 追加
    // 2006 /  3 / 24  ( Fri )     ACTID_MOSHIDECALENDAR 追加
    // 2006 /  4 / 14  ( Fri )     ACTID_CREATECALENDAR 追加
    // ACTID_DESTROYCALENDAR 追加
    // 2006 /  8 / 28  ( Mon )     ACTID_SHOWMODAL 追加
    // ACTID_TAXCALCREATESHOW 追加
    // ACTID_TAXCALAUTOCLOSE 追加
    // 2006 / 11 / 30  ( Thu )     ACTID_CMNCHANGDISPINFO 追加
    // 2007 /  1 / 31              ACTID_CMNIPTELSHOW 追加
    // 2007 /  7 /  6  ( Fri ) 	ACTID_QUERY_RUNAPPCOUNT 追加（VK07用）
    // ACTID_RUNAPPALLCLOSE    追加（VK07用）
    // ACTID_CHANGEENVIRONMENT 追加（VK07用）
    // ACTID_CALLAPPLICATION   追加（VK07用）
    // ACTID_OPENDATAFROMAPP   追加（VK07用）
    // ACTID_CLOSEDATAFROMAPP  追加（VK07用）
    // 2007 / 10 / 22  ( Fri ) 	SID_VK_KMNSK 追加
    // SID_ML2      追加
    // ==============================================================================
    // -------------------------------------------------------------------------------------------
    // ActionID				 		値				内容						UPDATE
    // ------------------------------------------------------------------------------------------
    // Form Create要求
    // Form Create通知
    // Form Create&Show要求
    // Form Create&Show通知
    // Form Close要求
    // Form Close通知
    // Form CanClose要求
    // Form CanClose通知
    // Show要求
    // Show通知
    // Hide 要求
    // Hide 通知
    // Show要求(ﾄﾞﾘﾙﾀﾞｳﾝ系)
    // Show通知(ﾄﾞﾘﾙﾀﾞｳﾝ系)
    // Hide 要求 ( ドリルダウン系 )
    // Hide 通知 ( ドリルダウン系 )
    // モーダル表示要求		// 2006-08-28
    // 埋め込み 要求
    // 埋め込み 通知
    // 切り出し 要求
    // 切り出し 通知
    // Active 要求
    // Active 通知
    // MenuItem要求
    // MenuItem通知
    // 更新要求
    // 更新通知
    // 顧問先更新要求		( 業務 -> DESKTOP )		// 2005-05-27
    // 顧問先更新通知								// 2005-05-27
    // 会社情報更新要求
    // 会社情報更新通知
    // キャプション変更要求 ( AP -> Menu -> Desktop )
    // HELPインデックスセット
    // HELP呼出
    // HELPインデックス取得
    // ｷｬﾌﾟｼｮﾝ文字列取得	( 業務 -> ｽﾃﾙｽ )
    // 処理ｺﾝﾎﾞ文字列取得	( 業務 -> ｽﾃﾙｽ )
    // カレンダー表示	 ( Menu -> Desktop )		// 2005-08-04
    // カレンダー非表示	 ( Menu -> Desktop )		// 2005-08-04
    // カレンダー作成	 ( Menu -> Desktop )		// 2006/04/14
    // カレンダー破棄	 ( Menu -> Desktop )		// 2006/04/14
    // ショートカットキー 処理選択中コンボ	 ( Desktop -> Menu )	// 2005-08-04
    // ショートカットキー メニュー表示		 ( Desktop -> Menu )	// 2005-08-04
    // ショートカットキー 操作ガイド		 ( Desktop -> Menu )	// 2005-08-04
    // 税務カレンダーの作成&表示	// 2006-08-28
    // 税務カレンダーの自動終了		// 2006-08-28
    // 起動中処理件数の問合せ
    // 起動中処理の全クローズ依頼
    // 動作環境の変更通知
    // 処理の起動依頼
    // 処理からのデータオープン依頼
    // 処理からのデータクローズ依頼
    // 年度変更通知 ( Menu -> Desktop )
    // 別起動要求
    // 別起動通知
    // 別起動要求	( MosGrpForm -> Desktop )  // 2006/02/21
    // 別起動通知	( MosGrpForm -> Desktop )  // 2006/02/21
    // 配色タイフ゜の変更   ( Desktop -> MosGrpForm )  // 2006/03/06
    // 担当者の変更         ( Desktop -> MosGrpForm )  // 2006/03/06
    // 登録ダイアログの表示 ( Desktop -> MosGrpForm )  // 2006/03/09
    // 表示倍率の変更           ( Desktop -> MosGrpForm )  // 2006/03/15
    // MJSDESKTOPのりサイズ通知 ( Desktop -> MosGrpForm )  // 2006/03/15
    // カレンダー非表示依頼 ( MosGrpForm -> Desktop )   // 2006/03/24
    // 表示情報の変更( Desktop -> CMNComunicate)
    // 電話番号入力フィールドからIPフォン起動
    // MjsCommon.db 接続要求
    // MjsCommon.db 接続解除要求
    // MOS-DB 接続要求		( Desktop -> MosGrpForm )  // 2006/02/21
    // MOS-DB 接続解除要求	( Desktop -> MosGrpForm )  // 2006/02/21
    // 要求(ﾕｰｻﾞｰﾌﾘｰ)
    // 通知(ﾕｰｻﾞｰﾌﾘｰ)
    // 以降AP制御系(ﾒﾆｭｰが使用)
    // AP Create要求
    // AP Create通知
    // AP Create&Show要求
    // AP Create&Show通知
    // AP Close要求
    // AP Close通知
    // AP Show要求
    // AP Show通知
    // AP Hide 要求
    // AP Hide 通知
    // AP 埋め込み 要求
    // AP 埋め込み 通知
    // AP 切り出し 要求
    // AP 切り出し 通知
    // 戻り値
    // ------------------------------------------------------------------------------
    // OK
    // NG
    // ==============================================================================
    // アプリケーションシリーズID  ComMemRsvFlg2
    // 2006 /  3 / 15	( Wed )		新規作成
    // 2006 /  4 /  6  ( Thu )     SID_MLORMLAD 追加
    // ==============================================================================
    // -------------------------------------------------------------------------------------------
    // シリーズID                      値				内容						UPDATE
    // ------------------------------------------------------------------------------------------
    // [事務所]
    // ACELINK 事務所
    // ACELINK Navi 事務所
    // [顧問先]
    // ACELINK 顧問先
    // iCompass 顧問先
    // ACELINK Navi 顧問先
    // VK                       // 2007/10/22
    // [企業]
    // MJSLINK or MJSLINK AD    // 2006/04/06
    // MJSLINK
    // MJSLINK AD
    // MJSLINKU                // 2007/10/22
    // MJSLINK Tax              // 2008/08/14
    // End of File
    // {$I MASL310RootI.inc}		//	日常処理共通外部インターフェイス
    // ******************************************************************************
    // System		: 顧問先入力システム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310EntryIF_VK07I
    // Comment		: 仕訳更新
    // ******************************************************************************
    // ******************************************************************************
    // System		: ACELINK Navi会計大将 VKシステム
    // Program		: 仕訳更新
    // ProgramID	: VKZL310TrnIFI
    // Name		: Y.Sato
    // Create		: 2007/05/11
    // Comment		: 仕訳更新
    // History		: 9999/99/99	X.Xxxx		・<H0000>	XXXXXXXXXXXXXXXXXX
    // : 2015/12/18	S.Arai		・<LEAF>  証憑OCRイメージ対応。
    // ******************************************************************************
    // 内部月
    public enum TVKZL310TrnNMonth
    {
        nmNone,
        nm00,
        nm01,
        nm02,
        nm03,
        nm04,
        nm05,
        nm06,
        nm07,
        nm11,
        nm12,
        nm13,
        nm14,
        nm15,
        nm16,
        nm17,
        nm21,
        nm22,
        nm23,
        nm24,
        nm25,
        nm26,
        nm27,
        nm31,
        nm32,
        nm33,
        nm34,
        nm35,
        nm36,
        nm37,
        nm41,
        nm42,
        nm43,
        nm44,
        nm45,
        nm46,
        nm47
    } // end TVKZL310TrnNMonth

    // マスタID
    public enum TMstID
    {
        mid00,
        mid02,
        mid03,
        mid21,
        mid22,
        mid25,
        mid31,
        mid32,
        mid33,
        mid34,
        mid35,
        mid41,
        mid42,
        mid43,
        mid44,
        mid45,
        mid51,
        mid52
    } // end TMstID

    // 部門ID
    public enum TBmnID
    {
        bid41,
        bid42,
        bid43,
        bid44,
        bid45
    } // end TBmnID

    // 電子帳簿ID
    public enum TEleAccID
    {
        eaid00,
        eaid21,
        eaid22,
        eaid23,
        eaid24,
        eaid25,
        eaid31,
        eaid32,
        eaid33,
        eaid34,
        eaid35,
        eaid51
    } // end TEleAccID

    // 資金単位集計区分
    public enum TCashID
    {
        cid21,
        cid41,
        cid42,
        cid43,
        cid44,
        cid45
    } // end TCashID

    // 仮受・仮払消費税採用区分
    public enum TUkeHaraiID
    {
        uhidSub,
        uhidBmn,
        uhidHoj1,
        uhidHoj2,
        uhidBH1,
        uhidBH2
    } // end TUkeHaraiID

    public delegate int TVKZL310TrnInit(ref TVKZL310TrnParam TrnParam, ref object pVKZL310Trn, ref TVKZL310TrnCmnInfo TrnCmnInfo);
    public delegate int TVKZL310TrnSwkup(object pVKZL310Trn, ref TVKZL310TrnSwkRec TrnSwkRec, ref TVKZL310TrnSwkResult[] TrnSwkResults, ref TVKZL310TrnParamE ParamE);
    public delegate int TVKZL310TrnGetMonthInfo(object pVKZL310Trn, int NMonth, out TVKZL310TrnMonthInfo MonthInfo);
    public delegate int TVKZL310TrnSumup1(object pVKZL310Trn, ref TVKZL310TrnSumResult[] TrnSumResults, ref TVKZL310TrnParamE ParamE);
    public delegate int TVKZL310TrnSumup2(object pVKZL310Trn, ref TVKZL310TrnMRec[] TrnMRecList, ref TVKZL310TrnSumResult[] TrnSumResults, ref TVKZL310TrnParamE ParamE);
    public delegate int TVKZL310TrnSumupCancel(object pVKZL310Trn);
    public delegate int TVKZL310TrnBalance(object pVKZL310Trn, int NMonth);
    public delegate int TVKZL310TrnMRecCnt(object pVKZL310Trn);
    public delegate int TVKZL310TrnTerm(object pVKZL310Trn);
    public delegate int TVKZL310FixInit(ref TVKZL310TrnParam TrnParam, ref object pVKZL310Fix, ref TVKZL310TrnCmnInfo TrnCmnInfo);
    public delegate int TVKZL310FixSwkup(object pVKZL310Fix, ref TVKZL310FixSwkRec FixSwkRec, ref TVKZL310TrnSwkResult[] TrnSwkResults);
    public delegate int TVKZL310FixTerm(object pVKZL310Fix);
    public delegate int TDbVerExceptApp(object pPar);
    public enum Enum_TVisibleFlg1
    {
        ,
        ,
        ,
        ,
        ,
        
    } // end Enum_TVisibleFlg1

}

namespace MAS310000u.Units
{
    public class MAS310000u
    {
    //@ Undeclared identifier(3): 'WM_APP'
    // OnPaint 時の処理起動メッセージ用
    // ---<HIS-017>------------------------------------------------------------------
    //@ Undeclared identifier(3): 'WM_APP'
        // Delphi Vcl
        // Mjs Vcl
        // Mjs Lib
        // Local
        public const int BPLMAX = 29;
        public const int HDRD0X_WIDTH = 146;
        public const int HDRD0X_LABEL_WIDTH = 50;
        public static string[] arStr = {"月固定", "月可変"};
        public const object WM_ONPAINT = WM_APP + 1;
        // OnPaint 時の処理起動メッセージ用
        // ---<HIS-017>------------------------------------------------------------------
        public const object WM_TERM = WM_APP + 2;
        // ==============================================================================
        // ActionID	APPEntry関数で使用する処理番号
        // 2000 /  7 / xx	( xxx )		新規作成
        // 2000 /  7 / 12	( Wed )		ACTID_FROMCREATESHOWSTART 追加
        // ACTID_FROMCREATESHOWEND 追加
        // 2000 /  8 / 21	( Mon )		ACTID_CAPTIONCHANGESTART 追加
        // 2000 /  8 / 23	( Wed )		ACTID_ACTIVESTART 追加
        // ACTID_ACTIVEEND 追加
        // 2000 /  9 / 28	( Thu )		ACTID_HIDESTART 追加
        // ACTID_HIDEEND 追加
        // ACTID_HIDESTARTDRILL 追加
        // ACTID_HIDEENDDRILL 追加
        // ACTID_DOCKINGINSTART 追加
        // ACTID_DOCKINGINEND 追加
        // ACTID_DOCKINGOUTSTART 追加
        // ACTID_DOCKINGOUTEND 追加
        // 2000 / 11 /  9	( Thu )		ACTID_APPxxxxxxxx 追加
        // 2001 /  1 / 29	( Mon )		ACTID_COMMONDBOPEN 追加
        // ACTID_COMMONDBCLOSE 追加
        // 2001 /  3 /  1	( Thu )		ACTID_CORPUPDATESTART 追加
        // ACTID_CORPUPDATEEND 追加
        // 2001 /  6 / 26	( Tue )		ACTID_YEARCHANGEEND 追加
        // 2005 /  2 / 22	( Tue )		ACTID_HELPCALL 追加
        // 2005 /  3 / 10	( Tue )		ACTID_HELPINDEXSET 追加
        // 2005 /  5 /  2	( Mon )		ACTID_HELPINDEXGET 追加
        // 2005 /  5 /  9	( Mon )		ACTID_CAPTIONTEXTGET 追加
        // ACTID_COMBOTEXTGET 追加
        // 2005 /  5 / 27	( Fri )		ACTID_USERUPDATESTART 追加
        // ACTID_USERUPDATEEND   追加
        // 2005 /  8 /  4	( Thu )		ACTID_SHOWCALENDAR		追加
        // ACTID_HIDECALENDAR		追加
        // ACTID_STCUT_SELECTAP	追加
        // ACTID_STCUT_MENUDISP	追加
        // ACTID_STCUT_HELP		追加
        // 2006 /  2 / 21  ( Tue )		ACTID_MOSDBOPEN 追加
        // ACTID_MOSDBCLOSE 追加
        // ACTID_MOSANOTHERSTART 追加
        // ACTID_MOSANOTHEREND 追加
        // 2006 /  3 /  6  ( Mon )		ACTID_MOSCHANGECOLOR 追加
        // ACTID_MOSCHANGESTAFF 追加
        // 2006 /  3 /  9  ( Thu )     ACTID_MOSDIALOGSHOW 追加
        // 2006 /  3 / 15  ( Wed )     ACTID_MOSCHANGESCALE 追加
        // ACTID_MOSFORMRESIZE 追加
        // 2006 /  3 / 24  ( Fri )     ACTID_MOSHIDECALENDAR 追加
        // 2006 /  4 / 14  ( Fri )     ACTID_CREATECALENDAR 追加
        // ACTID_DESTROYCALENDAR 追加
        // 2006 /  8 / 28  ( Mon )     ACTID_SHOWMODAL 追加
        // ACTID_TAXCALCREATESHOW 追加
        // ACTID_TAXCALAUTOCLOSE 追加
        // 2006 / 11 / 30  ( Thu )     ACTID_CMNCHANGDISPINFO 追加
        // 2007 /  1 / 31              ACTID_CMNIPTELSHOW 追加
        // 2007 /  7 /  6  ( Fri ) 	ACTID_QUERY_RUNAPPCOUNT 追加（VK07用）
        // ACTID_RUNAPPALLCLOSE    追加（VK07用）
        // ACTID_CHANGEENVIRONMENT 追加（VK07用）
        // ACTID_CALLAPPLICATION   追加（VK07用）
        // ACTID_OPENDATAFROMAPP   追加（VK07用）
        // ACTID_CLOSEDATAFROMAPP  追加（VK07用）
        // 2007 / 10 / 22  ( Fri ) 	SID_VK_KMNSK 追加
        // SID_ML2      追加
        // ==============================================================================
        // -------------------------------------------------------------------------------------------
        // ActionID				 		値				内容						UPDATE
        // ------------------------------------------------------------------------------------------
        public const int ACTID_FORMCREATESTART = 1000;
        // Form Create要求
        public const int ACTID_FORMCREATEEND = 1010;
        // Form Create通知
        public const int ACTID_FORMCREATESHOWSTART = 1500;
        // Form Create&Show要求
        public const int ACTID_FORMCREATESHOWEND = 1510;
        // Form Create&Show通知
        public const int ACTID_FORMCLOSESTART = 2000;
        // Form Close要求
        public const int ACTID_FORMCLOSEEND = 2010;
        // Form Close通知
        public const int ACTID_FORMCANCLOSESTART = 2500;
        // Form CanClose要求
        public const int ACTID_FORMCANCLOSEEND = 2510;
        // Form CanClose通知
        public const int ACTID_SHOWSTART = 3000;
        // Show要求
        public const int ACTID_SHOWEND = 3010;
        // Show通知
        public const int ACTID_HIDESTART = 3100;
        // Hide 要求
        public const int ACTID_HIDEEND = 3110;
        // Hide 通知
        public const int ACTID_SHOWSTARTDRILL = 3500;
        // Show要求(ﾄﾞﾘﾙﾀﾞｳﾝ系)
        public const int ACTID_SHOWENDDRILL = 3510;
        // Show通知(ﾄﾞﾘﾙﾀﾞｳﾝ系)
        public const int ACTID_HIDESTARTDRILL = 3600;
        // Hide 要求 ( ドリルダウン系 )
        public const int ACTID_HIDEENDDRILL = 3610;
        // Hide 通知 ( ドリルダウン系 )
        public const int ACTID_SHOWMODAL = 3700;
        // モーダル表示要求		// 2006-08-28
        public const int ACTID_DOCKINGINSTART = 3800;
        // 埋め込み 要求
        public const int ACTID_DOCKINGINEND = 3810;
        // 埋め込み 通知
        public const int ACTID_DOCKINGOUTSTART = 3900;
        // 切り出し 要求
        public const int ACTID_DOCKINGOUTEND = 3910;
        // 切り出し 通知
        public const int ACTID_ACTIVESTART = 4000;
        // Active 要求
        public const int ACTID_ACTIVEEND = 4010;
        // Active 通知
        public const int ACTID_MENUITEMSTART = 5000;
        // MenuItem要求
        public const int ACTID_MENUITEMEND = 5010;
        // MenuItem通知
        public const int ACTID_UPDATESTART = 6000;
        // 更新要求
        public const int ACTID_UPDATEEND = 6010;
        // 更新通知
        public const int ACTID_USERUPDATESTART = 6101;
        // 顧問先更新要求		( 業務 -> DESKTOP )		// 2005-05-27
        public const int ACTID_USERUPDATEEND = 6102;
        // 顧問先更新通知								// 2005-05-27
        public const int ACTID_CORPUPDATESTART = 6900;
        // 会社情報更新要求
        public const int ACTID_CORPUPDATEEND = 6910;
        // 会社情報更新通知
        public const int ACTID_CAPTIONCHANGESTART = 7000;
        // キャプション変更要求 ( AP -> Menu -> Desktop )
        public const int ACTID_HELPINDEXSET = 7100;
        // HELPインデックスセット
        public const int ACTID_HELPCALL = 7101;
        // HELP呼出
        public const int ACTID_HELPINDEXGET = 7102;
        // HELPインデックス取得
        public const int ACTID_CAPTIONTEXTGET = 7201;
        // ｷｬﾌﾟｼｮﾝ文字列取得	( 業務 -> ｽﾃﾙｽ )
        public const int ACTID_COMBOTEXTGET = 7202;
        // 処理ｺﾝﾎﾞ文字列取得	( 業務 -> ｽﾃﾙｽ )
        public const int ACTID_SHOWCALENDAR = 7301;
        // カレンダー表示	 ( Menu -> Desktop )		// 2005-08-04
        public const int ACTID_HIDECALENDAR = 7302;
        // カレンダー非表示	 ( Menu -> Desktop )		// 2005-08-04
        public const int ACTID_CREATECALENDAR = 7303;
        // カレンダー作成	 ( Menu -> Desktop )		// 2006/04/14
        public const int ACTID_DESTROYCALENDAR = 7304;
        // カレンダー破棄	 ( Menu -> Desktop )		// 2006/04/14
        public const int ACTID_STCUT_SELECTAP = 7310;
        // ショートカットキー 処理選択中コンボ	 ( Desktop -> Menu )	// 2005-08-04
        public const int ACTID_STCUT_MENUDISP = 7311;
        // ショートカットキー メニュー表示		 ( Desktop -> Menu )	// 2005-08-04
        public const int ACTID_STCUT_HELP = 7312;
        // ショートカットキー 操作ガイド		 ( Desktop -> Menu )	// 2005-08-04
        public const int ACTID_TAXCALCREATESHOW = 7321;
        // 税務カレンダーの作成&表示	// 2006-08-28
        public const int ACTID_TAXCALAUTOCLOSE = 7322;
        // 税務カレンダーの自動終了		// 2006-08-28
        public const int ACTID_QUERY_RUNAPPCOUNT = 7331;
        // 起動中処理件数の問合せ
        public const int ACTID_RUNAPPALLCLOSE = 7332;
        // 起動中処理の全クローズ依頼
        public const int ACTID_CHANGEENVIRONMENT = 7333;
        // 動作環境の変更通知
        public const int ACTID_CALLAPPLICATION = 7334;
        // 処理の起動依頼
        public const int ACTID_OPENDATAFROMAPP = 7335;
        // 処理からのデータオープン依頼
        public const int ACTID_CLOSEDATAFROMAPP = 7336;
        // 処理からのデータクローズ依頼
        public const int ACTID_YEARCHANGEEND = 7910;
        // 年度変更通知 ( Menu -> Desktop )
        public const int ACTID_ANOTHERSTART = 9000;
        // 別起動要求
        public const int ACTID_ANOTHEREND = 9010;
        // 別起動通知
        public const int ACTID_MOSANOTHERSTART = 9001;
        // 別起動要求	( MosGrpForm -> Desktop )  // 2006/02/21
        public const int ACTID_MOSANOTHEREND = 9011;
        // 別起動通知	( MosGrpForm -> Desktop )  // 2006/02/21
        public const int ACTID_MOSCHANGECOLOR = 9021;
        // 配色タイフ゜の変更   ( Desktop -> MosGrpForm )  // 2006/03/06
        public const int ACTID_MOSCHANGESTAFF = 9022;
        // 担当者の変更         ( Desktop -> MosGrpForm )  // 2006/03/06
        public const int ACTID_MOSDIALOGSHOW = 9023;
        // 登録ダイアログの表示 ( Desktop -> MosGrpForm )  // 2006/03/09
        public const int ACTID_MOSCHANGESCALE = 9024;
        // 表示倍率の変更           ( Desktop -> MosGrpForm )  // 2006/03/15
        public const int ACTID_MOSFORMRESIZE = 9025;
        // MJSDESKTOPのりサイズ通知 ( Desktop -> MosGrpForm )  // 2006/03/15
        public const int ACTID_MOSHIDECALENDAR = 9026;
        // カレンダー非表示依頼 ( MosGrpForm -> Desktop )   // 2006/03/24
        public const int ACTID_CMNCHANGEDISPINFO = 9031;
        // 表示情報の変更( Desktop -> CMNComunicate)
        public const int ACTID_CMNIPTELSHOW = 9032;
        // 電話番号入力フィールドからIPフォン起動
        public const int ACTID_COMMONDBOPEN = 9800;
        // MjsCommon.db 接続要求
        public const int ACTID_COMMONDBCLOSE = 9810;
        // MjsCommon.db 接続解除要求
        public const int ACTID_MOSDBOPEN = 9820;
        // MOS-DB 接続要求		( Desktop -> MosGrpForm )  // 2006/02/21
        public const int ACTID_MOSDBCLOSE = 9830;
        // MOS-DB 接続解除要求	( Desktop -> MosGrpForm )  // 2006/02/21
        public const int ACTID_FREESTART = 10000;
        // 要求(ﾕｰｻﾞｰﾌﾘｰ)
        public const int ACTID_FREEEND = 10010;
        // 通知(ﾕｰｻﾞｰﾌﾘｰ)
        // 以降AP制御系(ﾒﾆｭｰが使用)
        public const int ACTID_APPCREATESTART = 1005;
        // AP Create要求
        public const int ACTID_APPCREATEEND = 1015;
        // AP Create通知
        public const int ACTID_APPCREATESHOWSTART = 1505;
        // AP Create&Show要求
        public const int ACTID_APPCREATESHOWEND = 1515;
        // AP Create&Show通知
        public const int ACTID_APPCLOSESTART = 2005;
        // AP Close要求
        public const int ACTID_APPCLOSEEND = 2015;
        // AP Close通知
        public const int ACTID_APPSHOWSTART = 3005;
        // AP Show要求
        public const int ACTID_APPSHOWEND = 3015;
        // AP Show通知
        public const int ACTID_APPHIDESTART = 3105;
        // AP Hide 要求
        public const int ACTID_APPHIDEEND = 3115;
        // AP Hide 通知
        public const int ACTID_APPDOCKINGINSTART = 3805;
        // AP 埋め込み 要求
        public const int ACTID_APPDOCKINGINEND = 3815;
        // AP 埋め込み 通知
        public const int ACTID_APPDOCKINGOUTSTART = 3905;
        // AP 切り出し 要求
        public const int ACTID_APPDOCKINGOUTEND = 3915;
        // AP 切り出し 通知
        // 戻り値
        // ------------------------------------------------------------------------------
        public const int ACTID_RET_OK = 1;
        // OK
        public const int ACTID_RET_NG =  -1;
        // NG
        // ==============================================================================
        // アプリケーションシリーズID  ComMemRsvFlg2
        // 2006 /  3 / 15	( Wed )		新規作成
        // 2006 /  4 /  6  ( Thu )     SID_MLORMLAD 追加
        // ==============================================================================
        // -------------------------------------------------------------------------------------------
        // シリーズID                      値				内容						UPDATE
        // ------------------------------------------------------------------------------------------
        // [事務所]
        public const int SID_AL_JIMUSYO = 101;
        // ACELINK 事務所
        public const int SID_ALNAVI_JIMUSYO = 102;
        // ACELINK Navi 事務所
        // [顧問先]
        public const int SID_AL_KMNSK = 201;
        // ACELINK 顧問先
        public const int SID_ICOMPASS_KMNSK = 202;
        // iCompass 顧問先
        public const int SID_ALNAVI_KMNSK = 203;
        // ACELINK Navi 顧問先
        public const int SID_VK_KMNSK = 251;
        // VK                       // 2007/10/22
        // [企業]
        public const int SID_MLORMLAD = 300;
        // MJSLINK or MJSLINK AD    // 2006/04/06
        public const int SID_ML = 301;
        // MJSLINK
        public const int SID_MLAD = 302;
        // MJSLINK AD
        public const int SID_ML2 = 303;
        // MJSLINKU                // 2007/10/22
        public const int SID_MLTAX = 304;
        // エラーコード
        public const int VKZL310Trn_Err_None = 0;
        // エラーなし
        public const int VKZL310Trn_Err_Init =  -2;
        // 初期処理がされていない
        public const int VKZL310Trn_Err_MaxCnt =  -3;
        // 最大件数オーバー
        public const int VKZL310Trn_Err_Load =  -4;
        // VKZL310Trn.Bplロードエラー
        public const int VKZL310Trn_Err_Address =  -5;
        // VKZL310TrnInit関数アドレス取得エラー
        public const int VKZL310Trn_Err_Create =  -6;
        // TVKZL310Trnクラス作成エラー
        public const int VKZL310Trn_Err_ParamO =  -7;
        // 出力パラメータを参照
        public const int VKZL310Trn_Err_Result =  -8;
        // 更新結果を参照
        public const int VKZL310Trn_Err_Use =  -9;
        // 他で使用中
        public const int VKZL310Trn_Err_DExist =  -104;
        // ヘッダが追加または修正で明細が無い
        public const int VKZL310Trn_Err_Etc =  -199;
        // その他エラー
        public const int VKZL310Trn_Err_Param =  -999;
        // パラメータエラー
        public const int VKZL310Trn_Err_Write =  -1;
        // テーブルへの書き込みに失敗
        public const int VKZL310Trn_Err_SKmkRead =  -205;
        // 資金繰実績更新で、該当の資金マスタが存在しない。
        public const int VKZL310Trn_Err_TaxClass =  -207;
        // 消費税集計マスタ[TaxSM]更新処理で消費税分類コードが見つからない。
        public const int VKZL310Trn_Err_OverFlow =  -211;
        // オーバフロー(金額が有効桁数を超えた。)
        public const int VKZL310Trn_Err_KmkRead =  -212;
        // 貸借のどちらかの科目が存在しない。
        public const int VKZL310Trn_Err_TblExist =  -11;
        // テーブルが存在しない
        public const int VKZL310Trn_Err_ColExist =  -12;
        // カラムが存在しない
        public const int VKZL310Trn_Err_Unique =  -13;
        // キー重複
        public const int VKZL310Trn_Err_Null =  -14;
        // NULL不可項目がNULLで追加・更新された
        public const int VKZL310Trn_Err_Lock =  -301;
        // 公益法人科目組み合わせ
        public static TKoekiPatternRec[] KPATLIST_1 = {
    {{31, 33}, {12, 11}, {true, false}, false} , 
    {{31, 36}, {12, 11}, {false, true}, false} , 
    {{33, 31}, {1, 2}, {true, false}, false} , 
    {{36, 31}, {1, 2}, {false, true}, false} , 
    {{32, 33}, {12, 11}, {true, false}, false} , 
    {{32, 36}, {12, 11}, {false, true}, false} , 
    {{33, 32}, {1, 2}, {true, false}, false} , 
    {{36, 32}, {1, 2}, {false, true}, false} , 
    {{33, 33}, {12, 2}, {true, true}, false} , 
    {{33, 34}, {1, 2}, {true, false}, false} , 
    {{33, 35}, {0, 12}, {true, false}, false} , 
    {{34, 33}, {12, 11}, {true, false}, false} , 
    {{35, 33}, {2, 0}, {true, false}, false} , 
    {{34, 36}, {12, 11}, {false, true}, false} , 
    {{36, 34}, {1, 2}, {false, true}, false} };
        // 新公益法人科目組み合わせ
        public static TKoekiPatternRec[] KPATLIST_1N = {
    {{31, 33}, {0, 11}, {true, true}, false} , 
    {{31, 34}, {0, 11}, {true, true}, false} , 
    {{31, 35}, {0, 11}, {true, true}, false} , 
    {{33, 31}, {1, 0}, {true, true}, false} , 
    {{34, 31}, {1, 0}, {true, true}, false} , 
    {{35, 31}, {1, 0}, {true, true}, false} , 
    {{32, 33}, {0, 11}, {true, true}, false} , 
    {{32, 34}, {0, 11}, {true, true}, false} , 
    {{32, 35}, {0, 11}, {true, true}, false} , 
    {{33, 32}, {1, 0}, {true, true}, false} , 
    {{34, 32}, {1, 0}, {true, true}, false} , 
    {{35, 32}, {1, 0}, {true, true}, false} , 
    {{34, 34}, {1, 11}, {true, true}, true} , 
    {{34, 35}, {1, 11}, {true, true}, true} , 
    {{35, 34}, {1, 11}, {true, true}, true} , 
    {{35, 35}, {1, 11}, {true, true}, true} };
        // 学校法人科目組み合わせ
        public static TKoekiPatternRec[] KPATLIST_2 = {
    {{1, 13}, {0, 11}, {true, false}, false} , 
    {{1, 14}, {0, 11}, {false, true}, false} , 
    {{1, 15}, {0, 11}, {true, false}, false} , 
    {{1, 16}, {0, 11}, {false, true}, false} , 
    {{1, 18}, {0, 11}, {false, true}, false} , 
    {{13, 1}, {1, 0}, {true, false}, false} , 
    {{14, 1}, {1, 0}, {false, true}, false} , 
    {{15, 1}, {1, 0}, {true, false}, false} , 
    {{16, 1}, {1, 0}, {false, true}, false} , 
    {{18, 1}, {1, 0}, {false, true}, false} , 
    {{11, 13}, {0, 11}, {true, false}, false} , 
    {{11, 14}, {0, 11}, {false, true}, false} , 
    {{11, 15}, {0, 11}, {true, false}, false} , 
    {{11, 16}, {0, 11}, {false, true}, false} , 
    {{11, 18}, {0, 11}, {false, true}, false} , 
    {{13, 11}, {1, 0}, {true, false}, false} , 
    {{14, 11}, {1, 0}, {false, true}, false} , 
    {{15, 11}, {1, 0}, {true, false}, false} , 
    {{16, 11}, {1, 0}, {false, true}, false} , 
    {{18, 11}, {1, 0}, {false, true}, false} , 
    {{12, 13}, {0, 11}, {true, false}, false} , 
    {{12, 14}, {0, 11}, {false, true}, false} , 
    {{12, 15}, {0, 11}, {true, false}, false} , 
    {{12, 16}, {0, 11}, {false, true}, false} , 
    {{12, 18}, {0, 11}, {false, true}, false} , 
    {{13, 12}, {1, 0}, {true, false}, false} , 
    {{14, 12}, {1, 0}, {false, true}, false} , 
    {{15, 12}, {1, 0}, {true, false}, false} , 
    {{16, 12}, {1, 0}, {false, true}, false} , 
    {{18, 12}, {1, 0}, {false, true}, false} , 
    {{13, 14}, {1, 11}, {false, true}, false} , 
    {{13, 15}, {1, 11}, {true, false}, false} , 
    {{13, 16}, {1, 11}, {false, true}, false} , 
    {{13, 18}, {1, 11}, {false, true}, false} , 
    {{14, 13}, {1, 11}, {false, true}, false} , 
    {{15, 13}, {1, 11}, {true, false}, false} , 
    {{16, 13}, {1, 11}, {false, true}, false} , 
    {{18, 13}, {1, 11}, {false, true}, false} , 
    {{14, 14}, {1, 11}, {false, true}, false} , 
    {{14, 15}, {1, 11}, {false, false}, false} , 
    {{14, 16}, {1, 11}, {false, true}, false} , 
    {{14, 18}, {1, 11}, {false, true}, false} , 
    {{15, 14}, {1, 11}, {false, false}, false} , 
    {{16, 14}, {1, 11}, {false, true}, false} , 
    {{18, 14}, {1, 11}, {false, true}, false} , 
    {{15, 15}, {1, 11}, {true, false}, false} , 
    {{15, 16}, {1, 11}, {false, false}, false} , 
    {{15, 18}, {1, 11}, {false, false}, false} , 
    {{16, 15}, {1, 11}, {false, false}, false} , 
    {{18, 15}, {1, 11}, {false, false}, false} , 
    {{16, 16}, {1, 11}, {false, true}, false} , 
    {{16, 18}, {1, 11}, {false, true}, false} , 
    {{18, 16}, {1, 11}, {false, true}, false} };
        // 新学校法人科目組み合わせ
        public static TKoekiPatternRec[] KPATLIST_2N = {
    {{1, 13}, {0, 11}, {true, false}, false} , 
    {{1, 14}, {0, 11}, {false, true}, false} , 
    {{1, 15}, {0, 11}, {true, false}, false} , 
    {{1, 16}, {0, 11}, {false, true}, false} , 
    {{1, 18}, {0, 11}, {false, true}, false} , 
    {{13, 1}, {1, 0}, {true, false}, false} , 
    {{14, 1}, {1, 0}, {false, true}, false} , 
    {{15, 1}, {1, 0}, {true, false}, false} , 
    {{16, 1}, {1, 0}, {false, true}, false} , 
    {{18, 1}, {1, 0}, {false, true}, false} , 
    {{11, 13}, {0, 11}, {true, false}, false} , 
    {{11, 14}, {0, 11}, {false, true}, false} , 
    {{11, 15}, {0, 11}, {true, false}, false} , 
    {{11, 16}, {0, 11}, {false, true}, false} , 
    {{11, 18}, {0, 11}, {false, true}, false} , 
    {{13, 11}, {1, 0}, {true, false}, false} , 
    {{14, 11}, {1, 0}, {false, true}, false} , 
    {{15, 11}, {1, 0}, {true, false}, false} , 
    {{16, 11}, {1, 0}, {false, true}, false} , 
    {{18, 11}, {1, 0}, {false, true}, false} , 
    {{12, 13}, {0, 11}, {true, false}, false} , 
    {{12, 14}, {0, 11}, {false, true}, false} , 
    {{12, 15}, {0, 11}, {true, false}, false} , 
    {{12, 16}, {0, 11}, {false, true}, false} , 
    {{12, 18}, {0, 11}, {false, true}, false} , 
    {{13, 12}, {1, 0}, {true, false}, false} , 
    {{14, 12}, {1, 0}, {false, true}, false} , 
    {{15, 12}, {1, 0}, {true, false}, false} , 
    {{16, 12}, {1, 0}, {false, true}, false} , 
    {{18, 12}, {1, 0}, {false, true}, false} , 
    {{13, 14}, {1, 11}, {false, true}, false} , 
    {{13, 15}, {1, 11}, {true, false}, false} , 
    {{13, 16}, {1, 11}, {false, true}, false} , 
    {{13, 18}, {1, 11}, {false, true}, false} , 
    {{14, 13}, {1, 11}, {false, true}, false} , 
    {{15, 13}, {1, 11}, {true, false}, false} , 
    {{16, 13}, {1, 11}, {false, true}, false} , 
    {{18, 13}, {1, 11}, {false, true}, false} , 
    {{14, 14}, {1, 11}, {false, true}, false} , 
    {{14, 15}, {1, 11}, {false, false}, false} , 
    {{14, 16}, {1, 11}, {false, true}, false} , 
    {{14, 18}, {1, 11}, {false, true}, false} , 
    {{15, 14}, {1, 11}, {false, false}, false} , 
    {{16, 14}, {1, 11}, {false, true}, false} , 
    {{18, 14}, {1, 11}, {false, true}, false} , 
    {{15, 15}, {1, 11}, {true, false}, false} , 
    {{15, 16}, {1, 11}, {false, false}, false} , 
    {{15, 18}, {1, 11}, {false, false}, false} , 
    {{16, 15}, {1, 11}, {false, false}, false} , 
    {{18, 15}, {1, 11}, {false, false}, false} , 
    {{16, 16}, {1, 11}, {false, true}, false} , 
    {{16, 18}, {1, 11}, {false, true}, false} , 
    {{18, 16}, {1, 11}, {false, true}, false} , 
    {{1, 21}, {0, 11}, {true, false}, false} , 
    {{21, 1}, {1, 0}, {true, false}, false} , 
    {{11, 21}, {0, 11}, {true, false}, false} , 
    {{21, 11}, {1, 0}, {true, false}, false} , 
    {{12, 21}, {0, 11}, {true, false}, false} , 
    {{21, 12}, {1, 0}, {true, false}, false} , 
    {{13, 21}, {0, 0}, {true, true}, false} , 
    {{21, 13}, {0, 0}, {true, true}, false} , 
    {{16, 21}, {0, 0}, {false, false}, false} , 
    {{21, 16}, {0, 0}, {false, false}, false} , 
    {{17, 21}, {0, 0}, {true, true}, false} , 
    {{21, 17}, {0, 0}, {true, true}, false} , 
    {{14, 21}, {0, 0}, {false, false}, false} , 
    {{21, 14}, {0, 0}, {false, false}, false} , 
    {{15, 21}, {1, 11}, {true, false}, false} , 
    {{21, 15}, {1, 11}, {true, false}, false} };
        // 宗教法人科目組み合わせ
        public static TKoekiPatternRec[] KPATLIST_3 = {
    {{1, 13}, {0, 11}, {true, false}, false} , 
    {{1, 16}, {0, 11}, {false, true}, false} , 
    {{1, 17}, {0, 11}, {true, false}, false} , 
    {{13, 1}, {1, 0}, {true, false}, false} , 
    {{16, 1}, {1, 0}, {false, true}, false} , 
    {{17, 1}, {1, 0}, {true, false}, false} , 
    {{11, 13}, {0, 11}, {true, false}, false} , 
    {{11, 16}, {0, 11}, {false, true}, false} , 
    {{11, 17}, {0, 11}, {true, false}, false} , 
    {{13, 11}, {1, 0}, {true, false}, false} , 
    {{16, 11}, {1, 0}, {false, true}, false} , 
    {{17, 11}, {1, 0}, {true, false}, false} , 
    {{12, 13}, {0, 11}, {true, false}, false} , 
    {{12, 16}, {0, 11}, {false, true}, false} , 
    {{12, 17}, {0, 11}, {true, false}, false} , 
    {{13, 12}, {1, 0}, {true, false}, false} , 
    {{16, 12}, {1, 0}, {false, true}, false} , 
    {{17, 12}, {1, 0}, {true, false}, false} , 
    {{13, 15}, {1, 0}, {true, true}, false} , 
    {{13, 16}, {0, 11}, {false, true}, false} , 
    {{15, 13}, {0, 11}, {true, true}, false} , 
    {{16, 13}, {1, 0}, {false, true}, false} , 
    {{15, 16}, {0, 11}, {false, true}, false} , 
    {{16, 15}, {1, 0}, {false, true}, false} , 
    {{16, 16}, {1, 11}, {false, true}, false} };
        // 社会福祉法人科目組み合わせ
        public static TKoekiPatternRec[] KPATLIST_4 = {
    {{1, 53}, {0, 11}, {true, false}, false} , 
    {{1, 55}, {0, 11}, {false, true}, false} , 
    {{53, 1}, {1, 0}, {true, false}, false} , 
    {{55, 1}, {1, 0}, {false, true}, false} , 
    {{51, 53}, {0, 11}, {true, false}, false} , 
    {{51, 55}, {0, 11}, {false, true}, false} , 
    {{53, 51}, {1, 0}, {true, false}, false} , 
    {{55, 51}, {1, 0}, {false, true}, false} , 
    {{52, 53}, {0, 11}, {true, false}, false} , 
    {{52, 55}, {0, 11}, {false, true}, false} , 
    {{53, 52}, {1, 0}, {true, false}, false} , 
    {{55, 52}, {1, 0}, {false, true}, false} , 
    {{53, 54}, {1, 0}, {true, true}, false} , 
    {{53, 55}, {0, 11}, {false, true}, false} , 
    {{54, 53}, {0, 11}, {true, true}, false} , 
    {{55, 53}, {1, 0}, {false, true}, false} , 
    {{54, 55}, {0, 11}, {false, true}, false} , 
    {{55, 54}, {1, 0}, {false, true}, false} , 
    {{55, 55}, {1, 11}, {false, true}, false} };
        // 新社会福祉法人科目組み合わせ
        public static TKoekiPatternRec[] KPATLIST_4N = {
    {{1, 53}, {0, 11}, {true, false}, false} , 
    {{1, 55}, {0, 11}, {false, true}, false} , 
    {{1, 58}, {0, 11}, {false, true}, false} , 
    {{1, 59}, {0, 11}, {true, false}, false} , 
    {{53, 1}, {1, 0}, {true, false}, false} , 
    {{55, 1}, {1, 0}, {false, true}, false} , 
    {{58, 1}, {1, 0}, {false, true}, false} , 
    {{59, 1}, {1, 0}, {true, false}, false} , 
    {{51, 53}, {0, 11}, {true, false}, false} , 
    {{51, 55}, {0, 11}, {false, true}, false} , 
    {{51, 58}, {0, 11}, {false, true}, false} , 
    {{51, 59}, {0, 11}, {true, false}, false} , 
    {{53, 51}, {1, 0}, {true, false}, false} , 
    {{55, 51}, {1, 0}, {false, true}, false} , 
    {{58, 51}, {1, 0}, {false, true}, false} , 
    {{59, 51}, {1, 0}, {true, false}, false} , 
    {{52, 53}, {0, 11}, {true, false}, false} , 
    {{52, 55}, {0, 11}, {false, true}, false} , 
    {{52, 58}, {0, 11}, {false, true}, false} , 
    {{52, 59}, {0, 11}, {true, false}, false} , 
    {{53, 52}, {1, 0}, {true, false}, false} , 
    {{55, 52}, {1, 0}, {false, true}, false} , 
    {{58, 52}, {1, 0}, {false, true}, false} , 
    {{59, 52}, {1, 0}, {true, false}, false} , 
    {{53, 55}, {0, 11}, {false, true}, false} , 
    {{53, 58}, {0, 11}, {false, true}, false} , 
    {{53, 59}, {1, 11}, {true, false}, false} , 
    {{55, 53}, {1, 0}, {false, true}, false} , 
    {{58, 53}, {1, 0}, {false, true}, false} , 
    {{59, 53}, {1, 11}, {true, false}, false} , 
    {{55, 55}, {1, 11}, {false, true}, false} , 
    {{58, 58}, {1, 11}, {false, true}, false} , 
    {{59, 59}, {1, 11}, {true, false}, false} , 
    {{56, 53}, {0, 0}, {true, true}, false} , 
    {{53, 56}, {0, 0}, {true, true}, false} , 
    {{1, 61}, {0, 11}, {true, false}, false} , 
    {{61, 1}, {1, 0}, {true, false}, false} , 
    {{51, 61}, {0, 11}, {true, false}, false} , 
    {{61, 51}, {1, 0}, {true, false}, false} , 
    {{52, 61}, {0, 11}, {true, false}, false} , 
    {{61, 52}, {1, 0}, {true, false}, false} , 
    {{53, 61}, {0, 0}, {true, true}, false} , 
    {{61, 53}, {0, 0}, {true, true}, false} , 
    {{55, 61}, {0, 0}, {false, false}, false} , 
    {{61, 55}, {0, 0}, {false, false}, false} , 
    {{56, 61}, {0, 0}, {true, true}, false} , 
    {{61, 56}, {0, 0}, {true, true}, false} , 
    {{58, 61}, {0, 0}, {false, false}, false} , 
    {{61, 58}, {0, 0}, {false, false}, false} , 
    {{59, 61}, {1, 11}, {true, false}, false} , 
    {{61, 59}, {1, 11}, {true, false}, false} };
        // ﾃｰﾌﾞﾙID
        public const int KTbl_KmkMA = 0;
        public const int KTbl_KmkMB = 1;
        public const int MAS310SELWND_SPACE_CODE = 3;
        public const int MAS310SELWND_SPACE_NAME = 3;
        // 5;
        public const int MAS310SELWND_THREAD_COUNT = 1;
        public const object MAS310SELWND_THREAD_TABLE1 = {VKZ310Cmnu.TWTableID.wtiKanjoKmk};
        // MAS310SELWND_THREAD_TABLE1	= [wtiKanjoKmk..wtiGinko,wtiKoji,wtiKosh];
        public const object MAS310SELWND_THREAD_TABLE2 = {VKZ310Cmnu.TWTableID.wtiTrhksaki};
        public const object MAS310SELWND_THREAD_TABLE3 = {VKZ310Cmnu.TWTableID.wtiShain};
        public const object MAS310SELWND_THREAD_TABLE4 = {VKZ310Cmnu.TWTableID.wtiBumon};
        public const object MAS310SELWND_THREAD_TABLE5 = {VKZ310Cmnu.TWTableID.wtiTeki};
        // -------------------------------------------------------------------------------------------
        // ID				 		値				内容						UPDATE
        // ------------------------------------------------------------------------------------------
        // ≪ステータス≫
        public const int EXCEPT_RET_OK = 0;
        // 正常
        public const int EXCEPT_RET_NG =  -1;
        // 失敗
        // ≪処理ID≫
        public const int MODE_INIT = 0;
        // 初期処理
        public const int MODE_TERM = 1;
        // 終了処理
        public const int MODE_SETEXCEPT = 2;
        // 排他情報 セット
        public const int MODE_RESETEXCEPT = 3;
        // 排他情報 リセット
        public const int MODE_RESETTERM = 4;
        // 自端末の排他情報 リセット
        public const int MODE_RELEASETERM = 5;
        // 全端末の排他情報 リセット
        // ≪排他ID≫
        public const int ID_BUSYO_EXP = 100;
        // 部署抽出
        public const int ID_BUSYO_IMP = 200;
        // 部署連結
        public const int ID_BUSYO_ELES = 300;
        // その他DB更新処理
        // 〜排他用マスタNO〜
        public const int ID_EXC_KAMOKU = 401;
        // 科目マスタ・実績更新
        public const int ID_EXC_HOJYO = 402;
        // 科目別補助マスタ・実績更新
        public const int ID_EXC_SIKIN = 403;
        // 資金繰マスタ・実績更新
        public const int ID_EXC_YBS = 404;
        // 要約B/Sマスタ・実績更新
        public const int ID_EXC_YPL = 405;
        // 要約P/Lマスタ・実績更新
        public const int ID_EXC_KOTEI = 406;
        // 固定変動マスタ・実績更新
        public const int ID_EXC_TITLE = 407;
        // タイトル科目マスタ・実績更新
        public const int ID_EXC_GO_KOJI = 408;
        // 工事合計科目マスタ・実績更新
        public const int ID_EXC_SUM_KOJI = 409;
        // 工事集計科目マスタ・実績更新
        public const int ID_EXC_ANALY = 410;
        // 分析科目マスタ・実績更新
        public const int ID_EXC_BM_MOTO = 416;
        // 部門元帳合計科目マスタ・実績更新
        public const int ID_EXC_HJ_MOTO = 417;
        // 補助元帳合計科目マスタ・実績更新
        public const int ID_EXC_BANK = 421;
        // 銀行マスタ・実績更新
        public const int ID_EXC_CUSTOMER = 422;
        // 取引先マスタ・実績更新
        public const int ID_EXC_STAFF = 425;
        // 社員マスタ・実績更新
        public const int ID_EXC_FREE_HOJO1 = 431;
        // 汎用補助1銀行マスタ・実績更新
        public const int ID_EXC_FREE_HOJO2 = 432;
        // 汎用補助2銀行マスタ・実績更新
        public const int ID_EXC_FREE_HOJO3 = 433;
        // 汎用補助3銀行マスタ・実績更新
        public const int ID_EXC_FREE_HOJO4 = 434;
        // 汎用補助4銀行マスタ・実績更新
        public const int ID_EXC_FREE_HOJO5 = 435;
        // 汎用補助5銀行マスタ・実績更新
        public const int ID_EXC_BUMON = 441;
        // 部門マスタ・実績更新
        public const int ID_EXC_SEGMENT = 442;
        // セグメントマスタ・実績更新
        public const int ID_EXC_KOJI = 451;
        // 工事マスタ・実績更新
        public const int ID_EXC_TEKIYO = 461;
        // 摘要マスタ・実績更新
        public const int ID_EXC_ELSE = 499;
        // その他
        // 〜チェック用マスタNO〜
        public const int ID_CHK_SIWAKE = 500;
        // 仕訳
        public const int ID_CHK_KAMOKU = 501;
        // 科目マスタ・実績更新
        public const int ID_CHK_HOJYO = 502;
        // 科目別補助マスタ・実績更新
        public const int ID_CHK_SIKIN = 503;
        // 資金繰マスタ・実績更新
        public const int ID_CHK_YBS = 504;
        // 要約B/Sマスタ・実績更新
        public const int ID_CHK_YPL = 505;
        // 要約P/Lマスタ・実績更新
        public const int ID_CHK_KOTEI = 506;
        // 固定変動マスタ・実績更新
        public const int ID_CHK_TITLE = 507;
        // タイトル科目マスタ・実績更新
        public const int ID_CHK_GO_KOJI = 508;
        // 工事合計科目マスタ・実績更新
        public const int ID_CHK_SUM_KOJI = 509;
        // 工事集計科目マスタ・実績更新
        public const int ID_CHK_ANALY = 510;
        // 分析科目マスタ・実績更新
        public const int ID_CHK_BM_MOTO = 516;
        // 部門元帳合計科目マスタ・実績更新
        public const int ID_CHK_HJ_MOTO = 517;
        // 補助元帳合計科目マスタ・実績更新
        public const int ID_CHK_BANK = 521;
        // 銀行マスタ・実績更新
        public const int ID_CHK_CUSTOMER = 522;
        // 取引先マスタ・実績更新
        public const int ID_CHK_STAFF = 525;
        // 社員マスタ・実績更新
        public const int ID_CHK_FREE_HOJO1 = 531;
        // 汎用補助1銀行マスタ・実績更新
        public const int ID_CHK_FREE_HOJO2 = 532;
        // 汎用補助2銀行マスタ・実績更新
        public const int ID_CHK_FREE_HOJO3 = 533;
        // 汎用補助3銀行マスタ・実績更新
        public const int ID_CHK_FREE_HOJO4 = 534;
        // 汎用補助4銀行マスタ・実績更新
        public const int ID_CHK_FREE_HOJO5 = 535;
        // 汎用補助5銀行マスタ・実績更新
        public const int ID_CHK_BUMON = 541;
        // 部門マスタ・実績更新
        public const int ID_CHK_SEGMENT = 542;
        // セグメントマスタ・実績更新
        public const int ID_CHK_KOJI = 551;
        // 工事マスタ・実績更新
        public const int ID_CHK_TEKIYO = 561;
        // 摘要マスタ・実績更新
        public const int ID_CHK_ELSE = 599;
        // その他
        // ≪ミューテックス名称≫
        public const string MUTEXNAME = "MASEXCEPT_MUTEX_";
    } // end MAS310000u

}

